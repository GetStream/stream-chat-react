---
id: message_ui
title: Message UI
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

Message UI is one of the main building blocks of the chat application. Designing proper message UI is no easy feat and that's why our SDK comes with a pre-built component ([`MessageSimple`](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/MessageSimple.tsx)) which is packed with functionality and is easy to customize through [our CSS variables](../../theming/component-variables.mdx) or through component replacement ([Component Context](../../components/contexts/component-context.mdx#message)).

In this guide we'll build a simplified custom message UI component combining pre-built and other completely custom components.

Message UI and all of its children can access [`MessageContext`](../../components/contexts/message-context.mdx) in which it's wrapped, and therefore can call the `useMessageContext` hook accessing all of the message related information and functions alike.

## Custom Message UI

### Message Text and Avatars

Let's begin with the simplest form the message UI can take: rendering the raw message text.

```tsx
import { useMessageContext, Channel } from 'stream-chat-react';

const CustomMessageUi = () => {
  const { message } = useMessageContext();

  return <div data-message-id={message.id}>{message.text}</div>;
};
```

To see our changes we'll need to pass this component down to either `Channel` or `MessageList` (`VirtualizedMessageList`) components as `Message` prop.

```tsx
<Channel Message={CustomMessageUi}>...</Channel>
```

![](../../assets/custom-message-ui-0.png)

You can see that all of the messages are now on one side and we have no idea who's the message coming from, let's adjust that with the help of some CSS and to render the name of the sender we'll need to access `user` property of the `message` object.

Our message will be on the right and the message of the other senders will be on the left side of the screen.

<Tabs groupId="example">
<TabItem value="js" label="React">

```tsx
import { useMessageContext, Channel } from 'stream-chat-react';

const CustomMessageUi = () => {
  const { isMyMessage, message } = useMessageContext();

  const messageUiClassNames = ['custom-message-ui'];

  if (isMyMessage()) {
    messageUiClassNames.push('custom-message-ui--mine');
  } else {
    messageUiClassNames.push('custom-message-ui--other');
  }

  return (
    <div className={messageUiClassNames.join(' ')} data-message-id={message.id}>
      <strong className='custom-message-ui__name'>{message.user?.name || message.user?.id}</strong>
      <span>{message.text}</span>
    </div>
  );
};
```

</TabItem>

<TabItem value='css' label='CSS'>

```css
.custom-message-ui {
  --cmui-gap-size: 0.5rem;
  --cmui-inline-spacing: 2rem;
  --cmui-block-spacing: 0.5rem;

  display: flex;
  gap: var(--cmui-gap-size);
  padding-inline: var(--cmui-inline-spacing);
  padding-block: var(--cmui-block-spacing);
}

.custom-message-ui__name {
  display: flex;
  gap: var(--cmui-gap-size);
}

.custom-message-ui--mine .custom-message-ui__name::before {
  content: '<';
}

.custom-message-ui--other .custom-message-ui__name::after {
  content: '>';
}

.custom-message-ui--mine {
  flex-direction: row-reverse;
  text-align: right;
}
```

</TabItem>
</Tabs>

![](../../assets/custom-message-ui-1.png)

Now this already looks way better than the initial version but we can do better - let's switch from names to avatars using pre-built [`Avatar`](../../components/utility-components/avatar.mdx) component to make the UI slightly friendlier.

<Tabs groupId='example'>
<TabItem value='js' label='React'>

```tsx
import { Avatar, useMessageContext, Channel } from 'stream-chat-react';

const CustomMessageUi = () => {
  const { isMyMessage, message } = useMessageContext();

  const messageUiClassNames = ['custom-message-ui'];

  if (isMyMessage()) {
    messageUiClassNames.push('custom-message-ui--mine');
  } else {
    messageUiClassNames.push('custom-message-ui--other');
  }

  return (
    <div className={messageUiClassNames.join(' ')} data-message-id={message.id}>
      <Avatar image={message.user?.image} name={message.user?.name || message.user?.id} />
      <span className='custom-message-ui__text'>{message.text}</span>
    </div>
  );
};
```

</TabItem>
<TabItem value='css' label='CSS'>

```css
.custom-message-ui {
  --cmui-gap-size: 0.5rem;
  --cmui-inline-spacing: 2rem;
  --cmui-block-spacing: 0.5rem;

  display: flex;
  gap: var(--cmui-gap-size);
  padding-inline: var(--cmui-inline-spacing);
  padding-block: var(--cmui-block-spacing);
}

.custom-message-ui__text {
  display: flex;
  flex-direction: column;
  align-self: center;
}

.custom-message-ui--mine {
  flex-direction: row-reverse;
  text-align: right;
}
```

</TabItem>
</Tabs>

![](../../assets/custom-message-ui-2.png)

Our message UI looks pretty good now but what if text of a message becomes more complex? Let's say someone sends a link to a site or mentions some other user? In the current state our UI would display this in plaintext and none of it would be interactive.

![](../../assets/custom-message-ui-3a.png)

Let's enhance this behavior by using pre-built [`MessageText`](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/MessageText.tsx) which uses [`renderText`](../../components/message-components/render-text.mdx) internally and that'll transform all of our links, mentions and certain Markdown syntax to interactive and neat-looking elements.

<Tabs groupId='example'>
<TabItem value='js' label='React'>

```tsx
import { Avatar, MessageText, useMessageContext, Channel } from 'stream-chat-react';

const CustomMessageUi = () => {
  const { isMyMessage, message } = useMessageContext();

  const messageUiClassNames = ['custom-message-ui'];

  if (isMyMessage()) {
    messageUiClassNames.push('custom-message-ui--mine');
  } else {
    messageUiClassNames.push('custom-message-ui--other');
  }

  return (
    <div className={messageUiClassNames.join(' ')} data-message-id={message.id}>
      <Avatar image={message.user?.image} name={message.user?.name || message.user?.id} />
      <MessageText />
    </div>
  );
};
```

</TabItem>
<TabItem value='css' label='css'>

```css
.custom-message-ui {
  --cmui-gap-size: 0.5rem;
  --cmui-inline-spacing: 2rem;
  --cmui-block-spacing: 0.5rem;

  display: flex;
  gap: var(--cmui-gap-size);
  padding-inline: var(--cmui-inline-spacing);
  padding-block: var(--cmui-block-spacing);
}

.custom-message-ui--mine {
  flex-direction: row-reverse;
  text-align: right;
}

.custom-message-ui .str-chat__message-text p {
  all: unset;
}

.custom-message-ui .str-chat__message-text {
  display: flex;
  flex-direction: column;
  align-self: center;
}

.custom-message-ui .str-chat__message-mention {
  font-weight: bold;
  color: palevioletred;
  cursor: pointer;
}
```

</TabItem>
</Tabs>

![](../../assets/custom-message-ui-3b.png)

:::note
While the mentioned user is being highlighted there's no default pointer event attached to the highlighted element, see [Mentions Actions guide](./actions/mentions-hover-click.mdx) for more information.
:::

### Metadata

So far we've covered avatars and proper text rendering but the UI still feels a bit empty. Each message has a lot of extra information which can be benefitial to the end users. Let's add creation date, "edited" flag and delivery/read status information to our message UI.

<Tabs groupId='example'>
<TabItem value='js' label='React'>

```tsx
import { Avatar, MessageText, useMessageContext, useChatContext, Channel } from 'stream-chat-react';

const statusIconMap = {
  received: 'âœ…',
  receivedAndRead: 'ðŸ‘ï¸',
  sending: 'ðŸ›«',
  unknown: 'â“',
};

const CustomMessageUiMetadata = () => {
  const {
    message: { created_at, message_text_updated_at, status = 'unknown' },
    readBy = [],
  } = useMessageContext();
  const { client } = useChatContext();

  const [firstUser] = readBy;

  const receivedAndRead = readBy.length > 1 || (firstUser && firstUser.id !== client.user?.id);

  return (
    <div className='custom-message-ui__metadata'>
      <div className='custom-message-ui__metadata-created-at'>{created_at?.toLocaleString()}</div>
      <div className='custom-message-ui__metadata-read-status'>
        {receivedAndRead
          ? statusIconMap.receivedAndRead
          : statusIconMap[status as keyof typeof statusIconMap] ?? statusIconMap.unknown}
      </div>
      {message_text_updated_at && (
        <div className='custom-message-ui__metadata-edited-status' title={message_text_updated_at}>
          Edited
        </div>
      )}
    </div>
  );
};

const CustomMessageUi = () => {
  const { isMyMessage, message } = useMessageContext();

  const messageUiClassNames = ['custom-message-ui'];

  if (isMyMessage()) {
    messageUiClassNames.push('custom-message-ui--mine');
  } else {
    messageUiClassNames.push('custom-message-ui--other');
  }

  return (
    <div className={messageUiClassNames.join(' ')} data-message-id={message.id}>
      <div className='custom-message-ui__body'>
        <Avatar image={message.user?.image} name={message.user?.name || message.user?.id} />
        <MessageText />
      </div>
      <CustomMessageUiMetadata />
    </div>
  );
};
```

</TabItem>
<TabItem value='css' label='css'>

```css
.custom-message-ui {
  --cmui-gap-size-md: 0.5rem;
  --cmui-gap-size-sm: 0.2rem;
  --cmui-inline-spacing: 2rem;
  --cmui-block-spacing: 0.5rem;

  display: flex;
  flex-direction: column;
  gap: var(--cmui-gap-size-md);
  padding-inline: var(--cmui-inline-spacing);
  padding-block: var(--cmui-block-spacing);
}

.custom-message-ui__body {
  gap: var(--cmui-gap-size-md);
  display: flex;
}

.custom-message-ui--mine .custom-message-ui__body {
  flex-direction: row-reverse;
  text-align: right;
}

.custom-message-ui__metadata {
  display: flex;
  font-size: x-small;
  align-items: baseline;
}

.custom-message-ui__metadata > *:nth-child(even)::after,
.custom-message-ui__metadata > *:nth-child(even)::before {
  content: 'â€¢';
  padding-inline: var(--cmui-gap-size-sm);
}

.custom-message-ui__metadata > *:last-child::after {
  content: '';
}

.custom-message-ui--mine .custom-message-ui__metadata {
  align-self: flex-end;
}

.custom-message-ui .str-chat__message-text p {
  all: unset;
}

.custom-message-ui .str-chat__message-text {
  display: flex;
  flex-direction: column;
  align-self: center;
}

.custom-message-ui .str-chat__message-mention {
  font-weight: bold;
  color: palevioletred;
  cursor: pointer;
}
```

</TabItem>
</Tabs>

![](../../assets/custom-message-ui-4.png)

Message grouping is being managed automatically by the SDK and each parent element (which holds our message UI) receives appropriate class name based on which we can adjust our rules to display metadata elements only when it's appropriate to make our UI look less busy.

TODO: link to grouping logic (maybe how to adjust it if needed)

```css
.custom-message-ui__metadata {
  /* removed-line */
  display: flex;
  /* added-line */
  display: none;
  font-size: x-small;
  align-items: baseline;
}

/* added-block-start */
.str-chat__li--bottom .custom-message-ui__metadata,
.str-chat__li--single .custom-message-ui__metadata {
  display: flex;
}
/* added-block-end */
```

![](../../assets/custom-message-ui-5.png)

:::note
You can utilize [`MessageContext`](../../components/contexts/message-context.mdx) properties [`firstOfGroup`](../../components/contexts/message-context.mdx#firstofgroup), [`endOfGroup`](../../components/contexts/message-context.mdx#endofgroup) and [`groupedByUser`](../../components/contexts/message-context.mdx#groupedbyuser) if you use [`VirtualizedMessageList`](../../components/core-components/virtualized-list.mdx) for conditional metadata rendering. These properties **are not available** in regular [`MessageList`](../../components/core-components/message-list.mdx).
:::

The SDK also comes with [`MessageStatus`](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/MessageStatus.tsx) and [`MessageTimestamp`](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/MessageTimestamp.tsx) components which you can use to replace our custom made ones. These components come with some extra logic but essentially provide almost identical amount of utility for the end users so we won't be covering the replacement in this guide.

### Message Actions and Reactions

Up to this point we've covered mostly the presentational part of our message UI and apart from the mentions and links there's not much the end users can interact with. Obviously - the SDK offers so much more so in this section of the guide we'll explain how to add and enable message actions (pinning, deleting, replies, etc.) and reactions.

Let's begin by adding a reply count to our `CustomMessageUiMetadata` component. At this point nothing will be displayed but once we implement the thread functionality we'll see the count indicator rendered beside the rest of the metadata elements.

TODO: cover message actions + reactions
TODO?: cover edit and bouncing dialogs

### Attachments

TODO: cover attachments (link to appropriate guide)
