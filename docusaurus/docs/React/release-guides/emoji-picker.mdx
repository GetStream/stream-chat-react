---
id: new-emoji-picker-integration
sidebar_position: 3
title: EmojiPicker Integration (11.0.0)
keywords: [migration guide, upgrade, emoji picker, breaking changes, v11]
---

import GHComponentLink from '../_docusaurus-components/GHComponentLink';

## Dropping support for built-in `EmojiPicker` (with breaking changes)

By default - our SDK would ship with `emoji-mart` dependency on top of which our `EmojiPicker` component is built. And since the SDK is using `emoji-mart` for this component - it was also reused for reactions (`ReactionsList` and `ReactionSelector`) and suggestion list (`MessageInput`). This solution proved to be very uncomfortable to work with when it came to replacing either of the mentioned components (or disabling them completely) and the final applications using our SDK would still bundle certain `emoji-mart` parts which weren't needed (or seemingly "disabled") resulting in sub-optimal load times. Maintaining such architecture became a burden so we're switching things a bit.

## Changes to the default component composition (architecture)

Component now comes as two-part "bundle" - a button and an actual picker element. The component now holds its own `open` state which is handled by the button.

{/_ TODO: extend once you have the component ready _/}
{/_ TODO: mention that we're dropping the EmojiContext _/}

## Switching to opt-in mechanism (BREAKING CHANGE)

We made `emoji-mart` package in our SDK completely optional which means that `EmojiPicker` component is now disabled by default.

### Reinstate the `EmojiPicker` component

Add `emoji-mart` to your packages and make sure the package versions fit our peer-dependency requirements:

```bash
yarn add emoji-mart@^5.5.2 @emoji-mart/data@^1.1.2 @emoji-mart/react@^1.1.1
```

\\Import `EmojiPicker` component from the `stream-chat-react` package:

```tsx
import { Channel } from 'stream-chat-react';
import { EmojiPicker } from 'stream-chat-react/emojis';

// and apply it to the Channel (component context)

const ChannelWrapper = ({ children }) => {
  return <Channel EmojiPicker={EmojiPicker}>{children}</Channel>;
};
```

### Build your custom `EmojiPicker` (example)

If `emoji-mart` is too heavy for your use-case and you'd like to build your own you can certainly do so, here's a simple `EmojiPicker` built using `emoji-picker-react` package:

```tsx
import EmojiPicker from 'emoji-picker-react';
import { useMessageInputContext } from 'stream-chat-react';

export const CustomEmojiPicker = () => {
  const [open, setOpen] = useState(false);

  const { insertText, textareaRef } = useMessageInputContext();

  return (
    <>
      <button onClick={() => setOpen((cv) => !cv)}>Open EmojiPicker</button>

      {open && (
        <EmojiPicker
          onEmojiClick={(emoji, event) => {
            insertText(e.native);
            textareaRef.current?.focus(); // returns focus back to the message input element
          }}
        />
      )}
    </>
  );
};

// and apply it to the Channel (component context)
```

You can make the component slightly better using `FloatingUI` by wrapping the actual picker element to make it float perfectly positioned above the button. See the source of the component which comes with the SDK for inspiration.
{/_ TODO: provide link to the source (once ready) _/}
