---
id: emoji-search-index-integration-v11
sidebar_position: 4
title: Emoji Search Index Integration (11.0.0)
keywords: [migration guide, upgrade, emoji search index, breaking changes, v11]
---

## Dropping support for built-in `EmojiIndex`

By default, our SDK comes bundled with the `emoji-mart`'s (`emojiIndex`)[https://github.com/missive/emoji-mart/tree/v3.0.1#headless-search]. This index serves as a tool for efficiently searching through the emoji list and returning a subset that matches the search criteria (query). Within our SDK, this functionality is utilized by our autocomplete component, triggered by entering `:<query>` to the meessage input. This functionality will continue to be integrated within our SDK. However, due to our decision to discontinue the use of `emoji-mart` within the SDK, this feature will now be available on an opt-in basis. With the updated types and interface this will also allow integrators to supply their own `emojiSearchIndex` instead of relying exclusively on the one supplied by `emoji-mart`.

### Reinstate emoji autocomplete behavior (search for emojis with `:`)

Add `emoji-mart` to your packages and make sure the package versions fit our peer-dependency requirements:

```bash
yarn add emoji-mart@^5.5.2 @emoji-mart/data@^1.1.2
```

\Import `SearchIndex` and `data` from `emoji-mart`, initiate these data and then and pass `SearchIndex` to our `MessageInput` component:

```tsx
import { MessageInput } from 'stream-chat-react';
import { init, SearchIndex } from 'emoji-mart';
import data from '@emoji-mart/data';

init({ data });

export const WrappedMessageInput = () => {
  return <MessageInput emojiSearchIndex={SearchIndex} focus />;
};
```

### Build your custom `emojiSearchIndex`

## Prerequisities

Your data returned from the `search` method should have _at least_ these three properies which our SDK relies on:

- name - display name for the emoji, ie: `"Smile"`
- id - unique emoji identificator
- skins - an array of emojis with different skins (our SDK uses only the first one in this array), ie: `[{ native: "ðŸ˜„" }]`

Optional properties:

- emoticons - an array of strings to match substitutions with, ie: `[":D", ":-D", ":d"]`
- native - native emoji string (old `emoji-mart` API), ie: `"ðŸ˜„"` - will be prioritized if specified

## Example

```tsx
import search from '@jukben/emoji-search';

const emoticonMap: Record<string, string[]> = {
  'ðŸ˜ƒ': [':D', ':-D'],
  'ðŸ˜‘': ['-_-'],
  'ðŸ˜¢': [":'("],
};

const emojiSearchIndex: EmojiSearchIndex = {
  search: (query) => {
    const results = search(query);

    return results.slice(0, 15).map((data) => ({
      emoticons: emoticonMap[data.name],
      id: data.name,
      name: data.keywords.slice(1, data.keywords.length).join(', '),
      native: data.name,
      skins: [],
    }));
  },
};

export const WrappedChannel = ({ children }) => (
  <Channel emojiSearchIndex={emojiSearchIndex}>{children}</Channel>
);
```

### Migrate from `v10` to `v11` (`EmojiIndex` becomes `emojiSearchIndex`)

`EmojiIndex` has previously lived in the `EmojiContext` passed to through `Channel` component. But since `EmojiContext` no longer exists in our SDK, the property has been moved to our `ComponentContext` (still passed through `Channel`) and changed its name to `emojiSearchIndex` to properly repesent its funtionality. If your custom `EmojiIndex` worked with our default components in `v10` then it should still work in `v11` without any changes to its `search` method output:

Your old code:

```tsx
import { Channel, MessageInput } from 'stream-chat-react';
// arbitrary import
import { CustomEmojiIndex } from './CustomEmojiIndex';

const App = () => {
  return (
    <Channel EmojiIndex={CustomEmojiIndex}>
      {/* other components */}
      <MessageInput />
    </Channel>
  );
};
```

Should newly look like this:

```tsx
import { Channel, MessageInput } from 'stream-chat-react';
// arbitrary import
import { CustomEmojiIndex } from './CustomEmojiIndex';

const App = () => {
  return (
    <Channel emojiSearchIndex={CustomEmojiIndex}>
      {/* other components */}
      <MessageInput />
    </Channel>
  );
};
```

Or enable it in either of the `MessageInput` components individually:

```tsx
import { Channel, MessageInput } from 'stream-chat-react';
// arbitrary import
import { CustomEmojiIndex } from './CustomEmojiIndex';

const App = () => {
  return (
    <Channel>
      {/* other components */}
      <MessageInput emojiSearchIndex={CustomEmojiIndex} />
      <Thread additionalMessageInputProps={{ emojiSearchIndex: CustomEmojiIndex }} />
    </Channel>
  );
};
```
