{"version":3,"file":"index.js","sources":["../src/context/ChatContext.js","../src/context/ChannelContext.js","../src/context/TranslationContext.js","../src/utils.js","../src/i18n/Streami18n.js","../src/components/Attachment/AttachmentActions.js","../src/components/Attachment/Audio.js","../src/assets/Poweredby_100px-White_VertText.png","../src/components/SafeAnchor/SafeAnchor.js","../src/components/Attachment/Card.js","../src/components/Attachment/FileAttachment.js","../src/components/Gallery/ModalImage.js","../src/components/Gallery/ModalWrapper.js","../src/components/Gallery/Gallery.js","../src/components/Gallery/Image.js","../src/components/Attachment/Attachment.js","../src/components/AutoCompleteTextarea/listener.js","../src/components/AutoCompleteTextarea/Item.js","../src/components/AutoCompleteTextarea/List.js","../src/components/AutoCompleteTextarea/utils.js","../src/components/AutoCompleteTextarea/Textarea.js","../src/components/Avatar/Avatar.js","../src/components/ChannelPreview/ChannelPreviewCountOnly.js","../src/components/ChannelPreview/utils.js","../src/components/ChannelPreview/ChannelPreview.js","../src/components/ChannelPreview/ChannelPreviewCompact.js","../src/components/ChannelPreview/ChannelPreviewLastMessage.js","../src/components/ChannelPreview/ChannelPreviewMessenger.js","../src/components/Message/icons.js","../src/components/Message/MessageRepliesCountButton.js","../src/components/Modal/Modal.js","../src/components/Loading/LoadingChannels.js","../src/components/Loading/LoadingErrorIndicator.js","../src/components/Loading/LoadingIndicator.js","../src/components/EmoticonItem/EmoticonItem.js","../src/components/UserItem/UserItem.js","../src/components/CommandItem/CommandItem.js","../src/components/ChatAutoComplete/ChatAutoComplete.js","../src/components/Tooltip/Tooltip.js","../src/components/MessageInput/hooks/messageInput.js","../src/components/MessageInput/EmojiPicker.js","../src/components/MessageInput/UploadsPreview.js","../src/components/MessageInput/SendButton.js","../src/components/MessageInput/MessageInputLarge.js","../src/components/MessageInput/MessageInput.js","../src/components/MessageInput/MessageInputFlat.js","../src/components/MessageInput/MessageInputSmall.js","../src/components/MessageInput/EditMessageForm.js","../src/components/Reactions/ReactionSelector.js","../src/components/Reactions/ReactionsList.js","../src/components/Reactions/SimpleReactionsList.js","../src/components/Message/hooks/useActionHandler.js","../src/components/Message/hooks/useDeleteHandler.js","../src/components/Message/hooks/useEditHandler.js","../src/components/Message/utils.js","../src/components/Message/hooks/useFlagHandler.js","../src/components/Message/hooks/useMentionsHandler.js","../src/components/Message/hooks/useMuteHandler.js","../src/components/Message/hooks/useOpenThreadHandler.js","../src/components/Message/hooks/useReactionHandler.js","../src/components/Message/hooks/useRetryHandler.js","../src/components/Message/hooks/useUserHandler.js","../src/components/Message/hooks/useUserRole.js","../src/components/MessageActions/MessageActionsBox.js","../src/components/MessageActions/MessageActions.js","../src/components/Message/MessageOptions.js","../src/components/Message/MessageText.js","../src/components/Message/MessageDeleted.js","../src/components/Message/MessageTimestamp.js","../src/components/Message/MessageSimple.js","../src/components/Message/Message.js","../src/components/Message/MessageCommerce.js","../src/components/Message/MessageLivestream.js","../src/components/Message/MessageTeam.js","../src/components/Channel/hooks/useMentionsHandlers.js","../src/components/Channel/hooks/useEditMessageHandler.js","../src/components/Channel/channelState.js","../src/components/Channel/Channel.js","../src/components/ChannelHeader/ChannelHeader.js","../src/assets/str-chat__connection-error.svg","../src/components/ChatDown/ChatDown.js","../src/assets/str-chat__icon-chevron-down.svg","../src/components/ChannelList/ChannelListTeam.js","../src/components/LoadMore/LoadMoreButton.js","../src/components/LoadMore/LoadMorePaginator.js","../src/components/EmptyStateIndicator/EmptyStateIndicator.js","../src/components/ChannelList/utils.js","../src/components/ChannelList/hooks/useMessageNewListener.js","../src/components/ChannelList/hooks/useNotificationMessageNewListener.js","../src/components/ChannelList/hooks/useNotificationAddedToChannelListener.js","../src/components/ChannelList/hooks/useNotificationRemovedFromChannelListener.js","../src/components/ChannelList/hooks/useChannelDeletedListener.js","../src/components/ChannelList/hooks/useChannelTruncatedListener.js","../src/components/ChannelList/hooks/useChannelUpdatedListener.js","../src/components/ChannelList/hooks/useChannelHiddenListener.js","../src/components/ChannelList/hooks/useChannelVisibleListener.js","../src/components/ChannelList/hooks/useConnectionRecoveredListener.js","../src/components/ChannelList/hooks/useUserPresenceChangedListener.js","../src/components/ChannelList/hooks/usePaginatedChannels.js","../src/components/ChannelList/hooks/useMobileNavigation.js","../src/components/ChannelList/ChannelList.js","../src/components/ChannelList/ChannelListMessenger.js","../src/components/ChannelSearch/ChannelSearch.js","../src/components/Chat/Chat.js","../src/components/DateSeparator/DateSeparator.js","../src/components/EventComponent/EventComponent.js","../src/components/InfiniteScrollPaginator/InfiniteScroll.js","../src/components/InfiniteScrollPaginator/InfiniteScrollPaginator.js","../src/components/InfiniteScrollPaginator/ReverseInfiniteScroll.js","../src/components/MessageList/Center.js","../src/components/MessageList/MessageNotification.js","../src/components/MessageList/CustomNotification.js","../src/components/MessageList/MessageListInner.js","../src/components/MessageList/MessageList.js","../src/components/MessageList/FastMessageList.js","../src/components/Thread/Thread.js","../src/components/TypingIndicator/TypingIndicator.js","../src/components/Window/Window.js"],"sourcesContent":["// @ts-check\nimport React from 'react';\nimport { StreamChat } from 'stream-chat';\n\n/**\n * @typedef {import('types').ChatContextValue} ChatContextProps\n */\n\nexport const ChatContext = React.createContext(\n  /** @type {ChatContextProps} */ ({\n    client: new StreamChat(''),\n    setActiveChannel: () => null,\n  }),\n);\n\n/**\n * @function\n * @template P\n * @param {React.ComponentType<P>} OriginalComponent\n * @returns {React.ComponentType<Exclude<P, ChatContextProps>>}\n */\nexport function withChatContext(OriginalComponent) {\n  /** @param {Exclude<P, ChatContextProps>} props */\n  const ContextAwareComponent = function ContextComponent(props) {\n    return (\n      <ChatContext.Consumer>\n        {(context) => <OriginalComponent {...context} {...props} />}\n      </ChatContext.Consumer>\n    );\n  };\n\n  ContextAwareComponent.displayName = (\n    OriginalComponent.displayName ||\n    OriginalComponent.name ||\n    'Component'\n  ).replace('Base', '');\n\n  return ContextAwareComponent;\n}\n","// @ts-check\n\nimport React from 'react';\n\n/**\n * @typedef {import('types').ChannelContextValue} ChannelContextProps\n */\n\nexport const ChannelContext = React.createContext(\n  /** @type {ChannelContextProps} */ ({}),\n);\n\n/**\n * @function\n * @template P\n * @param { React.ComponentType<P> } OriginalComponent\n * @returns {React.ComponentType<Exclude<P, ChannelContextProps>>}\n */\nexport function withChannelContext(OriginalComponent) {\n  /** @param {Exclude<P, ChannelContextProps>} props */\n  const ContextAwareComponent = function ContextComponent(props) {\n    return (\n      <ChannelContext.Consumer>\n        {(context) => <OriginalComponent {...context} {...props} />}\n      </ChannelContext.Consumer>\n    );\n  };\n\n  ContextAwareComponent.displayName = (\n    OriginalComponent.displayName ||\n    OriginalComponent.name ||\n    'Component'\n  ).replace('Base', '');\n\n  return ContextAwareComponent;\n}\n","// @ts-check\n\nimport React from 'react';\nimport Dayjs from 'dayjs';\nimport LocalizedFormat from 'dayjs/plugin/localizedFormat';\n\nDayjs.extend(LocalizedFormat);\n\n/**\n * @typedef {Required<import('types').TranslationContextValue>} TranslationContextProps\n */\n\nexport const TranslationContext = React.createContext(\n  /** @type {TranslationContextProps} */ ({\n    t: /** @param {string} key */ (key) => key,\n    tDateTimeParser: (input) => Dayjs(input),\n  }),\n);\n\n/**\n * @function\n * @template P\n * @param {React.ComponentType<P>} OriginalComponent\n * @returns {React.ComponentType<Exclude<P, TranslationContextProps>>}\n */\nexport function withTranslationContext(OriginalComponent) {\n  /** @param {Exclude<P, TranslationContextProps>} props */\n  const ContextAwareComponent = function ContextComponent(props) {\n    return (\n      <TranslationContext.Consumer>\n        {(context) => <OriginalComponent {...context} {...props} />}\n      </TranslationContext.Consumer>\n    );\n  };\n\n  ContextAwareComponent.displayName = (\n    OriginalComponent.displayName ||\n    OriginalComponent.name ||\n    'Component'\n  ).replace('Base', '');\n\n  return ContextAwareComponent;\n}\n","/* eslint-disable */\nimport emojiRegex from 'emoji-regex';\nimport ReactMarkdown from 'react-markdown/with-html';\nimport data from 'emoji-mart/data/all.json';\nimport React from 'react';\nimport { find as linkifyFind } from 'linkifyjs/lib/linkify';\n\nexport const emojiSetDef = {\n  spriteUrl: 'https://getstream.imgix.net/images/emoji-sprite.png',\n  size: 20,\n  sheetColumns: 2,\n  sheetRows: 3,\n  sheetSize: 64,\n};\n\nexport const commonEmoji = {\n  emoticons: [],\n  short_names: [],\n  custom: true,\n};\n/** @type {import(\"types\").MinimalEmojiInterface[]} */\nexport const defaultMinimalEmojis = [\n  {\n    id: 'like',\n    name: 'like',\n    colons: ':+1:',\n    sheet_x: 0,\n    sheet_y: 0,\n    ...commonEmoji,\n    ...emojiSetDef,\n  },\n  {\n    id: 'love',\n    name: 'love',\n    colons: ':heart:',\n    sheet_x: 1,\n    sheet_y: 2,\n    ...commonEmoji,\n    ...emojiSetDef,\n  },\n  {\n    id: 'haha',\n    name: 'haha',\n    colons: ':joy:',\n    sheet_x: 1,\n    sheet_y: 0,\n    ...commonEmoji,\n    ...emojiSetDef,\n  },\n  {\n    id: 'wow',\n    name: 'wow',\n    colons: ':astonished:',\n    sheet_x: 0,\n    sheet_y: 2,\n    ...commonEmoji,\n    ...emojiSetDef,\n  },\n  {\n    id: 'sad',\n    name: 'sad',\n    colons: ':pensive:',\n    sheet_x: 0,\n    sheet_y: 1,\n    ...commonEmoji,\n    ...emojiSetDef,\n  },\n  {\n    id: 'angry',\n    name: 'angry',\n    colons: ':angry:',\n    sheet_x: 1,\n    sheet_y: 1,\n    ...commonEmoji,\n    ...emojiSetDef,\n  },\n];\n\nconst d = Object.assign({}, data);\nd.emojis = {};\n\n// use this only for small lists like in ReactionSelector\nexport const emojiData = d;\n\nexport const isOnlyEmojis = (text) => {\n  if (!text) return false;\n\n  const noEmojis = text.replace(emojiRegex(), '');\n  const noSpace = noEmojis.replace(/[\\s\\n]/gm, '');\n  return !noSpace;\n};\n\nexport const isPromise = (thing) => thing && typeof thing.then === 'function';\n\nexport const byDate = (a, b) => a.created_at - b.created_at;\n\n// https://stackoverflow.com/a/29234240/7625485\n/**\n * @deprecated This function is deprecated and will be removed in future major release.\n * @param {*} dict\n * @param {*} currentUserId\n */\nexport const formatArray = (dict, currentUserId) => {\n  const arr2 = Object.keys(dict);\n  const arr3 = [];\n  arr2.forEach((item, i) => {\n    if (currentUserId === dict[arr2[i]].user.id) {\n      return;\n    }\n\n    arr3.push(dict[arr2[i]].user.name || dict[arr2[i]].user.id);\n  });\n  let outStr = '';\n  if (arr3.length === 1) {\n    outStr = arr3[0] + ' is typing...';\n    dict;\n  } else if (arr3.length === 2) {\n    //joins all with \"and\" but =no commas\n    //example: \"bob and sam\"\n    outStr = arr3.join(' and ') + ' are typing...';\n  } else if (arr3.length > 2) {\n    //joins all with commas, but last one gets \", and\" (oxford comma!)\n    //example: \"bob, joe, and sam\"\n    outStr =\n      arr3.slice(0, -1).join(', ') +\n      ', and ' +\n      arr3.slice(-1) +\n      ' are typing...';\n  }\n\n  return outStr;\n};\n\nconst allowedMarkups = [\n  'html',\n  'root',\n  'text',\n  'break',\n  'paragraph',\n  'emphasis',\n  'strong',\n  'link',\n  'list',\n  'listItem',\n  'code',\n  'inlineCode',\n  'blockquote',\n  'delete',\n];\n\nconst matchMarkdownLinks = (message) => {\n  const regexMdLinks = /\\[([^\\[]+)\\](\\(.*\\))/gm;\n  const matches = message.match(regexMdLinks);\n  const singleMatch = /\\[([^\\[]+)\\]\\((.*)\\)/;\n\n  const links = matches\n    ? matches.map((match) => singleMatch.exec(match)[2])\n    : [];\n  return links;\n};\n\nexport const truncate = (input, length, end = '...') => {\n  if (input.length > length) {\n    return `${input.substring(0, length - end.length)}${end}`;\n  }\n  return input;\n};\n\nexport const renderText = (text, mentioned_users) => {\n  // take the @ mentions and turn them into markdown?\n  // translate links\n  if (!text) return null;\n\n  let newText = text;\n  let markdownLinks = matchMarkdownLinks(newText);\n  // extract all valid links/emails within text and replace it with proper markup\n  linkifyFind(newText).forEach(({ type, href, value }) => {\n    // check if message is already  markdown\n    const noParsingNeeded =\n      markdownLinks &&\n      markdownLinks.filter((text) => text.indexOf(href) !== -1);\n    if (noParsingNeeded.length > 0) return;\n\n    const displayLink =\n      type === 'email'\n        ? value\n        : truncate(value.replace(/(http(s?):\\/\\/)?(www\\.)?/, ''), 20);\n    newText = newText.replace(value, `[${displayLink}](${encodeURI(href)})`);\n  });\n\n  if (mentioned_users && mentioned_users.length) {\n    for (let i = 0; i < mentioned_users.length; i++) {\n      const username = mentioned_users[i].name || mentioned_users[i].id;\n      const mkdown = `**@${username}**`;\n      const re = new RegExp(`@${username}`, 'g');\n      newText = newText.replace(re, mkdown);\n    }\n  }\n\n  return (\n    <ReactMarkdown\n      allowedTypes={allowedMarkups}\n      source={newText}\n      linkTarget=\"_blank\"\n      plugins={[]}\n      escapeHtml={true}\n      skipHtml={false}\n      unwrapDisallowed={true}\n      transformLinkUri={(uri) => {\n        if (uri.startsWith('app://')) {\n          return uri;\n        } else {\n          return ReactMarkdown.uriTransformer(uri);\n        }\n      }}\n    />\n  );\n};\n\n// https://stackoverflow.com/a/6860916/2570866\nexport function generateRandomId() {\n  // prettier-ignore\n  return (S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4());\n}\n\nfunction S4() {\n  return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n}\n\nexport const smartRender = (ElementOrComponentOrLiteral, props, fallback) => {\n  if (ElementOrComponentOrLiteral === undefined) {\n    ElementOrComponentOrLiteral = fallback;\n  }\n  if (React.isValidElement(ElementOrComponentOrLiteral)) {\n    // Flow cast through any, to make flow believe it's a React.Element\n    const element = ElementOrComponentOrLiteral; // eslint-disable-line\n    return element;\n  }\n\n  // Flow cast through any to remove React.Element after previous check\n  const ComponentOrLiteral = ElementOrComponentOrLiteral;\n\n  if (\n    typeof ComponentOrLiteral === 'string' ||\n    typeof ComponentOrLiteral === 'number' ||\n    typeof ComponentOrLiteral === 'boolean' ||\n    ComponentOrLiteral == null\n  ) {\n    return ComponentOrLiteral;\n  }\n  return <ComponentOrLiteral {...props} />;\n};\n\nexport const filterEmoji = (emoji) => {\n  if (\n    emoji.name === 'White Smiling Face' ||\n    emoji.name === 'White Frowning Face'\n  ) {\n    return false;\n  }\n  return true;\n};\n\nexport const getReadByTooltipText = (users, t, client) => {\n  let outStr = '';\n  // first filter out client user, so restLength won't count it\n  const otherUsers = users\n    .filter((item) => item && item.id !== client.user.id)\n    .map((item) => item.name || item.id);\n\n  const slicedArr = otherUsers.slice(0, 5);\n  const restLength = otherUsers.length - slicedArr.length;\n\n  if (slicedArr.length === 1) {\n    outStr = slicedArr[0] + ' ';\n  } else if (slicedArr.length === 2) {\n    //joins all with \"and\" but =no commas\n    //example: \"bob and sam\"\n    outStr = t('{{ firstUser }} and {{ secondUser }}', {\n      firstUser: slicedArr[0],\n      secondUser: slicedArr[1],\n    });\n  } else if (slicedArr.length > 2) {\n    //joins all with commas, but last one gets \", and\" (oxford comma!)\n    //example: \"bob, joe, sam and 4 more\"\n    if (restLength === 0) {\n      // mutate slicedArr to remove last user to display it separately\n      const lastUser = slicedArr.splice(slicedArr.length - 2, 1);\n      outStr = t('{{ commaSeparatedUsers }}, and {{ lastUser }}', {\n        commaSeparatedUsers: slicedArr.join(', '),\n        lastUser,\n      });\n    } else {\n      outStr = t('{{ commaSeparatedUsers }} and {{ moreCount }} more', {\n        commaSeparatedUsers: slicedArr.join(', '),\n        moreCount: restLength,\n      });\n    }\n  }\n\n  return outStr;\n};\n","/* eslint-disable */\nimport i18n from 'i18next';\nimport Dayjs from 'dayjs';\nimport calendar from 'dayjs/plugin/calendar';\nimport updateLocale from 'dayjs/plugin/updateLocale';\nimport LocalizedFormat from 'dayjs/plugin/localizedFormat';\nimport localeData from 'dayjs/plugin/localeData';\nimport relativeTime from 'dayjs/plugin/relativeTime';\n\nimport {\n  enTranslations,\n  nlTranslations,\n  ruTranslations,\n  trTranslations,\n  frTranslations,\n  hiTranslations,\n  itTranslations,\n} from './translations';\n\nconst defaultNS = 'translation';\nconst defaultLng = 'en';\n\nimport 'dayjs/locale/nl';\nimport 'dayjs/locale/ru';\nimport 'dayjs/locale/tr';\nimport 'dayjs/locale/fr';\nimport 'dayjs/locale/hi';\nimport 'dayjs/locale/it';\n// These locale imports also set these locale globally.\n// So As a last step I am going to import english locale\n// to make sure I don't mess up language at other places in app.\nimport 'dayjs/locale/en';\n\nDayjs.extend(updateLocale);\n\nDayjs.updateLocale('nl', {\n  calendar: {\n    sameDay: '[vandaag om] LT',\n    nextDay: '[morgen om] LT',\n    nextWeek: 'dddd [om] LT',\n    lastDay: '[gisteren om] LT',\n    lastWeek: '[afgelopen] dddd [om] LT',\n    sameElse: 'L',\n  },\n});\nDayjs.updateLocale('it', {\n  calendar: {\n    sameDay: '[Oggi alle] LT',\n    nextDay: '[Domani alle] LT',\n    nextWeek: 'dddd [alle] LT',\n    lastDay: '[Ieri alle] LT',\n    lastWeek: '[lo scorso] dddd [alle] LT',\n    sameElse: 'L',\n  },\n});\nDayjs.updateLocale('hi', {\n  calendar: {\n    sameDay: '[आज] LT',\n    nextDay: '[कल] LT',\n    nextWeek: 'dddd, LT',\n    lastDay: '[कल] LT',\n    lastWeek: '[पिछले] dddd, LT',\n    sameElse: 'L',\n  },\n  // Hindi notation for meridiems are quite fuzzy in practice. While there exists\n  // a rigid notion of a 'Pahar' it is not used as rigidly in modern Hindi.\n  meridiemParse: /रात|सुबह|दोपहर|शाम/,\n  meridiemHour(hour, meridiem) {\n    if (hour === 12) {\n      hour = 0;\n    }\n    if (meridiem === 'रात') {\n      return hour < 4 ? hour : hour + 12;\n    } else if (meridiem === 'सुबह') {\n      return hour;\n    } else if (meridiem === 'दोपहर') {\n      return hour >= 10 ? hour : hour + 12;\n    } else if (meridiem === 'शाम') {\n      return hour + 12;\n    }\n  },\n  meridiem(hour) {\n    if (hour < 4) {\n      return 'रात';\n    } else if (hour < 10) {\n      return 'सुबह';\n    } else if (hour < 17) {\n      return 'दोपहर';\n    } else if (hour < 20) {\n      return 'शाम';\n    } else {\n      return 'रात';\n    }\n  },\n});\nDayjs.updateLocale('fr', {\n  calendar: {\n    sameDay: '[Aujourd’hui à] LT',\n    nextDay: '[Demain à] LT',\n    nextWeek: 'dddd [à] LT',\n    lastDay: '[Hier à] LT',\n    lastWeek: 'dddd [dernier à] LT',\n    sameElse: 'L',\n  },\n});\nDayjs.updateLocale('tr', {\n  calendar: {\n    sameDay: '[bugün saat] LT',\n    nextDay: '[yarın saat] LT',\n    nextWeek: '[gelecek] dddd [saat] LT',\n    lastDay: '[dün] LT',\n    lastWeek: '[geçen] dddd [saat] LT',\n    sameElse: 'L',\n  },\n});\nDayjs.updateLocale('ru', {\n  calendar: {\n    sameDay: '[Сегодня, в] LT',\n    nextDay: '[Завтра, в] LT',\n    lastDay: '[Вчера, в] LT',\n  },\n});\n\nconst en_locale = {\n  weekdays: 'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split(\n    '_',\n  ),\n  months: 'January_February_March_April_May_June_July_August_September_October_November_December'.split(\n    '_',\n  ),\n};\n\n/**\n * Wrapper around [i18next](https://www.i18next.com/) class for Stream related translations.\n * Instance of this class should be provided to Chat component to handle translations.\n * Stream provides following list of in-built translations:\n * 1. English (en)\n * 2. Dutch (nl)\n * 3. Russian (ru)\n * 4. Turkish (tr)\n * 5. French (fr)\n * 6. Italian (it)\n * 7. Hindi (hi)\n *\n * Simplest way to start using chat components in one of the in-built languages would be following:\n *\n * ```\n * const i18n = new Streami18n({ language 'nl' });\n * <Chat client={chatClient} i18nInstance={i18n}>\n *  ...\n * </Chat>\n * ```\n *\n * If you would like to override certain keys in in-built translation.\n * UI will be automatically updated in this case.\n *\n * ```\n * const i18n = new Streami18n({\n *  language: 'nl',\n *  translationsForLanguage: {\n *    'Nothing yet...': 'Nog Niet ...',\n *    '{{ firstUser }} and {{ secondUser }} are typing...': '{{ firstUser }} en {{ secondUser }} zijn aan het typen...',\n *  }\n * });\n *\n * If you would like to register additional languages, use registerTranslation. You can add as many languages as you want:\n *\n * i18n.registerTranslation('zh', {\n *  'Nothing yet...': 'Nog Niet ...',\n *  '{{ firstUser }} and {{ secondUser }} are typing...': '{{ firstUser }} en {{ secondUser }} zijn aan het typen...',\n * });\n *\n * <Chat client={chatClient} i18nInstance={i18n}>\n *  ...\n * </Chat>\n * ```\n *\n * You can use the same function to add whole new language as well.\n *\n * ```\n * const i18n = new Streami18n();\n *\n * i18n.registerTranslation('mr', {\n *  'Nothing yet...': 'काहीही नाही  ...',\n *  '{{ firstUser }} and {{ secondUser }} are typing...': '{{ firstUser }} आणि {{ secondUser }} टीपी करत आहेत ',\n * });\n *\n * // Make sure to call setLanguage to reflect new language in UI.\n * i18n.setLanguage('it');\n * <Chat client={chatClient} i18nInstance={i18n}>\n *  ...\n * </Chat>\n * ```\n *\n * ## Datetime translations\n *\n * Stream react chat components uses [dayjs](https://day.js.org/en/) internally by default to format datetime stamp.\n * e.g., in ChannelPreview, MessageContent components.\n * Dayjs has locale support as well - https://day.js.org/docs/en/i18n/i18n\n * Dayjs is a lightweight alternative to Momentjs with the same modern API.\n *\n * Dayjs provides locale config for plenty of languages, you can check the whole list of locale configs at following url\n * https://github.com/iamkun/dayjs/tree/dev/src/locale\n *\n * You can either provide the dayjs locale config while registering\n * language with Streami18n (either via constructor or registerTranslation()) or you can provide your own Dayjs or Moment instance\n * to Streami18n constructor, which will be then used internally (using the language locale) in components.\n *\n * 1. Via language registration\n *\n * e.g.,\n * ```\n * const i18n = new Streami18n({\n *  language: 'nl',\n *  dayjsLocaleConfigForLanguage: {\n *    months: [...],\n *    monthsShort: [...],\n *    calendar: {\n *      sameDay: ...'\n *    }\n *  }\n * });\n * ```\n *\n * Similarly, you can add locale config for moment while registering translation via `registerTranslation` function.\n *\n * e.g.,\n * ```\n * const i18n = new Streami18n();\n *\n * i18n.registerTranslation(\n *  'mr',\n *  {\n *    'Nothing yet...': 'काहीही नाही  ...',\n *    '{{ firstUser }} and {{ secondUser }} are typing...': '{{ firstUser }} आणि {{ secondUser }} टीपी करत आहेत ',\n *  },\n *  {\n *    months: [...],\n *    monthsShort: [...],\n *    calendar: {\n *      sameDay: ...'\n *    }\n *  }\n * );\n *```\n * 2. Provide your own Moment object\n *\n * ```js\n * import 'moment/locale/nl';\n * import 'moment/locale/it';\n * // or if you want to include all locales\n * import 'moment/min/locales';\n *\n * import Moment from moment\n *\n * const i18n = new Streami18n({\n *  language: 'nl',\n *  DateTimeParser: Moment\n * })\n * ```\n *\n * 3. Provide your own Dayjs object\n *\n * ```js\n * import Dayjs from 'dayjs'\n *\n * import 'dayjs/locale/nl';\n * import 'dayjs/locale/it';\n * // or if you want to include all locales\n * import 'dayjs/min/locales';\n *\n * const i18n = new Streami18n({\n *  language: 'nl',\n *  DateTimeParser: Dayjs\n * })\n * ```\n * If you would like to stick with english language for datetimes in Stream compoments, you can set `disableDateTimeTranslations` to true.\n *\n */\nconst defaultStreami18nOptions = {\n  language: 'en',\n  disableDateTimeTranslations: false,\n  debug: false,\n  logger: (msg) => console.warn(msg),\n  dayjsLocaleConfigForLanguage: null,\n  DateTimeParser: Dayjs,\n};\nexport class Streami18n {\n  i18nInstance = i18n.createInstance();\n  Dayjs = null;\n  setLanguageCallback = () => null;\n  initialized = false;\n\n  t = null;\n  tDateTimeParser = null;\n  translations = {\n    en: { [defaultNS]: enTranslations },\n    nl: { [defaultNS]: nlTranslations },\n    ru: { [defaultNS]: ruTranslations },\n    tr: { [defaultNS]: trTranslations },\n    fr: { [defaultNS]: frTranslations },\n    hi: { [defaultNS]: hiTranslations },\n    it: { [defaultNS]: itTranslations },\n  };\n  /**\n   * dayjs.defineLanguage('nl') also changes the global locale. We don't want to do that\n   * when user calls registerTranslation() function. So intead we will store the locale configs\n   * given to registerTranslation() function in `dayjsLocales` object, and register the required locale\n   * with moment, when setLanguage is called.\n   * */\n  dayjsLocales = {};\n  /**\n   * Contructor accepts following options:\n   *  - language (String) default: 'en'\n   *    Language code e.g., en, tr\n   *\n   *  - translationsForLanguage (object)\n   *    Translations object. Please check src/i18n/en.json for example.\n   *\n   *  - disableDateTimeTranslations (boolean) default: false\n   *    Disable translations for datetimes\n   *\n   *  - debug (boolean) default: false\n   *    Enable debug mode in internal i18n class\n   *\n   *  - logger (function) default: () => {}\n   *    Logger function to log warnings/errors from this class\n   *\n   *  - dayjsLocaleConfigForLanguage (object) default: 'enConfig'\n   *    [Config object](https://momentjs.com/docs/#/i18n/changing-locale/) for internal moment object,\n   *    corresponding to language (param)\n   *\n   *  - DateTimeParser (function) Moment or Dayjs instance/function.\n   *    Make sure to load all the required locales in this Moment or Dayjs instance that you will be provide to Streami18n\n   *\n   * @param {*} options\n   */\n  constructor(options = {}) {\n    const finalOptions = {\n      ...defaultStreami18nOptions,\n      ...options,\n    };\n    // Prepare the i18next configuration.\n    this.logger = finalOptions.logger;\n\n    this.currentLanguage = finalOptions.language;\n    this.DateTimeParser = finalOptions.DateTimeParser;\n\n    try {\n      // This is a shallow check to see if given parser is instance of Dayjs.\n      // For some reason Dayjs.isDayjs(this.DateTimeParser()) doesn't work.\n      if (this.DateTimeParser && this.DateTimeParser.extend) {\n        this.DateTimeParser.extend(LocalizedFormat);\n        this.DateTimeParser.extend(calendar);\n        this.DateTimeParser.extend(localeData);\n        this.DateTimeParser.extend(relativeTime);\n      }\n    } catch (error) {\n      throw Error(\n        `Streami18n: Looks like you wanted to provide Dayjs instance, but something went wrong while adding plugins ${error}`,\n      );\n    }\n\n    this.isCustomDateTimeParser = !!options.DateTimeParser;\n    const translationsForLanguage = finalOptions.translationsForLanguage;\n\n    if (translationsForLanguage) {\n      this.translations[this.currentLanguage] = {\n        [defaultNS]: translationsForLanguage,\n      };\n    }\n\n    // If translations don't exist for given language, then set it as empty object.\n    if (!this.translations[this.currentLanguage]) {\n      this.translations[this.currentLanguage] = {\n        [defaultNS]: {},\n      };\n    }\n\n    this.i18nextConfig = {\n      nsSeparator: false,\n      keySeparator: false,\n      fallbackLng: false,\n      debug: finalOptions.debug,\n      lng: this.currentLanguage,\n      interpolation: { escapeValue: false },\n\n      parseMissingKeyHandler: (key) => {\n        this.logger(`Streami18n: Missing translation for key: ${key}`);\n\n        return key;\n      },\n    };\n\n    this.validateCurrentLanguage(this.currentLanguage);\n\n    const dayjsLocaleConfigForLanguage =\n      finalOptions.dayjsLocaleConfigForLanguage;\n\n    if (dayjsLocaleConfigForLanguage) {\n      this.addOrUpdateLocale(this.currentLanguage, {\n        ...dayjsLocaleConfigForLanguage,\n      });\n    } else if (!this.localeExists(this.currentLanguage)) {\n      this.logger(\n        `Streami18n: Streami18n(...) - Locale config for ${this.currentLanguage} does not exist in momentjs.` +\n          `Please import the locale file using \"import 'moment/locale/${this.currentLanguage}';\" in your app or ` +\n          `register the locale config with Streami18n using registerTranslation(language, translation, customDayjsLocale)`,\n      );\n    }\n\n    this.tDateTimeParser = (timestamp) => {\n      if (\n        finalOptions.disableDateTimeTranslations ||\n        !this.localeExists(this.currentLanguage)\n      ) {\n        return this.DateTimeParser(timestamp).locale(defaultLng);\n      }\n      return this.DateTimeParser(timestamp).locale(this.currentLanguage);\n    };\n  }\n\n  /**\n   * Initializes the i18next instance with configuration (which enables natural language as default keys)\n   */\n  async init() {\n    this.validateCurrentLanguage();\n    try {\n      this.t = await this.i18nInstance.init({\n        ...this.i18nextConfig,\n        resources: this.translations,\n        lng: this.currentLanguage,\n      });\n      this.initialized = true;\n\n      return {\n        t: this.t,\n        tDateTimeParser: this.tDateTimeParser,\n      };\n    } catch (e) {\n      this.logger(`Something went wrong with init:`, e);\n    }\n  }\n\n  localeExists = (language) => {\n    if (this.isCustomDateTimeParser) return true;\n\n    return Object.keys(Dayjs.Ls).indexOf(language) > -1;\n  };\n\n  validateCurrentLanguage = () => {\n    const availableLanguages = Object.keys(this.translations);\n    if (availableLanguages.indexOf(this.currentLanguage) === -1) {\n      this.logger(\n        `Streami18n: '${this.currentLanguage}' language is not registered.` +\n          ` Please make sure to call streami18n.registerTranslation('${this.currentLanguage}', {...}) or ` +\n          `use one the built-in supported languages - ${this.getAvailableLanguages()}`,\n      );\n\n      this.currentLanguage = defaultLng;\n    }\n  };\n\n  /** Returns an instance of i18next used within this class instance */\n  geti18Instance = () => this.i18nInstance;\n\n  /** Returns list of available languages. */\n  getAvailableLanguages = () => Object.keys(this.translations);\n\n  /** Returns all the translation dictionary for all inbuilt-languages */\n  getTranslations = () => this.translations;\n\n  /**\n   * Returns current version translator function.\n   */\n  async getTranslators() {\n    if (!this.initialized) {\n      if (this.dayjsLocales[this.currentLanguage]) {\n        this.addOrUpdateLocale(\n          this.currentLanguage,\n          this.dayjsLocales[this.currentLanguage],\n        );\n      }\n      return await this.init();\n    } else {\n      return {\n        t: this.t,\n        tDateTimeParser: this.tDateTimeParser,\n      };\n    }\n  }\n\n  /**\n   * Register translation\n   *\n   * @param {*} language\n   * @param {*} translation\n   * @param {*} customDayjsLocale\n   */\n  registerTranslation(language, translation, customDayjsLocale) {\n    if (!translation) {\n      this.logger(\n        `Streami18n: registerTranslation(language, translation, customDayjsLocale) called without translation`,\n      );\n      return;\n    }\n\n    if (!this.translations[language]) {\n      this.translations[language] = { [defaultNS]: translation };\n    } else {\n      this.translations[language][defaultNS] = translation;\n    }\n\n    if (customDayjsLocale) {\n      this.dayjsLocales[language] = { ...customDayjsLocale };\n    } else if (!this.localeExists(language)) {\n      this.logger(\n        `Streami18n: registerTranslation(language, translation, customDayjsLocale) - ` +\n          `Locale config for ${language} does not exist in Dayjs.` +\n          `Please import the locale file using \"import 'dayjs/locale/${language}';\" in your app or ` +\n          `register the locale config with Streami18n using registerTranslation(language, translation, customDayjsLocale)`,\n      );\n    }\n\n    if (this.initialized) {\n      this.i18nInstance.addResources(language, defaultNS, translation);\n    }\n  }\n\n  addOrUpdateLocale(key, config) {\n    if (this.localeExists(key)) {\n      Dayjs.updateLocale(key, { ...config });\n    } else {\n      // Merging the custom locale config with en config, so missing keys can default to english.\n      Dayjs.locale({ name: key, ...{ ...en_locale, ...config } }, null, true);\n    }\n  }\n\n  /**\n   * Changes the language.\n   * @param {*} language\n   */\n  async setLanguage(language) {\n    this.currentLanguage = language;\n\n    if (!this.initialized) return;\n\n    try {\n      const t = await this.i18nInstance.changeLanguage(language);\n      if (this.dayjsLocales[language]) {\n        this.addOrUpdateLocale(\n          this.currentLanguage,\n          this.dayjsLocales[this.currentLanguage],\n        );\n      }\n\n      this.setLanguageCallback(t);\n      return t;\n    } catch (e) {\n      this.logger(`Failed to set language:`, e);\n    }\n  }\n\n  /**\n   * @param {(t: import('i18next').TFunction) => void} callback\n   */\n  registerSetLanguageCallback(callback) {\n    this.setLanguageCallback = callback;\n  }\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * AttachmentActions - The actions you can take on an attachment\n *\n * @example ../../docs/AttachmentActions.md\n * @type {React.FC<import('type').AttachmentActionsProps>}\n */\nconst AttachmentActions = ({ text, id, actions, actionHandler }) => (\n  <div className=\"str-chat__message-attachment-actions\">\n    <div className=\"str-chat__message-attachment-actions-form\">\n      <span key={0}>{text}</span>\n      {actions.map((action) => (\n        <button\n          className={`str-chat__message-attachment-actions-button str-chat__message-attachment-actions-button--${action.style}`}\n          data-testid={`${action.name}`}\n          key={`${id}-${action.value}`}\n          data-value={action.value}\n          onClick={(e) => actionHandler(action.name, action.value, e)}\n        >\n          {action.text}\n        </button>\n      ))}\n    </div>\n  </div>\n);\n\nAttachmentActions.propTypes = {\n  /** Unique id for action button key. Key is generated by concatenating this id with action value - {`${id}-${action.value}`} */\n  id: PropTypes.string.isRequired,\n  /** The text for the form input */\n  text: PropTypes.string,\n  /** A list of actions */\n  actions: PropTypes.array.isRequired,\n  /**\n   *\n   * @param name {string} Name of action\n   * @param value {string} Value of action\n   * @param event Dom event that triggered this handler\n   */\n  actionHandler: PropTypes.func.isRequired,\n};\n\nexport default React.memo(AttachmentActions);\n","// @ts-check\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\n\nconst progressUpdateInterval = 500;\n/**\n * Audio attachment with play/pause button and progress bar\n * @param {import(\"types\").AudioProps} props\n */\nconst Audio = ({ og }) => {\n  const audioRef = useRef(/** @type {HTMLAudioElement | null} */ (null));\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [progress, setProgress] = useState(0);\n\n  const updateProgress = useCallback(() => {\n    if (audioRef.current !== null) {\n      const position = audioRef.current.currentTime;\n      const { duration } = audioRef.current;\n      const currentProgress = (100 / duration) * position;\n      setProgress(currentProgress);\n      if (position === duration) {\n        setIsPlaying(false);\n      }\n    }\n  }, [audioRef]);\n\n  useEffect(() => {\n    if (audioRef.current !== null) {\n      if (isPlaying) {\n        audioRef.current.play();\n        const interval = setInterval(updateProgress, progressUpdateInterval);\n        return () => clearInterval(interval);\n      }\n      audioRef.current.pause();\n    }\n    return () => {};\n  }, [isPlaying, updateProgress]);\n\n  const { asset_url, image_url, title, description, text } = og;\n\n  return (\n    <div className=\"str-chat__audio\">\n      <div className=\"str-chat__audio__wrapper\">\n        <audio ref={audioRef}>\n          <source src={asset_url} type=\"audio/mp3\" data-testid=\"audio-source\" />\n        </audio>\n        <div className=\"str-chat__audio__image\">\n          <div className=\"str-chat__audio__image--overlay\">\n            {!isPlaying ? (\n              <div\n                onClick={() => setIsPlaying(true)}\n                className=\"str-chat__audio__image--button\"\n                data-testid=\"play-audio\"\n              >\n                <svg\n                  width=\"40\"\n                  height=\"40\"\n                  viewBox=\"0 0 64 64\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                >\n                  <path\n                    d=\"M32 58c14.36 0 26-11.64 26-26S46.36 6 32 6 6 17.64 6 32s11.64 26 26 26zm0 6C14.327 64 0 49.673 0 32 0 14.327 14.327 0 32 0c17.673 0 32 14.327 32 32 0 17.673-14.327 32-32 32zm13.237-28.412L26.135 45.625a3.27 3.27 0 0 1-4.426-1.4 3.319 3.319 0 0 1-.372-1.47L21 23.36c-.032-1.823 1.41-3.327 3.222-3.358a3.263 3.263 0 0 1 1.473.322l19.438 9.36a3.311 3.311 0 0 1 .103 5.905z\"\n                    fillRule=\"nonzero\"\n                  />\n                </svg>\n              </div>\n            ) : (\n              <div\n                onClick={() => setIsPlaying(false)}\n                className=\"str-chat__audio__image--button\"\n                data-testid=\"pause-audio\"\n              >\n                <svg\n                  width=\"40\"\n                  height=\"40\"\n                  viewBox=\"0 0 64 64\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                >\n                  <path\n                    d=\"M32 58.215c14.478 0 26.215-11.737 26.215-26.215S46.478 5.785 32 5.785 5.785 17.522 5.785 32 17.522 58.215 32 58.215zM32 64C14.327 64 0 49.673 0 32 0 14.327 14.327 0 32 0c17.673 0 32 14.327 32 32 0 17.673-14.327 32-32 32zm-7.412-45.56h2.892a2.17 2.17 0 0 1 2.17 2.17v23.865a2.17 2.17 0 0 1-2.17 2.17h-2.892a2.17 2.17 0 0 1-2.17-2.17V20.61a2.17 2.17 0 0 1 2.17-2.17zm12.293 0h2.893a2.17 2.17 0 0 1 2.17 2.17v23.865a2.17 2.17 0 0 1-2.17 2.17h-2.893a2.17 2.17 0 0 1-2.17-2.17V20.61a2.17 2.17 0 0 1 2.17-2.17z\"\n                    fillRule=\"nonzero\"\n                  />\n                </svg>\n              </div>\n            )}\n          </div>\n          {image_url && <img src={image_url} alt={`${description}`} />}\n        </div>\n        <div className=\"str-chat__audio__content\">\n          <span className=\"str-chat__audio__content--title\">\n            <strong>{title}</strong>\n          </span>\n          <span className=\"str-chat__audio__content--subtitle\">{text}</span>\n          <div className=\"str-chat__audio__content--progress\">\n            <div\n              style={{ width: `${progress}%` }}\n              data-testid=\"audio-progress\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(Audio);\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAkCAYAAAB/up84AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABVhJREFUeNrsW6GS20AMdToGBgEGAQYBBgEBBQYFgQcP5hMO9jP6CYWFBwsPBgYUGBQEFAQUGAQYBBgYGHjmutt5O6NupbXXcZJrx5rJXGyv11o96Ukr52avr6/BJG9HZmMBMpvNYnxt1JzNZNoRAYFxM2Z8rT6FuueMcaH6s1KfhBn3U42r1Jg1rrfq+Bt5xgf1Z64+uQFQndNzLc1Ydfwg6F2p6wd1PVXfU+b6Gc9vHGuh8+jrsXVN61Sq64XggNw95tlH9XmP6y3W2OI+qvN3db6mN7/zBFAb8L2aNMJxRsDQC6jIuEyN039LnAvV8QJKRRijZUHmT8iiLpEFDHKJaB1TGN732WuAokEIDQCwhwGjsMEIMNgp6qY9JlsTgyXquCFG1d54IsbOsKAVPLDBcQJjUxB0RJwAltGntNQ46GhzqPnb0y0954RG/1iLQ7SRCkR+guiPtW6GFRg5gAlCrFvbJEZ0ngDAUn0/Y77fDCJFXuiB/AmGDC3PLg0YWLRW5CcJWWPglNxDKS6C59AcZBs/sYxbOQBqHHkuZYCsGCds4SQJDDx3RK3RjUb9EfMUcLQ57BHS64MAIYtYkvEt+d4wCzqr++ipkoTtkihOI2chREfA5KiC0GOAaMig05zoWJPjgMk39jxcPphDR0mSDrtq438g51iq8omQlEnYJfHoiAFxYQGko6bCPSmZ5wS+TRx0Zc5R4CtmHbEVJT+0p1uOYdNE1SMfOKNO0zXWEmItptApsfYa1LV0UZUPIHSCmlRYJhfokNWhX5IcsmIWbEAMCQWerWirhZK57MghNQyzgke3QuQWPUv4EAac9wCuJjmkNmvUNEwiobX+DgdEWoQGgNDPGtTWWhRRWONX5JlnePCZhP1JUCOzPN1O0C2MohP7xuiko8Qy9INUDBg2YPJMlzP8pRv0qYeUdu+Cy+RAKIYmtVqojM5kkS0DwkXlLuY0ICzgAEOlAd8fPe+rYJdppz61TiZ5G4AgcScWz05RcUtAkOwyJMtI4FzNt3suCWKfwLUhdqRC0yA/enB1CZ4vBZ2fhIptJ4x/5PYVavyzQ39N0V8ddnsQ+m3sfX02hjo3bIVJ7d5PhqojZxYdC3NEdv9oQMQWFFjHHqpLEsc9BZyF23c9cG0ZOJjUIN15V1mY8OOAhW0E77yWaP2eoO9VBFG/d6yX6/xuHT2z3AsQ5ImnjrZBF6XcUiKAEl0RlJzZ7ZtnbxmqSgRqfxmyD9k6wNDGzuExecB3Z1/ukBOjQH73MZbspChFp9nQ/EYY9+LaaIYOqlo7JjwISX+LcBwbjAOz2ZKS7BpOcq0o0R2HvZAbHpHPJGc+dm00paQuedmOA4O0WD5fyQ4V08Ip4ATxhYl8CCh76/0QLVyehlBVFyCpYJTcKmPjHoY8XNE2VQ8dbIkdr4Z95npBwcNVahKzNEMBSYSyz46iLm8sLunreG5O+xYTsaMUHYu6bMn79sRCT2+8l6SMV2cCT5e3UspBXbbd9n3nDIN/Q1KP3JDfWLcd8kZwCVX12hjeOlmOIMe+L6FGjJLC4QS5rz6hg/tThjZiU0Pr/g7D65/uCUafKgaUJu0lHjvox/XsjXA+GAOQUogIXV8/v7GoKOGJfYuHxvHjt7t3rEMHD2+E5PoR+5GCLCS+8g6Z2xgGt6anuwGC99MSKAl6RrfUs/ofje+b1PcjlJBlMMk4gKBUe77AqKVP/T1Jj30IQPmCTdkm6NeKb5BkJzCGdCA8XuFGZIOWCBEh/mwGiZ/rFZXk3xHEdkjHb6MknVOhypJe+Sac03XlL4fe3r81mH518q9GyCS3kV8CDADlsrVaJhTLAgAAAABJRU5ErkJggg==\"","// @ts-check\nimport React from 'react';\nimport { sanitizeUrl } from '@braintree/sanitize-url';\n\n/**\n * SafeAnchor - In all ways similar to a regular anchor tag.\n * The difference is that it sanitizes the href value and prevents XSS\n * @type {React.FC<React.AnchorHTMLAttributes<HTMLAnchorElement>>}\n */\nconst SafeAnchor = ({ href, children, target, className }) => {\n  if (!href) return null;\n  const sanitized = sanitizeUrl(href);\n  return (\n    <a href={sanitized} target={target} className={className}>\n      {children}\n    </a>\n  );\n};\n\nexport default React.memo(SafeAnchor);\n","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\n\nimport giphyLogo from '../../assets/Poweredby_100px-White_VertText.png';\nimport { TranslationContext } from '../../context';\nimport { SafeAnchor } from '../SafeAnchor';\n\n/**\n * Card - Simple Card Layout\n *\n * @example ../../docs/Card.md\n * @typedef {import('types').CardProps} Props\n * @type React.FC<Props>\n */\nconst Card = ({\n  title,\n  title_link,\n  og_scrape_url,\n  image_url,\n  thumb_url,\n  text,\n  type,\n}) => {\n  const { t } = useContext(TranslationContext);\n  const image = thumb_url || image_url;\n\n  /** @type {(url?: string) => string | null} Typescript syntax */\n  const trimUrl = (url) => {\n    if (url !== undefined && url !== null) {\n      const [trimmedUrl] = url\n        .replace(/^(?:https?:\\/\\/)?(?:www\\.)?/i, '')\n        .split('/');\n\n      return trimmedUrl;\n    }\n    return null;\n  };\n\n  if (!title && !title_link && !image) {\n    return (\n      <div\n        className={`str-chat__message-attachment-card str-chat__message-attachment-card--${type}`}\n      >\n        <div className=\"str-chat__message-attachment-card--content\">\n          <div className=\"str-chat__message-attachment-card--text\">\n            {t('this content could not be displayed')}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!title_link && !og_scrape_url) {\n    return null;\n  }\n\n  return (\n    <div\n      className={`str-chat__message-attachment-card str-chat__message-attachment-card--${type}`}\n    >\n      {image && (\n        <div className=\"str-chat__message-attachment-card--header\">\n          <img src={image} alt={image} />\n        </div>\n      )}\n      <div className=\"str-chat__message-attachment-card--content\">\n        <div className=\"str-chat__message-attachment-card--flex\">\n          {title && (\n            <div className=\"str-chat__message-attachment-card--title\">\n              {title}\n            </div>\n          )}\n          {text && (\n            <div className=\"str-chat__message-attachment-card--text\">\n              {text}\n            </div>\n          )}\n          {(title_link || og_scrape_url) && (\n            <SafeAnchor\n              href={title_link || og_scrape_url}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"str-chat__message-attachment-card--url\"\n            >\n              {trimUrl(title_link || og_scrape_url)}\n            </SafeAnchor>\n          )}\n        </div>\n        {type === 'giphy' && (\n          <img\n            className=\"str-chat__message-attachment-card__giphy-logo\"\n            data-testid=\"card-giphy\"\n            src={giphyLogo}\n            alt=\"giphy logo\"\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nCard.propTypes = {\n  /** Title returned by the OG scraper */\n  title: PropTypes.string,\n  /** Link returned by the OG scraper */\n  title_link: PropTypes.string,\n  /** The scraped url, used as a fallback if the OG-data doesn't include a link */\n  og_scrape_url: PropTypes.string,\n  /** The url of the full sized image */\n  image_url: PropTypes.string,\n  /** The url for thumbnail sized image */\n  thumb_url: PropTypes.string,\n  /** Description returned by the OG scraper */\n  text: PropTypes.string,\n};\n\nexport default React.memo(Card);\n","import React from 'react';\nimport { FileIcon } from 'react-file-utils';\nimport prettybytes from 'pretty-bytes';\nimport { SafeAnchor } from '../SafeAnchor';\n\n/** @type React.FC<import('types').FileAttachmentProps> */\nconst FileAttachment = ({ attachment }) => {\n  return (\n    <div\n      data-testid=\"attachment-file\"\n      className=\"str-chat__message-attachment-file--item\"\n    >\n      <FileIcon\n        mimeType={attachment.mime_type}\n        filename={attachment.title}\n        big={true}\n        size={30}\n      />\n      <div className=\"str-chat__message-attachment-file--item-text\">\n        <SafeAnchor href={attachment.asset_url} target=\"_blank\" download>\n          {attachment.title}\n        </SafeAnchor>\n        {attachment.file_size && (\n          <span>{prettybytes(attachment.file_size)}</span>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(FileAttachment);\n","// @ts-check\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * Modal - Custom Image component used in modal\n * @type {React.FC<import('types').ModalImageProps>}\n */\nconst ModalImage = ({ data }) => (\n  <div className=\"str-chat__modal-image__wrapper\" data-testid=\"modal-image\">\n    <img src={data.src} className=\"str-chat__modal-image__image\" />\n  </div>\n);\n\nModalImage.propTypes = {\n  data: PropTypes.shape({\n    src: PropTypes.string.isRequired,\n  }).isRequired,\n};\n\nexport default ModalImage;\n","// @ts-check\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Carousel, { Modal, ModalGateway } from 'react-images';\nimport ModalImage from './ModalImage';\n\n/**\n * ImageModal - Small modal component\n * @type { React.FC<import('types').ModalWrapperProps>}\n */\nconst ModalComponent = ({ images, toggleModal, index, modalIsOpen }) => (\n  <ModalGateway>\n    {modalIsOpen ? (\n      // @ts-ignore\n      <Modal onClose={toggleModal}>\n        <Carousel\n          views={images}\n          currentIndex={index}\n          components={{\n            // @ts-ignore\n            View: ModalImage,\n          }}\n        />\n      </Modal>\n    ) : null}\n  </ModalGateway>\n);\n\nModalComponent.propTypes = {\n  images: PropTypes.array.isRequired,\n  toggleModal: PropTypes.func.isRequired,\n  index: PropTypes.number,\n  modalIsOpen: PropTypes.bool.isRequired,\n};\n\nexport default ModalComponent;\n","// @ts-check\nimport React, { useState, useContext, useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport { TranslationContext } from '../../context';\nimport ModalWrapper from './ModalWrapper';\n\n/**\n * Gallery - displays up to 4 images in a simple responsive grid with a lightbox to view the images.\n * @example ../../docs/Gallery.md\n * @typedef {import('types').GalleryProps} Props\n * @type React.FC<Props>\n */\nconst Gallery = ({ images }) => {\n  const [index, setIndex] = useState(0);\n  const [modalOpen, setModalOpen] = useState(false);\n  const { t } = useContext(TranslationContext);\n\n  /**\n   * @param {number} selectedIndex Index of image clicked\n   */\n  const toggleModal = (selectedIndex) => {\n    if (modalOpen) {\n      setModalOpen(false);\n    } else {\n      setIndex(selectedIndex);\n      setModalOpen(true);\n    }\n  };\n\n  const formattedArray = useMemo(\n    () =>\n      images.map((image) => ({\n        src: image.image_url || image.thumb_url || '',\n        source: image.image_url || image.thumb_url || '',\n      })),\n    [images],\n  );\n\n  const renderImages = images.slice(0, 3).map((image, i) => (\n    <div\n      data-testid=\"gallery-image\"\n      className=\"str-chat__gallery-image\"\n      key={`gallery-image-${i}`}\n      onClick={() => toggleModal(i)}\n    >\n      <img src={image.image_url || image.thumb_url} />\n    </div>\n  ));\n\n  return (\n    <div\n      className={`str-chat__gallery ${\n        images.length > 3 ? 'str-chat__gallery--square' : ''\n      }`}\n    >\n      {renderImages}\n      {images.length > 3 && (\n        <div\n          className=\"str-chat__gallery-placeholder\"\n          style={{\n            backgroundImage: `url(${images[3].image_url})`,\n          }}\n          onClick={() => toggleModal(3)}\n        >\n          <p>\n            {t('{{ imageCount }} more', {\n              imageCount: images.length - 3,\n            })}\n          </p>\n        </div>\n      )}\n      <ModalWrapper\n        images={formattedArray}\n        index={index}\n        // @ts-ignore\n        toggleModal={toggleModal}\n        modalIsOpen={modalOpen}\n      />\n    </div>\n  );\n};\n\nGallery.propTypes = {\n  images: PropTypes.arrayOf(PropTypes.object.isRequired).isRequired,\n};\n\nexport default React.memo(Gallery);\n","/* eslint-disable */\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport ModalWrapper from './ModalWrapper';\n\n/**\n * Image - Small wrapper around an image tag, supports thumbnails\n *\n * @example ../../docs/Image.md\n * @extends {React.PureComponent<import('type').ImageProps>}\n */\nclass Image extends React.PureComponent {\n  static propTypes = {\n    /** The full size image url */\n    image_url: PropTypes.string,\n    /** The thumb url */\n    thumb_url: PropTypes.string,\n    /** The text fallback for the image */\n    fallback: PropTypes.string,\n  };\n  state = {\n    modalIsOpen: false,\n    currentIndex: 0,\n  };\n\n  toggleModal = () => {\n    this.setState((state) => ({\n      modalIsOpen: !state.modalIsOpen,\n    }));\n  };\n\n  render() {\n    const { image_url, thumb_url, fallback } = this.props;\n    const formattedArray = [{ src: image_url || thumb_url }];\n    return (\n      <React.Fragment>\n        <img\n          className=\"str-chat__message-attachment--img\"\n          onClick={this.toggleModal}\n          src={thumb_url || image_url}\n          alt={fallback}\n          data-testid=\"image-test\"\n        />\n\n        <ModalWrapper\n          images={formattedArray}\n          toggleModal={this.toggleModal}\n          index={this.state.currentIndex}\n          modalIsOpen={this.state.modalIsOpen}\n        />\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Image;\n","// @ts-check\n\nimport React from 'react';\nimport DefaultMedia from 'react-player';\nimport PropTypes from 'prop-types';\n\nimport DefaultAttachmentActions from './AttachmentActions';\n\nimport DefaultAudio from './Audio';\nimport DefaultCard from './Card';\nimport DefaultFile from './FileAttachment';\n\nimport { Image as DefaultImage } from '../Gallery';\n\nexport const SUPPORTED_VIDEO_FORMATS = [\n  'video/mp4',\n  'video/ogg',\n  'video/webm',\n  'video/quicktime',\n];\n\n/**\n * @typedef {import('types').ExtendedAttachment} ExtendedAttachment\n * @typedef {Required<Pick<import('types').AttachmentUIComponentProps, 'Card' | 'File' | 'Image' | 'Audio' | 'Media' | 'AttachmentActions'>>} DefaultProps\n * @typedef {Omit<import('types').AttachmentUIComponentProps, 'Card' | 'File' | 'Image' | 'Audio' | 'Media' | 'AttachmentActions'> & DefaultProps} AttachmentProps\n */\n\n/**\n * @param {ExtendedAttachment} a\n */\nexport const isImageAttachment = (a) => {\n  return a.type === 'image' && !a.title_link && !a.og_scrape_url;\n};\n\n/**\n * @param {ExtendedAttachment} a\n */\nexport const isMediaAttachment = (a) => {\n  return (\n    (a.mime_type && SUPPORTED_VIDEO_FORMATS.indexOf(a.mime_type) !== -1) ||\n    a.type === 'video'\n  );\n};\n\n/**\n * @param {ExtendedAttachment} a\n */\nexport const isAudioAttachment = (a) => {\n  return a.type === 'audio';\n};\n\n/**\n * @param {ExtendedAttachment} a\n */\nexport const isFileAttachment = (a) => {\n  return (\n    a.type === 'file' ||\n    (a.mime_type &&\n      SUPPORTED_VIDEO_FORMATS.indexOf(a.mime_type) === -1 &&\n      a.type !== 'video')\n  );\n};\n\n/**\n * @param {React.ReactNode} children\n * @param {ExtendedAttachment} attachment\n * @param {string} componentType\n */\nexport const renderAttachmentWithinContainer = (\n  children,\n  attachment,\n  componentType,\n) => {\n  let extra =\n    attachment && attachment.actions && attachment.actions.length\n      ? 'actions'\n      : '';\n  if (\n    componentType === 'card' &&\n    !attachment.image_url &&\n    !attachment.thumb_url\n  ) {\n    extra = 'no-image';\n  }\n\n  return (\n    <div\n      className={`str-chat__message-attachment str-chat__message-attachment--${componentType} str-chat__message-attachment--${attachment.type} str-chat__message-attachment--${componentType}--${extra}`}\n    >\n      {children}\n    </div>\n  );\n};\n\n/**\n * @param {AttachmentProps} props\n */\nexport const renderAttachmentActions = (props) => {\n  const { attachment: a, AttachmentActions, actionHandler } = props;\n  if (!a.actions || !a.actions.length) {\n    return null;\n  }\n\n  return (\n    <AttachmentActions\n      {...a}\n      id={a.id || ''}\n      actions={a.actions || []}\n      text={a.text || ''}\n      key={`key-actions-${a.id}`}\n      actionHandler={actionHandler}\n    />\n  );\n};\n\n/**\n * @param {AttachmentProps} props\n */\nexport const renderImage = (props) => {\n  const { attachment: a, Image } = props;\n  if (a.actions && a.actions.length) {\n    return renderAttachmentWithinContainer(\n      <div className=\"str-chat__attachment\" key={`key-image-${a.id}`}>\n        <Image {...a} />\n        {renderAttachmentActions(props)}\n      </div>,\n      a,\n      'image',\n    );\n  }\n\n  return renderAttachmentWithinContainer(\n    <Image {...a} key={`key-image-${a.id}`} />,\n    a,\n    'image',\n  );\n};\n\n/**\n * @param {AttachmentProps} props\n */\nexport const renderCard = (props) => {\n  const { attachment: a, Card } = props;\n  if (a.actions && a.actions.length) {\n    return renderAttachmentWithinContainer(\n      <div className=\"str-chat__attachment\" key={`key-image-${a.id}`}>\n        <Card {...a} key={`key-card-${a.id}`} />\n        {renderAttachmentActions(props)}\n      </div>,\n      a,\n      'card',\n    );\n  }\n\n  return renderAttachmentWithinContainer(\n    <Card {...a} key={`key-card-${a.id}`} />,\n    a,\n    'card',\n  );\n};\n\n/**\n * @param {AttachmentProps} props\n */\nexport const renderFile = (props) => {\n  const { attachment: a, File } = props;\n  if (!a.asset_url) return null;\n\n  return renderAttachmentWithinContainer(\n    <File attachment={a} key={`key-file-${a.id}`} />,\n    a,\n    'file',\n  );\n};\n\n/**\n * @param {AttachmentProps} props\n */\nexport const renderAudio = (props) => {\n  const { attachment: a, Audio } = props;\n  return renderAttachmentWithinContainer(\n    <div className=\"str-chat__attachment\" key={`key-video-${a.id}`}>\n      <Audio og={a} />\n    </div>,\n    a,\n    'audio',\n  );\n};\n\n/**\n * @param {AttachmentProps} props\n */\nexport const renderMedia = (props) => {\n  const { attachment: a, Media } = props;\n  if (a.actions && a.actions.length) {\n    return renderAttachmentWithinContainer(\n      <div\n        className=\"str-chat__attachment str-chat__attachment-media\"\n        key={`key-video-${a.id}`}\n      >\n        <div className=\"str-chat__player-wrapper\">\n          <Media\n            className=\"react-player\"\n            url={a.asset_url}\n            width=\"100%\"\n            height=\"100%\"\n            controls\n          />\n        </div>\n        {renderAttachmentActions(props)}\n      </div>,\n      a,\n      'media',\n    );\n  }\n\n  return renderAttachmentWithinContainer(\n    <div className=\"str-chat__player-wrapper\" key={`key-video-${a.id}`}>\n      <Media\n        className=\"react-player\"\n        url={a.asset_url}\n        width=\"100%\"\n        height=\"100%\"\n        controls\n      />\n    </div>,\n    a,\n    'media',\n  );\n};\n\n/**\n * Attachment - The message attachment\n *\n * @example ../../docs/Attachment.md\n * @type { React.FC<import('types').AttachmentUIComponentProps> }\n */\nconst Attachment = ({\n  attachment,\n  Card = DefaultCard,\n  Image = DefaultImage,\n  Audio = DefaultAudio,\n  File = DefaultFile,\n  Media = DefaultMedia,\n  AttachmentActions = DefaultAttachmentActions,\n  ...rest\n}) => {\n  const propsWithDefault = {\n    attachment,\n    Card,\n    Image,\n    Audio,\n    File,\n    Media,\n    AttachmentActions,\n    ...rest,\n  };\n\n  if (isImageAttachment(attachment)) {\n    return renderImage(propsWithDefault);\n  }\n\n  if (isFileAttachment(attachment)) {\n    return renderFile(propsWithDefault);\n  }\n\n  if (isAudioAttachment(attachment)) {\n    return renderAudio(propsWithDefault);\n  }\n\n  if (isMediaAttachment(attachment)) {\n    return renderMedia(propsWithDefault);\n  }\n\n  return renderCard(propsWithDefault);\n};\n\nAttachment.propTypes = {\n  /**\n   * The attachment to render\n   * @see See [Attachment structure](https://getstream.io/chat/docs/#message_format)\n   *\n   *  */\n  attachment: PropTypes.object.isRequired,\n  /**\n   *\n   * @param name {string} Name of action\n   * @param value {string} Value of action\n   * @param event Dom event that triggered this handler\n   */\n  actionHandler: PropTypes.func,\n  /**\n   * Custom UI component for card type attachment\n   * Defaults to [Card](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment/Card.js)\n   */\n  Card: /** @type {PropTypes.Validator<React.ComponentType<import('types').CardProps>>} */ (PropTypes.elementType),\n  /**\n   * Custom UI component for file type attachment\n   * Defaults to [File](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment/File.js)\n   */\n  File: /** @type {PropTypes.Validator<React.ComponentType<import('types').FileAttachmentProps>>} */ (PropTypes.elementType),\n  /**\n   * Custom UI component for image type attachment\n   * Defaults to [Image](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Gallery/Image.js)\n   */\n  Image: /** @type {PropTypes.Validator<React.ComponentType<import('types').ImageProps>>} */ (PropTypes.elementType),\n  /**\n   * Custom UI component for audio type attachment\n   * Defaults to [Audio](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment/Audio.js)\n   */\n  Audio: /** @type {PropTypes.Validator<React.ComponentType<import('types').AudioProps>>} */ (PropTypes.elementType),\n  /**\n   * Custom UI component for media type attachment\n   * Defaults to [ReactPlayer](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment/ReactPlayer.js)\n   */\n  Media: /** @type {PropTypes.Validator<React.ComponentType<import('react-player').ReactPlayerProps>>} */ (PropTypes.elementType),\n  /**\n   * Custom UI component for attachment actions\n   * Defaults to [AttachmentActions](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment/AttachmentActions.js)\n   */\n  AttachmentActions: /** @type {PropTypes.Validator<React.ComponentType<import('types').AttachmentActionsProps>>} */ (PropTypes.elementType),\n};\n\nexport default Attachment;\n","/* eslint-disable */\nexport const KEY_CODES = {\n  ESC: 27,\n  UP: 38,\n  DOWN: 40,\n  ENTER: 13,\n  TAB: 9,\n  SPACE: 32,\n};\n\n// This is self-made key shortcuts manager, used for caching key strokes\nclass Listener {\n  constructor() {\n    this.index = 0;\n    this.listeners = {};\n    this.refCount = 0;\n\n    this.f = (e) => {\n      const code = e.keyCode || e.which;\n      Object.values(this.listeners).forEach(({ keyCode, fn }) => {\n        if (keyCode.includes(code)) fn(e);\n      });\n    };\n  }\n\n  startListen = () => {\n    if (!this.refCount) {\n      // prevent multiple listeners in case of multiple TextareaAutocomplete components on page\n      document.addEventListener('keydown', this.f);\n    }\n    this.refCount++;\n  };\n\n  stopListen = () => {\n    this.refCount--;\n    if (!this.refCount) {\n      // prevent disable listening in case of multiple TextareaAutocomplete components on page\n      document.removeEventListener('keydown', this.f);\n    }\n  };\n\n  add = (keyCodes, fn) => {\n    let keyCode = keyCodes;\n\n    if (typeof keyCode !== 'object') keyCode = [keyCode];\n\n    this.listeners[this.index] = {\n      keyCode,\n      fn,\n    };\n\n    this.index += 1;\n\n    return this.index;\n  };\n\n  remove = (id) => {\n    delete this.listeners[id];\n  };\n\n  removeAll = () => {\n    this.listeners = {};\n    this.index = 0;\n  };\n}\n\nexport default new Listener();\n","//\n\nimport React from 'react';\n\nexport class Item extends React.Component {\n  selectItem = () => {\n    const { item, onSelectHandler } = this.props;\n    onSelectHandler(item);\n  };\n\n  render() {\n    const {\n      component: Component,\n      style,\n      onClickHandler,\n      item,\n      selected,\n      className,\n      innerRef,\n    } = this.props;\n\n    return (\n      <li className={`rta__item ${className || ''}`} style={style}>\n        <div\n          className={`rta__entity ${\n            selected === true ? 'rta__entity--selected' : ''\n          }`}\n          role=\"button\"\n          tabIndex={0}\n          onClick={onClickHandler}\n          onFocus={this.selectItem}\n          onMouseEnter={this.selectItem}\n          /* $FlowFixMe */\n          ref={innerRef}\n        >\n          <Component selected={selected} entity={item} />\n        </div>\n      </li>\n    );\n  }\n}\n\nexport default Item;\n","/* eslint-disable */\nimport React from 'react';\n\nimport Listeners, { KEY_CODES } from './listener';\nimport Item from './Item';\n\nexport class List extends React.Component {\n  state = {\n    selectedItem: null,\n  };\n\n  cachedValues = null;\n\n  componentDidMount() {\n    this.listeners.push(\n      Listeners.add([KEY_CODES.DOWN, KEY_CODES.UP], this.scroll),\n      Listeners.add([KEY_CODES.ENTER, KEY_CODES.TAB], this.onPressEnter),\n    );\n\n    const { values } = this.props;\n    if (values && values[0]) this.selectItem(values[0]);\n  }\n\n  UNSAFE_componentWillReceiveProps({ values }) {\n    const newValues = values.map((val) => this.getId(val)).join('');\n\n    if (this.cachedValues !== newValues && values && values[0]) {\n      this.selectItem(values[0]);\n      this.cachedValues = newValues;\n    }\n  }\n\n  componentWillUnmount() {\n    let listener;\n    while (this.listeners.length) {\n      listener = this.listeners.pop();\n      Listeners.remove(listener);\n    }\n  }\n\n  onPressEnter = (e) => {\n    if (e && e.preventDefault) {\n      e.preventDefault();\n    }\n\n    const { values } = this.props;\n\n    this.modifyText(values[this.getPositionInList()]);\n  };\n\n  getPositionInList = () => {\n    const { values } = this.props;\n    const { selectedItem } = this.state;\n\n    if (!selectedItem) return 0;\n\n    return values.findIndex((a) => this.getId(a) === this.getId(selectedItem));\n  };\n\n  getId = (item) => {\n    const textToReplace = this.props.getTextToReplace(item);\n    if (textToReplace.key) {\n      return textToReplace.key;\n    }\n\n    if (typeof item === 'string' || !item.key) {\n      return textToReplace.text;\n    }\n\n    return item.key;\n  };\n\n  listeners = [];\n\n  itemsRef = {};\n\n  modifyText = (value) => {\n    if (!value) return;\n\n    const { onSelect, getTextToReplace, getSelectedItem } = this.props;\n\n    onSelect(getTextToReplace(value));\n    if (getSelectedItem) {\n      getSelectedItem(value);\n    }\n  };\n\n  selectItem = (item, keyboard = false) => {\n    this.setState({ selectedItem: item }, () => {\n      if (keyboard) {\n        this.props.dropdownScroll(this.itemsRef[this.getId(item)]);\n      }\n    });\n  };\n\n  scroll = (e) => {\n    if (e && e.preventDefault) {\n      e.preventDefault();\n    }\n\n    const { values } = this.props;\n\n    const code = e.keyCode || e.which;\n\n    const oldPosition = this.getPositionInList();\n    let newPosition;\n    switch (code) {\n      case KEY_CODES.DOWN:\n        newPosition = oldPosition + 1;\n        break;\n      case KEY_CODES.UP:\n        newPosition = oldPosition - 1;\n        break;\n      default:\n        newPosition = oldPosition;\n        break;\n    }\n\n    newPosition =\n      ((newPosition % values.length) + values.length) % values.length; // eslint-disable-line\n    this.selectItem(\n      values[newPosition],\n      [KEY_CODES.DOWN, KEY_CODES.UP].includes(code),\n    );\n  };\n\n  isSelected = (item) => {\n    const { selectedItem } = this.state;\n    if (!selectedItem) return false;\n\n    return this.getId(selectedItem) === this.getId(item);\n  };\n\n  renderHeader = (value) => {\n    if (value[0] === '/') {\n      return `Commands matching <strong>${value.replace('/', '')}</strong>`;\n    }\n\n    if (value[0] === ':') {\n      return `Emoji matching <strong>${value.replace(':', '')}</strong>`;\n    }\n\n    if (value[0] === '@') {\n      return `Searching for people`;\n    }\n  };\n\n  render() {\n    const {\n      values,\n      component,\n      style,\n      itemClassName,\n      className,\n      itemStyle,\n    } = this.props;\n\n    return (\n      <ul className={`rta__list ${className || ''}`} style={style}>\n        <li\n          className=\"rta__list-header\"\n          dangerouslySetInnerHTML={{\n            __html: this.renderHeader(this.props.value),\n          }}\n        />\n        {values.map((item) => (\n          <Item\n            key={this.getId(item)}\n            innerRef={(ref) => {\n              this.itemsRef[this.getId(item)] = ref;\n            }}\n            selected={this.isSelected(item)}\n            item={item}\n            className={itemClassName}\n            style={itemStyle}\n            onClickHandler={this.onPressEnter}\n            onSelectHandler={this.selectItem}\n            component={component}\n          />\n        ))}\n      </ul>\n    );\n  }\n}\n\nexport default List;\n","//\n\nexport function defaultScrollToItem(container, item) {\n  const itemHeight = parseInt(\n    getComputedStyle(item).getPropertyValue('height'),\n    10,\n  );\n\n  const containerHight =\n    parseInt(getComputedStyle(container).getPropertyValue('height'), 10) -\n    itemHeight;\n\n  const itemOffsetTop = item.offsetTop;\n  const actualScrollTop = container.scrollTop;\n\n  if (\n    itemOffsetTop < actualScrollTop + containerHight &&\n    actualScrollTop < itemOffsetTop\n  ) {\n    return;\n  }\n\n  // eslint-disable-next-line\n  container.scrollTop = itemOffsetTop;\n}\n","/* eslint-disable */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport getCaretCoordinates from 'textarea-caret';\nimport CustomEvent from 'custom-event';\nimport { isValidElementType } from 'react-is';\n\nimport Listeners, { KEY_CODES } from './listener';\nimport List from './List';\n\nimport { defaultScrollToItem } from './utils';\n\nimport Textarea from 'react-textarea-autosize';\n\nconst DEFAULT_CARET_POSITION = 'next';\n\nconst errorMessage = (message) =>\n  console.error(\n    `RTA: dataProvider fails: ${message}\n    \\nCheck the documentation or create issue if you think it's bug. https://github.com/webscopeio/react-textarea-autocomplete/issues`,\n  );\n\nclass ReactTextareaAutocomplete extends React.Component {\n  static defaultProps = {\n    closeOnClickOutside: true,\n    movePopupAsYouType: false,\n    value: '',\n    minChar: 1,\n    scrollToItem: true,\n    maxRows: 10,\n  };\n\n  constructor(props) {\n    super(props);\n\n    const { loadingComponent, trigger, value } = this.props;\n\n    // TODO: it would be better to have the parent control state...\n    // if (value) this.state.value = value;\n\n    this._createRegExp();\n\n    if (!loadingComponent) {\n      throw new Error('RTA: loadingComponent is not defined');\n    }\n\n    if (!trigger) {\n      throw new Error('RTA: trigger is not defined');\n    }\n    this.state = {\n      top: null,\n      left: null,\n      currentTrigger: null,\n      actualToken: '',\n      data: null,\n      value: value || '',\n      dataLoading: false,\n      selectionEnd: 0,\n      selectionStart: 0,\n      component: null,\n      listenerIndex: 0,\n    };\n  }\n\n  componentDidMount() {\n    Listeners.add(KEY_CODES.ESC, () => this._closeAutocomplete());\n    Listeners.add(KEY_CODES.SPACE, () => this._onSpace());\n    const listenerIndex = Listeners.add(KEY_CODES.ENTER, (e) =>\n      this._onEnter(e),\n    );\n    this.setState({\n      listenerIndex,\n    });\n    Listeners.startListen();\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    this._update(nextProps);\n  }\n\n  componentWillUnmount() {\n    Listeners.stopListen();\n    Listeners.remove(this.state.listenerIndex);\n  }\n\n  getSelectionPosition = () => {\n    if (!this.textareaRef) return null;\n\n    return {\n      selectionStart: this.textareaRef.selectionStart,\n      selectionEnd: this.textareaRef.selectionEnd,\n    };\n  };\n\n  getSelectedText = () => {\n    if (!this.textareaRef) return null;\n    const { selectionStart, selectionEnd } = this.textareaRef;\n\n    if (selectionStart === selectionEnd) return null;\n\n    return this.state.value.substr(\n      selectionStart,\n      selectionEnd - selectionStart,\n    );\n  };\n\n  setCaretPosition = (position = 0) => {\n    if (!this.textareaRef) return;\n\n    this.textareaRef.focus();\n    this.textareaRef.setSelectionRange(position, position);\n  };\n\n  getCaretPosition = () => {\n    if (!this.textareaRef) {\n      return 0;\n    }\n\n    return this.textareaRef.selectionEnd;\n  };\n\n  // handle the on-enter behaviour\n  _onEnter = (event) => {\n    const trigger = this.state.currentTrigger;\n    if (!this.textareaRef) {\n      return;\n    }\n\n    const hasFocus = this.textareaRef.matches(':focus');\n\n    // don't submit if the element has focus or the shift key is pressed\n    if (!hasFocus || event.shiftKey === true) {\n      return;\n    }\n    if (!trigger || !this.state.data) {\n      // trigger a submit\n      this._replaceWord();\n      if (this.textareaRef) {\n        this.textareaRef.selectionEnd = 0;\n      }\n      this.props.handleSubmit(event);\n    }\n  };\n\n  // handle the on-space behaviour\n  _onSpace = () => {\n    if (!this.props.replaceWord) {\n      return;\n    }\n\n    if (!this.textareaRef) {\n      return;\n    }\n    const hasFocus = this.textareaRef.matches(':focus');\n\n    // don't change characters if the element doesn't have focus\n    if (!hasFocus) {\n      return;\n    }\n    this._replaceWord();\n  };\n\n  _replaceWord = () => {\n    const lastWordRegex = /([^\\s]+)(\\s*)$/;\n    const { value } = this.state;\n    const match = lastWordRegex.exec(value.slice(0, this.getCaretPosition()));\n    const lastWord = match && match[1];\n    if (!lastWord) {\n      return;\n    }\n    const spaces = match[2];\n\n    const newWord = this.props.replaceWord(lastWord);\n    if (newWord == null) {\n      return;\n    }\n    const textBeforeWord = value.slice(\n      0,\n      this.getCaretPosition() - match[0].length,\n    );\n    const textAfterCaret = value.slice(this.getCaretPosition(), -1);\n    const newText = textBeforeWord + newWord + spaces + textAfterCaret;\n    this.setState(\n      {\n        value: newText,\n      },\n      () => {\n        // fire onChange event after successful selection\n        const e = new CustomEvent('change', { bubbles: true });\n        this.textareaRef.dispatchEvent(e);\n        if (this.props.onChange) this.props.onChange(e);\n      },\n    );\n  };\n\n  _onSelect = (newToken) => {\n    const { selectionEnd, currentTrigger, value: textareaValue } = this.state;\n    const { onChange, trigger } = this.props;\n\n    if (!currentTrigger) return;\n\n    const computeCaretPosition = (position, token, startToken) => {\n      switch (position) {\n        case 'start':\n          return startToken;\n        case 'next':\n        case 'end':\n          return startToken + token.length;\n        default:\n          if (!Number.isInteger(position)) {\n            throw new Error(\n              'RTA: caretPosition should be \"start\", \"next\", \"end\" or number.',\n            );\n          }\n\n          return position;\n      }\n    };\n\n    const textToModify = textareaValue.slice(0, selectionEnd);\n\n    const startOfTokenPosition = textToModify.search(\n      /**\n       * It's important to escape the currentTrigger char for chars like [, (,...\n       */\n      new RegExp(`\\\\${currentTrigger}${`[^\\\\${currentTrigger}${'\\\\s'}]`}*$`),\n    );\n\n    // we add space after emoji is selected if a caret position is next\n    const newTokenString =\n      newToken.caretPosition === 'next' ? `${newToken.text} ` : newToken.text;\n\n    const newCaretPosition = computeCaretPosition(\n      newToken.caretPosition,\n      newTokenString,\n      startOfTokenPosition,\n    );\n\n    const modifiedText =\n      textToModify.substring(0, startOfTokenPosition) + newTokenString;\n\n    // set the new textarea value and after that set the caret back to its position\n    this.setState(\n      {\n        value: textareaValue.replace(textToModify, modifiedText),\n        dataLoading: false,\n      },\n      () => {\n        // fire onChange event after successful selection\n        const e = new CustomEvent('change', { bubbles: true });\n        this.textareaRef.dispatchEvent(e);\n        if (onChange) onChange(e);\n\n        this.setCaretPosition(newCaretPosition);\n      },\n    );\n    this._closeAutocomplete();\n  };\n\n  _getItemOnSelect = () => {\n    const { currentTrigger } = this.state;\n    const triggerSettings = this._getCurrentTriggerSettings();\n\n    if (!currentTrigger || !triggerSettings) return null;\n\n    const { callback } = triggerSettings;\n\n    if (!callback) return null;\n\n    return (item) => {\n      if (typeof callback !== 'function') {\n        throw new Error(\n          'Output functor is not defined! You have to define \"output\" function. https://github.com/webscopeio/react-textarea-autocomplete#trigger-type',\n        );\n      }\n      if (callback) {\n        return callback(item, currentTrigger);\n      }\n      return null;\n    };\n  };\n\n  _getTextToReplace = () => {\n    const { currentTrigger, actualToken } = this.state;\n    const triggerSettings = this._getCurrentTriggerSettings();\n\n    if (!currentTrigger || !triggerSettings) return null;\n\n    const { output } = triggerSettings;\n\n    return (item) => {\n      if (\n        typeof item === 'object' &&\n        (!output || typeof output !== 'function')\n      ) {\n        throw new Error(\n          'Output functor is not defined! If you are using items as object you have to define \"output\" function. https://github.com/webscopeio/react-textarea-autocomplete#trigger-type',\n        );\n      }\n\n      if (output) {\n        const textToReplace = output(item, currentTrigger);\n\n        if (!textToReplace || typeof textToReplace === 'number') {\n          throw new Error(\n            `Output functor should return string or object in shape {text: string, caretPosition: string | number}.\\nGot \"${String(\n              textToReplace,\n            )}\". Check the implementation for trigger \"${currentTrigger}\" and its token \"${actualToken}\"\\n\\nSee https://github.com/webscopeio/react-textarea-autocomplete#trigger-type for more informations.\\n`,\n          );\n        }\n\n        if (typeof textToReplace === 'string') {\n          return {\n            text: textToReplace,\n            caretPosition: DEFAULT_CARET_POSITION,\n          };\n        }\n\n        if (!textToReplace.text) {\n          throw new Error(\n            `Output \"text\" is not defined! Object should has shape {text: string, caretPosition: string | number}. Check the implementation for trigger \"${currentTrigger}\" and its token \"${actualToken}\"\\n`,\n          );\n        }\n\n        if (!textToReplace.caretPosition) {\n          throw new Error(\n            `Output \"caretPosition\" is not defined! Object should has shape {text: string, caretPosition: string | number}. Check the implementation for trigger \"${currentTrigger}\" and its token \"${actualToken}\"\\n`,\n          );\n        }\n\n        return textToReplace;\n      }\n\n      if (typeof item !== 'string') {\n        throw new Error('Output item should be string\\n');\n      }\n\n      return {\n        text: `${currentTrigger}${item}${currentTrigger}`,\n        caretPosition: DEFAULT_CARET_POSITION,\n      };\n    };\n  };\n\n  _getCurrentTriggerSettings = () => {\n    const { currentTrigger } = this.state;\n\n    if (!currentTrigger) return null;\n\n    return this.props.trigger[currentTrigger];\n  };\n\n  _getValuesFromProvider = () => {\n    const { currentTrigger, actualToken } = this.state;\n    const triggerSettings = this._getCurrentTriggerSettings();\n    if (!currentTrigger || !triggerSettings) {\n      return;\n    }\n\n    const { dataProvider, component } = triggerSettings;\n\n    if (typeof dataProvider !== 'function') {\n      throw new Error('Trigger provider has to be a function!');\n    }\n\n    this.setState({\n      dataLoading: true,\n    });\n\n    // Modified: send the full text to support / style commands\n    dataProvider(actualToken, this.state.value, (data, token) => {\n      // Make sure that the result is still relevant for current query\n      if (token !== this.state.actualToken) return;\n\n      if (!Array.isArray(data)) {\n        throw new Error('Trigger provider has to provide an array!');\n      }\n\n      if (!isValidElementType(component)) {\n        throw new Error('Component should be defined!');\n      }\n\n      // throw away if we resolved old trigger\n      if (currentTrigger !== this.state.currentTrigger) return;\n\n      // if we haven't resolved any data let's close the autocomplete\n      if (!data.length) {\n        this._closeAutocomplete();\n        return;\n      }\n\n      this.setState({\n        dataLoading: false,\n        data,\n        component,\n      });\n    });\n  };\n\n  _getSuggestions = () => {\n    const { currentTrigger, data } = this.state;\n\n    if (!currentTrigger || !data || (data && !data.length)) return null;\n\n    return data;\n  };\n\n  _createRegExp = () => {\n    const { trigger } = this.props;\n\n    // negative lookahead to match only the trigger + the actual token = \"bladhwd:adawd:word test\" => \":word\"\n    // https://stackoverflow.com/a/8057827/2719917\n    this.tokenRegExp = new RegExp(\n      `([${Object.keys(trigger).join('')}])(?:(?!\\\\1)[^\\\\s])*$`,\n    );\n  };\n\n  // TODO: This is an anti pattern in react, should come up with a better way\n  _update({ value, trigger }) {\n    const { value: oldValue } = this.state;\n    const { trigger: oldTrigger } = this.props;\n\n    if (value !== oldValue || !oldValue) this.setState({ value });\n    /**\n     * check if trigger chars are changed, if so, change the regexp accordingly\n     */\n    if (Object.keys(trigger).join('') !== Object.keys(oldTrigger).join('')) {\n      this._createRegExp();\n    }\n  }\n\n  /**\n   * Close autocomplete, also clean up trigger (to avoid slow promises)\n   */\n  _closeAutocomplete = () => {\n    this.setState({\n      data: null,\n      dataLoading: false,\n      currentTrigger: null,\n      top: null,\n      left: null,\n    });\n  };\n\n  _cleanUpProps = () => {\n    const props = { ...this.props };\n    const notSafe = [\n      'loadingComponent',\n      'containerStyle',\n      'minChar',\n      'scrollToItem',\n      'ref',\n      'innerRef',\n      'onChange',\n      'onCaretPositionChange',\n      'className',\n      'value',\n      'trigger',\n      'listStyle',\n      'itemStyle',\n      'containerStyle',\n      'loaderStyle',\n      'className',\n      'containerClassName',\n      'listClassName',\n      'itemClassName',\n      'loaderClassName',\n      'closeOnClickOutside',\n      'dropdownStyle',\n      'dropdownClassName',\n      'movePopupAsYouType',\n      'handleSubmit',\n      'replaceWord',\n      'grow',\n      'additionalTextareaProps',\n    ];\n\n    // eslint-disable-next-line\n    for (const prop in props) {\n      if (notSafe.includes(prop)) delete props[prop];\n    }\n\n    return props;\n  };\n\n  _isCommand = (text) => {\n    if (text[0] !== '/') return false;\n\n    const tokens = text.split(' ');\n\n    if (tokens.length > 1) return false;\n\n    return true;\n  };\n\n  _changeHandler = (e) => {\n    const {\n      trigger,\n      onChange,\n      minChar,\n      onCaretPositionChange,\n      movePopupAsYouType,\n    } = this.props;\n    const { top, left } = this.state;\n\n    const textarea = e.target;\n    const { selectionEnd, selectionStart } = textarea;\n    const value = textarea.value;\n\n    if (onChange) {\n      e.persist();\n      onChange(e);\n    }\n\n    if (onCaretPositionChange) {\n      const caretPosition = this.getCaretPosition();\n      onCaretPositionChange(caretPosition);\n    }\n\n    this.setState({\n      value,\n    });\n\n    let currentTrigger;\n    let lastToken;\n\n    if (this._isCommand(value)) {\n      currentTrigger = '/';\n      lastToken = value;\n    } else {\n      let tokenMatch = value\n        .slice(0, selectionEnd)\n        .match(/(?!^|\\W)?[:@][^\\s]*\\s?[^\\s]*$/g);\n\n      lastToken = tokenMatch && tokenMatch[tokenMatch.length - 1].trim();\n\n      currentTrigger =\n        (lastToken && Object.keys(trigger).find((a) => a === lastToken[0])) ||\n        null;\n    }\n\n    /*\n     if we lost the trigger token or there is no following character we want to close\n     the autocomplete\n    */\n    if (!lastToken || lastToken.length <= minChar) {\n      this._closeAutocomplete();\n      return;\n    }\n\n    const actualToken = lastToken.slice(1);\n\n    // if trigger is not configured step out from the function, otherwise proceed\n    if (!currentTrigger) {\n      return;\n    }\n\n    if (\n      movePopupAsYouType ||\n      (top === null && left === null) ||\n      // if we have single char - trigger it means we want to re-position the autocomplete\n      lastToken.length === 1\n    ) {\n      const { top: newTop, left: newLeft } = getCaretCoordinates(\n        textarea,\n        selectionEnd,\n      );\n\n      this.setState({\n        // make position relative to textarea\n        top: newTop - this.textareaRef.scrollTop || 0,\n        left: newLeft,\n      });\n    }\n\n    this.setState(\n      {\n        selectionEnd,\n        selectionStart,\n        currentTrigger,\n        actualToken,\n      },\n      () => {\n        try {\n          this._getValuesFromProvider();\n        } catch (err) {\n          errorMessage(err.message);\n        }\n      },\n    );\n  };\n\n  _selectHandler = (e) => {\n    const { onCaretPositionChange, onSelect } = this.props;\n\n    if (onCaretPositionChange) {\n      const caretPosition = this.getCaretPosition();\n      onCaretPositionChange(caretPosition);\n    }\n\n    if (onSelect) {\n      e.persist();\n      onSelect(e);\n    }\n  };\n\n  _onClickAndBlurHandler = (e) => {\n    const { closeOnClickOutside, onBlur } = this.props;\n\n    // If this is a click: e.target is the textarea, and e.relatedTarget is the thing\n    // that was actually clicked. If we clicked inside the autoselect dropdown, then\n    // that's not a blur, from the autoselect's point of view, so then do nothing.\n    const el = e.relatedTarget;\n    if (\n      this.dropdownRef &&\n      el instanceof Node &&\n      this.dropdownRef.contains(el)\n    ) {\n      return;\n    }\n\n    if (closeOnClickOutside) {\n      this._closeAutocomplete();\n    }\n\n    if (onBlur) {\n      e.persist();\n      onBlur(e);\n    }\n  };\n\n  _onScrollHandler = () => {\n    this._closeAutocomplete();\n  };\n\n  _dropdownScroll = (item) => {\n    const { scrollToItem } = this.props;\n\n    if (!scrollToItem) return;\n\n    if (scrollToItem === true) {\n      defaultScrollToItem(this.dropdownRef, item);\n      return;\n    }\n\n    if (typeof scrollToItem !== 'function' || scrollToItem.length !== 2) {\n      throw new Error(\n        '`scrollToItem` has to be boolean (true for default implementation) or function with two parameters: container, item.',\n      );\n    }\n\n    scrollToItem(this.dropdownRef, item);\n  };\n\n  render() {\n    const {\n      loadingComponent: Loader,\n      style,\n      className,\n      itemStyle,\n      listClassName,\n      itemClassName,\n      dropdownClassName,\n      dropdownStyle,\n      containerStyle,\n      containerClassName,\n      loaderStyle,\n      loaderClassName,\n    } = this.props;\n    const { dataLoading, currentTrigger, component, value } = this.state;\n\n    const suggestionData = this._getSuggestions();\n    const textToReplace = this._getTextToReplace();\n    const selectedItem = this._getItemOnSelect();\n\n    let maxRows = this.props.maxRows;\n    if (!this.props.grow) {\n      maxRows = 1;\n    }\n\n    return (\n      <div\n        className={`rta ${dataLoading === true ? 'rta--loading' : ''} ${\n          containerClassName || ''\n        }`}\n        style={containerStyle}\n      >\n        {(dataLoading || suggestionData) && currentTrigger && (\n          <div\n            ref={(ref) => {\n              // $FlowFixMe\n              this.dropdownRef = ref;\n            }}\n            style={{ ...dropdownStyle }}\n            className={`rta__autocomplete ${dropdownClassName || ''}`}\n          >\n            {suggestionData && component && textToReplace && (\n              <List\n                value={value}\n                values={suggestionData}\n                component={component}\n                className={listClassName}\n                itemClassName={itemClassName}\n                itemStyle={itemStyle}\n                getTextToReplace={textToReplace}\n                getSelectedItem={selectedItem}\n                onSelect={this._onSelect}\n                dropdownScroll={this._dropdownScroll}\n              />\n            )}\n          </div>\n        )}\n\n        <Textarea\n          {...this._cleanUpProps()}\n          ref={(ref) => {\n            this.props.innerRef && this.props.innerRef(ref);\n            this.textareaRef = ref;\n          }}\n          maxRows={maxRows}\n          className={`rta__textarea ${className || ''}`}\n          onChange={this._changeHandler}\n          onSelect={this._selectHandler}\n          onScroll={this._onScrollHandler}\n          onClick={\n            // The textarea itself is outside the autoselect dropdown.\n            this._onClickAndBlurHandler\n          }\n          onBlur={this._onClickAndBlurHandler}\n          onFocus={this.props.onFocus}\n          value={value}\n          style={style}\n          {...this.props.additionalTextareaProps}\n        />\n      </div>\n    );\n  }\n}\n\nconst triggerPropsCheck = ({ trigger }) => {\n  if (!trigger) return Error('Invalid prop trigger. Prop missing.');\n\n  const triggers = Object.entries(trigger);\n\n  for (let i = 0; i < triggers.length; i += 1) {\n    const [triggerChar, settings] = triggers[i];\n\n    if (typeof triggerChar !== 'string' || triggerChar.length !== 1) {\n      return Error(\n        'Invalid prop trigger. Keys of the object has to be string / one character.',\n      );\n    }\n\n    // $FlowFixMe\n    const triggerSetting = settings;\n\n    const { component, dataProvider, output, callback } = triggerSetting;\n\n    if (!isValidElementType(component)) {\n      return Error('Invalid prop trigger: component should be defined.');\n    }\n\n    if (!dataProvider || typeof dataProvider !== 'function') {\n      return Error('Invalid prop trigger: dataProvider should be defined.');\n    }\n\n    if (output && typeof output !== 'function') {\n      return Error('Invalid prop trigger: output should be a function.');\n    }\n\n    if (callback && typeof callback !== 'function') {\n      return Error('Invalid prop trigger: callback should be a function.');\n    }\n  }\n\n  return null;\n};\n\nReactTextareaAutocomplete.propTypes = {\n  loadingComponent: PropTypes.elementType,\n  minChar: PropTypes.number,\n  onChange: PropTypes.func,\n  onSelect: PropTypes.func,\n  onBlur: PropTypes.func,\n  onCaretPositionChange: PropTypes.func,\n  className: PropTypes.string,\n  containerStyle: PropTypes.object,\n  containerClassName: PropTypes.string,\n  closeOnClickOutside: PropTypes.bool,\n  style: PropTypes.object,\n  listStyle: PropTypes.object,\n  itemStyle: PropTypes.object,\n  loaderStyle: PropTypes.object,\n  dropdownStyle: PropTypes.object,\n  listClassName: PropTypes.string,\n  itemClassName: PropTypes.string,\n  loaderClassName: PropTypes.string,\n  dropdownClassName: PropTypes.string,\n  value: PropTypes.string,\n  trigger: triggerPropsCheck, //eslint-disable-line\n};\n\nexport default ReactTextareaAutocomplete;\n","// @ts-check\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * Avatar - A round avatar image with fallback to username's first letter\n *\n * @example ../../docs/Avatar.md\n * @typedef {import('types').AvatarProps} Props\n * @type { React.FC<Props>}\n */\nconst Avatar = ({\n  size = 32,\n  name,\n  shape = 'circle',\n  image,\n  onClick = () => {},\n  onMouseOver = () => {},\n}) => {\n  const [loaded, setLoaded] = useState(false);\n  const [error, setError] = useState(false);\n\n  useEffect(() => {\n    setLoaded(false);\n    setError(false);\n  }, [image]);\n\n  const initials = (name || '').charAt(0);\n\n  return (\n    <div\n      data-testid=\"avatar\"\n      className={`str-chat__avatar str-chat__avatar--${shape}`}\n      title={name}\n      style={{\n        width: size,\n        height: size,\n        flexBasis: size,\n        lineHeight: `${size}px`,\n        fontSize: size / 2,\n      }}\n      onClick={onClick}\n      onMouseOver={onMouseOver}\n    >\n      {image && !error ? (\n        <img\n          data-testid=\"avatar-img\"\n          src={image}\n          alt={initials}\n          className={`str-chat__avatar-image${\n            loaded ? ' str-chat__avatar-image--loaded' : ''\n          }`}\n          style={{\n            width: size,\n            height: size,\n            flexBasis: size,\n            objectFit: 'cover',\n          }}\n          onLoad={() => setLoaded(true)}\n          onError={() => setError(true)}\n        />\n      ) : (\n        <div\n          data-testid=\"avatar-fallback\"\n          className=\"str-chat__avatar-fallback\"\n        >\n          {initials}\n        </div>\n      )}\n    </div>\n  );\n};\n\nAvatar.propTypes = {\n  /** image url */\n  image: PropTypes.string,\n  /** name of the picture, used for title tag fallback */\n  name: PropTypes.string,\n  /** shape of the avatar, circle, rounded or square */\n  shape: PropTypes.oneOf(['circle', 'rounded', 'square']),\n  /** size in pixels */\n  size: PropTypes.number,\n  /** click event handler */\n  onClick: PropTypes.func,\n  /** mouseOver event handler */\n  onMouseOver: PropTypes.func,\n};\n\nexport default Avatar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\n/** @type {React.FC<import('types').ChannelPreviewUIComponentProps>} */\nconst ChannelPreviewCountOnly = ({\n  channel,\n  setActiveChannel,\n  watchers,\n  unread,\n  displayTitle,\n}) => {\n  return (\n    <div className={unread >= 1 ? 'unread' : ''}>\n      <button onClick={() => setActiveChannel(channel, watchers)}>\n        {' '}\n        {displayTitle} <span>{unread}</span>\n      </button>\n    </div>\n  );\n};\n\nChannelPreviewCountOnly.propTypes = {\n  /** **Available from [chat context](https://getstream.github.io/stream-chat-react/#chat)** */\n  channel: PropTypes.object.isRequired,\n  /** @see See [chat context](https://getstream.github.io/stream-chat-react/#chat) for doc */\n  setActiveChannel: PropTypes.func.isRequired,\n  /**\n   * Object containing watcher parameters\n   * @see See [Pagination documentation](https://getstream.io/chat/docs/#channel_pagination) for a list of available fields for sort.\n   * */\n  watchers: /** @type {PropTypes.Validator<{ limit?: number | undefined; offset?: number | undefined} | null | undefined> | undefined} */ (PropTypes.object),\n  /** Number of unread messages */\n  unread: PropTypes.number,\n  /** Title of channel to display */\n  displayTitle: PropTypes.string,\n};\n\nexport default React.memo(ChannelPreviewCountOnly);\n","export const getLatestMessagePreview = (channel, t) => {\n  const latestMessage =\n    channel.state.messages[channel.state.messages.length - 1];\n\n  if (!latestMessage) {\n    return t('Nothing yet...');\n  }\n  if (latestMessage.deleted_at) {\n    return t('Message deleted');\n  }\n  if (latestMessage.text) {\n    return latestMessage.text;\n  }\n  if (latestMessage.command) {\n    return `/${latestMessage.command}`;\n  }\n  if (latestMessage.attachments.length) {\n    return t('🏙 Attachment...');\n  }\n\n  return t('Empty message...');\n};\n\nexport const getDisplayTitle = (channel, currentUser) => {\n  let title = channel.data.name;\n  const members = Object.values(channel.state.members);\n\n  if (!title && members.length === 2) {\n    const otherMember = members.find((m) => m.user.id !== currentUser.id);\n    title = otherMember.user.name;\n  }\n\n  return title;\n};\n\nexport const getDisplayImage = (channel, currentUser) => {\n  let { image } = channel.data;\n  const members = Object.values(channel.state.members);\n\n  if (!image && members.length === 2) {\n    const otherMember = members.find((m) => m.user.id !== currentUser.id);\n    image = otherMember.user.image;\n  }\n\n  return image;\n};\n","// @ts-check\nimport React, { useState, useEffect, useContext } from 'react';\n\n// eslint-disable-next-line import/no-unresolved\nimport PropTypes from 'prop-types';\nimport ChannelPreviewCountOnly from './ChannelPreviewCountOnly';\nimport { TranslationContext, ChatContext } from '../../context';\nimport {\n  getLatestMessagePreview,\n  getDisplayTitle,\n  getDisplayImage,\n} from './utils';\n\n/**\n * @type {React.FC<import('types').ChannelPreviewProps>}\n */\nconst ChannelPreview = (props) => {\n  const { t } = useContext(TranslationContext);\n  const { client, channel: activeChannel, setActiveChannel } = useContext(\n    ChatContext,\n  );\n  const { channel, Preview = ChannelPreviewCountOnly } = props;\n  const [lastMessage, setLastMessage] = useState(\n    /** @type {import('stream-chat').MessageResponse | undefined} */ (undefined),\n  );\n  const [unread, setUnread] = useState(0);\n\n  useEffect(() => {\n    setUnread(channel.countUnread());\n  }, [channel]);\n\n  useEffect(() => {\n    /** @type {(event: StreamChat.Event) => void} Typescript syntax */\n    const handleEvent = (event) => {\n      const isActive = activeChannel?.cid === channel.cid;\n      setLastMessage(event.message);\n\n      if (!isActive) {\n        setUnread(channel.countUnread());\n      } else {\n        setUnread(0);\n      }\n    };\n\n    channel.on('message.new', handleEvent);\n    channel.on('message.updated', handleEvent);\n    channel.on('message.deleted', handleEvent);\n\n    return () => {\n      channel.off('message.new', handleEvent);\n      channel.off('message.updated', handleEvent);\n      channel.off('message.deleted', handleEvent);\n    };\n  }, [channel, activeChannel]);\n\n  useEffect(() => {\n    const isActive = activeChannel?.cid === channel.cid;\n\n    if (isActive) {\n      setUnread(0);\n    } else {\n      setUnread(channel.countUnread());\n    }\n  }, [activeChannel, channel]);\n\n  if (!Preview) {\n    return null;\n  }\n\n  return (\n    <Preview\n      {...props}\n      setActiveChannel={setActiveChannel}\n      lastMessage={lastMessage}\n      unread={unread}\n      latestMessage={getLatestMessagePreview(channel, t)}\n      displayTitle={getDisplayTitle(channel, client.user)}\n      displayImage={getDisplayImage(channel, client.user)}\n      active={activeChannel && activeChannel.cid === channel.cid}\n    />\n  );\n};\n\nChannelPreview.propTypes = {\n  /** **Available from [chat context](https://getstream.github.io/stream-chat-react/#chat)** */\n  channel: /** @type {PropTypes.Validator<import('stream-chat').Channel>} */ (PropTypes\n    .object.isRequired),\n  /** Current selected channel object */\n  activeChannel: /** @type {PropTypes.Validator<import('stream-chat').Channel | null | undefined>} */ (PropTypes.object),\n  /**\n   * Available built-in options (also accepts the same props as):\n   *\n   * 1. [ChannelPreviewCompact](https://getstream.github.io/stream-chat-react/#ChannelPreviewCompact) (default)\n   * 2. [ChannelPreviewLastMessage](https://getstream.github.io/stream-chat-react/#ChannelPreviewLastMessage)\n   * 3. [ChannelPreviewMessanger](https://getstream.github.io/stream-chat-react/#ChannelPreviewMessanger)\n   *\n   * The Preview to use, defaults to ChannelPreviewLastMessage\n   * */\n  Preview: /** @type {PropTypes.Validator<React.ComponentType<import('types').ChannelPreviewUIComponentProps>>} */ (PropTypes.elementType),\n};\n\nexport default ChannelPreview;\n","// @ts-check\nimport React, { useRef } from 'react';\n// eslint-disable-next-line import/no-unresolved\nimport PropTypes from 'prop-types';\nimport { Channel } from 'stream-chat';\n\nimport { Avatar } from '../Avatar';\n\n/**\n *\n * @example ../../docs/ChannelPreviewCompact.md\n * @type {import('types').ChannelPreviewCompact}\n */\nconst ChannelPreviewCompact = (props) => {\n  /**\n   * @type {React.MutableRefObject<HTMLButtonElement | null>} Typescript syntax\n   */\n  const channelPreviewButton = useRef(null);\n  const unreadClass =\n    props.unread_count >= 1 ? 'str-chat__channel-preview-compact--unread' : '';\n  const activeClass = props.active\n    ? 'str-chat__channel-preview-compact--active'\n    : '';\n\n  const onSelectChannel = () => {\n    props.setActiveChannel(props.channel, props.watchers);\n    // eslint-disable-next-line no-unused-expressions\n    channelPreviewButton?.current?.blur();\n  };\n\n  return (\n    <button\n      data-testid=\"channel-preview-button\"\n      onClick={onSelectChannel}\n      ref={channelPreviewButton}\n      className={`str-chat__channel-preview-compact ${unreadClass} ${activeClass}`}\n    >\n      <div className=\"str-chat__channel-preview-compact--left\">\n        <Avatar image={props.displayImage} size={20} />\n      </div>\n      <div className=\"str-chat__channel-preview-compact--right\">\n        {props.displayTitle}\n      </div>\n    </button>\n  );\n};\n\nChannelPreviewCompact.propTypes = {\n  /** **Available from [chat context](https://getstream.github.io/stream-chat-react/#chat)** */\n  channel: PropTypes.instanceOf(Channel).isRequired,\n  /** Current selected channel object */\n  activeChannel: PropTypes.instanceOf(Channel),\n  /** Setter for selected channel */\n  setActiveChannel: PropTypes.func.isRequired,\n  /**\n   * Object containing watcher parameters\n   * @see See [Pagination documentation](https://getstream.io/chat/docs/#channel_pagination) for a list of available fields for sort.\n   * */\n  watchers: /** @type {PropTypes.Validator<{ limit?: number | undefined; offset?: number | undefined} | null | undefined> | undefined} */ (PropTypes.object),\n  /** Number of unread messages */\n  unread: PropTypes.number,\n  /** If channel of component is active (selected) channel */\n  active: PropTypes.bool,\n  /** Latest message's text. */\n  latestMessage: PropTypes.string,\n  /** Title of channel to display */\n  displayTitle: PropTypes.string,\n  /** Image of channel to display */\n  displayImage: PropTypes.string,\n};\n\nexport default React.memo(ChannelPreviewCompact);\n","// @ts-check\nimport React, { useRef } from 'react';\n// eslint-disable-next-line import/no-unresolved\nimport PropTypes from 'prop-types';\nimport { truncate } from '../../utils';\n\nimport { Avatar } from '../Avatar';\n\n/**\n * Used as preview component for channel item in [ChannelList](#channellist) component.\n *\n * @example ../../docs/ChannelPreviewLastMessage.md\n * @type {import('types').ChannelPreviewLastMessage}\n */\nconst ChannelPreviewLastMessage = (props) => {\n  /** @type {React.MutableRefObject<HTMLButtonElement | null>} Typescript syntax */\n  const channelPreviewButton = useRef(null);\n  const onSelectChannel = () => {\n    props.setActiveChannel(props.channel, props.watchers);\n    // eslint-disable-next-line no-unused-expressions\n    channelPreviewButton?.current?.blur();\n  };\n\n  const unreadClass =\n    props.unread >= 1 ? 'str-chat__channel-preview--unread' : '';\n  const activeClass = props.active ? 'str-chat__channel-preview--active' : '';\n\n  return (\n    <div className={`str-chat__channel-preview ${unreadClass} ${activeClass}`}>\n      <button\n        onClick={onSelectChannel}\n        ref={channelPreviewButton}\n        data-testid=\"channel-preview-button\"\n      >\n        {props.unread >= 1 && (\n          <div className=\"str-chat__channel-preview--dot\" />\n        )}\n        <Avatar image={props.displayImage} />\n        <div className=\"str-chat__channel-preview-info\">\n          <span className=\"str-chat__channel-preview-title\">\n            {props.displayTitle}\n          </span>\n          <span className=\"str-chat__channel-preview-last-message\">\n            {truncate(props.latestMessage, props.latestMessageLength)}\n          </span>\n          {props.unread >= 1 && (\n            <span className=\"str-chat__channel-preview-unread-count\">\n              {props.unread}\n            </span>\n          )}\n        </div>\n      </button>\n    </div>\n  );\n};\n\nChannelPreviewLastMessage.propTypes = {\n  /** **Available from [chat context](https://getstream.github.io/stream-chat-react/#chat)** */\n  channel: PropTypes.object.isRequired,\n  /** Current selected channel object */\n  activeChannel: PropTypes.object,\n  /** Setter for selected channel */\n  setActiveChannel: PropTypes.func.isRequired,\n  /**\n   * Object containing watcher parameters\n   * @see See [Pagination documentation](https://getstream.io/chat/docs/#channel_pagination) for a list of available fields for sort.\n   * */\n  watchers: PropTypes.object,\n  /** Number of unread messages */\n  unread: PropTypes.number,\n  /** If channel of component is active (selected) channel */\n  active: PropTypes.bool,\n  /** Latest message's text. */\n  latestMessage: PropTypes.string,\n  /** Length of latest message to truncate at */\n  latestMessageLength: PropTypes.number,\n  /** Title of channel to display */\n  displayTitle: PropTypes.string,\n  /** Image of channel to display */\n  displayImage: PropTypes.string,\n};\n\nChannelPreviewLastMessage.defaultProps = {\n  latestMessageLength: 20,\n};\n\nexport default React.memo(ChannelPreviewLastMessage);\n","// @ts-check\nimport React, { useRef } from 'react';\n// eslint-disable-next-line import/no-unresolved\nimport PropTypes from 'prop-types';\nimport { truncate } from '../../utils';\n\nimport { Avatar } from '../Avatar';\n\n/**\n * Used as preview component for channel item in [ChannelList](#channellist) component.\n * Its best suited for messenger type chat.\n *\n * @example ../../docs/ChannelPreviewMessenger.md\n * @type {import('types').ChannelPreviewMessenger}\n */\nconst ChannelPreviewMessenger = (props) => {\n  /** @type {React.MutableRefObject<HTMLButtonElement | null>} Typescript syntax */\n  const channelPreviewButton = useRef(null);\n  const unreadClass =\n    props.unread >= 1 ? 'str-chat__channel-preview-messenger--unread' : '';\n  const activeClass = props.active\n    ? 'str-chat__channel-preview-messenger--active'\n    : '';\n  const onSelectChannel = () => {\n    props.setActiveChannel(props.channel, props.watchers);\n    // eslint-disable-next-line no-unused-expressions\n    channelPreviewButton?.current?.blur();\n  };\n\n  return (\n    <button\n      onClick={onSelectChannel}\n      ref={channelPreviewButton}\n      className={`str-chat__channel-preview-messenger ${unreadClass} ${activeClass}`}\n      data-testid=\"channel-preview-button\"\n    >\n      <div className=\"str-chat__channel-preview-messenger--left\">\n        {<Avatar image={props.displayImage} size={40} />}\n      </div>\n      <div className=\"str-chat__channel-preview-messenger--right\">\n        <div className=\"str-chat__channel-preview-messenger--name\">\n          <span>{props.displayTitle}</span>\n        </div>\n        <div className=\"str-chat__channel-preview-messenger--last-message\">\n          {truncate(props.latestMessage, props.latestMessageLength)}\n        </div>\n      </div>\n    </button>\n  );\n};\n\nChannelPreviewMessenger.propTypes = {\n  /** **Available from [chat context](https://getstream.github.io/stream-chat-react/#chat)** */\n  channel: PropTypes.object.isRequired,\n  /** Current selected channel object */\n  activeChannel: PropTypes.object,\n  /** Setter for selected channel */\n  setActiveChannel: PropTypes.func.isRequired,\n  /**\n   * Object containing watcher parameters\n   * @see See [Pagination documentation](https://getstream.io/chat/docs/#channel_pagination) for a list of available fields for sort.\n   * */\n  watchers: PropTypes.object,\n  /** Number of unread messages */\n  unread: PropTypes.number,\n  /** If channel of component is active (selected) channel */\n  active: PropTypes.bool,\n  /** Latest message's text. */\n  latestMessage: PropTypes.string,\n  /** Length of latest message to truncate at */\n  latestMessageLength: PropTypes.number,\n  /** Title of channel to display */\n  displayTitle: PropTypes.string,\n  /** Image of channel to display */\n  displayImage: PropTypes.string,\n};\n\nChannelPreviewMessenger.defaultProps = {\n  latestMessageLength: 14,\n};\n\nexport default React.memo(ChannelPreviewMessenger);\n","// @ts-check\nimport React from 'react';\n\nexport const ReplyIcon = () => (\n  <svg width=\"18\" height=\"15\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      d=\"M.56 10.946H.06l-.002-.498L.025.92a.5.5 0 1 1 1-.004l.032 9.029H9.06v-4l9 4.5-9 4.5v-4H.56z\"\n      fillRule=\"nonzero\"\n    />\n  </svg>\n);\n\nexport const DeliveredCheckIcon = () => (\n  <svg width=\"16\" height=\"16\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      d=\"M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zm3.72 6.633a.955.955 0 1 0-1.352-1.352L6.986 8.663 5.633 7.31A.956.956 0 1 0 4.28 8.663l2.029 2.028a.956.956 0 0 0 1.353 0l4.058-4.058z\"\n      fill=\"#006CFF\"\n      fillRule=\"evenodd\"\n    />\n  </svg>\n);\n\nexport const ReactionIcon = () => (\n  <svg width=\"14\" height=\"14\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      d=\"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\"\n      fillRule=\"evenodd\"\n    />\n  </svg>\n);\n\nexport const ThreadIcon = () => (\n  <svg width=\"14\" height=\"10\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      d=\"M8.516 3c4.78 0 4.972 6.5 4.972 6.5-1.6-2.906-2.847-3.184-4.972-3.184v2.872L3.772 4.994 8.516.5V3zM.484 5l4.5-4.237v1.78L2.416 5l2.568 2.125v1.828L.484 5z\"\n      fillRule=\"evenodd\"\n    />\n  </svg>\n);\n\nexport const ErrorIcon = () => (\n  <svg width=\"14\" height=\"14\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      d=\"M7 0a7 7 0 1 0 0 14A7 7 0 0 0 7 0zm.875 10.938a.438.438 0 0 1-.438.437h-.875a.438.438 0 0 1-.437-.438v-.874c0-.242.196-.438.438-.438h.875c.241 0 .437.196.437.438v.874zm0-2.626a.438.438 0 0 1-.438.438h-.875a.438.438 0 0 1-.437-.438v-5.25c0-.241.196-.437.438-.437h.875c.241 0 .437.196.437.438v5.25z\"\n      fill=\"#EA152F\"\n      fillRule=\"evenodd\"\n    />\n  </svg>\n);\n","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport { TranslationContext } from '../../context';\nimport { ReplyIcon } from './icons';\n\n/** @type {React.FC<import(\"types\").MessageRepliesCountButtonProps>} */\nconst MessageRepliesCountButton = ({\n  reply_count,\n  labelSingle,\n  labelPlural,\n  onClick,\n}) => {\n  const { t } = useContext(TranslationContext);\n  let singleReplyText;\n  let pluralReplyText;\n\n  if (reply_count === 1) {\n    if (labelSingle) {\n      singleReplyText = `1 ${labelSingle}`;\n    } else {\n      singleReplyText = t('1 reply');\n    }\n  }\n\n  if (reply_count && reply_count > 1) {\n    if (labelPlural) {\n      pluralReplyText = `${reply_count} ${labelPlural}`;\n    } else {\n      pluralReplyText = t('{{ replyCount }} replies', {\n        replyCount: reply_count,\n      });\n    }\n  }\n\n  if (reply_count && reply_count !== 0) {\n    return (\n      <button\n        data-testid=\"replies-count-button\"\n        className=\"str-chat__message-replies-count-button\"\n        onClick={onClick}\n      >\n        <ReplyIcon />\n        {reply_count === 1 ? singleReplyText : pluralReplyText}\n      </button>\n    );\n  }\n  return null;\n};\n\nMessageRepliesCountButton.defaultProps = {\n  reply_count: 0,\n};\n\nMessageRepliesCountButton.propTypes = {\n  /** Label for number of replies, when count is 1 */\n  labelSingle: PropTypes.string,\n  /** Label for number of replies, when count is more than 1 */\n  labelPlural: PropTypes.string,\n  /** Number of replies */\n  reply_count: PropTypes.number,\n  /**\n   * click handler for button\n   * @param event React's MouseEventHandler event\n   * @returns void\n   * */\n  onClick: PropTypes.func,\n};\n\nexport default React.memo(MessageRepliesCountButton);\n","// @ts-check\nimport React, { useRef, useEffect, useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport { TranslationContext } from '../../context';\n\n/** @type {React.FC<import(\"types\").ModalProps>} */\nconst Modal = ({ children, onClose, open }) => {\n  /** @type {React.RefObject<HTMLDivElement>} */\n  const innerRef = useRef(null);\n  const { t } = useContext(TranslationContext);\n\n  /** @param {React.MouseEvent} e */\n  const handleClick = (e) => {\n    if (\n      e.target instanceof Node &&\n      !innerRef.current?.contains(e.target) &&\n      onClose\n    ) {\n      onClose();\n    }\n  };\n\n  useEffect(() => {\n    if (!open) return () => {};\n    /** @type {EventListener} */\n    const handleEscKey = (e) => {\n      if (e instanceof KeyboardEvent && e.keyCode === 27 && onClose) {\n        onClose();\n      }\n    };\n    document.addEventListener('keyPress', handleEscKey, false);\n    return () => document.removeEventListener('keyPress', handleEscKey, false);\n  }, [onClose, open]);\n\n  const openClasses = open\n    ? 'str-chat__modal--open'\n    : 'str-chat__modal--closed';\n\n  return (\n    <div className={`str-chat__modal ${openClasses}`} onClick={handleClick}>\n      <div className=\"str-chat__modal__close-button\">\n        {t('Close')}\n        <svg width=\"10\" height=\"10\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path\n            d=\"M9.916 1.027L8.973.084 5 4.058 1.027.084l-.943.943L4.058 5 .084 8.973l.943.943L5 5.942l3.973 3.974.943-.943L5.942 5z\"\n            fillRule=\"evenodd\"\n          />\n        </svg>\n      </div>\n      <div className=\"str-chat__modal__inner\" ref={innerRef}>\n        {children}\n      </div>\n    </div>\n  );\n};\n\nModal.propTypes = {\n  /** Callback handler for closing of modal. */\n  onClose: PropTypes.func.isRequired,\n  /** If true, modal is opened or visible. */\n  open: PropTypes.bool.isRequired,\n};\n\nexport default Modal;\n","// @ts-check\nimport React from 'react';\n\nconst LoadingItems = () => (\n  <div className=\"str-chat__loading-channels-item\">\n    <div className=\"str-chat__loading-channels-avatar\" />\n    <div className=\"str-chat__loading-channels-meta\">\n      <div className=\"str-chat__loading-channels-username\" />\n      <div className=\"str-chat__loading-channels-status\" />\n    </div>\n  </div>\n);\n\n/**\n * LoadingChannels - Fancy loading indicator for the channel list\n *\n * @example ../../docs/LoadingChannels.md\n */\nconst LoadingChannels = () => (\n  <div className=\"str-chat__loading-channels\">\n    <LoadingItems />\n    <LoadingItems />\n    <LoadingItems />\n  </div>\n);\n\nexport default React.memo(LoadingChannels);\n","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { TranslationContext } from '../../context';\n\n/**\n * LoadingErrorIndicator - UI component for error indicator in Channel.\n *\n * @example ../../docs/LoadingErrorIndicator.md\n * @type {React.FC<import('types').LoadingErrorIndicatorProps>}\n */\nconst LoadingErrorIndicator = ({ error }) => {\n  const { t } = useContext(TranslationContext);\n  if (!error) return null;\n\n  return (\n    // @ts-ignore\n    <div>{t('Error: {{ errorMessage }}', { errorMessage: error.message })}</div>\n  );\n};\n\nLoadingErrorIndicator.defaultProps = {\n  error: null,\n};\n\nLoadingErrorIndicator.propTypes = {\n  /** Error object */\n  error: PropTypes.instanceOf(Error),\n};\n\nexport default React.memo(LoadingErrorIndicator);\n","// @ts-check\nimport React from 'react';\n\n// @ts-ignore\nimport svg from '../../assets/str-chat__loading-indicator.svg';\n\n/**\n * LoadingIndicator - Just a simple loading spinner..\n *\n * @example ../../docs/LoadingIndicator.md\n * @type { React.FC<import('types').LoadingIndicatorProps>}\n */\nconst LoadingIndicator = ({ size = 15, color = '#006CFF' }) => (\n  <div\n    className={`str-chat__loading-indicator ${color}`}\n    data-testid=\"loading-indicator-wrapper\"\n    style={{ width: size, height: size }}\n  >\n    <svg\n      width={size}\n      height={size}\n      viewBox={`0 0 30 30`}\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <defs>\n        <linearGradient x1=\"50%\" y1=\"0%\" x2=\"50%\" y2=\"100%\" id=\"a\">\n          <stop stopColor=\"#FFF\" stopOpacity=\"0\" offset=\"0%\" />\n          <stop\n            offset=\"100%\"\n            data-testid=\"loading-indicator-circle\"\n            stopColor={color}\n            stopOpacity=\"1\"\n            style={{ stopColor: color }}\n          />\n        </linearGradient>\n      </defs>\n      <path\n        d=\"M2.518 23.321l1.664-1.11A12.988 12.988 0 0 0 15 28c7.18 0 13-5.82 13-13S22.18 2 15 2V0c8.284 0 15 6.716 15 15 0 8.284-6.716 15-15 15-5.206 0-9.792-2.652-12.482-6.679z\"\n        fill=\"url(#a)\"\n        fillRule=\"evenodd\"\n      />\n    </svg>\n  </div>\n);\n\nexport default React.memo(LoadingIndicator);\n","// @ts-check\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/** @type {React.FC<import(\"types\").EmoticonItemProps>} */\nconst EmoticonItem = ({ entity }) => (\n  <div className=\"str-chat__emoji-item\">\n    <span className=\"str-chat__emoji-item--entity\">{entity.native}</span>\n    <span className=\"str-chat__emoji-item--name\">{entity.name}</span>\n  </div>\n);\n\nEmoticonItem.propTypes = {\n  entity: PropTypes.shape({\n    /** Name for emoticon */\n    name: PropTypes.string.isRequired,\n    /** Native value or actual emoticon */\n    native: PropTypes.string.isRequired,\n  }).isRequired,\n};\n\nexport default React.memo(EmoticonItem);\n","// @ts-check\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { Avatar } from '../Avatar';\n\n/**\n * UserItem - Component rendered in commands menu\n * @typedef {import('types').UserItemProps} Props\n * @type {React.FC<Props>}\n */\nconst UserItem = ({ entity }) => (\n  <div className=\"str-chat__user-item\">\n    <Avatar size={20} image={entity.image} />\n    <div>\n      <strong>{entity.name}</strong> {!entity.name ? entity.id : ''}\n    </div>\n  </div>\n);\n\nUserItem.propTypes = {\n  entity: PropTypes.shape({\n    /** Name of the user */\n    name: PropTypes.string,\n    /** Id of the user */\n    id: PropTypes.string,\n    /** Image of the user */\n    image: PropTypes.string,\n  }).isRequired,\n};\n\nexport default React.memo(UserItem);\n","// @ts-check\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * @type {React.FC<import('types').CommandItemProps>}\n */\nconst CommandItem = ({ entity }) => (\n  <div className=\"str-chat__slash-command\">\n    <span className=\"str-chat__slash-command-header\">\n      <strong>{entity.name}</strong> {entity.args}\n    </span>\n    <br />\n    <span className=\"str-chat__slash-command-description\">\n      {entity.description}\n    </span>\n  </div>\n);\n\nCommandItem.propTypes = {\n  entity: PropTypes.shape({\n    /** Name of the command */\n    name: PropTypes.string,\n    /** Arguments of command */\n    args: PropTypes.string,\n    /** Description of command */\n    description: PropTypes.string,\n  }).isRequired,\n};\n\nexport default React.memo(CommandItem);\n","// @ts-check\nimport React, { useContext, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { emojiIndex } from 'emoji-mart';\n// ignore TS error because the type definitions for this package requires generics, which you can't do in jsdoc\n// @ts-ignore\nimport debounce from 'lodash.debounce';\n\nimport { AutoCompleteTextarea } from '../AutoCompleteTextarea';\nimport { LoadingIndicator } from '../Loading';\nimport { EmoticonItem } from '../EmoticonItem';\nimport { UserItem } from '../UserItem';\nimport { CommandItem } from '../CommandItem';\nimport { ChatContext } from '../../context/ChatContext';\n\n/** @param {string} word */\nconst emojiReplace = (word) => {\n  const found = emojiIndex.search(word) || [];\n  const emoji = found\n    .slice(0, 10)\n    .find(({ emoticons }) => emoticons?.includes(word));\n  if (!emoji || !('native' in emoji)) return null;\n  return emoji.native;\n};\n\n/** @type {React.FC<import(\"types\").ChatAutoCompleteProps>} */\nconst ChatAutoComplete = (props) => {\n  const { channel } = useContext(ChatContext);\n  const members = channel?.state?.members;\n  const watchers = channel?.state?.watchers;\n\n  const getMembersAndWatchers = useCallback(() => {\n    const memberUsers = members\n      ? Object.values(members).map(({ user }) => user)\n      : [];\n    const watcherUsers = watchers ? Object.values(watchers) : [];\n    const users = [...memberUsers, ...watcherUsers];\n    // make sure we don't list users twice\n    /** @type {{ [key: string]: import('stream-chat').User}} */\n    const uniqueUsers = {};\n    users.forEach((user) => {\n      if (user && !uniqueUsers[user.id]) {\n        uniqueUsers[user.id] = user;\n      }\n    });\n    return Object.values(uniqueUsers);\n  }, [members, watchers]);\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const queryMembersdebounced = useCallback(\n    debounce(\n      /**\n       * @param {string} query\n       * @param {(data: any[]) => void} onReady\n       */\n      async (query, onReady) => {\n        if (!channel?.queryMembers) return;\n        const response = await channel?.queryMembers({\n          name: { $autocomplete: query },\n        });\n        const users = response.members.map((m) => m.user);\n        if (onReady) onReady(users);\n      },\n      200,\n    ),\n    [channel?.queryMembers],\n  );\n\n  const { commands, onSelectItem, triggers } = props;\n  /**\n   * dataProvider accepts `onReady` function, which will executed once the data is ready.\n   * Another approach would have been to simply return the data from dataProvider and let the\n   * component await for it and then execute the required logic. We are going for callback instead\n   * of async-await since we have debounce function in dataProvider. Which will delay the execution\n   * of api call on trailing end of debounce (lets call it a1) but will return with result of\n   * previous call without waiting for a1. So in this case, we want to execute onReady, when trailing\n   * end of debounce executes.\n   * @type {() => import(\"../AutoCompleteTextarea/types\").TriggerMap | object}\n   */\n  const getTriggers = useCallback(\n    // eslint-disable-next-line sonarjs/cognitive-complexity\n    () =>\n      triggers || {\n        ':': {\n          dataProvider: (q, text, onReady) => {\n            if (q.length === 0 || q.charAt(0).match(/[^a-zA-Z0-9+-]/)) {\n              return [];\n            }\n            const emojis = emojiIndex.search(q) || [];\n            const result = emojis.slice(0, 10);\n\n            if (onReady) onReady(result, q);\n\n            return result;\n          },\n          component: EmoticonItem,\n          output: (entity) => ({\n            key: entity.id,\n            text: `${entity.native}`,\n            caretPosition: 'next',\n          }),\n        },\n        '@': {\n          dataProvider: (query, text, onReady) => {\n            // By default, we return maximum 100 members via queryChannels api call.\n            // Thus it is safe to assume, that if number of members in channel.state is < 100,\n            // then all the members are already available on client side and we don't need to\n            // make any api call to queryMembers endpoint.\n            if (!query || Object.values(members || {}).length < 100) {\n              const users = getMembersAndWatchers();\n\n              const matchingUsers = users.filter((user) => {\n                if (!query) return true;\n                if (\n                  user.name !== undefined &&\n                  user.name.toLowerCase().includes(query.toLowerCase())\n                ) {\n                  return true;\n                }\n                return user.id.toLowerCase().includes(query.toLowerCase());\n              });\n              const data = matchingUsers.slice(0, 10);\n\n              if (onReady) onReady(data, query);\n\n              return data;\n            }\n            return queryMembersdebounced(\n              query,\n              /** @param {any[]} data */\n              (data) => {\n                if (onReady) onReady(data, query);\n              },\n            );\n          },\n          component: UserItem,\n          output: (entity) => ({\n            key: entity.id,\n            text: `@${entity.name || entity.id}`,\n            caretPosition: 'next',\n          }),\n          callback: (item) => onSelectItem && onSelectItem(item),\n        },\n        '/': {\n          dataProvider: (q, text, onReady) => {\n            if (text.indexOf('/') !== 0 || !commands) {\n              return [];\n            }\n            const selectedCommands = commands.filter(\n              (c) => c.name.indexOf(q) !== -1,\n            );\n\n            // sort alphabetically unless the you're matching the first char\n            selectedCommands.sort((a, b) => {\n              let nameA = a.name.toLowerCase();\n              let nameB = b.name.toLowerCase();\n              if (nameA.indexOf(q) === 0) {\n                nameA = `0${nameA}`;\n              }\n              if (nameB.indexOf(q) === 0) {\n                nameB = `0${nameB}`;\n              }\n              if (nameA < nameB) {\n                return -1;\n              }\n              if (nameA > nameB) {\n                return 1;\n              }\n\n              return 0;\n            });\n\n            const result = selectedCommands.slice(0, 10);\n            if (onReady) onReady(result, q);\n\n            return result;\n          },\n          component: CommandItem,\n          output: (entity) => ({\n            key: entity.id,\n            text: `/${entity.name}`,\n            caretPosition: 'next',\n          }),\n        },\n      },\n    [\n      members,\n      getMembersAndWatchers,\n      commands,\n      onSelectItem,\n      queryMembersdebounced,\n      triggers,\n    ],\n  );\n\n  const { innerRef } = props;\n\n  const updateInnerRef = useCallback(\n    (ref) => {\n      if (innerRef) innerRef.current = ref;\n    },\n    [innerRef],\n  );\n\n  return (\n    <AutoCompleteTextarea\n      loadingComponent={LoadingIndicator}\n      trigger={getTriggers()}\n      replaceWord={emojiReplace}\n      minChar={0}\n      maxRows={props.maxRows}\n      innerRef={updateInnerRef}\n      onFocus={props.onFocus}\n      rows={props.rows}\n      className=\"str-chat__textarea__textarea\"\n      containerClassName=\"str-chat__textarea\"\n      dropdownClassName=\"str-chat__emojisearch\"\n      listClassName=\"str-chat__emojisearch__list\"\n      itemClassName=\"str-chat__emojisearch__item\"\n      placeholder={props.placeholder}\n      onChange={props.onChange}\n      handleSubmit={props.handleSubmit}\n      onPaste={props.onPaste}\n      value={props.value}\n      grow={props.grow}\n      disabled={props.disabled}\n      additionalTextareaProps={props.additionalTextareaProps}\n    />\n  );\n};\n\nChatAutoComplete.propTypes = {\n  /** The number of rows you want the textarea to have */\n  rows: PropTypes.number,\n  /** Grow the number of rows of the textarea while you're typing */\n  grow: PropTypes.bool,\n  /** Maximum number of rows */\n  maxRows: PropTypes.number,\n  /** Make the textarea disabled */\n  disabled: PropTypes.bool,\n  /** The value of the textarea */\n  value: PropTypes.string,\n  /** Function to run on pasting within the textarea */\n  onPaste: PropTypes.func,\n  /** Function that runs on submit */\n  handleSubmit: PropTypes.func,\n  /** Function that runs on change */\n  onChange: PropTypes.func,\n  /** Placeholder for the textare */\n  placeholder: PropTypes.string,\n  /** What loading component to use for the auto complete when loading results. */\n  // @ts-ignore\n  LoadingIndicator: PropTypes.elementType,\n  /** Minimum number of Character */\n  minChar: PropTypes.number,\n  /**\n   * Handler for selecting item from suggestions list\n   *\n   * @param item Selected item object.\n   *  */\n  onSelectItem: PropTypes.func,\n  /** Array of [commands](https://getstream.io/chat/docs/#channel_commands) */\n  commands: PropTypes.array,\n  /** Listener for onfocus event on textarea */\n  onFocus: PropTypes.func,\n  /**\n   * Any additional attrubutes that you may want to add for underlying HTML textarea element.\n   */\n  additionalTextareaProps: PropTypes.object,\n};\n\nChatAutoComplete.defaultProps = {\n  rows: 3,\n};\n\nexport default React.memo(ChatAutoComplete);\n","// @ts-check\nimport React from 'react';\n\n/**\n * @type {React.FC<import('types').TooltipProps>}\n */\nconst Tooltip = (props) => (\n  <div className=\"str-chat__tooltip\" {...props}>\n    {props.children}\n  </div>\n);\n\nexport default React.memo(Tooltip);\n","// @ts-check\nimport { useReducer, useEffect, useContext, useRef, useCallback } from 'react';\nimport Immutable from 'seamless-immutable';\nimport { logChatPromiseExecution } from 'stream-chat';\nimport {\n  dataTransferItemsHaveFiles,\n  dataTransferItemsToFiles,\n  // @ts-ignore\n} from 'react-file-utils';\nimport { ChannelContext } from '../../../context/ChannelContext';\nimport { generateRandomId } from '../../../utils';\n\n/**\n * @typedef {import(\"types\").MessageInputState} State\n * @typedef {import(\"types\").MessageInputProps} Props\n * @typedef {import(\"stream-chat\").FileUploadAPIResponse} FileUploadAPIResponse\n * @typedef {import('stream-chat').UserResponse} UserResponse\n */\n\n/**\n * Get attachment type from MIME type\n * @param {string} mime\n * @returns {string}\n */\nconst getAttachmentTypeFromMime = (mime) => {\n  if (mime.includes('video/')) return 'media';\n  if (mime.includes('audio/')) return 'audio';\n  return 'file';\n};\n\n/** @type {{ [id: string]: import('types').FileUpload }} */\nconst emptyFileUploads = {};\n/** @type {{ [id: string]: import('types').ImageUpload }} */\nconst emptyImageUploads = {};\n\n/**\n * Initializes the state. Empty if the message prop is falsy.\n * @param {import(\"stream-chat\").MessageResponse | undefined} message\n * @returns {State}\n */\nfunction initState(message) {\n  if (!message) {\n    return {\n      text: '',\n      imageOrder: [],\n      imageUploads: Immutable(emptyImageUploads),\n      fileOrder: [],\n      fileUploads: Immutable(emptyFileUploads),\n      numberOfUploads: 0,\n      attachments: [],\n      mentioned_users: [],\n      emojiPickerIsOpen: false,\n    };\n  }\n\n  // if message prop is defined, get imageuploads, fileuploads, text, etc. from it\n  const imageUploads =\n    message.attachments\n      ?.filter(({ type }) => type === 'image')\n      .reduce((acc, attachment) => {\n        const id = generateRandomId();\n        return acc.setIn([id], {\n          id,\n          url: attachment.image_url,\n          state: 'finished',\n          file: {\n            name: attachment.fallback,\n          },\n        });\n      }, Immutable(emptyImageUploads)) || Immutable(emptyImageUploads);\n  const imageOrder = Object.keys(imageUploads);\n\n  const fileUploads =\n    message.attachments\n      ?.filter(({ type }) => type === 'file')\n      .reduce((acc, attachment) => {\n        const id = generateRandomId();\n        return acc.setIn([id], {\n          id,\n          url: attachment.asset_url,\n          state: 'finished',\n          file: {\n            name: attachment.title,\n            type: attachment.mime_type,\n            size: attachment.file_size,\n          },\n        });\n      }, Immutable(emptyFileUploads)) || Immutable(emptyFileUploads);\n  const fileOrder = Object.keys(fileUploads);\n\n  const numberOfUploads = fileOrder.length + imageOrder.length;\n\n  const attachments =\n    message.attachments?.filter(\n      ({ type }) => type !== 'file' && type !== 'image',\n    ) || [];\n\n  const mentioned_users = message.mentioned_users || [];\n\n  return {\n    text: message.text || '',\n    imageOrder,\n    imageUploads,\n    fileOrder,\n    fileUploads,\n    numberOfUploads,\n    attachments,\n    mentioned_users,\n    emojiPickerIsOpen: false,\n  };\n}\n/**\n * MessageInput state reducer\n * @param {State} state\n * @param {import(\"./types\").MessageInputReducerAction} action\n * @returns {State}\n */\nfunction messageInputReducer(state, action) {\n  switch (action.type) {\n    case 'setEmojiPickerIsOpen':\n      return { ...state, emojiPickerIsOpen: action.value };\n    case 'setText':\n      return { ...state, text: action.getNewText(state.text) };\n    case 'clear':\n      return {\n        ...state,\n        text: '',\n        mentioned_users: [],\n        imageOrder: [],\n        imageUploads: Immutable(emptyImageUploads),\n        fileOrder: [],\n        fileUploads: Immutable(emptyFileUploads),\n        numberOfUploads: 0,\n      };\n    case 'setImageUpload': {\n      const imageAlreadyExists = state.imageUploads[action.id];\n      const imageOrder = imageAlreadyExists\n        ? state.imageOrder\n        : state.imageOrder.concat(action.id);\n      const { type, ...newUploadFields } = action;\n      return {\n        ...state,\n        imageOrder,\n        imageUploads: state.imageUploads.setIn([action.id], {\n          ...state.imageUploads[action.id],\n          ...newUploadFields,\n        }),\n        numberOfUploads: imageAlreadyExists\n          ? state.numberOfUploads\n          : state.numberOfUploads + 1,\n      };\n    }\n    case 'setFileUpload': {\n      const fileAlreadyExists = state.fileUploads[action.id];\n      const fileOrder = fileAlreadyExists\n        ? state.fileOrder\n        : state.fileOrder.concat(action.id);\n      const { type, ...newUploadFields } = action;\n      return {\n        ...state,\n        fileOrder,\n        fileUploads: state.fileUploads.setIn([action.id], {\n          ...state.fileUploads[action.id],\n          ...newUploadFields,\n        }),\n        numberOfUploads: fileAlreadyExists\n          ? state.numberOfUploads\n          : state.numberOfUploads + 1,\n      };\n    }\n    case 'removeImageUpload':\n      if (!state.imageUploads[action.id]) return state; // cannot remove anything\n      return {\n        ...state,\n        numberOfUploads: state.numberOfUploads - 1,\n        imageOrder: state.imageOrder.filter((_id) => _id !== action.id),\n        imageUploads: state.imageUploads.without(action.id),\n      };\n    case 'removeFileUpload':\n      if (!state.fileUploads[action.id]) return state; // cannot remove anything\n      return {\n        ...state,\n        numberOfUploads: state.numberOfUploads - 1,\n        fileOrder: state.fileOrder.filter((_id) => _id !== action.id),\n        fileUploads: state.fileUploads.without(action.id),\n      };\n    case 'reduceNumberOfUploads': // TODO: figure out if we can just use uploadOrder instead\n      return { ...state, numberOfUploads: state.numberOfUploads - 1 };\n    case 'addMentionedUser':\n      return {\n        ...state,\n        mentioned_users: state.mentioned_users.concat(action.user),\n      };\n    default:\n      return state;\n  }\n}\n/**\n * hook for MessageInput state\n * @param {Props} props\n */\nexport default function useMessageInputState(props) {\n  const {\n    doImageUploadRequest,\n    doFileUploadRequest,\n    focus,\n    message,\n    clearEditingState,\n    overrideSubmitHandler,\n    parent,\n    noFiles,\n    errorHandler,\n    publishTypingEvent,\n  } = props;\n\n  const [state, dispatch] = useReducer(messageInputReducer, message, initState);\n  const textareaRef = useRef(\n    /** @type {HTMLTextAreaElement | undefined} */ (undefined),\n  );\n  const emojiPickerRef = useRef(/** @type {HTMLDivElement | null} */ (null));\n  const channelContext = useContext(ChannelContext);\n  const {\n    text,\n    imageOrder,\n    imageUploads,\n    fileOrder,\n    fileUploads,\n    attachments,\n    numberOfUploads,\n    mentioned_users,\n  } = state;\n  const { channel, editMessage, sendMessage } = channelContext;\n\n  // Focus\n\n  useEffect(() => {\n    if (focus && textareaRef.current) {\n      textareaRef.current.focus();\n    }\n  }, [focus]);\n\n  // Text + cursor position\n  const newCursorPosition = useRef(/** @type {number | null} */ (null));\n  const insertText = useCallback(\n    (textToInsert) => {\n      if (!textareaRef.current) {\n        dispatch({\n          type: 'setText',\n          getNewText: (t) => t + textToInsert,\n        });\n        return;\n      }\n\n      const textareaElement = textareaRef.current;\n      const { selectionStart, selectionEnd } = textareaElement;\n      newCursorPosition.current = selectionStart + textToInsert.length;\n      dispatch({\n        type: 'setText',\n        getNewText: (prevText) =>\n          prevText.slice(0, selectionStart) +\n          textToInsert +\n          prevText.slice(selectionEnd),\n      });\n    },\n    [textareaRef, newCursorPosition],\n  );\n\n  useEffect(() => {\n    const textareaElement = textareaRef.current;\n    if (textareaElement && newCursorPosition.current !== null) {\n      textareaElement.selectionStart = newCursorPosition.current;\n      textareaElement.selectionEnd = newCursorPosition.current;\n      newCursorPosition.current = null;\n    }\n  }, [text, newCursorPosition]);\n\n  const handleChange = useCallback(\n    (event) => {\n      event.preventDefault();\n      if (!event || !event.target) {\n        return;\n      }\n\n      const newText = event.target.value;\n      dispatch({\n        type: 'setText',\n        getNewText: () => newText,\n      });\n      if (publishTypingEvent && newText && channel) {\n        logChatPromiseExecution(channel.keystroke(), 'start typing event');\n      }\n    },\n    [channel, publishTypingEvent],\n  );\n\n  // Emoji\n\n  const closeEmojiPicker = useCallback(\n    (e) => {\n      if (\n        emojiPickerRef.current &&\n        !emojiPickerRef.current.contains(e.target)\n      ) {\n        dispatch({\n          type: 'setEmojiPickerIsOpen',\n          value: false,\n        });\n        document.removeEventListener('click', closeEmojiPicker, false);\n      }\n    },\n    [emojiPickerRef],\n  );\n\n  const openEmojiPicker = useCallback(() => {\n    dispatch({\n      type: 'setEmojiPickerIsOpen',\n      value: true,\n    });\n    document.addEventListener('click', closeEmojiPicker, false);\n  }, [closeEmojiPicker]);\n\n  const onSelectEmoji = useCallback((emoji) => insertText(emoji.native), [\n    insertText,\n  ]);\n\n  // Commands / mentions\n\n  const getCommands = useCallback(\n    () => channel && channel.getConfig().commands,\n    [channel],\n  );\n\n  const getUsers = useCallback(() => {\n    if (!channel) return [];\n    return [\n      ...Object.values(channel.state.members).map(({ user }) => user),\n      ...Object.values(channel.state.watchers),\n    ].filter(\n      (_user, index, self) =>\n        self.findIndex((user) => user?.id === _user?.id) === index, // filter out non-unique ids\n    );\n  }, [channel]);\n\n  const onSelectItem = useCallback(\n    /** @param {UserResponse} item */\n    (item) => {\n      dispatch({ type: 'addMentionedUser', user: item });\n    },\n    [],\n  );\n\n  // Submitting\n\n  const getAttachmentsFromUploads = useCallback(() => {\n    const imageAttachments = imageOrder\n      .map((id) => imageUploads[id])\n      .filter((upload) => upload.state !== 'failed')\n      .filter((\n        { id, url },\n        index,\n        self, // filter out duplicates based on url\n      ) => self.every((upload) => upload.id === id || upload.url !== url))\n      .map((upload) => ({\n        type: 'image',\n        image_url: upload.url,\n        fallback: upload.file.name,\n      }));\n\n    const fileAttachments = fileOrder\n      .map((id) => fileUploads[id])\n      .filter((upload) => upload.state !== 'failed')\n      .map((upload) => ({\n        type: getAttachmentTypeFromMime(upload.file.type),\n        asset_url: upload.url,\n        title: upload.file.name,\n        mime_type: upload.file.type,\n        file_size: upload.file.size,\n      }));\n\n    return [\n      ...attachments, // from state\n      ...imageAttachments,\n      ...fileAttachments,\n    ];\n  }, [imageOrder, imageUploads, fileOrder, fileUploads, attachments]);\n\n  /**\n   * @param {React.FormEvent | React.MouseEvent} event\n   */\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    const trimmedMessage = text.trim();\n    const isEmptyMessage =\n      trimmedMessage === '' ||\n      trimmedMessage === '>' ||\n      trimmedMessage === '``````' ||\n      trimmedMessage === '``' ||\n      trimmedMessage === '**' ||\n      trimmedMessage === '____' ||\n      trimmedMessage === '__' ||\n      trimmedMessage === '****';\n    if (isEmptyMessage && numberOfUploads === 0) {\n      return;\n    }\n    // the channel component handles the actual sending of the message\n    const someAttachmentsUploading =\n      Object.values(imageUploads).some(\n        (upload) => upload.state === 'uploading',\n      ) ||\n      Object.values(fileUploads).some((upload) => upload.state === 'uploading');\n    if (someAttachmentsUploading) {\n      // TODO: show error to user that they should wait until image is uploaded\n      return;\n    }\n\n    const newAttachments = getAttachmentsFromUploads();\n\n    // Instead of checking if a user is still mentioned every time the text changes,\n    // just filter out non-mentioned users before submit, which is cheaper\n    // and allows users to easily undo any accidental deletion\n    const actualMentionedUsers = Array.from(\n      new Set(\n        mentioned_users\n          .filter(\n            ({ name, id }) =>\n              text.includes(`@${id}`) || text.includes(`@${name}`),\n          )\n          .map(({ id }) => id),\n      ),\n    );\n\n    const updatedMessage = {\n      text,\n      attachments: newAttachments,\n      mentioned_users: actualMentionedUsers,\n    };\n\n    if (!!message && editMessage) {\n      // TODO: Remove this line and show an error when submit fails\n      if (clearEditingState) clearEditingState();\n\n      const updateMessagePromise = editMessage({\n        ...updatedMessage,\n        id: message.id,\n      }).then(clearEditingState);\n\n      logChatPromiseExecution(updateMessagePromise, 'update message');\n    } else if (\n      overrideSubmitHandler &&\n      typeof overrideSubmitHandler === 'function' &&\n      channel\n    ) {\n      overrideSubmitHandler(\n        {\n          ...updatedMessage,\n          parent,\n        },\n        channel.cid,\n      );\n      dispatch({ type: 'clear' });\n    } else if (sendMessage) {\n      const sendMessagePromise = sendMessage({\n        ...updatedMessage,\n        parent,\n      });\n      logChatPromiseExecution(sendMessagePromise, 'send message');\n      dispatch({ type: 'clear' });\n    }\n    if (channel && publishTypingEvent)\n      logChatPromiseExecution(channel.stopTyping(), 'stop typing');\n  };\n\n  // Attachments\n\n  // Files\n\n  const uploadFile = useCallback((id) => {\n    dispatch({ type: 'setFileUpload', id, state: 'uploading' });\n  }, []);\n\n  useEffect(() => {\n    (async () => {\n      if (!channel) return;\n      const upload = Object.values(fileUploads).find(\n        (fileUpload) => fileUpload.state === 'uploading' && fileUpload.file,\n      );\n      if (!upload) return;\n\n      const { id, file } = upload;\n      /** @type FileUploadAPIResponse */\n      let response;\n      try {\n        if (doFileUploadRequest) {\n          response = await doFileUploadRequest(file, channel);\n        } else {\n          response = await channel.sendFile(file);\n        }\n      } catch (e) {\n        console.warn(e);\n        let alreadyRemoved = false;\n\n        dispatch({ type: 'reduceNumberOfUploads' });\n        if (!fileUploads[id]) {\n          alreadyRemoved = true;\n        } else {\n          dispatch({ type: 'setFileUpload', id, state: 'failed' });\n        }\n        if (!alreadyRemoved && errorHandler) {\n          // TODO: verify if the paramaters passed to the error handler actually make sense\n          errorHandler(e, 'upload-file', file);\n        }\n        return;\n      }\n      dispatch({\n        type: 'setFileUpload',\n        id,\n        state: 'finished',\n        url: response.file,\n      });\n    })();\n  }, [fileUploads, channel, doFileUploadRequest, errorHandler]);\n\n  const removeFile = useCallback((id) => {\n    // TODO: cancel upload if still uploading\n    dispatch({ type: 'removeFileUpload', id });\n  }, []);\n\n  // Images\n\n  const uploadImage = useCallback(\n    async (id) => {\n      const img = imageUploads[id];\n      if (!img || !channel) return;\n      const { file } = img;\n      if (img.state !== 'uploading') {\n        dispatch({ type: 'setImageUpload', id, state: 'uploading' });\n      }\n      /** @type FileUploadAPIResponse */\n      let response;\n      try {\n        if (doImageUploadRequest) {\n          response = await doImageUploadRequest(file, channel);\n        } else {\n          response = await channel.sendImage(file);\n        }\n      } catch (e) {\n        console.warn(e);\n        let alreadyRemoved = false;\n        dispatch({ type: 'reduceNumberOfUploads' });\n        if (!imageUploads[id]) {\n          alreadyRemoved = true;\n        } else {\n          dispatch({ type: 'setImageUpload', id, state: 'failed' });\n        }\n        if (!alreadyRemoved && errorHandler) {\n          // TODO: verify if the paramaters passed to the error handler actually make sense\n          errorHandler(e, 'upload-image', {\n            id,\n            file,\n          });\n        }\n        return;\n      }\n      if (!imageUploads[id]) return; // removed before done\n      dispatch({\n        type: 'setImageUpload',\n        id,\n        state: 'finished',\n        url: response.file,\n      });\n    },\n    [imageUploads, channel, doImageUploadRequest, errorHandler],\n  );\n\n  useEffect(() => {\n    if (FileReader) {\n      const upload = Object.values(imageUploads).find(\n        (imageUpload) =>\n          imageUpload.state === 'uploading' &&\n          !!imageUpload.file &&\n          !imageUpload.previewUri,\n      );\n      if (upload) {\n        const { id, file } = upload;\n        // TODO: Possibly use URL.createObjectURL instead. However, then we need\n        // to release the previews when not used anymore though.\n        const reader = new FileReader();\n        reader.onload = (event) => {\n          if (typeof event.target?.result !== 'string') return;\n          dispatch({\n            type: 'setImageUpload',\n            id,\n            previewUri: event.target.result,\n          });\n        };\n        reader.readAsDataURL(file);\n        uploadImage(id);\n        return () => {\n          reader.onload = null;\n        };\n      }\n    }\n    return () => {};\n  }, [imageUploads, uploadImage]);\n\n  const removeImage = useCallback((id) => {\n    dispatch({ type: 'removeImageUpload', id });\n    // TODO: cancel upload if still uploading\n  }, []);\n\n  const uploadNewFiles = useCallback(\n    /**\n     * @param {FileList} files\n     */\n    (files) => {\n      Array.from(files).forEach((file) => {\n        const id = generateRandomId();\n        if (file.type.startsWith('image/')) {\n          dispatch({ type: 'setImageUpload', id, file, state: 'uploading' });\n        } else if (file instanceof File && !noFiles) {\n          dispatch({ type: 'setFileUpload', id, file, state: 'uploading' });\n        }\n      });\n    },\n    [noFiles],\n  );\n\n  const onPaste = useCallback(\n    (e) => {\n      (async (event) => {\n        // TODO: Move this handler to package with ImageDropzone\n        const { items } = event.clipboardData;\n        if (!dataTransferItemsHaveFiles(items)) {\n          return;\n        }\n\n        event.preventDefault();\n        // Get a promise for the plain text in case no files are\n        // found. This needs to be done here because chrome cleans\n        // up the DataTransferItems after resolving of a promise.\n        let plainTextPromise;\n        /** @type {DataTransferItem} */\n        const plainTextItem = [...items].find(\n          ({ kind, type }) => kind === 'string' && type === 'text/plain',\n        );\n        if (plainTextItem) {\n          plainTextPromise = new Promise((resolve) => {\n            plainTextItem.getAsString((s) => {\n              resolve(s);\n            });\n          });\n        }\n\n        const fileLikes = await dataTransferItemsToFiles(items);\n        if (fileLikes.length) {\n          uploadNewFiles(fileLikes);\n          return;\n        }\n        // fallback to regular text paste\n        if (plainTextPromise) {\n          const s = await plainTextPromise;\n          insertText(s);\n        }\n      })(e);\n    },\n    [uploadNewFiles, insertText],\n  );\n\n  return {\n    ...state,\n    // refs\n    textareaRef,\n    emojiPickerRef,\n    // handlers\n    uploadNewFiles,\n    removeImage,\n    uploadImage,\n    removeFile,\n    uploadFile,\n    onSelectEmoji,\n    getUsers,\n    getCommands,\n    handleSubmit,\n    handleChange,\n    onPaste,\n    onSelectItem,\n    openEmojiPicker,\n  };\n}\n","// @ts-check\nimport React, { useContext } from 'react';\n// @ts-ignore\nimport { Picker } from 'emoji-mart';\nimport { TranslationContext } from '../../context';\nimport { filterEmoji } from '../../utils';\n\n/** @type {React.FC<import(\"types\").MessageInputEmojiPickerProps>} */\nconst EmojiPicker = ({\n  emojiPickerIsOpen,\n  emojiPickerRef,\n  onSelectEmoji,\n  small,\n}) => {\n  const { t } = useContext(TranslationContext);\n  if (emojiPickerIsOpen) {\n    const className = small\n      ? 'str-chat__small-message-input-emojipicker'\n      : 'str-chat__input--emojipicker';\n\n    return (\n      <div className={className} ref={emojiPickerRef}>\n        <Picker\n          native\n          emoji=\"point_up\"\n          title={t('Pick your emoji')}\n          onSelect={onSelectEmoji}\n          color=\"#006CFF\"\n          showPreview={false}\n          useButton={true}\n          emojisToShowFilter={filterEmoji}\n        />\n      </div>\n    );\n  }\n  return null;\n};\n\nexport default EmojiPicker;\n","// @ts-check\nimport React, { useContext } from 'react';\n// @ts-ignore\nimport { ImagePreviewer, FilePreviewer } from 'react-file-utils';\nimport { ChannelContext } from '../../context';\n\n/** @type {React.FC<import(\"types\").MessageInputUploadsProps>} */\nconst UploadsPreview = ({\n  imageOrder,\n  imageUploads,\n  removeImage,\n  uploadImage,\n  uploadNewFiles,\n  numberOfUploads,\n  fileOrder,\n  fileUploads,\n  removeFile,\n  uploadFile,\n}) => {\n  const channelContext = useContext(ChannelContext);\n  return (\n    <>\n      {imageOrder.length > 0 && (\n        <ImagePreviewer\n          imageUploads={imageOrder.map((id) => imageUploads[id])}\n          handleRemove={removeImage}\n          handleRetry={uploadImage}\n          handleFiles={uploadNewFiles}\n          multiple={channelContext.multipleUploads}\n          disabled={\n            channelContext.maxNumberOfFiles !== undefined &&\n            numberOfUploads >= channelContext.maxNumberOfFiles\n          }\n        />\n      )}\n      {fileOrder.length > 0 && (\n        <FilePreviewer\n          uploads={fileOrder.map((id) => fileUploads[id])}\n          handleRemove={removeFile}\n          handleRetry={uploadFile}\n          handleFiles={uploadNewFiles}\n        />\n      )}\n    </>\n  );\n};\n\nexport default UploadsPreview;\n","// @ts-check\nimport React, { useContext } from 'react';\nimport { TranslationContext } from '../../context';\n\n/** @type {React.FC<import(\"types\").SendButtonProps>} */\nconst SendButton = ({ sendMessage }) => {\n  const { t } = useContext(TranslationContext);\n  return (\n    <button className=\"str-chat__send-button\" onClick={sendMessage}>\n      <svg\n        width=\"18\"\n        height=\"17\"\n        viewBox=\"0 0 18 17\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <title>{t('Send')}</title>\n        <path\n          d=\"M0 17.015l17.333-8.508L0 0v6.617l12.417 1.89L0 10.397z\"\n          fillRule=\"evenodd\"\n          fill=\"#006cff\"\n        />\n      </svg>\n    </button>\n  );\n};\n\nexport default React.memo(SendButton);\n","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\n// @ts-ignore\nimport {\n  ImageDropzone,\n  FileUploadButton,\n  // @ts-ignore\n} from 'react-file-utils';\n\nimport { TranslationContext, ChannelContext } from '../../context';\nimport { ChatAutoComplete } from '../ChatAutoComplete';\nimport { Tooltip } from '../Tooltip';\nimport useMessageInput from './hooks/messageInput';\nimport EmojiPicker from './EmojiPicker';\nimport UploadsPreview from './UploadsPreview';\nimport SendButtonComponent from './SendButton';\n\n/** @type {React.FC<import(\"types\").MessageInputProps>} */\nconst MessageInputLarge = (props) => {\n  const messageInput = useMessageInput(props);\n  const { t } = useContext(TranslationContext);\n  const channelContext = useContext(ChannelContext);\n\n  /**\n   * @typedef {import(\"stream-chat\").Event} ClientEvent\n   * @param {{ [userid: string]: ClientEvent } | {}} typingUsers\n   */\n  const constructTypingString = (typingUsers) => {\n    const otherTypingUsers = Object.values(typingUsers)\n      .filter(({ user }) => channelContext.client?.user.id !== user?.id)\n      .map(({ user }) => user?.name || user?.id);\n    if (otherTypingUsers.length === 0) return '';\n    if (otherTypingUsers.length === 1) {\n      return t('{{ user }} is typing...', { user: otherTypingUsers[0] });\n    }\n    if (otherTypingUsers.length === 2) {\n      // joins all with \"and\" but =no commas\n      // example: \"bob and sam\"\n      return t('{{ firstUser }} and {{ secondUser }} are typing...', {\n        firstUser: otherTypingUsers[0],\n        secondUser: otherTypingUsers[1],\n      });\n    }\n    // joins all with commas, but last one gets \", and\" (oxford comma!)\n    // example: \"bob, joe, and sam\"\n    return t('{{ commaSeparatedUsers }} and {{ lastUser }} are typing...', {\n      commaSeparatedUsers: otherTypingUsers.slice(0, -1).join(', '),\n      lastUser: otherTypingUsers[otherTypingUsers.length - 1],\n    });\n  };\n\n  const { SendButton } = props;\n  return (\n    <div className=\"str-chat__input-large\">\n      <ImageDropzone\n        accept={channelContext.acceptedFiles}\n        multiple={channelContext.multipleUploads}\n        disabled={\n          channelContext.maxNumberOfFiles !== undefined &&\n          messageInput.numberOfUploads >= channelContext.maxNumberOfFiles\n        }\n        handleFiles={messageInput.uploadNewFiles}\n      >\n        <div className=\"str-chat__input\">\n          <EmojiPicker {...messageInput} />\n          <div className=\"str-chat__input--textarea-wrapper\">\n            <UploadsPreview {...messageInput} />\n            <ChatAutoComplete\n              commands={messageInput.getCommands()}\n              innerRef={messageInput.textareaRef}\n              handleSubmit={messageInput.handleSubmit}\n              onChange={messageInput.handleChange}\n              onSelectItem={messageInput.onSelectItem}\n              value={messageInput.text}\n              rows={1}\n              maxRows={props.maxRows}\n              placeholder={t('Type your message')}\n              onPaste={messageInput.onPaste}\n              triggers={props.autocompleteTriggers}\n              grow={props.grow}\n              disabled={props.disabled}\n              additionalTextareaProps={props.additionalTextareaProps}\n            />\n            <div className=\"str-chat__emojiselect-wrapper\">\n              <Tooltip>{t('Open emoji picker')}</Tooltip>\n              <span\n                className=\"str-chat__input-emojiselect\"\n                onClick={messageInput.openEmojiPicker}\n                ref={messageInput.emojiPickerRef}\n              >\n                <svg width=\"14\" height=\"14\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <title>{t('Open emoji picker')}</title>\n                  <path\n                    d=\"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\"\n                    fillRule=\"evenodd\"\n                  />\n                </svg>\n              </span>\n            </div>\n            <div\n              className=\"str-chat__fileupload-wrapper\"\n              data-testid=\"fileinput\"\n            >\n              <Tooltip>{t('Attach files')}</Tooltip>\n              <FileUploadButton\n                multiple={channelContext.multipleUploads}\n                disabled={\n                  channelContext.maxNumberOfFiles !== undefined &&\n                  messageInput.numberOfUploads >=\n                    channelContext.maxNumberOfFiles\n                }\n                accepts={channelContext.acceptedFiles}\n                handleFiles={messageInput.uploadNewFiles}\n              >\n                <span className=\"str-chat__input-fileupload\">\n                  <svg\n                    width=\"14\"\n                    height=\"14\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                  >\n                    <title>{t('Attach files')}</title>\n                    <path\n                      d=\"M7 .5c3.59 0 6.5 2.91 6.5 6.5s-2.91 6.5-6.5 6.5S.5 10.59.5 7 3.41.5 7 .5zm0 12c3.031 0 5.5-2.469 5.5-5.5S10.031 1.5 7 1.5A5.506 5.506 0 0 0 1.5 7c0 3.034 2.469 5.5 5.5 5.5zM7.506 3v3.494H11v1.05H7.506V11h-1.05V7.544H3v-1.05h3.456V3h1.05z\"\n                      fillRule=\"nonzero\"\n                    />\n                  </svg>\n                </span>\n              </FileUploadButton>\n            </div>\n          </div>\n          {SendButton && <SendButton sendMessage={messageInput.handleSubmit} />}\n        </div>\n        <div>\n          <div className=\"str-chat__input-footer\">\n            <span\n              className={`str-chat__input-footer--count ${\n                !channelContext.watcher_count\n                  ? 'str-chat__input-footer--count--hidden'\n                  : ''\n              }`}\n            >\n              {t('{{ watcherCount }} online', {\n                watcherCount: channelContext.watcher_count,\n              })}\n            </span>\n            <span className=\"str-chat__input-footer--typing\">\n              {constructTypingString(channelContext.typing || {})}\n            </span>\n          </div>\n        </div>\n      </ImageDropzone>\n    </div>\n  );\n};\n\nMessageInputLarge.propTypes = {\n  /** Set focus to the text input if this is enabled */\n  focus: PropTypes.bool.isRequired,\n  /** Grow the textarea while you're typing */\n  grow: PropTypes.bool.isRequired,\n  /** Specify the max amount of rows the textarea is able to grow */\n  maxRows: PropTypes.number.isRequired,\n  /** Make the textarea disabled */\n  disabled: PropTypes.bool,\n  /** enable/disable firing the typing event */\n  publishTypingEvent: PropTypes.bool,\n  /**\n   * Any additional attrubutes that you may want to add for underlying HTML textarea element.\n   */\n  additionalTextareaProps: PropTypes.object,\n  /**\n   * Override the default triggers of the ChatAutoComplete component\n   */\n  autocompleteTriggers: PropTypes.object,\n  /**\n   * @param message: the Message object to be sent\n   * @param cid: the channel id\n   */\n  overrideSubmitHandler: PropTypes.func,\n  /** Override image upload request */\n  doImageUploadRequest: PropTypes.func,\n  /** Override file upload request */\n  doFileUploadRequest: PropTypes.func,\n  /**\n   * Custom UI component for send button.\n   *\n   * Defaults to and accepts same props as: [SendButton](https://getstream.github.io/stream-chat-react/#sendbutton)\n   * */\n  // @ts-ignore\n  SendButton: PropTypes.elementType,\n};\n\nMessageInputLarge.defaultProps = {\n  focus: false,\n  disabled: false,\n  publishTypingEvent: true,\n  grow: true,\n  maxRows: 10,\n  Input: MessageInputLarge,\n  SendButton: SendButtonComponent,\n  additionalTextareaProps: {},\n};\n\nexport default MessageInputLarge;\n","import React from 'react';\nimport MessageInputLarge from './MessageInputLarge';\nimport SendButton from './SendButton';\n\nconst MessageInput = (props) => {\n  const { Input } = props;\n  return <Input {...props} />;\n};\n\nMessageInput.defaultProps = {\n  focus: false,\n  disabled: false,\n  publishTypingEvent: true,\n  grow: true,\n  maxRows: 10,\n  Input: MessageInputLarge,\n  SendButton,\n  additionalTextareaProps: {},\n};\n\nexport default React.memo(MessageInput);\n","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\n// @ts-ignore\nimport { ImageDropzone, FileUploadButton } from 'react-file-utils';\n\nimport { TranslationContext, ChannelContext } from '../../context';\nimport { ChatAutoComplete } from '../ChatAutoComplete';\nimport { Tooltip } from '../Tooltip';\nimport useMessageInput from './hooks/messageInput';\nimport UploadsPreview from './UploadsPreview';\nimport EmojiPicker from './EmojiPicker';\nimport SendButtonComponent from './SendButton';\n\n/** @type {React.FC<import(\"types\").MessageInputProps>} */\nconst MessageInputFlat = (props) => {\n  const messageInput = useMessageInput(props);\n  const channelContext = useContext(ChannelContext);\n  const { t } = useContext(TranslationContext);\n  const { SendButton } = props;\n\n  return (\n    <div\n      className={`str-chat__input-flat ${\n        SendButton ? 'str-chat__input-flat--send-button-active' : null\n      }`}\n    >\n      <ImageDropzone\n        accept={channelContext.acceptedFiles}\n        multiple={channelContext.multipleUploads}\n        disabled={\n          channelContext.maxNumberOfFiles !== undefined &&\n          messageInput.numberOfUploads >= channelContext.maxNumberOfFiles\n        }\n        handleFiles={messageInput.uploadNewFiles}\n      >\n        <div className=\"str-chat__input-flat-wrapper\">\n          <EmojiPicker {...messageInput} />\n\n          <div className=\"str-chat__input-flat--textarea-wrapper\">\n            <UploadsPreview {...messageInput} />\n            <ChatAutoComplete\n              commands={messageInput.getCommands()}\n              innerRef={messageInput.textareaRef}\n              handleSubmit={messageInput.handleSubmit}\n              onSelectItem={messageInput.onSelectItem}\n              onChange={messageInput.handleChange}\n              value={messageInput.text}\n              rows={1}\n              maxRows={props.maxRows}\n              placeholder={t('Type your message')}\n              onPaste={messageInput.onPaste}\n              triggers={props.autocompleteTriggers}\n              grow={props.grow}\n              disabled={props.disabled}\n              additionalTextareaProps={props.additionalTextareaProps}\n            />\n\n            <div className=\"str-chat__emojiselect-wrapper\">\n              <Tooltip>{t('Open emoji picker')}</Tooltip>\n              <span\n                className=\"str-chat__input-flat-emojiselect\"\n                onClick={messageInput.openEmojiPicker}\n              >\n                <svg width=\"28\" height=\"28\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <title>{t('Open emoji picker')}</title>\n                  <path\n                    d=\"M22.217 16.1c.483.25.674.849.423 1.334C21.163 20.294 17.771 22 14 22c-3.867 0-7.347-1.765-8.66-4.605a.994.994 0 0 1 .9-1.407c.385 0 .739.225.9.575C8.135 18.715 10.892 20 14 20c3.038 0 5.738-1.267 6.879-3.476a.99.99 0 0 1 1.338-.424zm1.583-3.652c.341.443.235 1.064-.237 1.384a1.082 1.082 0 0 1-.62.168c-.338 0-.659-.132-.858-.389-.212-.276-.476-.611-1.076-.611-.598 0-.864.337-1.08.614-.197.254-.517.386-.854.386-.224 0-.438-.045-.62-.167-.517-.349-.578-.947-.235-1.388.66-.847 1.483-1.445 2.789-1.445 1.305 0 2.136.6 2.79 1.448zm-14 0c.341.443.235 1.064-.237 1.384a1.082 1.082 0 0 1-.62.168c-.339 0-.659-.132-.858-.389C7.873 13.335 7.61 13 7.01 13c-.598 0-.864.337-1.08.614-.197.254-.517.386-.854.386-.224 0-.438-.045-.62-.167-.518-.349-.579-.947-.235-1.388C4.88 11.598 5.703 11 7.01 11c1.305 0 2.136.6 2.79 1.448zM14 0c7.732 0 14 6.268 14 14s-6.268 14-14 14S0 21.732 0 14 6.268 0 14 0zm8.485 22.485A11.922 11.922 0 0 0 26 14c0-3.205-1.248-6.219-3.515-8.485A11.922 11.922 0 0 0 14 2a11.922 11.922 0 0 0-8.485 3.515A11.922 11.922 0 0 0 2 14c0 3.205 1.248 6.219 3.515 8.485A11.922 11.922 0 0 0 14 26c3.205 0 6.219-1.248 8.485-3.515z\"\n                    fillRule=\"evenodd\"\n                  />\n                </svg>\n              </span>\n            </div>\n            <div\n              className=\"str-chat__fileupload-wrapper\"\n              data-testid=\"fileinput\"\n            >\n              <Tooltip>{t('Attach files')}</Tooltip>\n              <FileUploadButton\n                multiple={channelContext.multipleUploads}\n                disabled={\n                  channelContext.maxNumberOfFiles !== undefined &&\n                  messageInput.numberOfUploads >=\n                    channelContext.maxNumberOfFiles\n                }\n                accepts={channelContext.acceptedFiles}\n                handleFiles={messageInput.uploadNewFiles}\n              >\n                <span className=\"str-chat__input-flat-fileupload\">\n                  <svg\n                    width=\"14\"\n                    height=\"14\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                  >\n                    <title>{t('Attach files')}</title>\n                    <path\n                      d=\"M1.667.333h10.666c.737 0 1.334.597 1.334 1.334v10.666c0 .737-.597 1.334-1.334 1.334H1.667a1.333 1.333 0 0 1-1.334-1.334V1.667C.333.93.93.333 1.667.333zm2 1.334a1.667 1.667 0 1 0 0 3.333 1.667 1.667 0 0 0 0-3.333zm-2 9.333v1.333h10.666v-4l-2-2-4 4-2-2L1.667 11z\"\n                      fillRule=\"nonzero\"\n                    />\n                  </svg>\n                </span>\n              </FileUploadButton>\n            </div>\n          </div>\n          {SendButton && <SendButton sendMessage={messageInput.handleSubmit} />}\n        </div>\n      </ImageDropzone>\n    </div>\n  );\n};\n\nMessageInputFlat.propTypes = {\n  /** Set focus to the text input if this is enabled */\n  focus: PropTypes.bool.isRequired,\n  /** Grow the textarea while you're typing */\n  grow: PropTypes.bool.isRequired,\n  /** Specify the max amount of rows the textarea is able to grow */\n  maxRows: PropTypes.number.isRequired,\n  /** Make the textarea disabled */\n  disabled: PropTypes.bool,\n  /** enable/disable firing the typing event */\n  publishTypingEvent: PropTypes.bool,\n  /**\n   * Any additional attrubutes that you may want to add for underlying HTML textarea element.\n   */\n  additionalTextareaProps: PropTypes.object,\n  /**\n   * Override the default triggers of the ChatAutoComplete component\n   */\n  autocompleteTriggers: PropTypes.object,\n  /**\n   * @param message: the Message object to be sent\n   * @param cid: the channel id\n   */\n  overrideSubmitHandler: PropTypes.func,\n  /** Override image upload request */\n  doImageUploadRequest: PropTypes.func,\n  /** Override file upload request */\n  doFileUploadRequest: PropTypes.func,\n  /**\n   * Custom UI component for send button.\n   *\n   * Defaults to and accepts same props as: [SendButton](https://getstream.github.io/stream-chat-react/#sendbutton)\n   * */\n  // @ts-ignore\n  SendButton: PropTypes.elementType,\n};\n\nMessageInputFlat.defaultProps = {\n  focus: false,\n  disabled: false,\n  publishTypingEvent: true,\n  grow: true,\n  maxRows: 10,\n  SendButton: SendButtonComponent,\n  additionalTextareaProps: {},\n};\n\nexport default MessageInputFlat;\n","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\n// @ts-ignore\nimport { ImageDropzone, FileUploadButton } from 'react-file-utils';\nimport { TranslationContext, ChannelContext } from '../../context';\nimport { ChatAutoComplete } from '../ChatAutoComplete';\nimport { Tooltip } from '../Tooltip';\nimport useMessageInput from './hooks/messageInput';\nimport UploadsPreview from './UploadsPreview';\nimport EmojiPicker from './EmojiPicker';\nimport SendButtonComponent from './SendButton';\n\n/** @type {React.FC<import(\"types\").MessageInputProps>} */\nconst MessageInputSmall = (props) => {\n  const messageInput = useMessageInput(props);\n  const channelContext = useContext(ChannelContext);\n  const { t } = useContext(TranslationContext);\n  const { SendButton } = props;\n\n  return (\n    <div className=\"str-chat__small-message-input__wrapper\">\n      <ImageDropzone\n        accept={channelContext.acceptedFiles}\n        multiple={channelContext.multipleUploads}\n        disabled={\n          channelContext.maxNumberOfFiles !== undefined &&\n          messageInput.numberOfUploads >= channelContext.maxNumberOfFiles\n        }\n        handleFiles={messageInput.uploadNewFiles}\n      >\n        <div\n          className={`str-chat__small-message-input ${\n            SendButton\n              ? 'str-chat__small-message-input--send-button-active'\n              : null\n          }`}\n        >\n          <EmojiPicker {...messageInput} small />\n          <div className=\"str-chat__small-message-input--textarea-wrapper\">\n            <UploadsPreview {...messageInput} />\n\n            <ChatAutoComplete\n              commands={messageInput.getCommands()}\n              innerRef={messageInput.textareaRef}\n              handleSubmit={messageInput.handleSubmit}\n              onChange={messageInput.handleChange}\n              value={messageInput.text}\n              rows={1}\n              maxRows={props.maxRows}\n              onSelectItem={messageInput.onSelectItem}\n              placeholder={t('Type your message')}\n              onPaste={messageInput.onPaste}\n              triggers={props.autocompleteTriggers}\n              grow={props.grow}\n              disabled={props.disabled}\n              additionalTextareaProps={props.additionalTextareaProps}\n            />\n\n            <div className=\"str-chat__emojiselect-wrapper\">\n              <Tooltip>{t('Open emoji picker')}</Tooltip>\n              <span\n                className=\"str-chat__small-message-input-emojiselect\"\n                onClick={messageInput.openEmojiPicker}\n              >\n                <svg width=\"14\" height=\"14\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <title>{t('Open emoji picker')}</title>\n                  <path\n                    d=\"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\"\n                    fillRule=\"evenodd\"\n                  />\n                </svg>\n              </span>\n            </div>\n\n            <div\n              className=\"str-chat__fileupload-wrapper\"\n              data-testid=\"fileinput\"\n            >\n              <Tooltip>{t('Attach files')}</Tooltip>\n              <FileUploadButton\n                multiple={channelContext.multipleUploads}\n                disabled={\n                  channelContext.maxNumberOfFiles !== undefined &&\n                  messageInput.numberOfUploads >=\n                    channelContext.maxNumberOfFiles\n                }\n                accepts={channelContext.acceptedFiles}\n                handleFiles={messageInput.uploadNewFiles}\n              >\n                <span className=\"str-chat__small-message-input-fileupload\">\n                  <svg\n                    width=\"14\"\n                    height=\"14\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                  >\n                    <title>{t('Attach files')}</title>\n                    <path\n                      d=\"M7 .5c3.59 0 6.5 2.91 6.5 6.5s-2.91 6.5-6.5 6.5S.5 10.59.5 7 3.41.5 7 .5zm0 12c3.031 0 5.5-2.469 5.5-5.5S10.031 1.5 7 1.5A5.506 5.506 0 0 0 1.5 7c0 3.034 2.469 5.5 5.5 5.5zM7.506 3v3.494H11v1.05H7.506V11h-1.05V7.544H3v-1.05h3.456V3h1.05z\"\n                      fillRule=\"nonzero\"\n                    />\n                  </svg>\n                </span>\n              </FileUploadButton>\n            </div>\n          </div>\n          {SendButton && <SendButton sendMessage={messageInput.handleSubmit} />}\n        </div>\n      </ImageDropzone>\n    </div>\n  );\n};\n\nMessageInputSmall.propTypes = {\n  /** Set focus to the text input if this is enabled */\n  focus: PropTypes.bool.isRequired,\n  /** Grow the textarea while you're typing */\n  grow: PropTypes.bool.isRequired,\n  /** Specify the max amount of rows the textarea is able to grow */\n  maxRows: PropTypes.number.isRequired,\n  /** Make the textarea disabled */\n  disabled: PropTypes.bool,\n  /** enable/disable firing the typing event */\n  publishTypingEvent: PropTypes.bool,\n  /**\n   * Any additional attrubutes that you may want to add for underlying HTML textarea element.\n   */\n  additionalTextareaProps: PropTypes.object,\n  /**\n   * Override the default triggers of the ChatAutoComplete component\n   */\n  autocompleteTriggers: PropTypes.object,\n  /**\n   * @param message: the Message object to be sent\n   * @param cid: the channel id\n   */\n  overrideSubmitHandler: PropTypes.func,\n  /** Override image upload request */\n  doImageUploadRequest: PropTypes.func,\n  /** Override file upload request */\n  doFileUploadRequest: PropTypes.func,\n  /**\n   * Custom UI component for send button.\n   *\n   * Defaults to and accepts same props as: [SendButton](https://getstream.github.io/stream-chat-react/#sendbutton)\n   * */\n  // @ts-ignore\n  SendButton: PropTypes.elementType,\n};\n\nMessageInputSmall.defaultProps = {\n  focus: false,\n  disabled: false,\n  publishTypingEvent: true,\n  grow: true,\n  maxRows: 10,\n  SendButton: SendButtonComponent,\n  additionalTextareaProps: {},\n};\n\nexport default MessageInputSmall;\n","// @ts-check\nimport React, { useEffect, useContext } from 'react';\nimport PropTypes from 'prop-types';\n// @ts-ignore\nimport { ImageDropzone, FileUploadButton } from 'react-file-utils';\nimport { Tooltip } from '../Tooltip';\n\nimport { ChannelContext, TranslationContext } from '../../context';\nimport { ChatAutoComplete } from '../ChatAutoComplete';\nimport useMessageInput from './hooks/messageInput';\nimport UploadsPreview from './UploadsPreview';\nimport EmojiPicker from './EmojiPicker';\nimport SendButtonComponent from './SendButton';\nimport { KEY_CODES } from '../AutoCompleteTextarea';\n\n/** @type {React.FC<import(\"types\").MessageInputProps>} */\nconst EditMessageForm = (props) => {\n  const messageInput = useMessageInput(props);\n  const channelContext = useContext(ChannelContext);\n  const { t } = useContext(TranslationContext);\n\n  const { clearEditingState } = props;\n\n  useEffect(() => {\n    /** @type {(event: KeyboardEvent) => void} Typescript syntax */\n    const onKeyDown = (event) => {\n      console.log('event.keyCode :>> ', event.keyCode);\n      if (event.keyCode === KEY_CODES.ESC && clearEditingState)\n        clearEditingState();\n    };\n\n    document.addEventListener('keydown', onKeyDown);\n    return () => document.removeEventListener('keydown', onKeyDown);\n  }, [clearEditingState]);\n\n  return (\n    <div className=\"str-chat__edit-message-form\">\n      <ImageDropzone\n        accept={channelContext.acceptedFiles}\n        multiple={channelContext.multipleUploads}\n        disabled={\n          channelContext.maxNumberOfFiles !== undefined &&\n          messageInput.numberOfUploads >= channelContext.maxNumberOfFiles\n        }\n        handleFiles={messageInput.uploadNewFiles}\n      >\n        <form onSubmit={messageInput.handleSubmit}>\n          <UploadsPreview {...messageInput} />\n          <EmojiPicker {...messageInput} small />\n          <ChatAutoComplete\n            commands={messageInput.getCommands()}\n            innerRef={messageInput.textareaRef}\n            handleSubmit={messageInput.handleSubmit}\n            onChange={messageInput.handleChange}\n            onSelectItem={messageInput.onSelectItem}\n            placeholder={t('Type your message')}\n            value={messageInput.text}\n            rows={1}\n            maxRows={props.maxRows}\n            onPaste={messageInput.onPaste}\n            grow={props.grow}\n            additionalTextareaProps={props.additionalTextareaProps}\n          />\n          <div className=\"str-chat__message-team-form-footer\">\n            <div className=\"str-chat__edit-message-form-options\">\n              <span\n                className=\"str-chat__input-emojiselect\"\n                onClick={messageInput.openEmojiPicker}\n              >\n                <svg width=\"14\" height=\"14\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <title>{t('Open emoji picker')}</title>\n                  <path\n                    d=\"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\"\n                    fillRule=\"evenodd\"\n                  />\n                </svg>\n              </span>\n              <div\n                className=\"str-chat__fileupload-wrapper\"\n                data-testid=\"fileinput\"\n              >\n                <Tooltip>{t('Attach files')}</Tooltip>\n                <FileUploadButton\n                  multiple={channelContext.multipleUploads}\n                  disabled={\n                    channelContext.maxNumberOfFiles !== undefined &&\n                    messageInput.numberOfUploads >=\n                      channelContext.maxNumberOfFiles\n                  }\n                  accepts={channelContext.acceptedFiles}\n                  handleFiles={messageInput.uploadNewFiles}\n                >\n                  <span className=\"str-chat__input-fileupload\">\n                    <svg\n                      width=\"14\"\n                      height=\"14\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <title>{t('Attach files')}</title>\n                      <path\n                        d=\"M7 .5c3.59 0 6.5 2.91 6.5 6.5s-2.91 6.5-6.5 6.5S.5 10.59.5 7 3.41.5 7 .5zm0 12c3.031 0 5.5-2.469 5.5-5.5S10.031 1.5 7 1.5A5.506 5.506 0 0 0 1.5 7c0 3.034 2.469 5.5 5.5 5.5zM7.506 3v3.494H11v1.05H7.506V11h-1.05V7.544H3v-1.05h3.456V3h1.05z\"\n                        fillRule=\"nonzero\"\n                      />\n                    </svg>\n                  </span>\n                </FileUploadButton>\n              </div>\n            </div>\n            <div>\n              <button onClick={props.clearEditingState}>{t('Cancel')}</button>\n              <button type=\"submit\">{t('Send')}</button>\n            </div>\n          </div>\n        </form>\n      </ImageDropzone>\n    </div>\n  );\n};\n\nEditMessageForm.propTypes = {\n  /** Set focus to the text input if this is enabled */\n  focus: PropTypes.bool.isRequired,\n  /** Grow the textarea while you're typing */\n  grow: PropTypes.bool.isRequired,\n  /** Specify the max amount of rows the textarea is able to grow */\n  maxRows: PropTypes.number.isRequired,\n  /** Make the textarea disabled */\n  disabled: PropTypes.bool,\n  /** enable/disable firing the typing event */\n  publishTypingEvent: PropTypes.bool,\n  /**\n   * Any additional attrubutes that you may want to add for underlying HTML textarea element.\n   */\n  additionalTextareaProps: PropTypes.object,\n  /**\n   * @param message: the Message object to be sent\n   * @param cid: the channel id\n   */\n  overrideSubmitHandler: PropTypes.func,\n  /** Override image upload request */\n  doImageUploadRequest: PropTypes.func,\n  /** Override file upload request */\n  doFileUploadRequest: PropTypes.func,\n  /**\n   * Custom UI component for send button.\n   *\n   * Defaults to and accepts same props as: [SendButton](https://getstream.github.io/stream-chat-react/#sendbutton)\n   * */\n  // @ts-ignore\n  SendButton: PropTypes.elementType,\n  /**\n   * Clears edit state for current message (passed down from message component)\n   */\n  clearEditingState: PropTypes.func,\n};\n\nEditMessageForm.defaultProps = {\n  focus: false,\n  disabled: false,\n  publishTypingEvent: true,\n  grow: true,\n  maxRows: 10,\n  SendButton: SendButtonComponent,\n  additionalTextareaProps: {},\n};\n\nexport default EditMessageForm;\n","// @ts-check\nimport React, {\n  useState,\n  useCallback,\n  useRef,\n  useImperativeHandle,\n  useEffect,\n} from 'react';\nimport PropTypes from 'prop-types';\nimport { NimbleEmoji } from 'emoji-mart';\nimport { Avatar } from '../Avatar';\n\nimport { defaultMinimalEmojis, emojiSetDef, emojiData } from '../../utils';\n\n/** @type {React.ForwardRefRenderFunction<HTMLDivElement | null, import(\"types\").ReactionSelectorProps>} */\nconst ReactionSelectorWithRef = (\n  {\n    latest_reactions,\n    reaction_counts,\n    reactionOptions = defaultMinimalEmojis,\n    reverse = false,\n    handleReaction,\n    detailedView = true,\n  },\n  ref,\n) => {\n  const [tooltipReactionType, setTooltipReactionType] = useState(null);\n  const [tooltipPositions, setTooltipPositions] = useState(\n    /** @type {{ tooltip: number, arrow: number } | null} */ (null),\n  );\n  const containerRef = useRef(/** @type {HTMLDivElement | null} */ (null));\n  const tooltipRef = useRef(/** @type {HTMLDivElement | null} */ (null));\n  const targetRef = useRef(/** @type {HTMLDivElement | null} */ (null));\n\n  // @ts-ignore because it's okay for our ref to be null in the parent component.\n  useImperativeHandle(ref, () => containerRef.current);\n\n  const showTooltip = useCallback((e, reactionType) => {\n    targetRef.current = e.target;\n    setTooltipReactionType(reactionType);\n  }, []);\n\n  const hideTooltip = useCallback(() => {\n    setTooltipReactionType(null);\n    setTooltipPositions(null);\n  }, []);\n\n  useEffect(() => {\n    if (tooltipReactionType) {\n      const tooltip = tooltipRef.current?.getBoundingClientRect();\n      const target = targetRef.current?.getBoundingClientRect();\n      const container = containerRef.current?.getBoundingClientRect();\n\n      if (!tooltip || !target || !container) return;\n\n      const tooltipPosition =\n        tooltip.width === container.width || tooltip.x < container.x\n          ? 0\n          : target.left + target.width / 2 - container.left - tooltip.width / 2;\n      const arrowPosition =\n        target.x - tooltip.x + target.width / 2 - tooltipPosition;\n      setTooltipPositions({\n        tooltip: tooltipPosition,\n        arrow: arrowPosition,\n      });\n    }\n  }, [tooltipReactionType, containerRef]);\n\n  /**\n   * @param {string | null} type\n   * @returns {string[] | undefined}\n   * */\n  const getUsersPerReactionType = (type) =>\n    latest_reactions\n      ?.map((reaction) => {\n        if (reaction.type === type) {\n          return reaction.user?.name || reaction.user?.id;\n        }\n        return null;\n      })\n      .filter(Boolean);\n\n  /**\n   * @param {string | null} type\n   * @returns {import(\"stream-chat\").User | undefined}\n   * */\n  const getLatestUserForReactionType = (type) =>\n    latest_reactions?.find(\n      (reaction) => reaction.type === type && !!reaction.user,\n    )?.user;\n\n  return (\n    <div\n      data-testid=\"reaction-selector\"\n      className={`str-chat__reaction-selector ${\n        reverse ? 'str-chat__reaction-selector--reverse' : ''\n      }`}\n      ref={containerRef}\n    >\n      {!!tooltipReactionType && detailedView && (\n        <div\n          className=\"str-chat__reaction-selector-tooltip\"\n          ref={tooltipRef}\n          style={{\n            left: tooltipPositions?.tooltip,\n            visibility: tooltipPositions ? 'visible' : 'hidden',\n          }}\n        >\n          <div className=\"arrow\" style={{ left: tooltipPositions?.arrow }} />\n          {getUsersPerReactionType(tooltipReactionType)?.map(\n            (user, i, users) => (\n              <span className=\"latest-user-username\" key={`key-${i}-${user}`}>\n                {`${user}${i < users.length - 1 ? ', ' : ''}`}\n              </span>\n            ),\n          )}\n        </div>\n      )}\n      <ul className=\"str-chat__message-reactions-list\">\n        {reactionOptions.map((reactionOption) => {\n          const latestUser = getLatestUserForReactionType(reactionOption.id);\n\n          const count = reaction_counts && reaction_counts[reactionOption.id];\n          return (\n            <li\n              key={`item-${reactionOption.id}`}\n              className=\"str-chat__message-reactions-list-item\"\n              data-text={reactionOption.id}\n              onClick={() =>\n                handleReaction && handleReaction(reactionOption.id)\n              }\n            >\n              {!!count && detailedView && (\n                <React.Fragment>\n                  <div\n                    className=\"latest-user\"\n                    onMouseEnter={(e) => showTooltip(e, reactionOption.id)}\n                    onMouseLeave={hideTooltip}\n                  >\n                    {latestUser ? (\n                      <Avatar\n                        image={latestUser.image}\n                        size={20}\n                        name={latestUser.name || null}\n                      />\n                    ) : (\n                      <div className=\"latest-user-not-found\" />\n                    )}\n                  </div>\n                </React.Fragment>\n              )}\n              <NimbleEmoji\n                // @ts-ignore because emoji-mart types don't support specifying\n                // spriteUrl instead of imageUrl, while the implementation does\n                emoji={reactionOption}\n                {...emojiSetDef}\n                data={emojiData}\n              />\n\n              {Boolean(count) && detailedView && (\n                <span className=\"str-chat__message-reactions-list-item__count\">\n                  {count || ''}\n                </span>\n              )}\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n};\n\nconst ReactionSelector = React.forwardRef(ReactionSelectorWithRef);\n\nReactionSelector.propTypes = {\n  /**\n   * Array of latest reactions.\n   * Reaction object has following structure:\n   *\n   * ```json\n   * {\n   *  \"type\": \"love\",\n   *  \"user_id\": \"demo_user_id\",\n   *  \"user\": {\n   *    ...userObject\n   *  },\n   *  \"created_at\": \"datetime\";\n   * }\n   * ```\n   * */\n  latest_reactions: PropTypes.array,\n  /** Object/map of reaction id/type (e.g. 'like' | 'love' | 'haha' | 'wow' | 'sad' | 'angry') vs count */\n  reaction_counts: PropTypes.objectOf(PropTypes.number.isRequired),\n  /** Provide a list of reaction options [{id: 'angry', emoji: 'angry'}] */\n  reactionOptions: PropTypes.array,\n  reverse: PropTypes.bool,\n  /**\n   * Handler to set/unset reaction on message.\n   *\n   * @param type e.g. 'like' | 'love' | 'haha' | 'wow' | 'sad' | 'angry'\n   * */\n  handleReaction: PropTypes.func.isRequired,\n  /** Enable the avatar display */\n  detailedView: PropTypes.bool,\n};\n\nexport default React.memo(ReactionSelector);\n","// @ts-check\nimport React from 'react';\nimport PropTypes from 'prop-types';\n// @ts-ignore\nimport { NimbleEmoji } from 'emoji-mart';\n\nimport { defaultMinimalEmojis, emojiSetDef, emojiData } from '../../utils';\n\n/** @type {React.FC<import(\"types\").ReactionsListProps>} */\nconst ReactionsList = ({\n  reactions,\n  reaction_counts,\n  reactionOptions = defaultMinimalEmojis,\n  reverse = false,\n  onClick,\n}) => {\n  const getTotalReactionCount = () =>\n    Object.values(reaction_counts || {}).reduce(\n      (total, count) => total + count,\n      0,\n    );\n\n  /** @param {string} type */\n  const getOptionForType = (type) =>\n    reactionOptions.find((option) => option.id === type);\n\n  const getReactionTypes = () => {\n    if (!reactions) return [];\n    const allTypes = new Set();\n    reactions.forEach(({ type }) => {\n      allTypes.add(type);\n    });\n    return Array.from(allTypes);\n  };\n\n  return (\n    <div\n      data-testid=\"reaction-list\"\n      className={`str-chat__reaction-list ${\n        reverse ? 'str-chat__reaction-list--reverse' : ''\n      }`}\n      onClick={onClick}\n    >\n      <ul>\n        {getReactionTypes().map((reactionType) => {\n          const emojiDefinition = getOptionForType(reactionType);\n          return emojiDefinition ? (\n            <li key={emojiDefinition.id}>\n              <NimbleEmoji\n                // emoji-mart type defs don't support spriteSheet use case\n                // (but implementation does)\n                // @ts-ignore\n                emoji={emojiDefinition}\n                {...emojiSetDef}\n                size={16}\n                data={emojiData}\n              />{' '}\n              &nbsp;\n            </li>\n          ) : null;\n        })}\n        <li>\n          <span className=\"str-chat__reaction-list--counter\">\n            {getTotalReactionCount()}\n          </span>\n        </li>\n      </ul>\n    </div>\n  );\n};\n\nReactionsList.propTypes = {\n  reactions: PropTypes.array,\n  /** Object/map of reaction id/type (e.g. 'like' | 'love' | 'haha' | 'wow' | 'sad' | 'angry') vs count */\n  reaction_counts: PropTypes.objectOf(PropTypes.number.isRequired),\n  /** Provide a list of reaction options [{id: 'angry', emoji: 'angry'}] */\n  reactionOptions: PropTypes.array,\n  reverse: PropTypes.bool,\n  onClick: PropTypes.func,\n};\n\nexport default React.memo(ReactionsList);\n","// @ts-check\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\n// @ts-ignore\nimport { NimbleEmoji } from 'emoji-mart';\nimport { defaultMinimalEmojis, emojiSetDef, emojiData } from '../../utils';\n\n/** @type {React.FC<import(\"types\").SimpleReactionsListProps>} */\nconst SimpleReactionsList = ({\n  reactions,\n  reaction_counts,\n  reactionOptions = defaultMinimalEmojis,\n  handleReaction,\n}) => {\n  const [tooltipReactionType, setTooltipReactionType] = useState(null);\n\n  if (!reactions || reactions.length === 0) {\n    return null;\n  }\n\n  /** @param {string | null} type */\n  const getUsersPerReactionType = (type) =>\n    reactions\n      ?.map((reaction) => {\n        if (reaction.type === type) {\n          return reaction.user?.name || reaction.user?.id;\n        }\n        return null;\n      })\n      .filter(Boolean);\n\n  const getTotalReactionCount = () =>\n    Object.values(reaction_counts || {}).reduce(\n      (total, count) => total + count,\n      0,\n    );\n\n  const getReactionTypes = () => {\n    if (!reactions) return [];\n    const allTypes = new Set();\n    reactions.forEach(({ type }) => {\n      allTypes.add(type);\n    });\n    return Array.from(allTypes);\n  };\n\n  /** @param {string} type */\n  const getOptionForType = (type) =>\n    reactionOptions.find((option) => option.id === type);\n\n  return (\n    <ul\n      data-testid=\"simple-reaction-list\"\n      className=\"str-chat__simple-reactions-list\"\n      onMouseLeave={() => setTooltipReactionType(null)}\n    >\n      {getReactionTypes().map((reactionType, i) => {\n        const emojiDefinition = getOptionForType(reactionType);\n        return emojiDefinition ? (\n          <li\n            className=\"str-chat__simple-reactions-list-item\"\n            key={`${emojiDefinition?.id}-${i}`}\n            onClick={() => handleReaction && handleReaction(reactionType)}\n          >\n            <span onMouseEnter={() => setTooltipReactionType(reactionType)}>\n              <NimbleEmoji\n                // emoji-mart type defs don't support spriteSheet use case\n                // (but implementation does)\n                // @ts-ignore\n                emoji={emojiDefinition}\n                {...emojiSetDef}\n                size={13}\n                data={emojiData}\n              />\n              &nbsp;\n            </span>\n\n            {tooltipReactionType === getOptionForType(reactionType)?.id && (\n              <div className=\"str-chat__simple-reactions-list-tooltip\">\n                <div className=\"arrow\" />\n                {getUsersPerReactionType(tooltipReactionType)?.join(', ')}\n              </div>\n            )}\n          </li>\n        ) : null;\n      })}\n      {reactions?.length !== 0 && (\n        <li className=\"str-chat__simple-reactions-list-item--last-number\">\n          {getTotalReactionCount()}\n        </li>\n      )}\n    </ul>\n  );\n};\n\nSimpleReactionsList.propTypes = {\n  reactions: PropTypes.array,\n  /** Object/map of reaction id/type (e.g. 'like' | 'love' | 'haha' | 'wow' | 'sad' | 'angry') vs count */\n  reaction_counts: PropTypes.objectOf(PropTypes.number.isRequired),\n  /** Provide a list of reaction options [{id: 'angry', emoji: 'angry'}] */\n  reactionOptions: PropTypes.array,\n  /**\n   * Handler to set/unset reaction on message.\n   *\n   * @param type e.g. 'like' | 'love' | 'haha' | 'wow' | 'sad' | 'angry'\n   * */\n  handleReaction: PropTypes.func,\n};\n\nexport default React.memo(SimpleReactionsList);\n","// @ts-check\nimport { useContext } from 'react';\nimport { ChannelContext } from '../../../context';\n\nexport const handleActionWarning = `Action handler was called, but it is missing one of its required arguments.\n      Make sure the ChannelContext was properly set and that this hook was initialized with a valid message.`;\n/**\n * @type {(message: import('stream-chat').MessageResponse | undefined) => (name: string, value: string, event: React.MouseEvent<HTMLElement>) => Promise<void>}\n */\nexport const useActionHandler = (message) => {\n  const { channel, updateMessage, removeMessage } = useContext(ChannelContext);\n  return async (name, value, event) => {\n    event.preventDefault();\n    if (!message || !updateMessage || !removeMessage || !channel) {\n      console.warn(handleActionWarning);\n      return;\n    }\n    const messageID = message.id;\n    const formData = {\n      [name]: value,\n    };\n\n    const data = await channel.sendAction(messageID, formData);\n\n    if (data && data.message) {\n      updateMessage(data.message);\n    } else {\n      removeMessage(message);\n    }\n  };\n};\n","// @ts-check\nimport { useContext } from 'react';\nimport { ChannelContext } from '../../../context';\n\n/**\n * @type {(message: import('stream-chat').MessageResponse | undefined) =>  (event: React.MouseEvent<HTMLElement>) => Promise<void>}\n */\nexport const useDeleteHandler = (message) => {\n  const { updateMessage, client } = useContext(ChannelContext);\n  return async (event) => {\n    event.preventDefault();\n    if (!message || !client || !updateMessage) {\n      return;\n    }\n    const data = await client.deleteMessage(message.id);\n    updateMessage(data.message);\n  };\n};\n","// @ts-check\nimport { useState } from 'react';\n\n/**\n * @type {(\n *   customInitialState?: boolean,\n *   customSetEditing?: (event: React.MouseEvent<HTMLElement>) => void,\n *   customClearEditing?: (event: React.MouseEvent<HTMLElement>) => void\n * ) => {\n *   editing: boolean,\n *   setEdit: (event: React.MouseEvent<HTMLElement>) => void,\n *   clearEdit: (event: React.MouseEvent<HTMLElement>) => void\n * }}\n */\nexport const useEditHandler = (\n  customInitialState = false,\n  customSetEditing,\n  customClearEditingHandler,\n) => {\n  const [editing, setEditing] = useState(customInitialState);\n\n  const setEdit =\n    customSetEditing ||\n    ((event) => {\n      event?.preventDefault();\n      setEditing(true);\n    });\n  const clearEdit =\n    customClearEditingHandler ||\n    ((event) => {\n      event?.preventDefault();\n      setEditing(false);\n    });\n  return { editing, setEdit, clearEdit };\n};\n","// @ts-check\nimport deepequal from 'react-fast-compare';\nimport PropTypes from 'prop-types';\n\n/**\n * Following function validates a function which returns notification message.\n * It validates if the first parameter is function and also if return value of function is string or no.\n *\n * @type {(func: Function, args: any) => null | string}\n */\nexport const validateAndGetMessage = (func, args) => {\n  if (!func || typeof func !== 'function') return null;\n\n  const returnValue = func(...args);\n\n  if (typeof returnValue !== 'string') return null;\n\n  return returnValue;\n};\n\n/**\n * Tell if the owner of the current message is muted\n *\n * @type {(message?: import('stream-chat').MessageResponse, mutes?: import('stream-chat').Mute[]) => boolean}\n */\nexport const isUserMuted = (message, mutes) => {\n  if (!mutes || !message) {\n    return false;\n  }\n\n  const userMuted = mutes.filter(\n    /** @type {(el: import('stream-chat').Mute) => boolean} Typescript syntax */\n    (el) => el.target.id === message.user?.id,\n  );\n  return !!userMuted.length;\n};\n\nexport const MESSAGE_ACTIONS = {\n  edit: 'edit',\n  delete: 'delete',\n  flag: 'flag',\n  mute: 'mute',\n};\n\n/**\n * @typedef {{\n *   canEdit: boolean;\n *   canDelete: boolean;\n *   canMute: boolean;\n *   canFlag: boolean;\n * }} Capabilities\n * @type {(actions: string[] | boolean, capabilities: Capabilities) => string[]} Typescript syntax\n */\nexport const getMessageActions = (\n  actions,\n  { canDelete, canFlag, canEdit, canMute },\n) => {\n  const messageActionsAfterPermission = [];\n  let messageActions = [];\n\n  if (actions && typeof actions === 'boolean') {\n    // If value of actions is true, then populate all the possible values\n    messageActions = Object.keys(MESSAGE_ACTIONS);\n  } else if (actions && actions.length > 0) {\n    messageActions = [...actions];\n  } else {\n    return [];\n  }\n\n  if (canEdit && messageActions.indexOf(MESSAGE_ACTIONS.edit) > -1) {\n    messageActionsAfterPermission.push(MESSAGE_ACTIONS.edit);\n  }\n\n  if (canDelete && messageActions.indexOf(MESSAGE_ACTIONS.delete) > -1) {\n    messageActionsAfterPermission.push(MESSAGE_ACTIONS.delete);\n  }\n\n  if (canFlag && messageActions.indexOf(MESSAGE_ACTIONS.flag) > -1) {\n    messageActionsAfterPermission.push(MESSAGE_ACTIONS.flag);\n  }\n\n  if (canMute && messageActions.indexOf(MESSAGE_ACTIONS.mute) > -1) {\n    messageActionsAfterPermission.push(MESSAGE_ACTIONS.mute);\n  }\n\n  return messageActionsAfterPermission;\n};\n\n/**\n * @typedef {Pick<import('types').MessageComponentProps, 'message' | 'readBy' | 'groupStyles' | 'lastReceivedId' | 'messageListRect'>} MessageEqualProps\n * @type {(props: MessageEqualProps, nextProps: MessageEqualProps) => boolean} Typescript syntax\n */\nexport const areMessagePropsEqual = (props, nextProps) => {\n  return (\n    // Message content is equal\n    nextProps.message === props.message &&\n    // Message was read by someone\n    deepequal(nextProps.readBy, props.readBy) &&\n    // Group style changes (it often happens that the last 3 messages of a channel have different group styles)\n    deepequal(nextProps.groupStyles, props.groupStyles) &&\n    // @ts-ignore\n    deepequal(nextProps.mutes, props.mutes) &&\n    // Last message received in the channel changes\n    deepequal(nextProps.lastReceivedId, props.lastReceivedId) &&\n    // User toggles edit state\n    // @ts-ignore // TODO: fix\n    nextProps.editing === props.editing &&\n    // Message wrapper layout changes\n    nextProps.messageListRect === props.messageListRect\n  );\n};\n\n/**\n * @type {(nextProps: import('types').MessageComponentProps, props: import('types').MessageComponentProps ) => boolean} Typescript syntax\n */\nexport const shouldMessageComponentUpdate = (props, nextProps) => {\n  // Component should only update if:\n  return !areMessagePropsEqual(props, nextProps);\n};\n\n/** @type {(message: import('stream-chat').MessageResponse | undefined) => boolean} */\nexport const messageHasReactions = (message) => {\n  return !!message?.latest_reactions && !!message.latest_reactions.length;\n};\n\n/** @type {(message: import('stream-chat').MessageResponse | undefined) => boolean} */\nexport const messageHasAttachments = (message) => {\n  return !!message?.attachments && !!message.attachments.length;\n};\n\n/**\n * @type {(message: import('stream-chat').MessageResponse | undefined) => import('stream-chat').Attachment[] }\n */\nexport const getImages = (message) => {\n  if (!message?.attachments) {\n    return [];\n  }\n  return message.attachments.filter(\n    /** @type {(item: import('stream-chat').Attachment) => boolean} Typescript syntax */\n    (item) => item.type === 'image',\n  );\n};\n\n/**\n * @type {(message: import('stream-chat').MessageResponse | undefined) => import('stream-chat').Attachment[] }\n */\nexport const getNonImageAttachments = (message) => {\n  if (!message?.attachments) {\n    return [];\n  }\n  return message.attachments.filter(\n    /** @type {(item: import('stream-chat').Attachment) => boolean} Typescript syntax */\n    (item) => item.type !== 'image',\n  );\n};\n\nexport const MessagePropTypes = PropTypes.shape({\n  id: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  text: PropTypes.string.isRequired,\n  html: PropTypes.string.isRequired,\n  created_at: PropTypes.instanceOf(Date).isRequired,\n  updated_at: PropTypes.instanceOf(Date).isRequired,\n}).isRequired;\n","// @ts-check\nimport { useContext } from 'react';\nimport { ChannelContext, TranslationContext } from '../../../context';\nimport { validateAndGetMessage } from '../utils';\n\nexport const missingUseFlagHandlerParameterWarning =\n  'useFlagHandler was called but it is missing one or more necessary parameters.';\n\n/**\n * @typedef {{\n *   notify?: import('types').MessageComponentProps['addNotification'],\n *   getSuccessNotification?: import('types').MessageComponentProps['getMuteUserSuccessNotification'],\n *   getErrorNotification?: import('types').MessageComponentProps['getMuteUserErrorNotification'],\n * }} NotificationArg\n * @type {(message: import('stream-chat').MessageResponse | undefined, notification: NotificationArg) => (event: React.MouseEvent<HTMLElement>) => Promise<void>}\n */\nexport const useFlagHandler = (message, notifications = {}) => {\n  const { client } = useContext(ChannelContext);\n  const { t } = useContext(TranslationContext);\n\n  /** @type {(event: React.MouseEvent<HTMLElement>) => Promise<void>} Typescript syntax */\n  return async (event) => {\n    event.preventDefault();\n    const {\n      notify,\n      getSuccessNotification,\n      getErrorNotification,\n    } = notifications;\n\n    if (!client || !t || !notify || !message) {\n      console.warn(missingUseFlagHandlerParameterWarning);\n      return;\n    }\n\n    try {\n      await client.flagMessage(message.id);\n      const successMessage =\n        getSuccessNotification &&\n        validateAndGetMessage(getSuccessNotification, [message]);\n      notify(\n        successMessage || t('Message has been successfully flagged'),\n        'success',\n      );\n    } catch (e) {\n      const errorMessage =\n        getErrorNotification &&\n        validateAndGetMessage(getErrorNotification, [message]);\n      notify(\n        errorMessage ||\n          t(\n            'Error adding flag: Either the flag already exist or there is issue with network connection ...',\n          ),\n        'error',\n      );\n    }\n  };\n};\n","// @ts-check\nimport { useContext } from 'react';\nimport { ChannelContext } from '../../../context';\n\n/** @type {(fn: Function | undefined, message: import('stream-chat').MessageResponse | undefined) => Handler} * */\nfunction createEventHandler(fn, message) {\n  return (e) => {\n    if (typeof fn !== 'function' || !message?.mentioned_users) {\n      return;\n    }\n    fn(e, message.mentioned_users);\n  };\n}\n\n/**\n * @typedef {React.EventHandler<React.SyntheticEvent>} Handler\n * @typedef { import('stream-chat').MessageResponse | undefined } Message\n * @typedef { (event: React.MouseEvent, user: import('stream-chat').UserResponse[] ) => void } CustomMentionHandler\n * @type {(\n *   message: Message,\n *   customMentionHandler?: {\n *     onMentionsClick?: CustomMentionHandler,\n *     onMentionsHover?: CustomMentionHandler\n *   }\n * ) => { onMentionsClick: Handler, onMentionsHover: Handler }}\n */\nexport const useMentionsHandler = (message, customMentionHandler) => {\n  /**\n   * @type{import('types').ChannelContextValue}\n   */\n  const {\n    onMentionsClick: channelOnMentionsClick,\n    onMentionsHover: channelOnMentionsHover,\n  } = useContext(ChannelContext);\n  const onMentionsClick =\n    customMentionHandler?.onMentionsClick ||\n    channelOnMentionsClick ||\n    (() => {});\n  const onMentionsHover =\n    customMentionHandler?.onMentionsHover ||\n    channelOnMentionsHover ||\n    (() => {});\n\n  return {\n    /** @type {(e: React.MouseEvent<HTMLElement>) => void} Typescript syntax */\n    onMentionsClick: createEventHandler(onMentionsClick, message),\n    /** @type {(e: React.MouseEvent<HTMLElement>) => void} Typescript syntax */\n    onMentionsHover: createEventHandler(onMentionsHover, message),\n  };\n};\n\n/**\n * @type {(\n *   message: Message,\n *   eventHandlers?: {\n *     onMentionsClick?: Handler,\n *     onMentionsHover?: Handler,\n *   },\n * ) => { onMentionsClick: Handler, onMentionsHover: Handler }}\n */\nexport const useMentionsUIHandler = (message, eventHandlers) => {\n  /**\n   * @type{import('types').ChannelContextValue}\n   */\n  const { onMentionsClick, onMentionsHover } = useContext(ChannelContext);\n\n  return {\n    /** @type {(e: React.MouseEvent<HTMLElement>) => void} Typescript syntax */\n    onMentionsClick:\n      eventHandlers?.onMentionsClick ||\n      createEventHandler(onMentionsClick, message),\n    /** @type {(e: React.MouseEvent<HTMLElement>) => void} Typescript syntax */\n    onMentionsHover:\n      eventHandlers?.onMentionsHover ||\n      createEventHandler(onMentionsHover, message),\n  };\n};\n","// @ts-check\nimport { useContext } from 'react';\nimport { isUserMuted, validateAndGetMessage } from '../utils';\nimport { ChannelContext, TranslationContext } from '../../../context';\n\nexport const missingUseMuteHandlerParamsWarning =\n  'useMuteHandler was called but it is missing one or more necessary parameter.';\n\n/**\n * @typedef {{\n *   notify?: import('types').MessageComponentProps['addNotification'],\n *   getSuccessNotification?: import('types').MessageComponentProps['getMuteUserSuccessNotification'],\n *   getErrorNotification?: import('types').MessageComponentProps['getMuteUserErrorNotification'],\n * }} NotificationArg\n * @type {(message: import('stream-chat').MessageResponse | undefined, notification: NotificationArg) => (event: React.MouseEvent<HTMLElement>) => Promise<void>}\n */\nexport const useMuteHandler = (message, notifications = {}) => {\n  const { client, mutes } = useContext(ChannelContext);\n  const { t } = useContext(TranslationContext);\n\n  /** @type {(event: React.MouseEvent<HTMLElement>) => Promise<void>} Typescript syntax */\n  return async (event) => {\n    event.preventDefault();\n    const {\n      notify,\n      getSuccessNotification,\n      getErrorNotification,\n    } = notifications;\n\n    if (!t || !message?.user || !notify || !client) {\n      console.warn(missingUseMuteHandlerParamsWarning);\n      return;\n    }\n    if (!isUserMuted(message, mutes)) {\n      try {\n        await client.muteUser(message.user.id);\n        const successMessage =\n          getSuccessNotification &&\n          validateAndGetMessage(getSuccessNotification, [message.user]);\n\n        notify(\n          successMessage ||\n            t(`{{ user }} has been muted`, {\n              user: message.user.name || message.user.id,\n            }),\n          'success',\n        );\n      } catch (e) {\n        const errorMessage =\n          getErrorNotification &&\n          validateAndGetMessage(getErrorNotification, [message.user]);\n\n        notify(errorMessage || t('Error muting a user ...'), 'error');\n      }\n    } else {\n      try {\n        await client.unmuteUser(message.user.id);\n        const fallbackMessage = t(`{{ user }} has been unmuted`, {\n          user: message.user.name || message.user.id,\n        });\n        const successMessage =\n          (getSuccessNotification &&\n            validateAndGetMessage(getSuccessNotification, [message.user])) ||\n          fallbackMessage;\n\n        if (typeof successMessage === 'string') {\n          notify(successMessage, 'success');\n        }\n      } catch (e) {\n        const errorMessage =\n          (getErrorNotification &&\n            validateAndGetMessage(getErrorNotification, [message.user])) ||\n          t('Error unmuting a user ...');\n        if (typeof errorMessage === 'string') {\n          notify(errorMessage, 'error');\n        }\n      }\n    }\n  };\n};\n","// @ts-check\nimport { useContext } from 'react';\nimport { ChannelContext } from '../../../context';\n\n/**\n * @type {(\n *   message: import('stream-chat').MessageResponse | undefined,\n *   customOpenThread?: (message: import('stream-chat').MessageResponse, event: React.SyntheticEvent) => void\n * ) => (event: React.SyntheticEvent) => void}\n */\nexport const useOpenThreadHandler = (message, customOpenThread) => {\n  /**\n   * @type{import('types').ChannelContextValue}\n   */\n  const { openThread: channelOpenThread } = useContext(ChannelContext);\n\n  const openThread = customOpenThread || channelOpenThread;\n  return (event) => {\n    if (!openThread || !message) {\n      console.warn(\n        'Open thread handler was called but it is missing one of its parameters',\n      );\n      return;\n    }\n    openThread(message, event);\n  };\n};\n","// @ts-check\nimport { useContext, useCallback, useEffect, useRef, useState } from 'react';\nimport { ChannelContext } from '../../../context';\n\nexport const reactionHandlerWarning = `Reaction handler was called, but it is missing one of its required arguments.\n      Make sure the ChannelContext was properly set and that this hook was initialized with a valid message.`;\n/**\n * @type {(message: import('stream-chat').MessageResponse | undefined) => (reactionType: string, event: React.MouseEvent) => Promise<void>}\n */\nexport const useReactionHandler = (message) => {\n  const { client, channel, updateMessage } = useContext(ChannelContext);\n\n  return async (reactionType, event) => {\n    if (event && event.preventDefault) {\n      event.preventDefault();\n    }\n\n    if (!updateMessage || !message || !channel || !client) {\n      console.warn(reactionHandlerWarning);\n      return;\n    }\n\n    let userExistingReaction = null;\n\n    const currentUser = client.userID;\n    if (message.own_reactions) {\n      message.own_reactions.forEach((reaction) => {\n        // own user should only ever contain the current user id\n        // just in case we check to prevent bugs with message updates from breaking reactions\n        if (\n          reaction.user &&\n          currentUser === reaction.user.id &&\n          reaction.type === reactionType\n        ) {\n          userExistingReaction = reaction;\n        } else if (reaction.user && currentUser !== reaction.user.id) {\n          console.warn(\n            `message.own_reactions contained reactions from a different user, this indicates a bug`,\n          );\n        }\n      });\n    }\n\n    const originalMessage = message;\n    let reactionChangePromise;\n\n    /*\n    - Make the API call in the background\n    - If it fails, revert to the old message...\n     */\n    if (userExistingReaction) {\n      reactionChangePromise = channel.deleteReaction(\n        message.id,\n        // @ts-ignore Typescript doesn't understand that the userExistingReaction variable might have been mutated inside the foreach loop\n        userExistingReaction.type,\n      );\n    } else {\n      // add the reaction\n      const messageID = message.id;\n\n      const reaction = { type: reactionType };\n\n      // this.props.channel.state.addReaction(tmpReaction, this.props.message);\n      reactionChangePromise = channel.sendReaction(messageID, reaction);\n    }\n\n    try {\n      // only wait for the API call after the state is updated\n      await reactionChangePromise;\n    } catch (e) {\n      // revert to the original message if the API call fails\n      updateMessage(originalMessage);\n    }\n  };\n};\n\n/**\n * @typedef {{ onReactionListClick: () => void, showDetailedReactions: boolean }} ReactionClickHandler\n * @type {(\n *   message: import('stream-chat').MessageResponse | undefined,\n *   reactionSelectorRef: React.RefObject<HTMLDivElement | null>,\n *   messageWrapperRef?: React.RefObject<HTMLElement | null>\n * ) => ReactionClickHandler}\n */\nexport const useReactionClick = (\n  message,\n  reactionSelectorRef,\n  messageWrapperRef,\n) => {\n  const [showDetailedReactions, setShowDetailedReactions] = useState(false);\n  const messageDeleted = !!message?.deleted_at;\n  const hasListener = useRef(false);\n  /** @type {EventListener} */\n  const closeDetailedReactions = useCallback(\n    (event) => {\n      if (\n        event.target &&\n        // @ts-ignore\n        reactionSelectorRef?.current?.contains(event.target)\n      ) {\n        return;\n      }\n      setShowDetailedReactions(false);\n    },\n    [setShowDetailedReactions, reactionSelectorRef],\n  );\n\n  useEffect(() => {\n    const messageWrapper = messageWrapperRef?.current;\n    if (showDetailedReactions && !hasListener.current) {\n      hasListener.current = true;\n      document.addEventListener('click', closeDetailedReactions);\n      document.addEventListener('touchend', closeDetailedReactions);\n      if (messageWrapper) {\n        messageWrapper.addEventListener('mouseleave', closeDetailedReactions);\n      }\n    }\n    if (!showDetailedReactions && hasListener.current) {\n      document.removeEventListener('click', closeDetailedReactions);\n      document.removeEventListener('touchend', closeDetailedReactions);\n      if (messageWrapper) {\n        messageWrapper.removeEventListener(\n          'mouseleave',\n          closeDetailedReactions,\n        );\n      }\n      hasListener.current = false;\n    }\n    return () => {\n      if (hasListener.current) {\n        document.removeEventListener('click', closeDetailedReactions);\n        document.removeEventListener('touchend', closeDetailedReactions);\n        if (messageWrapper) {\n          messageWrapper.removeEventListener(\n            'mouseleave',\n            closeDetailedReactions,\n          );\n        }\n        hasListener.current = false;\n      }\n    };\n  }, [showDetailedReactions, closeDetailedReactions, messageWrapperRef]);\n\n  useEffect(() => {\n    const messageWrapper = messageWrapperRef?.current;\n    if (messageDeleted && hasListener.current) {\n      document.removeEventListener('click', closeDetailedReactions);\n      document.removeEventListener('touchend', closeDetailedReactions);\n      if (messageWrapper) {\n        messageWrapper.removeEventListener(\n          'mouseleave',\n          closeDetailedReactions,\n        );\n      }\n      hasListener.current = false;\n    }\n  }, [messageDeleted, closeDetailedReactions, messageWrapperRef]);\n\n  /** @type {() => void} Typescript syntax */\n  const onReactionListClick = () => {\n    setShowDetailedReactions(true);\n  };\n  return {\n    onReactionListClick,\n    showDetailedReactions,\n  };\n};\n","// @ts-check\nimport { useContext } from 'react';\nimport { ChannelContext } from '../../../context';\n\n/**\n * @type {(\n *  customRetrySendMessage?: (message: import('stream-chat').Message) => Promise<void>\n * ) => (message: import('stream-chat').Message | undefined) => Promise<void>}\n */\nexport const useRetryHandler = (customRetrySendMessage) => {\n  /**\n   *@type {import('types').ChannelContextValue}\n   */\n  const { retrySendMessage: contextRetrySendMessage } = useContext(\n    ChannelContext,\n  );\n  const retrySendMessage = customRetrySendMessage || contextRetrySendMessage;\n  return async (message) => {\n    if (retrySendMessage && message) {\n      await retrySendMessage(message);\n    }\n  };\n};\n","// @ts-check\n/**\n * @typedef {React.EventHandler<React.SyntheticEvent>} Handler\n * @typedef {(e: React.MouseEvent, user: import('stream-chat').User) => void} UserEventHandler\n * @type {(message: import('stream-chat').MessageResponse | undefined, eventHandlers: {onUserClickHandler?: UserEventHandler, onUserHoverHandler?: UserEventHandler}) => { onUserClick: Handler, onUserHover: Handler }}\n */\nexport const useUserHandler = (message, eventHandlers) => {\n  return {\n    /** @type {(e: React.MouseEvent<HTMLElement>) => void} Typescript syntax */\n    onUserClick: (e) => {\n      if (\n        typeof eventHandlers?.onUserClickHandler !== 'function' ||\n        !message?.user\n      ) {\n        return;\n      }\n      eventHandlers.onUserClickHandler(e, message.user);\n    },\n    /** @type {(e: React.MouseEvent<HTMLElement>) => void} Typescript syntax */\n    onUserHover: (e) => {\n      if (\n        typeof eventHandlers?.onUserHoverHandler !== 'function' ||\n        !message?.user\n      ) {\n        return;\n      }\n\n      eventHandlers.onUserHoverHandler(e, message.user);\n    },\n  };\n};\n","// @ts-check\nimport { useContext } from 'react';\nimport { ChannelContext } from '../../../context';\n\n/**\n * @typedef {{\n *   isMyMessage: boolean;\n *   isAdmin: boolean;\n *   isModerator: boolean;\n *   isOwner: boolean;\n *   canEditMessage: boolean;\n *   canDeleteMessage: boolean;\n * }} UserRoles\n * @type {(message: import('stream-chat').MessageResponse | undefined) => UserRoles} Typescript syntax\n */\nexport const useUserRole = (message) => {\n  const { client, channel } = useContext(ChannelContext);\n\n  const isMyMessage =\n    !!message?.user && !!client?.user && client.user.id === message.user.id;\n\n  const isAdmin =\n    client?.user?.role === 'admin' ||\n    channel?.state?.membership?.role === 'admin';\n  const isOwner = channel?.state?.membership?.role === 'owner';\n  const isModerator =\n    channel?.state?.membership?.role === 'channel_moderator' ||\n    channel?.state?.membership?.role === 'moderator';\n  const canEditMessage = isMyMessage || isModerator || isOwner || isAdmin;\n  const canDeleteMessage = canEditMessage;\n\n  return {\n    isMyMessage,\n    isAdmin,\n    isOwner,\n    isModerator,\n    canEditMessage,\n    canDeleteMessage,\n  };\n};\n","// @ts-check\nimport React, { useContext, useState, useCallback } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { MESSAGE_ACTIONS } from '../Message/utils';\nimport { TranslationContext } from '../../context';\n\n/** @type {React.FC<import(\"types\").MessageActionsBoxProps>} */\nconst MessageActionsBox = ({\n  handleFlag,\n  handleMute,\n  handleEdit,\n  handleDelete,\n  getMessageActions,\n  isUserMuted,\n  open = false,\n  mine,\n  messageListRect,\n}) => {\n  const { t } = useContext(TranslationContext);\n  const messageActions = getMessageActions();\n  const [reverse, setReverse] = useState(false);\n\n  const checkIfReverse = useCallback(\n    (containerElement) => {\n      if (!containerElement) {\n        setReverse(false);\n        return;\n      }\n      if (open) {\n        const containerRect = containerElement.getBoundingClientRect();\n\n        if (mine) {\n          setReverse(\n            !!messageListRect && containerRect.left < messageListRect.left,\n          );\n        } else {\n          setReverse(\n            !!messageListRect &&\n              containerRect.right + 5 > messageListRect.right,\n          );\n        }\n      }\n    },\n    [messageListRect, mine, open],\n  );\n\n  return (\n    <div\n      data-testid=\"message-actions-box\"\n      className={`str-chat__message-actions-box\n        ${open ? 'str-chat__message-actions-box--open' : ''}\n        ${mine ? 'str-chat__message-actions-box--mine' : ''}\n        ${reverse ? 'str-chat__message-actions-box--reverse' : ''}\n      `}\n      ref={checkIfReverse}\n    >\n      <ul className=\"str-chat__message-actions-list\">\n        {messageActions.indexOf(MESSAGE_ACTIONS.flag) > -1 && (\n          <button onClick={handleFlag}>\n            <li className=\"str-chat__message-actions-list-item\">{t('Flag')}</li>\n          </button>\n        )}\n        {messageActions.indexOf(MESSAGE_ACTIONS.mute) > -1 && (\n          <button onClick={handleMute}>\n            <li className=\"str-chat__message-actions-list-item\">\n              {isUserMuted && isUserMuted() ? t('Unmute') : t('Mute')}\n            </li>\n          </button>\n        )}\n        {messageActions.indexOf(MESSAGE_ACTIONS.edit) > -1 && (\n          <button onClick={handleEdit}>\n            <li className=\"str-chat__message-actions-list-item\">\n              {t('Edit Message')}\n            </li>\n          </button>\n        )}\n        {messageActions.indexOf(MESSAGE_ACTIONS.delete) > -1 && (\n          <button onClick={handleDelete}>\n            <li className=\"str-chat__message-actions-list-item\">\n              {t('Delete')}\n            </li>\n          </button>\n        )}\n      </ul>\n    </div>\n  );\n};\n\nMessageActionsBox.propTypes = {\n  /** If the message actions box should be open or not */\n  open: PropTypes.bool,\n  /** If message belongs to current user. */\n  mine: PropTypes.bool,\n  /** DOMRect object for parent MessageList component */\n  messageListRect: /** @type {PropTypes.Validator<DOMRect>} */ (PropTypes.object),\n  /**\n   * Handler for flaging a current message\n   *\n   * @param event React's MouseEventHandler event\n   * @returns void\n   * */\n  handleFlag: PropTypes.func,\n  /**\n   * Handler for muting a current message\n   *\n   * @param event React's MouseEventHandler event\n   * @returns void\n   * */\n  handleMute: PropTypes.func,\n  /**\n   * Handler for editing a current message\n   *\n   * @param event React's MouseEventHandler event\n   * @returns void\n   * */\n  handleEdit: PropTypes.func,\n  /**\n   * Handler for deleting a current message\n   *\n   * @param event React's MouseEventHandler event\n   * @returns void\n   * */\n  handleDelete: PropTypes.func,\n  /**\n   * Returns array of avalable message actions for current message.\n   * Please check [Message](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message.js) component for default implementation.\n   */\n  getMessageActions: PropTypes.func.isRequired,\n};\nexport default React.memo(MessageActionsBox);\n","// @ts-check\nimport React, { useCallback, useContext, useEffect, useState } from 'react';\nimport MessageActionsBox from './MessageActionsBox';\nimport {\n  useDeleteHandler,\n  useUserRole,\n  useFlagHandler,\n  useMuteHandler,\n} from '../Message/hooks';\nimport { isUserMuted } from '../Message/utils';\nimport { ChatContext } from '../../context';\n\n/**\n * @type { React.FC<import('types').MessageActionsProps> }\n */\nexport const MessageActions = (props) => {\n  const {\n    addNotification,\n    message,\n    getMessageActions,\n    messageListRect,\n    messageWrapperRef,\n    setEditingState,\n    getMuteUserSuccessNotification,\n    getMuteUserErrorNotification,\n    getFlagMessageErrorNotification,\n    getFlagMessageSuccessNotification,\n    handleFlag: propHandleFlag,\n    handleMute: propHandleMute,\n    handleDelete: propHandleDelete,\n    inline,\n    customWrapperClass,\n  } = props;\n  const { mutes } = useContext(ChatContext);\n  const messageActions = getMessageActions();\n  const [actionsBoxOpen, setActionsBoxOpen] = useState(false);\n  const { isMyMessage } = useUserRole(message);\n  const handleDelete = useDeleteHandler(message);\n  const handleFlag = useFlagHandler(message, {\n    notify: addNotification,\n    getSuccessNotification: getFlagMessageErrorNotification,\n    getErrorNotification: getFlagMessageSuccessNotification,\n  });\n  const handleMute = useMuteHandler(message, {\n    notify: addNotification,\n    getErrorNotification: getMuteUserSuccessNotification,\n    getSuccessNotification: getMuteUserErrorNotification,\n  });\n  const isMuted = useCallback(() => {\n    return isUserMuted(message, mutes);\n  }, [message, mutes]);\n\n  /** @type {() => void} Typescript syntax */\n  const hideOptions = useCallback(() => setActionsBoxOpen(false), []);\n  const messageDeletedAt = !!message?.deleted_at;\n  useEffect(() => {\n    if (messageWrapperRef?.current) {\n      messageWrapperRef.current.addEventListener('onMouseLeave', hideOptions);\n    }\n  }, [messageWrapperRef, hideOptions]);\n  useEffect(() => {\n    if (messageDeletedAt) {\n      document.removeEventListener('click', hideOptions);\n    }\n  }, [messageDeletedAt, hideOptions]);\n\n  useEffect(() => {\n    if (actionsBoxOpen) {\n      document.addEventListener('click', hideOptions);\n    } else {\n      document.removeEventListener('click', hideOptions);\n    }\n    return () => {\n      document.removeEventListener('click', hideOptions);\n    };\n  }, [actionsBoxOpen, hideOptions]);\n  if (messageActions.length === 0) {\n    return null;\n  }\n\n  return (\n    <MessageActionsWrapper\n      inline={inline}\n      customWrapperClass={customWrapperClass}\n      setActionsBoxOpen={setActionsBoxOpen}\n    >\n      <MessageActionsBox\n        getMessageActions={getMessageActions}\n        open={actionsBoxOpen}\n        messageListRect={messageListRect}\n        handleFlag={propHandleFlag || handleFlag}\n        isUserMuted={isMuted}\n        handleMute={propHandleMute || handleMute}\n        handleEdit={setEditingState}\n        handleDelete={propHandleDelete || handleDelete}\n        mine={isMyMessage}\n      />\n      <svg\n        width=\"11\"\n        height=\"4\"\n        viewBox=\"0 0 11 4\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <path\n          d=\"M1.5 3a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z\"\n          fillRule=\"nonzero\"\n        />\n      </svg>\n    </MessageActionsWrapper>\n  );\n};\n\n/**\n * This is a workaround to encompass the different styles message actions can have at the moment\n * while allowing for sharing the component's stateful logic.\n * @type { React.FC<import('types').MessageActionsWrapperProps> }\n */\nconst MessageActionsWrapper = (props) => {\n  const { children, customWrapperClass, inline, setActionsBoxOpen } = props;\n  const defaultWrapperClass =\n    'str-chat__message-simple__actions__action str-chat__message-simple__actions__action--options';\n  const wrapperClass =\n    typeof customWrapperClass === 'string'\n      ? customWrapperClass\n      : defaultWrapperClass;\n  /** @type {() => void} Typescript syntax */\n  const onClickOptionsAction = () => setActionsBoxOpen(true);\n  const wrapperProps = {\n    'data-testid': 'message-actions',\n    onClick: onClickOptionsAction,\n    className: wrapperClass,\n  };\n  if (inline) {\n    return <span {...wrapperProps}>{children}</span>;\n  }\n  return <div {...wrapperProps}>{children}</div>;\n};\n","// @ts-check\nimport React, { useContext } from 'react';\nimport { useUserRole, useOpenThreadHandler } from './hooks';\nimport { ChannelContext } from '../../context';\nimport { MessageActions } from '../MessageActions';\nimport { ThreadIcon, ReactionIcon } from './icons';\n\n/**\n * @type { React.FC<import('types').MessageOptionsProps> }\n */\nconst MessageOptionsComponent = (props) => {\n  const {\n    displayActions = true,\n    displayLeft = true,\n    displayReplies = true,\n    handleOpenThread: propHandleOpenThread,\n    initialMessage,\n    message,\n    messageWrapperRef,\n    onReactionListClick,\n    theme = 'simple',\n    threadList,\n  } = props;\n  const { isMyMessage } = useUserRole(message);\n  const handleOpenThread = useOpenThreadHandler(message);\n  /**\n   * @type {import('types').ChannelContextValue}\n   */\n  const { channel } = useContext(ChannelContext);\n  const channelConfig = channel?.getConfig();\n  const shouldShowReplies =\n    displayReplies && !threadList && channelConfig && channelConfig.replies;\n  const shouldShowReactions = channelConfig && channelConfig.reactions;\n  if (\n    !message ||\n    message.type === 'error' ||\n    message.type === 'system' ||\n    message.type === 'ephemeral' ||\n    message.status === 'failed' ||\n    message.status === 'sending' ||\n    initialMessage\n  ) {\n    return null;\n  }\n  if (isMyMessage && displayLeft) {\n    return (\n      <div\n        data-testid=\"message-options-left\"\n        className={`str-chat__message-${theme}__actions`}\n      >\n        {<MessageActions {...props} messageWrapperRef={messageWrapperRef} />}\n        {shouldShowReplies && (\n          <div\n            data-testid=\"thread-action\"\n            onClick={propHandleOpenThread || handleOpenThread}\n            className={`str-chat__message-${theme} str-chat__message-${theme}__actions__action--thread`}\n          >\n            <ThreadIcon />\n          </div>\n        )}\n        {shouldShowReactions && (\n          <div\n            data-testid=\"message-reaction-action\"\n            className={`str-chat__message-${theme}__actions__action str-chat__message-${theme}__actions__action--reactions`}\n            onClick={onReactionListClick}\n          >\n            <ReactionIcon />\n          </div>\n        )}\n      </div>\n    );\n  }\n  return (\n    <div\n      data-testid=\"message-options\"\n      className={`str-chat__message-${theme}__actions`}\n    >\n      {shouldShowReactions && (\n        <div\n          data-testid=\"message-reaction-action\"\n          className={`str-chat__message-${theme}__actions__action str-chat__message-${theme}__actions__action--reactions`}\n          onClick={onReactionListClick}\n        >\n          <ReactionIcon />\n        </div>\n      )}\n      {shouldShowReplies && (\n        <div\n          onClick={propHandleOpenThread || handleOpenThread}\n          data-testid=\"thread-action\"\n          className={`str-chat__message-${theme}__actions__action str-chat__message-${theme}__actions__action--thread`}\n        >\n          <ThreadIcon />\n        </div>\n      )}\n      {displayActions && (\n        <MessageActions {...props} messageWrapperRef={messageWrapperRef} />\n      )}\n    </div>\n  );\n};\n\nexport default React.memo(MessageOptionsComponent);\n","// @ts-check\nimport React, { useMemo, useContext, useRef } from 'react';\nimport { isOnlyEmojis, renderText } from '../../utils';\nimport { TranslationContext } from '../../context';\nimport {\n  ReactionsList as DefaultReactionList,\n  ReactionSelector as DefaultReactionSelector,\n} from '../Reactions';\nimport {\n  useReactionHandler,\n  useReactionClick,\n  useMentionsUIHandler,\n} from './hooks';\nimport { messageHasReactions, messageHasAttachments } from './utils';\nimport MessageOptions from './MessageOptions';\n\n/**\n * @type { React.FC<import('types').MessageTextProps> }\n */\nconst MessageTextComponent = (props) => {\n  const {\n    ReactionsList = DefaultReactionList,\n    ReactionSelector = DefaultReactionSelector,\n    onMentionsClickMessage: propOnMentionsClick,\n    onMentionsHoverMessage: propOnMentionsHover,\n    customWrapperClass,\n    customInnerClass,\n    theme = 'simple',\n    message,\n    unsafeHTML,\n    customOptionProps,\n  } = props;\n  const reactionSelectorRef = useRef(\n    /** @type {HTMLDivElement | null} */ (null),\n  );\n  const { onMentionsClick, onMentionsHover } = useMentionsUIHandler(message, {\n    onMentionsClick: propOnMentionsClick,\n    onMentionsHover: propOnMentionsHover,\n  });\n  const { onReactionListClick, showDetailedReactions } = useReactionClick(\n    message,\n    reactionSelectorRef,\n  );\n  const { t } = useContext(TranslationContext);\n  const hasReactions = messageHasReactions(message);\n  const hasAttachment = messageHasAttachments(message);\n  const handleReaction = useReactionHandler(message);\n  const messageText = useMemo(\n    () => renderText(message?.text, message?.mentioned_users),\n    [message?.text, message?.mentioned_users],\n  );\n  const wrapperClass = customWrapperClass || 'str-chat__message-text';\n  const innerClass =\n    customInnerClass ||\n    `str-chat__message-text-inner str-chat__message-${theme}-text-inner`;\n\n  if (!message?.text) {\n    return null;\n  }\n\n  return (\n    <div className={wrapperClass}>\n      <div\n        data-testid=\"message-text-inner-wrapper\"\n        className={`\n          ${innerClass}\n          ${\n            hasAttachment\n              ? ` str-chat__message-${theme}-text-inner--has-attachment`\n              : ''\n          }\n          ${\n            isOnlyEmojis(message.text)\n              ? ` str-chat__message-${theme}-text-inner--is-emoji`\n              : ''\n          }\n        `.trim()}\n        onMouseOver={onMentionsHover}\n        onClick={onMentionsClick}\n      >\n        {message.type === 'error' && (\n          <div className={`str-chat__${theme}-message--error-message`}>\n            {t && t('Error · Unsent')}\n          </div>\n        )}\n        {message.status === 'failed' && (\n          <div className={`str-chat__${theme}-message--error-message`}>\n            {t && t('Message Failed · Click to try again')}\n          </div>\n        )}\n\n        {unsafeHTML ? (\n          <div dangerouslySetInnerHTML={{ __html: message.html }} />\n        ) : (\n          messageText\n        )}\n\n        {/* if reactions show them */}\n        {hasReactions && !showDetailedReactions && (\n          <ReactionsList\n            reactions={message.latest_reactions}\n            reaction_counts={message.reaction_counts}\n            onClick={onReactionListClick}\n            reverse={true}\n          />\n        )}\n        {showDetailedReactions && (\n          <ReactionSelector\n            handleReaction={handleReaction}\n            detailedView\n            reaction_counts={message.reaction_counts}\n            latest_reactions={message.latest_reactions}\n            ref={reactionSelectorRef}\n          />\n        )}\n      </div>\n      <MessageOptions\n        {...props}\n        {...customOptionProps}\n        onReactionListClick={onReactionListClick}\n      />\n    </div>\n  );\n};\n\nexport default React.memo(MessageTextComponent);\n","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport { TranslationContext } from '../../context';\nimport { useUserRole } from './hooks/useUserRole';\nimport { MessagePropTypes } from './utils';\n\n/**\n * @type{React.FC<import('types').MessageDeletedProps>}\n */\nconst MessageDeleted = (props) => {\n  const { message } = props;\n  const { t } = useContext(TranslationContext);\n  const { isMyMessage } = useUserRole(message);\n  if (props.isMyMessage) {\n    console.warn(\n      'The isMyMessage is deprecated, and will be removed in the next major release.',\n    );\n  }\n  const messageClasses =\n    (props.isMyMessage && props.isMyMessage(message)) || isMyMessage\n      ? 'str-chat__message str-chat__message--me str-chat__message-simple str-chat__message-simple--me'\n      : 'str-chat__message str-chat__message-simple';\n\n  return (\n    <div\n      key={message.id}\n      className={`${messageClasses} str-chat__message--deleted ${message.type} `}\n      data-testid={'message-deleted-component'}\n    >\n      <div className=\"str-chat__message--deleted-inner\">\n        {t && t('This message was deleted...')}\n      </div>\n    </div>\n  );\n};\n\nMessageDeleted.propTypes = {\n  /** The [message object](https://getstream.io/chat/docs/#message_format) */\n  // @ts-ignore\n  // Ignoring this for now as Typescript definitions on 'strem-chat' are wrong.\n  message: MessagePropTypes,\n  /** @deprecated This is no longer needed. The component should now rely on the user role custom hook */\n  isMyMessage: PropTypes.func,\n};\n\nexport default MessageDeleted;\n","// @ts-check\nimport React, { useContext, useMemo } from 'react';\nimport { TranslationContext } from '../../context';\n\nexport const defaultTimestampFormat = 'h:mmA';\nexport const notValidDateWarning =\n  'MessageTimestamp was called without a message, or message has invalid created_at date.';\nexport const noParsingFunctionWarning =\n  'MessageTimestamp was called but there is no datetime parsing function available';\n/**\n * @type { (\n *   messageCreatedAt?: string,\n *   formatDate?: import('types').MessageTimestampProps['formatDate'],\n *   calendar?: boolean,\n *   tDateTimeParser?: import('types').MessageTimestampProps['tDateTimeParser'],\n *   format?: string,\n * ) => string | null }\n */\nfunction getDateString(\n  messageCreatedAt,\n  formatDate,\n  calendar,\n  tDateTimeParser,\n  format,\n) {\n  if (!messageCreatedAt || !Date.parse(messageCreatedAt)) {\n    console.warn(notValidDateWarning);\n    return null;\n  }\n\n  if (typeof formatDate === 'function') {\n    return formatDate(new Date(messageCreatedAt));\n  }\n\n  if (!tDateTimeParser) {\n    console.warn(noParsingFunctionWarning);\n    return null;\n  }\n\n  const parsedTime = tDateTimeParser(messageCreatedAt);\n  if (calendar && typeof parsedTime.calendar !== 'function') {\n    return null;\n  }\n\n  return calendar ? parsedTime.calendar() : parsedTime.format(format);\n}\n/**\n * @typedef { import('types').MessageTimestampProps } Props\n * @type { React.FC<Props> }\n */\nconst MessageTimestamp = (props) => {\n  const {\n    message,\n    formatDate,\n    tDateTimeParser: propTDatetimeParser,\n    customClass = '',\n    format = defaultTimestampFormat,\n    calendar = false,\n  } = props;\n  const { tDateTimeParser: contextTDateTimeParser } = useContext(\n    TranslationContext,\n  );\n  const tDateTimeParser = propTDatetimeParser || contextTDateTimeParser;\n  const when = useMemo(\n    () =>\n      getDateString(\n        message?.created_at,\n        formatDate,\n        calendar,\n        tDateTimeParser,\n        format,\n      ),\n    [formatDate, calendar, tDateTimeParser, format, message?.created_at],\n  );\n\n  if (!when) {\n    return null;\n  }\n\n  return (\n    <time\n      className={customClass}\n      dateTime={message?.created_at}\n      title={message?.created_at}\n    >\n      {when}\n    </time>\n  );\n};\n\nexport default React.memo(MessageTimestamp);\n","// @ts-check\nimport React, { useContext, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport MessageRepliesCountButton from './MessageRepliesCountButton';\nimport { getReadByTooltipText, smartRender } from '../../utils';\nimport { TranslationContext, ChannelContext } from '../../context';\nimport { Attachment as DefaultAttachment } from '../Attachment';\nimport { Avatar } from '../Avatar';\nimport { Gallery } from '../Gallery';\nimport { Modal } from '../Modal';\nimport { MessageInput, EditMessageForm } from '../MessageInput';\nimport { Tooltip } from '../Tooltip';\nimport { LoadingIndicator } from '../Loading';\nimport {\n  ReactionsList as DefaultReactionList,\n  ReactionSelector as DefaultReactionSelector,\n} from '../Reactions';\nimport MessageOptions from './MessageOptions';\nimport MessageText from './MessageText';\nimport DefaultMessageDeleted from './MessageDeleted';\nimport {\n  useActionHandler,\n  useOpenThreadHandler,\n  useReactionClick,\n  useReactionHandler,\n  useRetryHandler,\n  useUserHandler,\n  useUserRole,\n} from './hooks';\nimport {\n  areMessagePropsEqual,\n  messageHasReactions,\n  messageHasAttachments,\n} from './utils';\nimport { DeliveredCheckIcon } from './icons';\nimport MessageTimestamp from './MessageTimestamp';\n\n/**\n * MessageSimple - Render component, should be used together with the Message component\n *\n * @example ../../docs/MessageSimple.md\n * @type { React.FC<import('types').MessageSimpleProps> }\n */\n// eslint-disable-next-line sonarjs/cognitive-complexity\nconst MessageSimple = (props) => {\n  const {\n    clearEditingState,\n    editing,\n    message,\n    threadList,\n    formatDate,\n    updateMessage: propUpdateMessage,\n    handleAction: propHandleAction,\n    handleOpenThread: propHandleOpenThread,\n    handleReaction: propHandleReaction,\n    handleRetry: propHandleRetry,\n    onUserClick: onUserClickCustomHandler,\n    onUserHover: onUserHoverCustomHandler,\n    tDateTimeParser: propTDateTimeParser,\n  } = props;\n  const { updateMessage: channelUpdateMessage } = useContext(ChannelContext);\n  const updateMessage = propUpdateMessage || channelUpdateMessage;\n  const { isMyMessage } = useUserRole(message);\n  const handleOpenThread = useOpenThreadHandler(message);\n  const handleReaction = useReactionHandler(message);\n  const handleAction = useActionHandler(message);\n  const handleRetry = useRetryHandler();\n  const { onUserClick, onUserHover } = useUserHandler(message, {\n    onUserClickHandler: onUserClickCustomHandler,\n    onUserHoverHandler: onUserHoverCustomHandler,\n  });\n  const reactionSelectorRef = React.createRef();\n  const messageWrapperRef = useRef(null);\n  const { onReactionListClick, showDetailedReactions } = useReactionClick(\n    message,\n    reactionSelectorRef,\n  );\n  const {\n    Attachment = DefaultAttachment,\n    MessageDeleted = DefaultMessageDeleted,\n    ReactionSelector = DefaultReactionSelector,\n    ReactionsList = DefaultReactionList,\n  } = props;\n\n  const hasReactions = messageHasReactions(message);\n  const hasAttachment = messageHasAttachments(message);\n\n  const messageClasses = isMyMessage\n    ? 'str-chat__message str-chat__message--me str-chat__message-simple str-chat__message-simple--me'\n    : 'str-chat__message str-chat__message-simple';\n\n  const images =\n    hasAttachment &&\n    message?.attachments?.filter(\n      /** @type {(item: import('stream-chat').Attachment) => boolean} Typescript syntax */\n      (item) => item.type === 'image',\n    );\n\n  if (message?.type === 'message.read' || message?.type === 'message.date') {\n    return null;\n  }\n\n  if (message?.deleted_at) {\n    return smartRender(MessageDeleted, { message }, null);\n  }\n  return (\n    <React.Fragment>\n      {editing && (\n        <Modal open={editing} onClose={clearEditingState}>\n          <MessageInput\n            Input={EditMessageForm}\n            message={message}\n            clearEditingState={clearEditingState}\n            updateMessage={updateMessage}\n            {...props.additionalMessageInputProps}\n          />\n        </Modal>\n      )}\n      {message && (\n        <div\n          key={message.id || ''}\n          className={`\n\t\t\t\t\t\t${messageClasses}\n\t\t\t\t\t\tstr-chat__message--${message.type}\n\t\t\t\t\t\tstr-chat__message--${message.status}\n\t\t\t\t\t\t${message.text ? 'str-chat__message--has-text' : 'has-no-text'}\n\t\t\t\t\t\t${hasAttachment ? 'str-chat__message--has-attachment' : ''}\n\t\t\t\t\t\t${hasReactions ? 'str-chat__message--with-reactions' : ''}\n\t\t\t\t\t`.trim()}\n          ref={messageWrapperRef}\n        >\n          <MessageSimpleStatus {...props} />\n\n          {message.user && (\n            <Avatar\n              image={message.user.image}\n              name={message.user.name || message.user.id}\n              onClick={onUserClick}\n              onMouseOver={onUserHover}\n            />\n          )}\n          <div\n            data-testid=\"message-inner\"\n            className=\"str-chat__message-inner\"\n            onClick={() => {\n              if (\n                message.status === 'failed' &&\n                (propHandleRetry || handleRetry)\n              ) {\n                const retryHandler = propHandleRetry || handleRetry;\n                // FIXME: type checking fails here because in the case of a failed message,\n                // `message` is of type Client.Message (i.e. request object)\n                // instead of Client.MessageResponse (i.e. server response object)\n                // @ts-ignore\n                retryHandler(message);\n              }\n            }}\n          >\n            {!message.text && (\n              <React.Fragment>\n                {\n                  <MessageOptions\n                    {...props}\n                    messageWrapperRef={messageWrapperRef}\n                    onReactionListClick={onReactionListClick}\n                    handleOpenThread={propHandleOpenThread}\n                  />\n                }\n                {/* if reactions show them */}\n                {hasReactions && !showDetailedReactions && (\n                  <ReactionsList\n                    reactions={message.latest_reactions}\n                    reaction_counts={message.reaction_counts}\n                    onClick={onReactionListClick}\n                    reverse={true}\n                  />\n                )}\n                {showDetailedReactions && (\n                  <ReactionSelector\n                    handleReaction={propHandleReaction || handleReaction}\n                    detailedView\n                    reaction_counts={message.reaction_counts}\n                    latest_reactions={message.latest_reactions}\n                    ref={reactionSelectorRef}\n                  />\n                )}\n              </React.Fragment>\n            )}\n\n            <div className=\"str-chat__message-attachment-container\">\n              {hasAttachment &&\n                message.attachments?.map(\n                  /** @type {(item: import('stream-chat').Attachment) => React.ReactElement | null} Typescript syntax */\n                  (attachment, index) => {\n                    if (\n                      attachment.type === 'image' &&\n                      images &&\n                      images.length > 1\n                    )\n                      return null;\n                    return (\n                      <Attachment\n                        key={`${message.id}-${index}`}\n                        attachment={attachment}\n                        actionHandler={propHandleAction || handleAction}\n                      />\n                    );\n                  },\n                )}\n            </div>\n            {images && images.length > 1 && <Gallery images={images} />}\n            {message.text && (\n              <MessageText\n                {...props}\n                customOptionProps={{\n                  messageWrapperRef,\n                  handleOpenThread: propHandleOpenThread,\n                }}\n                // FIXME: There's some unmatched definition between the infered and the declared\n                // ReactionSelector reference\n                // @ts-ignore\n                reactionSelectorRef={reactionSelectorRef}\n              />\n            )}\n            {!threadList && message.reply_count !== 0 && (\n              <div className=\"str-chat__message-simple-reply-button\">\n                <MessageRepliesCountButton\n                  onClick={propHandleOpenThread || handleOpenThread}\n                  reply_count={message.reply_count}\n                />\n              </div>\n            )}\n            <div\n              className={`str-chat__message-data str-chat__message-simple-data`}\n            >\n              {!isMyMessage && message.user ? (\n                <span className=\"str-chat__message-simple-name\">\n                  {message.user.name || message.user.id}\n                </span>\n              ) : null}\n              <MessageTimestamp\n                customClass=\"str-chat__message-simple-timestamp\"\n                tDateTimeParser={propTDateTimeParser}\n                formatDate={formatDate}\n                message={message}\n                calendar\n              />\n            </div>\n          </div>\n        </div>\n      )}\n    </React.Fragment>\n  );\n};\n\n/** @type { React.FC<import('types').MessageSimpleProps> } */\nconst MessageSimpleStatus = ({\n  readBy,\n  message,\n  threadList,\n  lastReceivedId,\n}) => {\n  const { t } = useContext(TranslationContext);\n  const { client } = useContext(ChannelContext);\n  const { isMyMessage } = useUserRole(message);\n  if (!isMyMessage || message?.type === 'error') {\n    return null;\n  }\n  const justReadByMe =\n    readBy &&\n    readBy.length === 1 &&\n    readBy[0] &&\n    client &&\n    readBy[0].id === client.user.id;\n  if (message && message.status === 'sending') {\n    return (\n      <span\n        className=\"str-chat__message-simple-status\"\n        data-testid=\"message-status-sending\"\n      >\n        <Tooltip>{t && t('Sending...')}</Tooltip>\n        <LoadingIndicator />\n      </span>\n    );\n  }\n  if (readBy && readBy.length !== 0 && !threadList && !justReadByMe) {\n    const lastReadUser = readBy.filter(\n      /** @type {(item: import('stream-chat').UserResponse) => boolean} Typescript syntax */\n      (item) => !!item && !!client && item.id !== client.user.id,\n    )[0];\n    return (\n      <span\n        className=\"str-chat__message-simple-status\"\n        data-testid=\"message-status-read-by\"\n      >\n        <Tooltip>{readBy && getReadByTooltipText(readBy, t, client)}</Tooltip>\n        <Avatar\n          name={lastReadUser && lastReadUser.name ? lastReadUser.name : null}\n          image={lastReadUser && lastReadUser.image ? lastReadUser.image : null}\n          size={15}\n        />\n        {readBy.length > 2 && (\n          <span\n            className=\"str-chat__message-simple-status-number\"\n            data-testid=\"message-status-read-by-many\"\n          >\n            {readBy.length - 1}\n          </span>\n        )}\n      </span>\n    );\n  }\n  if (\n    message &&\n    message.status === 'received' &&\n    message.id === lastReceivedId &&\n    !threadList\n  ) {\n    return (\n      <span\n        className=\"str-chat__message-simple-status\"\n        data-testid=\"message-status-received\"\n      >\n        <Tooltip>{t && t('Delivered')}</Tooltip>\n        <DeliveredCheckIcon />\n      </span>\n    );\n  }\n  return null;\n};\n\nMessageSimple.propTypes = {\n  /** The [message object](https://getstream.io/chat/docs/#message_format) */\n  message: /** @type {PropTypes.Validator<import('stream-chat').MessageResponse>} */ (PropTypes\n    .object.isRequired),\n  /**\n   * The attachment UI component.\n   * Default: [Attachment](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment.js)\n   * */\n  Attachment: /** @type {PropTypes.Validator<React.ElementType<import('types').AttachmentUIComponentProps>>} */ (PropTypes.elementType),\n  /**\n   * @deprecated Its not recommended to use this anymore. All the methods in this HOC are provided explicitly.\n   *\n   * The higher order message component, most logic is delegated to this component\n   * @see See [Message HOC](https://getstream.github.io/stream-chat-react/#message) for example\n   *\n   * */\n  Message: /** @type {PropTypes.Validator<React.ElementType<import('types').MessageUIComponentProps>>} */ (PropTypes.oneOfType(\n    [PropTypes.node, PropTypes.func, PropTypes.object],\n  )),\n  /** render HTML instead of markdown. Posting HTML is only allowed server-side */\n  unsafeHTML: PropTypes.bool,\n  /** Client object */\n  // @ts-ignore\n  client: PropTypes.object,\n  /** If its parent message in thread. */\n  initialMessage: PropTypes.bool,\n  /** Channel config object */\n  channelConfig: /** @type {PropTypes.Validator<import('stream-chat').ChannelConfig>} */ (PropTypes.object),\n  /** Override the default formatting of the date. This is a function that has access to the original date object. Returns a string or Node  */\n  formatDate: PropTypes.func,\n  /** If component is in thread list */\n  threadList: PropTypes.bool,\n  /**\n   * Function to open thread on current messxage\n   * @deprecated The component now relies on the useThreadHandler custom hook\n   * You can customize the behaviour for your thread handler on the <Channel> component instead.\n   */\n  handleOpenThread: PropTypes.func,\n  /** If the message is in edit state */\n  editing: PropTypes.bool,\n  /** Function to exit edit state */\n  clearEditingState: PropTypes.func,\n  /** Returns true if message belongs to current user */\n  isMyMessage: PropTypes.func,\n  /**\n   * Returns all allowed actions on message by current user e.g., [edit, delete, flag, mute]\n   * Please check [Message](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message.js) component for default implementation.\n   * */\n  getMessageActions: PropTypes.func.isRequired,\n  /**\n   * Function to publish updates on message to channel\n   *\n   * @param message Updated [message object](https://getstream.io/chat/docs/#message_format)\n   * */\n  updateMessage: PropTypes.func,\n  /**\n   * Reattempt sending a message\n   * @param message A [message object](https://getstream.io/chat/docs/#message_format) to resent.\n   * @deprecated This component now relies on the useRetryHandler custom hook.\n   */\n  handleRetry: PropTypes.func,\n  /**\n   * Add or remove reaction on message\n   *\n   * @param type Type of reaction - 'like' | 'love' | 'haha' | 'wow' | 'sad' | 'angry'\n   * @param event Dom event which triggered this function\n   * @deprecated This component now relies on the useReactionHandler custom hook.\n   */\n  handleReaction: PropTypes.func,\n  /**\n   * A component to display the selector that allows a user to react to a certain message.\n   */\n  ReactionSelector: /** @type {PropTypes.Validator<React.ElementType<import('types').ReactionSelectorProps>>} */ (PropTypes.elementType),\n  /**\n   * A component to display the a message list of reactions.\n   */\n  ReactionsList: /** @type {PropTypes.Validator<React.ElementType<import('types').ReactionsListProps>>} */ (PropTypes.elementType),\n  /** If actions such as edit, delete, flag, mute are enabled on message */\n  actionsEnabled: PropTypes.bool,\n  /** DOMRect object for parent MessageList component */\n  messageListRect: PropTypes.shape({\n    x: PropTypes.number.isRequired,\n    y: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired,\n    width: PropTypes.number.isRequired,\n    top: PropTypes.number.isRequired,\n    right: PropTypes.number.isRequired,\n    bottom: PropTypes.number.isRequired,\n    left: PropTypes.number.isRequired,\n    toJSON: PropTypes.func.isRequired,\n  }),\n  /**\n   * @param name {string} Name of action\n   * @param value {string} Value of action\n   * @param event Dom event that triggered this handler\n   * @deprecated This component now relies on the useActionHandler custom hook, and this prop will be removed on the next major release.\n   */\n  handleAction: PropTypes.func,\n  /**\n   * The handler for hover event on @mention in message\n   *\n   * @param event Dom hover event which triggered handler.\n   * @param user Target user object\n   * @deprecated This component now relies on the useMentionsHandler custom hook, and this prop will be removed on the next major release.\n   * You can customize the behaviour for your mention handler on the <Channel> component instead.\n   */\n  onMentionsHoverMessage: PropTypes.func,\n  /**\n   * The handler for click event on @mention in message\n   *\n   * @param event Dom click event which triggered handler.\n   * @param user Target user object\n   * @deprecated This component now relies on the useMentionsHandler custom hook, and this prop will be removed on the next major release.\n   * You can customize the behaviour for your mention handler on the <Channel> component instead.\n   */\n  onMentionsClickMessage: PropTypes.func,\n  /**\n   * The handler for click event on the user that posted the message\n   *\n   * @param event Dom click event which triggered handler.\n   */\n  onUserClick: PropTypes.func,\n  /**\n   * The handler for mouseOver event on the user that posted the message\n   *\n   * @param event Dom mouseOver event which triggered handler.\n   */\n  onUserHover: PropTypes.func,\n  /**\n   * Additional props for underlying MessageInput component.\n   * Available props - https://getstream.github.io/stream-chat-react/#messageinput\n   * */\n  additionalMessageInputProps: PropTypes.object,\n  /**\n   * The component that will be rendered if the message has been deleted.\n   * All of Message's props are passed into this component.\n   */\n  MessageDeleted: /** @type {PropTypes.Validator<React.ElementType<import('types').MessageDeletedProps>>} */ (PropTypes.elementType),\n};\n\nexport default React.memo(MessageSimple, areMessagePropsEqual);\n","// @ts-check\nimport React, { useCallback, useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport { Channel, StreamChat } from 'stream-chat';\nimport { ChannelContext } from '../../context';\nimport MessageSimple from './MessageSimple';\nimport {\n  MESSAGE_ACTIONS,\n  getMessageActions,\n  areMessagePropsEqual,\n} from './utils';\nimport {\n  useMuteHandler,\n  useEditHandler,\n  useReactionHandler,\n  useDeleteHandler,\n  useActionHandler,\n  useRetryHandler,\n  useMentionsHandler,\n  useUserHandler,\n  useOpenThreadHandler,\n  useUserRole,\n  useFlagHandler,\n} from './hooks';\n\n/**\n * Message - A high level component which implements all the logic required for a message.\n * The actual rendering of the message is delegated via the \"Message\" property\n *\n * @example ../../docs/Message.md\n * @type { React.FC<import('types').MessageComponentProps> }\n */\nconst Message = (props) => {\n  const {\n    addNotification,\n    getFlagMessageErrorNotification,\n    getFlagMessageSuccessNotification,\n    getMuteUserErrorNotification,\n    getMuteUserSuccessNotification,\n    message,\n    channel: propChannel,\n    onUserClick: propOnUserClick,\n    onUserHover: propOnUserHover,\n    openThread: propOpenThread,\n    retrySendMessage: propRetrySendMessage,\n    onMentionsClick: propOnMentionsClick,\n    onMentionsHover: propOnMentionsHover,\n    Message: MessageUIComponent = MessageSimple,\n    messageActions = Object.keys(MESSAGE_ACTIONS),\n    formatDate,\n    groupStyles = [],\n  } = props;\n  const { channel: contextChannel } = useContext(ChannelContext);\n  const channel = propChannel || contextChannel;\n  const channelConfig = channel?.getConfig && channel.getConfig();\n  const { editing, setEdit, clearEdit } = useEditHandler();\n  const handleDelete = useDeleteHandler(message);\n  const handleReaction = useReactionHandler(message);\n  const handleAction = useActionHandler(message);\n  const handleRetry = useRetryHandler(propRetrySendMessage);\n  const handleOpenThread = useOpenThreadHandler(message, propOpenThread);\n  const handleFlag = useFlagHandler(message, {\n    notify: addNotification,\n    getSuccessNotification: getFlagMessageSuccessNotification,\n    getErrorNotification: getFlagMessageErrorNotification,\n  });\n  const handleMute = useMuteHandler(message, {\n    notify: addNotification,\n    getSuccessNotification: getMuteUserSuccessNotification,\n    getErrorNotification: getMuteUserErrorNotification,\n  });\n  const { onMentionsClick, onMentionsHover } = useMentionsHandler(message, {\n    onMentionsClick: propOnMentionsClick,\n    onMentionsHover: propOnMentionsHover,\n  });\n  const { onUserClick, onUserHover } = useUserHandler(message, {\n    onUserClickHandler: propOnUserClick,\n    onUserHoverHandler: propOnUserHover,\n  });\n  const { isMyMessage, isAdmin, isModerator, isOwner } = useUserRole(message);\n  const canEdit = isMyMessage || isModerator || isOwner || isAdmin;\n  const canDelete = canEdit;\n  const messageActionsHandler = useCallback(() => {\n    if (!message || !messageActions) {\n      return [];\n    }\n\n    return getMessageActions(messageActions, {\n      canDelete,\n      canEdit,\n      canFlag: !isMyMessage,\n      canMute: !isMyMessage && !!channelConfig?.mutes,\n    });\n  }, [channelConfig, message, messageActions, canDelete, canEdit, isMyMessage]);\n\n  const actionsEnabled =\n    message && message.type === 'regular' && message.status === 'received';\n\n  return (\n    MessageUIComponent && (\n      <MessageUIComponent\n        {...props}\n        editing={editing}\n        formatDate={formatDate}\n        clearEditingState={clearEdit}\n        setEditingState={setEdit}\n        groupStyles={groupStyles}\n        actionsEnabled={actionsEnabled}\n        Message={MessageUIComponent}\n        handleReaction={handleReaction}\n        getMessageActions={messageActionsHandler}\n        handleFlag={handleFlag}\n        handleMute={handleMute}\n        handleAction={handleAction}\n        handleDelete={handleDelete}\n        handleEdit={setEdit}\n        handleRetry={handleRetry}\n        handleOpenThread={handleOpenThread}\n        isMyMessage={() => isMyMessage}\n        channelConfig={channelConfig}\n        onMentionsClickMessage={onMentionsClick}\n        onMentionsHoverMessage={onMentionsHover}\n        onUserClick={onUserClick}\n        onUserHover={onUserHover}\n      />\n    )\n  );\n};\n\nMessage.propTypes = {\n  /** The message object */\n  message: /** @type {PropTypes.Validator<import('stream-chat').MessageResponse>} */ (PropTypes.shape(\n    {\n      text: PropTypes.string.isRequired,\n      html: PropTypes.string.isRequired,\n      type: PropTypes.string.isRequired,\n      reaction_counts: PropTypes.objectOf(PropTypes.number.isRequired),\n      reaction_scores: PropTypes.objectOf(PropTypes.number.isRequired),\n      created_at: PropTypes.string.isRequired,\n      updated_at: PropTypes.string.isRequired,\n    },\n  ).isRequired),\n  /** The client connection object for connecting to Stream */\n  client: PropTypes.instanceOf(StreamChat).isRequired,\n  /** The current channel this message is displayed in */\n  channel: PropTypes.instanceOf(Channel).isRequired,\n  /** A list of users that have read this message */\n  readBy: PropTypes.array,\n  /** groupStyles, a list of styles to apply to this message. ie. top, bottom, single etc */\n  groupStyles: PropTypes.array,\n\n  /** Override the default formatting of the date. This is a function that has access to the original date object. Returns a string or Node  */\n  formatDate: PropTypes.func,\n  /**\n   * Message UI component to display a message in message list.\n   * Available from [channel context](https://getstream.github.io/stream-chat-react/#channelcontext)\n   * */\n  Message: /** @type {PropTypes.Validator<React.ElementType<import('types').MessageUIComponentProps>>} */ (PropTypes.elementType),\n  /**\n   * The component that will be rendered if the message has been deleted.\n   * All props are passed into this component.\n   */\n  MessageDeleted: /** @type {PropTypes.Validator<React.ElementType<import('types').MessageDeletedProps>>} */ (PropTypes.elementType),\n\n  /**\n   * A component to display the selector that allows a user to react to a certain message.\n   */\n  ReactionSelector: /** @type {PropTypes.Validator<React.ElementType<import('types').ReactionSelectorProps>>} */ (PropTypes.elementType),\n  /**\n   * A component to display the a message list of reactions.\n   */\n  ReactionsList: /** @type {PropTypes.Validator<React.ElementType<import('types').ReactionsListProps>>} */ (PropTypes.elementType),\n  /**\n   * Attachment UI component to display attachment in individual message.\n   * Available from [channel context](https://getstream.github.io/stream-chat-react/#channelcontext)\n   * */\n  Attachment: /** @type {PropTypes.Validator<React.ElementType<import('types').AttachmentUIComponentProps>>} */ (PropTypes.elementType),\n  /** render HTML instead of markdown. Posting HTML is only allowed server-side */\n  unsafeHTML: PropTypes.bool,\n  /**\n   * Array of allowed actions on message. e.g. ['edit', 'delete', 'mute', 'flag']\n   * If all the actions need to be disabled, empty array or false should be provided as value of prop.\n   * */\n  messageActions: PropTypes.oneOfType([PropTypes.bool, PropTypes.array]),\n  /**\n   * Function that returns message/text as string to be shown as notification, when request for flagging a message is successful\n   *\n   * This function should accept following params:\n   *\n   * @param message A [message object](https://getstream.io/chat/docs/#message_format) which is flagged.\n   *\n   * */\n  getFlagMessageSuccessNotification: PropTypes.func,\n  /**\n   * Function that returns message/text as string to be shown as notification, when request for flagging a message runs into error\n   *\n   * This function should accept following params:\n   *\n   * @param message A [message object](https://getstream.io/chat/docs/#message_format) which is flagged.\n   *\n   * */\n  getFlagMessageErrorNotification: PropTypes.func,\n  /**\n   * Function that returns message/text as string to be shown as notification, when request for muting a user is successful\n   *\n   * This function should accept following params:\n   *\n   * @param user A user object which is being muted\n   *\n   * */\n  getMuteUserSuccessNotification: PropTypes.func,\n  /**\n   * Function that returns message/text as string to be shown as notification, when request for muting a user runs into error\n   *\n   * This function should accept following params:\n   *\n   * @param user A user object which is being muted\n   *\n   * */\n  getMuteUserErrorNotification: PropTypes.func,\n  /** Latest message id on current channel */\n  lastReceivedId: PropTypes.string,\n  /** DOMRect object for parent MessageList component */\n  messageListRect: /** @type {PropTypes.Validator<DOMRect>} */ (PropTypes.object),\n  /** @see See [Channel Context](https://getstream.github.io/stream-chat-react/#channelcontext) */\n  members: /** @type {PropTypes.Validator<import('seamless-immutable').ImmutableObject<{[user_id: string]: import('stream-chat').Member}> | null | undefined>} */ (PropTypes.object),\n  /**\n   * Function to add custom notification on messagelist\n   *\n   * @param text Notification text to display\n   * @param type Type of notification. 'success' | 'error'\n   * */\n  addNotification: PropTypes.func,\n  /** @see See [Channel Context](https://getstream.github.io/stream-chat-react/#channelcontext) */\n  updateMessage: PropTypes.func,\n  /** @see See [Channel Context](https://getstream.github.io/stream-chat-react/#channelcontext) */\n  removeMessage: PropTypes.func,\n  /** @see See [Channel Context](https://getstream.github.io/stream-chat-react/#channelcontext) */\n  retrySendMessage: PropTypes.func,\n  /** @see See [Channel Context](https://getstream.github.io/stream-chat-react/#channelcontext) */\n  onMentionsClick: PropTypes.func,\n  /** @see See [Channel Context](https://getstream.github.io/stream-chat-react/#channelcontext) */\n  onMentionsHover: PropTypes.func,\n  /**\n   * The handler for click event on the user that posted the message\n   *\n   * @param event Dom click event which triggered handler.\n   * @param user the User object for the corresponding user.\n   */\n  onUserClick: PropTypes.func,\n  /**\n   * The handler for hover events on the user that posted the message\n   *\n   * @param event Dom hover event which triggered handler.\n   * @param user the User object for the corresponding user.\n   */\n  onUserHover: PropTypes.func,\n  /** @see See [Channel Context](https://getstream.github.io/stream-chat-react/#channelcontext) */\n  openThread: PropTypes.func,\n  /**\n   * Additional props for underlying MessageInput component.\n   * Available props - https://getstream.github.io/stream-chat-react/#messageinput\n   * */\n  additionalMessageInputProps: PropTypes.object,\n};\n\nMessage.defaultProps = {\n  Message: MessageSimple,\n  readBy: [],\n  groupStyles: [],\n  messageActions: Object.keys(MESSAGE_ACTIONS),\n};\n\nexport default React.memo(Message, areMessagePropsEqual);\n","// @ts-check\nimport React, { useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { smartRender } from '../../utils';\nimport { Attachment as DefaultAttachment } from '../Attachment';\nimport { Avatar } from '../Avatar';\nimport { Gallery } from '../Gallery';\nimport {\n  ReactionsList as DefaultReactionsList,\n  ReactionSelector as DefaultReactionSelector,\n} from '../Reactions';\nimport MessageRepliesCountButton from './MessageRepliesCountButton';\nimport {\n  areMessagePropsEqual,\n  messageHasReactions,\n  messageHasAttachments,\n  getImages,\n} from './utils';\nimport MessageOptions from './MessageOptions';\nimport MessageText from './MessageText';\nimport {\n  useUserRole,\n  useReactionClick,\n  useReactionHandler,\n  useActionHandler,\n  useOpenThreadHandler,\n  useUserHandler,\n} from './hooks';\nimport MessageTimestamp from './MessageTimestamp';\n\n/**\n * MessageCommerce - Render component, should be used together with the Message component\n *\n * @example ../../docs/MessageCommerce.md\n * @type { React.FC<import('types').MessageCommerceProps> }\n */\nconst MessageCommerce = (props) => {\n  const {\n    message,\n    formatDate,\n    groupStyles,\n    actionsEnabled,\n    threadList,\n    MessageDeleted,\n    getMessageActions,\n    ReactionsList = DefaultReactionsList,\n    ReactionSelector = DefaultReactionSelector,\n    handleReaction: propHandleReaction,\n    handleAction: propHandleAction,\n    handleOpenThread: propHandleOpenThread,\n    onUserClick: propOnUserClick,\n    onUserHover: propOnUserHover,\n    tDateTimeParser: propTDateTimeParser,\n  } = props;\n  const Attachment = props.Attachment || DefaultAttachment;\n  const hasReactions = messageHasReactions(message);\n  const handleAction = useActionHandler(message);\n  const handleReaction = useReactionHandler(message);\n  const handleOpenThread = useOpenThreadHandler(message);\n  const reactionSelectorRef = useRef(null);\n  const { onReactionListClick, showDetailedReactions } = useReactionClick(\n    message,\n    reactionSelectorRef,\n  );\n  const { onUserClick, onUserHover } = useUserHandler(message, {\n    onUserClickHandler: propOnUserClick,\n    onUserHoverHandler: propOnUserHover,\n  });\n  const { isMyMessage } = useUserRole(message);\n  const messageClasses = `str-chat__message-commerce str-chat__message-commerce--${\n    isMyMessage ? 'right' : 'left'\n  }`;\n\n  const hasAttachment = messageHasAttachments(message);\n  const images = getImages(message);\n\n  const firstGroupStyle = groupStyles ? groupStyles[0] : '';\n\n  if (message?.deleted_at) {\n    return smartRender(MessageDeleted, props, null);\n  }\n\n  if (\n    message &&\n    (message.type === 'message.read' || message.type === 'message.date')\n  ) {\n    return null;\n  }\n\n  // eslint-disable-next-line sonarjs/cognitive-complexity\n  return (\n    <React.Fragment>\n      <div\n        data-testid=\"message-commerce-wrapper\"\n        key={message?.id || ''}\n        className={`\n\t\t\t\t\t\t${messageClasses}\n\t\t\t\t\t\tstr-chat__message-commerce--${message?.type}\n\t\t\t\t\t\t${\n              message?.text\n                ? 'str-chat__message-commerce--has-text'\n                : 'str-chat__message-commerce--has-no-text'\n            }\n\t\t\t\t\t\t${hasAttachment ? 'str-chat__message-commerce--has-attachment' : ''}\n\t\t\t\t\t\t${hasReactions ? 'str-chat__message-commerce--with-reactions' : ''}\n\t\t\t\t\t\t${`str-chat__message-commerce--${firstGroupStyle}`}\n\t\t\t\t\t`.trim()}\n      >\n        {(firstGroupStyle === 'bottom' || firstGroupStyle === 'single') && (\n          <Avatar\n            image={message?.user?.image}\n            size={32}\n            name={message?.user?.name || message?.user?.id}\n            onClick={onUserClick}\n            onMouseOver={onUserHover}\n          />\n        )}\n        <div className=\"str-chat__message-commerce-inner\">\n          {message && !message.text && (\n            <React.Fragment>\n              {\n                <MessageOptions\n                  {...props}\n                  displayLeft={false}\n                  displayReplies={false}\n                  displayActions={false}\n                  onReactionListClick={onReactionListClick}\n                  theme={'commerce'}\n                />\n              }\n              {/* if reactions show them */}\n              {hasReactions && !showDetailedReactions && (\n                <ReactionsList\n                  reactions={message.latest_reactions}\n                  reaction_counts={message.reaction_counts}\n                  onClick={onReactionListClick}\n                />\n              )}\n              {showDetailedReactions && (\n                <ReactionSelector\n                  reverse={false}\n                  handleReaction={propHandleReaction || handleReaction}\n                  detailedView\n                  reaction_counts={message.reaction_counts}\n                  latest_reactions={message.latest_reactions}\n                  ref={reactionSelectorRef}\n                />\n              )}\n            </React.Fragment>\n          )}\n\n          {message?.attachments &&\n            (!images || images.length <= 1) &&\n            message.attachments.map((attachment, index) => (\n              <Attachment\n                key={`${message.id}-${index}`}\n                attachment={attachment}\n                actionHandler={propHandleAction || handleAction}\n              />\n            ))}\n\n          {!!images.length && <Gallery images={images} />}\n\n          {message?.text && (\n            <MessageText\n              ReactionSelector={ReactionSelector}\n              ReactionsList={ReactionsList}\n              actionsEnabled={actionsEnabled}\n              customWrapperClass=\"str-chat__message-commerce-text\"\n              customInnerClass=\"str-chat__message-commerce-text-inner\"\n              customOptionProps={{\n                displayLeft: false,\n                displayReplies: false,\n                displayActions: false,\n                theme: 'commerce',\n              }}\n              getMessageActions={getMessageActions}\n              message={message}\n              messageListRect={props.messageListRect}\n              unsafeHTML={props.unsafeHTML}\n              onMentionsClickMessage={props.onMentionsClickMessage}\n              onMentionsHoverMessage={props.onMentionsHoverMessage}\n              theme=\"commerce\"\n            />\n          )}\n          {!threadList && (\n            <div className=\"str-chat__message-commerce-reply-button\">\n              <MessageRepliesCountButton\n                onClick={propHandleOpenThread || handleOpenThread}\n                reply_count={message?.reply_count}\n              />\n            </div>\n          )}\n          <div className=\"str-chat__message-commerce-data\">\n            {!isMyMessage ? (\n              <span className=\"str-chat__message-commerce-name\">\n                {message?.user?.name || message?.user?.id}\n              </span>\n            ) : null}\n            <MessageTimestamp\n              formatDate={formatDate}\n              customClass=\"str-chat__message-commerce-timestamp\"\n              message={message}\n              tDateTimeParser={propTDateTimeParser}\n              format=\"LT\"\n            />\n          </div>\n        </div>\n      </div>\n    </React.Fragment>\n  );\n};\n\nMessageCommerce.propTypes = {\n  /** The [message object](https://getstream.io/chat/docs/#message_format) */\n  message: /** @type {PropTypes.Validator<import('stream-chat').MessageResponse>} */ (PropTypes\n    .object.isRequired),\n  /**\n   * The attachment UI component.\n   * Default: [Attachment](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment.js)\n   * */\n  Attachment: /** @type {PropTypes.Validator<React.ElementType<import('types').AttachmentUIComponentProps>>} */ (PropTypes.elementType),\n  /**\n   *\n   * @deprecated Its not recommended to use this anymore. All the methods in this HOC are provided explicitly.\n   *\n   * The higher order message component, most logic is delegated to this component\n   * @see See [Message HOC](https://getstream.github.io/stream-chat-react/#message) for example\n   *\n   */\n  Message: /** @type {PropTypes.Validator<React.ElementType<import('types').MessageUIComponentProps>>} */ (PropTypes.oneOfType(\n    [PropTypes.node, PropTypes.func, PropTypes.object],\n  )),\n  /** render HTML instead of markdown. Posting HTML is only allowed server-side */\n  unsafeHTML: PropTypes.bool,\n  /** If its parent message in thread. */\n  initialMessage: PropTypes.bool,\n  /** Channel config object */\n  channelConfig: /** @type {PropTypes.Validator<import('stream-chat').ChannelConfig>} */ (PropTypes.object),\n\n  /** Override the default formatting of the date. This is a function that has access to the original date object. Returns a string or Node  */\n  formatDate: PropTypes.func,\n\n  /** If component is in thread list */\n  threadList: PropTypes.bool,\n  /**\n   * Function to open thread on current messxage\n   * @deprecated The component now relies on the useThreadHandler custom hook\n   * You can customize the behaviour for your thread handler on the <Channel> component instead.\n   */\n  handleOpenThread: PropTypes.func,\n  /** Returns true if message belongs to current user */\n  isMyMessage: PropTypes.func,\n  /** Returns all allowed actions on message by current user e.g., [edit, delete, flag, mute] */\n  getMessageActions: PropTypes.func.isRequired,\n  /**\n   * Add or remove reaction on message\n   *\n   * @param type Type of reaction - 'like' | 'love' | 'haha' | 'wow' | 'sad' | 'angry'\n   * @param event Dom event which triggered this function\n   * @deprecated This component now relies on the useReactionHandler custom hook.\n   */\n  handleReaction: PropTypes.func,\n  /**\n   * A component to display the selector that allows a user to react to a certain message.\n   */\n  ReactionSelector: /** @type {PropTypes.Validator<React.ElementType<import('types').ReactionSelectorProps>>} */ (PropTypes.elementType),\n  /**\n   * A component to display the a message list of reactions.\n   */\n  ReactionsList: /** @type {PropTypes.Validator<React.ElementType<import('types').ReactionsListProps>>} */ (PropTypes.elementType),\n  /** If actions such as edit, delete, flag, mute are enabled on message */\n  actionsEnabled: PropTypes.bool,\n  /**\n   * @param name {string} Name of action\n   * @param value {string} Value of action\n   * @param event Dom event that triggered this handler\n   * @deprecated This component now relies on the useActionHandler custom hook, and this prop will be removed on the next major release.\n   */\n  handleAction: PropTypes.func,\n  /**\n   * The handler for hover event on @mention in message\n   *\n   * @param event Dom hover event which triggered handler.\n   * @param user Target user object\n   */\n  onMentionsHoverMessage: PropTypes.func,\n  /**\n   * The handler for click event on @mention in message\n   *\n   * @param event Dom click event which triggered handler.\n   * @param user Target user object\n   */\n  onMentionsClickMessage: PropTypes.func,\n  /** Position of message in group. Possible values: top, bottom, middle, single */\n  groupStyles: PropTypes.array,\n  /**\n   * The handler for click event on the user that posted the message\n   *\n   * @param event Dom click event which triggered handler.\n   * @deprecated This component now relies on the useUserHandler custom hook, and this prop will be removed on the next major release.\n   */\n  onUserClick: PropTypes.func,\n  /**\n   * The handler for mouseOver event on the user that posted the message\n   *\n   * @param event Dom mouseOver event which triggered handler.\n   * @deprecated This component now relies on the useUserHandler custom hook, and this prop will be removed on the next major release.\n   */\n  onUserHover: PropTypes.func,\n  /** The component that will be rendered if the message has been deleted.\n   * All of Message's props are passed into this component.\n   */\n  MessageDeleted: /** @type {PropTypes.Validator<React.ElementType<import('types').MessageDeletedProps>>} */ (PropTypes.elementType),\n};\n\nexport default React.memo(MessageCommerce, areMessagePropsEqual);\n","// @ts-check\nimport React, {\n  useCallback,\n  useEffect,\n  useContext,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport PropTypes from 'prop-types';\n\nimport MessageRepliesCountButton from './MessageRepliesCountButton';\n\nimport { isOnlyEmojis, renderText, smartRender } from '../../utils';\nimport { ChannelContext, TranslationContext } from '../../context';\n\nimport { Avatar } from '../Avatar';\nimport { Attachment as DefaultAttachment } from '../Attachment';\nimport { Gallery } from '../Gallery';\nimport { MessageInput, EditMessageForm } from '../MessageInput';\nimport {\n  SimpleReactionsList as DefaultReactionsList,\n  ReactionSelector as DefaultReactionSelector,\n} from '../Reactions';\nimport {\n  useReactionHandler,\n  useUserHandler,\n  useRetryHandler,\n  useOpenThreadHandler,\n  useActionHandler,\n  useReactionClick,\n  useMentionsUIHandler,\n  useEditHandler,\n} from './hooks';\nimport {\n  messageHasAttachments,\n  getImages,\n  getNonImageAttachments,\n  areMessagePropsEqual,\n} from './utils';\nimport { MessageActions } from '../MessageActions';\nimport { ReactionIcon, ThreadIcon, ErrorIcon } from './icons';\nimport MessageTimestamp from './MessageTimestamp';\n\n/**\n * MessageLivestream - Render component, should be used together with the Message component\n * Implements the look and feel for a livestream use case.\n *\n * @example ../../docs/MessageLivestream.md\n * @typedef { import('../../../types').MessageLivestreamProps } Props\n * @type { React.FC<Props> }\n */\n// eslint-disable-next-line sonarjs/cognitive-complexity\nconst MessageLivestreamComponent = (props) => {\n  const {\n    message,\n    groupStyles,\n    editing: propEditing,\n    setEditingState: propSetEdit,\n    clearEditingState: propClearEdit,\n    initialMessage,\n    unsafeHTML,\n    formatDate,\n    channelConfig: propChannelConfig,\n    ReactionsList = DefaultReactionsList,\n    ReactionSelector = DefaultReactionSelector,\n    onUserClick: propOnUserClick,\n    handleReaction: propHandleReaction,\n    handleOpenThread: propHandleOpenThread,\n    onUserHover: propOnUserHover,\n    handleRetry: propHandleRetry,\n    handleAction: propHandleAction,\n    updateMessage: propUpdateMessage,\n    onMentionsClickMessage: propOnMentionsClick,\n    onMentionsHoverMessage: propOnMentionsHover,\n    Attachment = DefaultAttachment,\n    t: propT,\n    tDateTimeParser: propTDateTimeParser,\n    MessageDeleted,\n  } = props;\n  const { t: contextT } = useContext(TranslationContext);\n  const t = propT || contextT;\n  const messageWrapperRef = useRef(null);\n  const reactionSelectorRef = useRef(null);\n  /**\n   *@type {import('types').ChannelContextValue}\n   */\n  const { updateMessage: channelUpdateMessage, channel } = useContext(\n    ChannelContext,\n  );\n  const channelConfig = propChannelConfig || channel?.getConfig();\n  const { onMentionsClick, onMentionsHover } = useMentionsUIHandler(message, {\n    onMentionsClick: propOnMentionsClick,\n    onMentionsHover: propOnMentionsHover,\n  });\n  const handleAction = useActionHandler(message);\n  const handleReaction = useReactionHandler(message);\n  const handleOpenThread = useOpenThreadHandler(message);\n  const {\n    editing: ownEditing,\n    setEdit: ownSetEditing,\n    clearEdit: ownClearEditing,\n  } = useEditHandler();\n  const editing = propEditing || ownEditing;\n  const setEdit = propSetEdit || ownSetEditing;\n  const clearEdit = propClearEdit || ownClearEditing;\n  const handleRetry = useRetryHandler();\n  const retryHandler = propHandleRetry || handleRetry;\n  const { onReactionListClick, showDetailedReactions } = useReactionClick(\n    message,\n    reactionSelectorRef,\n    messageWrapperRef,\n  );\n  const { onUserClick, onUserHover } = useUserHandler(message, {\n    onUserClickHandler: propOnUserClick,\n    onUserHoverHandler: propOnUserHover,\n  });\n  const messageText = useMemo(\n    () => renderText(message?.text, message?.mentioned_users),\n    [message?.text, message?.mentioned_users],\n  );\n\n  const hasAttachment = messageHasAttachments(message);\n  const galleryImages = getImages(message);\n  const attachments = getNonImageAttachments(message);\n  const firstGroupStyle = groupStyles ? groupStyles[0] : '';\n\n  if (\n    !message ||\n    message.type === 'message.read' ||\n    message.type === 'message.date'\n  ) {\n    return null;\n  }\n\n  if (message.deleted_at) {\n    return smartRender(MessageDeleted, props, null);\n  }\n  if (editing) {\n    return (\n      <div\n        data-testid={'message-livestream-edit'}\n        className={`str-chat__message-team str-chat__message-team--${firstGroupStyle} str-chat__message-team--editing`}\n      >\n        {(firstGroupStyle === 'top' || firstGroupStyle === 'single') && (\n          <div className=\"str-chat__message-team-meta\">\n            <Avatar\n              image={message.user?.image}\n              name={message.user?.name || message.user?.id}\n              size={40}\n              onClick={onUserClick}\n              onMouseOver={onUserHover}\n            />\n          </div>\n        )}\n        <MessageInput\n          Input={EditMessageForm}\n          message={message}\n          clearEditingState={clearEdit}\n          updateMessage={propUpdateMessage || channelUpdateMessage}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <React.Fragment>\n      <div\n        data-testid=\"message-livestream\"\n        className={`str-chat__message-livestream str-chat__message-livestream--${firstGroupStyle} str-chat__message-livestream--${\n          message.type\n        } str-chat__message-livestream--${message.status} ${\n          initialMessage ? 'str-chat__message-livestream--initial-message' : ''\n        }`}\n        ref={messageWrapperRef}\n      >\n        {showDetailedReactions && (\n          <ReactionSelector\n            reverse={false}\n            handleReaction={handleReaction}\n            detailedView\n            latest_reactions={message?.latest_reactions}\n            reaction_counts={message?.reaction_counts}\n            ref={reactionSelectorRef}\n          />\n        )}\n        <MessageLivestreamActions\n          initialMessage={initialMessage}\n          message={message}\n          formatDate={formatDate}\n          onReactionListClick={onReactionListClick}\n          messageWrapperRef={messageWrapperRef}\n          getMessageActions={props.getMessageActions}\n          tDateTimeParser={propTDateTimeParser}\n          channelConfig={channelConfig}\n          threadList={props.threadList}\n          handleOpenThread={propHandleOpenThread || handleOpenThread}\n          setEditingState={setEdit}\n        />\n        <div className=\"str-chat__message-livestream-left\">\n          <Avatar\n            image={message.user?.image}\n            name={message.user?.name || message?.user?.id}\n            size={30}\n            onClick={onUserClick}\n            onMouseOver={onUserHover}\n          />\n        </div>\n        <div className=\"str-chat__message-livestream-right\">\n          <div className=\"str-chat__message-livestream-content\">\n            <div className=\"str-chat__message-livestream-author\">\n              <strong>{message.user?.name || message.user?.id}</strong>\n              {message?.type === 'error' && (\n                <div className=\"str-chat__message-team-error-header\">\n                  {t('Only visible to you')}\n                </div>\n              )}\n            </div>\n\n            <div\n              data-testid=\"message-livestream-text\"\n              className={\n                isOnlyEmojis(message.text)\n                  ? 'str-chat__message-livestream-text--is-emoji'\n                  : ''\n              }\n              onMouseOver={onMentionsHover}\n              onClick={onMentionsClick}\n            >\n              {message.type !== 'error' &&\n                message.status !== 'failed' &&\n                !unsafeHTML &&\n                messageText}\n\n              {message.type !== 'error' &&\n                message.status !== 'failed' &&\n                unsafeHTML && (\n                  <div dangerouslySetInnerHTML={{ __html: message.html }} />\n                )}\n\n              {message.type === 'error' && !message.command && (\n                <p data-testid=\"message-livestream-error\">\n                  <ErrorIcon />\n                  {message.text}\n                </p>\n              )}\n\n              {message.type === 'error' && message.command && (\n                <p data-testid=\"message-livestream-command-error\">\n                  <ErrorIcon />\n                  {/* TODO: Translate following sentence */}\n                  <strong>/{message.command}</strong> is not a valid command\n                </p>\n              )}\n              {message.status === 'failed' && (\n                <p\n                  onClick={() => {\n                    if (retryHandler) {\n                      // FIXME: type checking fails here because in the case of a failed message,\n                      // `message` is of type Client.Message (i.e. request object)\n                      // instead of Client.MessageResponse (i.e. server response object)\n                      // @ts-ignore\n                      retryHandler(message);\n                    }\n                  }}\n                >\n                  <ErrorIcon />\n                  {t('Message failed. Click to try again.')}\n                </p>\n              )}\n            </div>\n\n            {hasAttachment &&\n              attachments.map(\n                /** @type {(item: import('stream-chat').Attachment) => React.ReactElement | null} Typescript syntax */\n                (attachment, index) => (\n                  <Attachment\n                    key={`${message?.id}-${index}`}\n                    attachment={attachment}\n                    actionHandler={propHandleAction || handleAction}\n                  />\n                ),\n              )}\n\n            {galleryImages.length !== 0 && <Gallery images={galleryImages} />}\n\n            <ReactionsList\n              reaction_counts={message.reaction_counts}\n              reactions={message.latest_reactions}\n              handleReaction={propHandleReaction || handleReaction}\n            />\n\n            {!initialMessage && (\n              <MessageRepliesCountButton\n                onClick={propHandleOpenThread || handleOpenThread}\n                reply_count={message.reply_count}\n              />\n            )}\n          </div>\n        </div>\n      </div>\n    </React.Fragment>\n  );\n};\n\n/**\n * @type { React.FC<import('types').MessageLivestreamActionProps> }\n */\nconst MessageLivestreamActions = (props) => {\n  const {\n    initialMessage,\n    message,\n    channelConfig,\n    threadList,\n    formatDate,\n    messageWrapperRef,\n    onReactionListClick,\n    getMessageActions,\n    handleOpenThread,\n    tDateTimeParser: propTDateTimeParser,\n  } = props;\n  const [actionsBoxOpen, setActionsBoxOpen] = useState(false);\n  /** @type {() => void} Typescript syntax */\n  const hideOptions = useCallback(() => setActionsBoxOpen(false), []);\n  const messageDeletedAt = !!message?.deleted_at;\n  const messageWrapper = messageWrapperRef?.current;\n  useEffect(() => {\n    if (messageWrapper) {\n      messageWrapper.addEventListener('mouseleave', hideOptions);\n    }\n\n    return () => {\n      if (messageWrapper) {\n        messageWrapper.removeEventListener('mouseleave', hideOptions);\n      }\n    };\n  }, [messageWrapper, hideOptions]);\n  useEffect(() => {\n    if (messageDeletedAt) {\n      document.removeEventListener('click', hideOptions);\n    }\n  }, [messageDeletedAt, hideOptions]);\n\n  useEffect(() => {\n    if (actionsBoxOpen) {\n      document.addEventListener('click', hideOptions);\n    } else {\n      document.removeEventListener('click', hideOptions);\n    }\n    return () => {\n      document.removeEventListener('click', hideOptions);\n    };\n  }, [actionsBoxOpen, hideOptions]);\n\n  if (\n    initialMessage ||\n    !message ||\n    message.type === 'error' ||\n    message.type === 'system' ||\n    message.type === 'ephemeral' ||\n    message.status === 'failed' ||\n    message.status === 'sending'\n  ) {\n    return null;\n  }\n\n  return (\n    <div\n      data-testid={'message-livestream-actions'}\n      className={`str-chat__message-livestream-actions`}\n    >\n      <MessageTimestamp\n        customClass=\"str-chat__message-livestream-time\"\n        message={message}\n        formatDate={formatDate}\n        tDateTimeParser={propTDateTimeParser}\n      />\n      {channelConfig && channelConfig.reactions && (\n        <span\n          onClick={onReactionListClick}\n          data-testid=\"message-livestream-reactions-action\"\n        >\n          <span>\n            <ReactionIcon />\n          </span>\n        </span>\n      )}\n      {!threadList && channelConfig && channelConfig.replies && (\n        <span\n          data-testid=\"message-livestream-thread-action\"\n          onClick={handleOpenThread}\n        >\n          <ThreadIcon />\n        </span>\n      )}\n      <MessageActions\n        {...props}\n        getMessageActions={getMessageActions}\n        customWrapperClass={''}\n        inline\n      />\n    </div>\n  );\n};\n\nMessageLivestreamComponent.propTypes = {\n  /** The [message object](https://getstream.io/chat/docs/#message_format) */\n  message: /** @type {PropTypes.Validator<import('stream-chat').MessageResponse>} */ (PropTypes\n    .object.isRequired),\n  /**\n   * The attachment UI component.\n   * Default: [Attachment](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment.js)\n   * */\n  Attachment: /** @type {PropTypes.Validator<React.ElementType<import('types').AttachmentUIComponentProps>>} */ (PropTypes.elementType),\n  /**\n   *\n   * @deprecated Its not recommended to use this anymore. All the methods in this HOC are provided explicitly.\n   *\n   * The higher order message component, most logic is delegated to this component\n   * @see See [Message HOC](https://getstream.github.io/stream-chat-react/#message) for example\n   *\n   * */\n  Message: /** @type {PropTypes.Validator<React.ElementType<import('types').MessageUIComponentProps>>} */ (PropTypes.oneOfType(\n    [PropTypes.node, PropTypes.func, PropTypes.object],\n  )),\n  /** render HTML instead of markdown. Posting HTML is only allowed server-side */\n  unsafeHTML: PropTypes.bool,\n  /** If its parent message in thread. */\n  initialMessage: PropTypes.bool,\n\n  /** Override the default formatting of the date. This is a function that has access to the original date object. Returns a string or Node  */\n  formatDate: PropTypes.func,\n\n  /** Channel config object */\n  channelConfig: /** @type {PropTypes.Validator<import('stream-chat').ChannelConfig>} */ (PropTypes.object),\n  /** If component is in thread list */\n  threadList: PropTypes.bool,\n  /** Function to open thread on current messxage */\n  handleOpenThread: PropTypes.func,\n  /** If the message is in edit state */\n  editing: PropTypes.bool,\n  /** Function to exit edit state */\n  clearEditingState: PropTypes.func,\n  /** Returns true if message belongs to current user */\n  isMyMessage: PropTypes.func,\n  /**\n   * Returns all allowed actions on message by current user e.g., [edit, delete, flag, mute]\n   * Please check [Message](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message.js) component for default implementation.\n   * */\n  getMessageActions: PropTypes.func.isRequired,\n  /**\n   * Function to publish updates on message to channel\n   *\n   * @param message Updated [message object](https://getstream.io/chat/docs/#message_format)\n   * */\n  updateMessage: PropTypes.func,\n  /**\n   * Reattempt sending a message\n   * @param message A [message object](https://getstream.io/chat/docs/#message_format) to resent.\n   */\n  handleRetry: PropTypes.func,\n  /**\n   * Add or remove reaction on message\n   *\n   * @param type Type of reaction - 'like' | 'love' | 'haha' | 'wow' | 'sad' | 'angry'\n   * @param event Dom event which triggered this function\n   */\n  handleReaction: PropTypes.func,\n  /**\n   * A component to display the selector that allows a user to react to a certain message.\n   */\n  ReactionSelector: /** @type {PropTypes.Validator<React.ElementType<import('types').ReactionSelectorProps>>} */ (PropTypes.elementType),\n  /**\n   * A component to display the a message list of reactions.\n   */\n  ReactionsList: /** @type {PropTypes.Validator<React.ElementType<import('types').ReactionsListProps>>} */ (PropTypes.elementType),\n\n  /** If actions such as edit, delete, flag, mute are enabled on message */\n  /** @deprecated This property is no longer used * */\n  actionsEnabled: PropTypes.bool,\n  /** DOMRect object for parent MessageList component */\n  messageListRect: PropTypes.shape({\n    x: PropTypes.number.isRequired,\n    y: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired,\n    width: PropTypes.number.isRequired,\n    top: PropTypes.number.isRequired,\n    right: PropTypes.number.isRequired,\n    bottom: PropTypes.number.isRequired,\n    left: PropTypes.number.isRequired,\n    toJSON: PropTypes.func.isRequired,\n  }),\n  /**\n   * @param name {string} Name of action\n   * @param value {string} Value of action\n   * @param event Dom event that triggered this handler\n   */\n  handleAction: PropTypes.func,\n  /**\n   * The handler for hover event on @mention in message\n   *\n   * @param event Dom hover event which triggered handler.\n   * @param user Target user object\n   */\n  onMentionsHoverMessage: PropTypes.func,\n  /**\n   * The handler for click event on @mention in message\n   *\n   * @param event Dom click event which triggered handler.\n   * @param user Target user object\n   */\n  onMentionsClickMessage: PropTypes.func,\n  /**\n   * The handler for click event on the user that posted the message\n   *\n   * @param event Dom click event which triggered handler.\n   */\n  onUserClick: PropTypes.func,\n  /**\n   * The handler for mouseOver event on the user that posted the message\n   *\n   * @param event Dom mouseOver event which triggered handler.\n   */\n  onUserHover: PropTypes.func,\n  /**\n   * The component that will be rendered if the message has been deleted.\n   * All of Message's props are passed into this component.\n   */\n  MessageDeleted: /** @type {PropTypes.Validator<React.ElementType<import('types').MessageDeletedProps>>} */ (PropTypes.elementType),\n};\n\nexport default React.memo(MessageLivestreamComponent, areMessagePropsEqual);\n","// @ts-check\nimport React, { Fragment, useMemo, useContext, useRef } from 'react';\nimport PropTypes from 'prop-types';\n\nimport MessageRepliesCountButton from './MessageRepliesCountButton';\nimport {\n  isOnlyEmojis,\n  renderText,\n  getReadByTooltipText,\n  smartRender,\n} from '../../utils';\nimport { ChannelContext, TranslationContext } from '../../context';\nimport { Attachment as DefaultAttachment } from '../Attachment';\nimport { Avatar } from '../Avatar';\nimport { Gallery } from '../Gallery';\nimport { MessageInput, EditMessageForm } from '../MessageInput';\nimport { MessageActions } from '../MessageActions';\nimport { Tooltip } from '../Tooltip';\nimport { LoadingIndicator } from '../Loading';\nimport {\n  SimpleReactionsList as DefaultReactionsList,\n  ReactionSelector as DefaultReactionSelector,\n} from '../Reactions';\nimport {\n  useUserRole,\n  useActionHandler,\n  useUserHandler,\n  useReactionClick,\n  useRetryHandler,\n  useReactionHandler,\n  useOpenThreadHandler,\n  useMentionsUIHandler,\n  useEditHandler,\n} from './hooks';\nimport {\n  getNonImageAttachments,\n  areMessagePropsEqual,\n  getImages,\n} from './utils';\nimport {\n  ReactionIcon,\n  ThreadIcon,\n  ErrorIcon,\n  DeliveredCheckIcon,\n} from './icons';\nimport MessageTimestamp from './MessageTimestamp';\n\n/**\n * MessageTeam - Render component, should be used together with the Message component\n * Implements the look and feel for a team style collaboration environment\n *\n * @example ../../docs/MessageTeam.md\n * @typedef { import('types').MessageTeamProps } Props\n *\n * @type {React.FC<Props>}\n */\n// eslint-disable-next-line sonarjs/cognitive-complexity\nconst MessageTeam = (props) => {\n  const {\n    message,\n    threadList,\n    formatDate,\n    initialMessage,\n    unsafeHTML,\n    getMessageActions,\n    MessageDeleted,\n    ReactionsList = DefaultReactionsList,\n    ReactionSelector = DefaultReactionSelector,\n    editing: propEditing,\n    setEditingState: propSetEdit,\n    clearEditingState: propClearEdit,\n    onMentionsHoverMessage: propOnMentionsHover,\n    onMentionsClickMessage: propOnMentionsClick,\n    channelConfig: propChannelConfig,\n    handleAction: propHandleAction,\n    handleOpenThread: propHandleOpenThread,\n    handleReaction: propHandleReaction,\n    handleRetry: propHandleRetry,\n    updateMessage: propUpdateMessage,\n    onUserClick: propOnUserClick,\n    onUserHover: propOnUserHover,\n    t: propT,\n  } = props;\n\n  /**\n   *@type {import('types').ChannelContextValue}\n   */\n  const { channel, updateMessage: channelUpdateMessage } = useContext(\n    ChannelContext,\n  );\n  const channelConfig = propChannelConfig || channel?.getConfig();\n  const { t: contextT } = useContext(TranslationContext);\n  const t = propT || contextT;\n  const groupStyles = props.groupStyles || ['single'];\n  const reactionSelectorRef = useRef(null);\n  const messageWrapperRef = useRef(null);\n  const {\n    editing: ownEditing,\n    setEdit: ownSetEditing,\n    clearEdit: ownClearEditing,\n  } = useEditHandler();\n  const editing = propEditing || ownEditing;\n  const setEdit = propSetEdit || ownSetEditing;\n  const clearEdit = propClearEdit || ownClearEditing;\n  const handleOpenThread = useOpenThreadHandler(message);\n  const handleReaction = useReactionHandler(message);\n  const retryHandler = useRetryHandler();\n  const retry = propHandleRetry || retryHandler;\n  const { onMentionsClick, onMentionsHover } = useMentionsUIHandler(message, {\n    onMentionsClick: propOnMentionsClick,\n    onMentionsHover: propOnMentionsHover,\n  });\n  const { onReactionListClick, showDetailedReactions } = useReactionClick(\n    message,\n    reactionSelectorRef,\n    messageWrapperRef,\n  );\n  const { onUserClick, onUserHover } = useUserHandler(message, {\n    onUserClickHandler: propOnUserClick,\n    onUserHoverHandler: propOnUserHover,\n  });\n  const messageText = useMemo(\n    () => renderText(message?.text, message?.mentioned_users),\n    [message?.text, message?.mentioned_users],\n  );\n  const galleryImages = getImages(message);\n  const attachments = getNonImageAttachments(message);\n  const firstGroupStyle = groupStyles ? groupStyles[0] : '';\n\n  if (message?.type === 'message.read') {\n    return null;\n  }\n\n  if (message?.deleted_at) {\n    return smartRender(MessageDeleted, props, null);\n  }\n\n  if (editing) {\n    return (\n      <div\n        data-testid=\"message-team-edit\"\n        className={`str-chat__message-team str-chat__message-team--${firstGroupStyle} str-chat__message-team--editing`}\n      >\n        {(firstGroupStyle === 'top' || firstGroupStyle === 'single') && (\n          <div className=\"str-chat__message-team-meta\">\n            <Avatar\n              image={message?.user?.image}\n              name={message?.user?.name || message?.user?.id}\n              size={40}\n              onClick={onUserClick}\n              onMouseOver={onUserHover}\n            />\n          </div>\n        )}\n        <MessageInput\n          Input={EditMessageForm}\n          message={message}\n          clearEditingState={clearEdit}\n          updateMessage={propUpdateMessage || channelUpdateMessage}\n        />\n      </div>\n    );\n  }\n  return (\n    <React.Fragment>\n      <div\n        data-testid=\"message-team\"\n        className={`str-chat__message-team str-chat__message-team--${firstGroupStyle} str-chat__message-team--${\n          message?.type\n        } ${threadList ? 'thread-list' : ''} str-chat__message-team--${\n          message?.status\n        }`}\n        ref={messageWrapperRef}\n      >\n        <div className=\"str-chat__message-team-meta\">\n          {firstGroupStyle === 'top' ||\n          firstGroupStyle === 'single' ||\n          initialMessage ? (\n            <Avatar\n              image={message?.user?.image}\n              name={message?.user?.name || message?.user?.id}\n              size={40}\n              onClick={onUserClick}\n              onMouseOver={onUserHover}\n            />\n          ) : (\n            <div\n              data-testid=\"team-meta-spacer\"\n              style={{ width: 40, marginRight: 0 }}\n            />\n          )}\n          <MessageTimestamp\n            message={message}\n            tDateTimeParser={props.tDateTimeParser}\n            formatDate={formatDate}\n          />\n        </div>\n        <div className=\"str-chat__message-team-group\">\n          {message &&\n            (firstGroupStyle === 'top' ||\n              firstGroupStyle === 'single' ||\n              initialMessage) && (\n              <div\n                data-testid=\"message-team-author\"\n                className=\"str-chat__message-team-author\"\n                onClick={onUserClick}\n              >\n                <strong>{message.user?.name || message.user?.id}</strong>\n                {message.type === 'error' && (\n                  <div className=\"str-chat__message-team-error-header\">\n                    {t('Only visible to you')}\n                  </div>\n                )}\n              </div>\n            )}\n          <div\n            data-testid=\"message-team-content\"\n            className={`str-chat__message-team-content str-chat__message-team-content--${firstGroupStyle} str-chat__message-team-content--${\n              message?.text === '' ? 'image' : 'text'\n            }`}\n          >\n            {!initialMessage &&\n              message &&\n              message.status !== 'sending' &&\n              message.status !== 'failed' &&\n              message.type !== 'system' &&\n              message.type !== 'ephemeral' &&\n              message.type !== 'error' && (\n                <div\n                  data-testid=\"message-team-actions\"\n                  className={`str-chat__message-team-actions`}\n                >\n                  {message && showDetailedReactions && (\n                    <ReactionSelector\n                      handleReaction={propHandleReaction || handleReaction}\n                      latest_reactions={message.latest_reactions}\n                      reaction_counts={message.reaction_counts}\n                      detailedView={true}\n                      ref={reactionSelectorRef}\n                    />\n                  )}\n\n                  {channelConfig && channelConfig.reactions && (\n                    <span\n                      data-testid=\"message-team-reaction-icon\"\n                      title=\"Reactions\"\n                      onClick={onReactionListClick}\n                    >\n                      <ReactionIcon />\n                    </span>\n                  )}\n                  {!threadList && channelConfig && channelConfig.replies && (\n                    <span\n                      data-testid=\"message-team-thread-icon\"\n                      title=\"Start a thread\"\n                      onClick={propHandleOpenThread || handleOpenThread}\n                    >\n                      <ThreadIcon />\n                    </span>\n                  )}\n                  {message &&\n                    getMessageActions &&\n                    getMessageActions().length > 0 && (\n                      <MessageActions\n                        addNotification={props.addNotification}\n                        message={message}\n                        getMessageActions={props.getMessageActions}\n                        messageListRect={props.messageListRect}\n                        messageWrapperRef={messageWrapperRef}\n                        setEditingState={setEdit}\n                        getMuteUserSuccessNotification={\n                          props.getMuteUserSuccessNotification\n                        }\n                        getMuteUserErrorNotification={\n                          props.getMuteUserErrorNotification\n                        }\n                        getFlagMessageErrorNotification={\n                          props.getFlagMessageErrorNotification\n                        }\n                        getFlagMessageSuccessNotification={\n                          props.getFlagMessageSuccessNotification\n                        }\n                        handleFlag={props.handleFlag}\n                        handleMute={props.handleMute}\n                        handleEdit={props.handleEdit}\n                        handleDelete={props.handleDelete}\n                        customWrapperClass={''}\n                        inline\n                      />\n                    )}\n                </div>\n              )}\n            {message && (\n              <span\n                data-testid=\"message-team-message\"\n                className={\n                  isOnlyEmojis(message.text)\n                    ? 'str-chat__message-team-text--is-emoji'\n                    : ''\n                }\n                onMouseOver={onMentionsHover}\n                onClick={onMentionsClick}\n              >\n                {unsafeHTML ? (\n                  <div dangerouslySetInnerHTML={{ __html: message.html }} />\n                ) : (\n                  messageText\n                )}\n              </span>\n            )}\n\n            {galleryImages.length !== 0 && <Gallery images={galleryImages} />}\n\n            {message && message.text === '' && (\n              <MessageTeamAttachments\n                Attachment={props.Attachment}\n                message={message}\n                handleAction={propHandleAction}\n              />\n            )}\n\n            {message?.latest_reactions &&\n              message.latest_reactions.length !== 0 &&\n              message.text !== '' && (\n                <ReactionsList\n                  reaction_counts={message.reaction_counts}\n                  handleReaction={propHandleReaction || handleReaction}\n                  reactions={message.latest_reactions}\n                />\n              )}\n            {message?.status === 'failed' && (\n              <button\n                data-testid=\"message-team-failed\"\n                className=\"str-chat__message-team-failed\"\n                onClick={() => {\n                  if (message.status === 'failed' && retry) {\n                    // FIXME: type checking fails here because in the case of a failed message,\n                    // `message` is of type Client.Message (i.e. request object)\n                    // instead of Client.MessageResponse (i.e. server response object)\n                    // @ts-ignore\n                    retry(message);\n                  }\n                }}\n              >\n                <ErrorIcon />\n                {t('Message failed. Click to try again.')}\n              </button>\n            )}\n          </div>\n          <MessageTeamStatus\n            readBy={props.readBy}\n            message={message}\n            threadList={threadList}\n            lastReceivedId={props.lastReceivedId}\n            t={propT}\n          />\n          {message && message.text !== '' && attachments && (\n            <MessageTeamAttachments\n              Attachment={props.Attachment}\n              message={message}\n              handleAction={propHandleAction}\n            />\n          )}\n          {message?.latest_reactions &&\n            message.latest_reactions.length !== 0 &&\n            message.text === '' && (\n              <ReactionsList\n                reaction_counts={message.reaction_counts}\n                handleReaction={propHandleReaction || handleReaction}\n                reactions={message.latest_reactions}\n              />\n            )}\n          {!threadList && message && (\n            <MessageRepliesCountButton\n              onClick={propHandleOpenThread || handleOpenThread}\n              reply_count={message.reply_count}\n            />\n          )}\n        </div>\n      </div>\n    </React.Fragment>\n  );\n};\n\n/** @type {(props: import('types').MessageTeamStatusProps) => React.ReactElement | null} */\nconst MessageTeamStatus = (props) => {\n  const { readBy, message, threadList, lastReceivedId, t: propT } = props;\n  const { client } = useContext(ChannelContext);\n  const { t: contextT } = useContext(TranslationContext);\n  const t = propT || contextT;\n  const { isMyMessage } = useUserRole(message);\n  if (!isMyMessage || message?.type === 'error') {\n    return null;\n  }\n  const justReadByMe =\n    readBy &&\n    client?.user &&\n    readBy.length === 1 &&\n    readBy[0] &&\n    readBy[0].id === client.user.id;\n  if (message && message.status === 'sending') {\n    return (\n      <span\n        className=\"str-chat__message-team-status\"\n        data-testid=\"message-team-sending\"\n      >\n        <Tooltip>{t && t('Sending...')}</Tooltip>\n        <LoadingIndicator />\n      </span>\n    );\n  }\n\n  if (readBy && readBy.length !== 0 && !threadList && !justReadByMe) {\n    const lastReadUser = readBy.filter(\n      (item) => item && client?.user && item.id !== client.user.id,\n    )[0];\n    return (\n      <span className=\"str-chat__message-team-status\">\n        <Tooltip>{getReadByTooltipText(readBy, t, client)}</Tooltip>\n        <Avatar\n          name={lastReadUser && lastReadUser.name ? lastReadUser.name : null}\n          image={lastReadUser && lastReadUser.image ? lastReadUser.image : null}\n          size={15}\n        />\n        {readBy.length - 1 > 1 && (\n          <span\n            data-testid=\"message-team-read-by-count\"\n            className=\"str-chat__message-team-status-number\"\n          >\n            {readBy.length - 1}\n          </span>\n        )}\n      </span>\n    );\n  }\n\n  if (\n    message &&\n    message.status === 'received' &&\n    message.id === lastReceivedId &&\n    !threadList\n  ) {\n    return (\n      <span\n        data-testid=\"message-team-received\"\n        className=\"str-chat__message-team-status\"\n      >\n        <Tooltip>{t && t('Delivered')}</Tooltip>\n        <DeliveredCheckIcon />\n      </span>\n    );\n  }\n\n  return null;\n};\n\n/** @type {(props: import('types').MessageTeamAttachmentsProps) => React.ReactElement | null} Typescript syntax */\nconst MessageTeamAttachments = (props) => {\n  const {\n    Attachment = DefaultAttachment,\n    message,\n    handleAction: propHandleAction,\n  } = props;\n  const handleAction = useActionHandler(message);\n  const attachments = getNonImageAttachments(message);\n  if (attachments.length > 0 && Attachment) {\n    return (\n      <Fragment>\n        {attachments.map(\n          /** @type {(item: import('stream-chat').Attachment) => React.ReactElement | null} Typescript syntax */\n          (attachment, index) => (\n            <Attachment\n              key={`${message?.id}-${index}`}\n              attachment={attachment}\n              actionHandler={propHandleAction || handleAction}\n            />\n          ),\n        )}\n      </Fragment>\n    );\n  }\n  return null;\n};\n\nMessageTeam.propTypes = {\n  /** The [message object](https://getstream.io/chat/docs/#message_format) */\n  message: /** @type {PropTypes.Validator<import('stream-chat').MessageResponse>} */ (PropTypes\n    .object.isRequired),\n  /**\n   * The attachment UI component.\n   * Default: [Attachment](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment.js)\n   * */\n  Attachment: /** @type {PropTypes.Validator<React.ElementType<import('types').AttachmentUIComponentProps>>} */ (PropTypes.elementType),\n  /**\n   *\n   * @deprecated Its not recommended to use this anymore. All the methods in this HOC are provided explicitly.\n   *\n   * The higher order message component, most logic is delegated to this component\n   * @see See [Message HOC](https://getstream.github.io/stream-chat-react/#message) for example\n   * */\n  Message: /** @type {PropTypes.Validator<React.ElementType<import('types').MessageUIComponentProps>>} */ (PropTypes.oneOfType(\n    [PropTypes.node, PropTypes.func, PropTypes.object],\n  )),\n  /** render HTML instead of markdown. Posting HTML is only allowed server-side */\n  unsafeHTML: PropTypes.bool,\n  /** Client object */\n  client: /** @type {PropTypes.Validator<import('stream-chat').StreamChat>} */ (PropTypes.object),\n  /** If its parent message in thread. */\n  initialMessage: PropTypes.bool,\n  /** Channel config object */\n  channelConfig: /** @type {PropTypes.Validator<import('stream-chat').ChannelConfig>} */ (PropTypes.object),\n  /** If component is in thread list */\n  threadList: PropTypes.bool,\n  /** Function to open thread on current messxage */\n  handleOpenThread: PropTypes.func,\n  /** If the message is in edit state */\n  editing: PropTypes.bool,\n  /** Function to exit edit state */\n  clearEditingState: PropTypes.func,\n  /** Returns true if message belongs to current user */\n  isMyMessage: PropTypes.func,\n\n  /** Override the default formatting of the date. This is a function that has access to the original date object. Returns a string or Node  */\n  formatDate: PropTypes.func,\n  /**\n   * Returns all allowed actions on message by current user e.g., [edit, delete, flag, mute]\n   * Please check [Message](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message.js) component for default implementation.\n   * */\n  getMessageActions: /** @type {PropTypes.Validator<() => Array<string>>} */ (PropTypes.func),\n  /**\n   * Function to publish updates on message to channel\n   *\n   * @param message Updated [message object](https://getstream.io/chat/docs/#message_format)\n   * */\n  updateMessage: PropTypes.func,\n  /**\n   * Reattempt sending a message\n   * @param message A [message object](https://getstream.io/chat/docs/#message_format) to resent.\n   */\n  handleRetry: PropTypes.func,\n  /**\n   * Add or remove reaction on message\n   *\n   * @param type Type of reaction - 'like' | 'love' | 'haha' | 'wow' | 'sad' | 'angry'\n   * @param event Dom event which triggered this function\n   */\n  handleReaction: PropTypes.func,\n  /**\n   * A component to display the selector that allows a user to react to a certain message.\n   */\n  ReactionSelector: /** @type {PropTypes.Validator<React.ElementType<import('types').ReactionSelectorProps>>} */ (PropTypes.elementType),\n  /**\n   * A component to display the a message list of reactions.\n   */\n  ReactionsList: /** @type {PropTypes.Validator<React.ElementType<import('types').ReactionsListProps>>} */ (PropTypes.elementType),\n  /** DOMRect object for parent MessageList component */\n  messageListRect: /** @type {PropTypes.Validator<DOMRect>} */ (PropTypes.object),\n  /**\n   * @param name {string} Name of action\n   * @param value {string} Value of action\n   * @param event Dom event that triggered this handler\n   */\n  handleAction: PropTypes.func,\n  /**\n   * The handler for hover event on @mention in message\n   *\n   * @param event Dom hover event which triggered handler.\n   * @param user Target user object\n   */\n  onMentionsHoverMessage: PropTypes.func,\n  /**\n   * The handler for click event on @mention in message\n   *\n   * @param event Dom click event which triggered handler.\n   * @param user Target user object\n   */\n  onMentionsClickMessage: PropTypes.func,\n  /**\n   * The handler for click event on the user that posted the message\n   *\n   * @param event Dom click event which triggered handler.\n   */\n  onUserClick: PropTypes.func,\n  /**\n   * The handler for mouseOver event on the user that posted the message\n   *\n   * @param event Dom mouseOver event which triggered handler.\n   */\n  onUserHover: PropTypes.func,\n  /** Position of message in group. Possible values: top, bottom, middle, single */\n  groupStyles: PropTypes.array,\n  /**\n   * The component that will be rendered if the message has been deleted.\n   * All of Message's props are passed into this component.\n   */\n  MessageDeleted: /** @type {PropTypes.Validator<React.ElementType<import('types').MessageDeletedProps>>} */ (PropTypes.elementType),\n};\n\nexport default React.memo(MessageTeam, areMessagePropsEqual);\n","// @ts-check\nimport { useCallback } from 'react';\n\n/**\n * @typedef {import('stream-chat').UserResponse} UserResponse\n * @typedef {(e: React.MouseEvent, user?: UserResponse) => void} MentionsHandler\n * @param {MentionsHandler=} onMentionsHover\n * @param {MentionsHandler=} onMentionsClick\n */\nconst useMentionsHandlers = (onMentionsHover, onMentionsClick) => {\n  return useCallback(\n    /** @type {(e: React.MouseEvent<HTMLSpanElement>, mentioned_users: UserResponse[]) => void} */\n    (e, mentioned_users) => {\n      if (!onMentionsHover && !onMentionsClick) return;\n      // eslint-disable-next-line prefer-destructuring\n      const target = /** @type {HTMLSpanElement} */ (e.target);\n      const tagName = target?.tagName.toLowerCase();\n      const textContent = target?.innerHTML.replace('*', '');\n      if (tagName === 'strong' && textContent[0] === '@') {\n        const userName = textContent.replace('@', '');\n        const user = mentioned_users.find(\n          ({ name, id }) => name === userName || id === userName,\n        );\n        if (\n          onMentionsHover &&\n          typeof onMentionsHover === 'function' &&\n          e.type === 'mouseover'\n        ) {\n          onMentionsHover(e, user);\n        }\n        if (\n          onMentionsClick &&\n          e.type === 'click' &&\n          typeof onMentionsClick === 'function'\n        ) {\n          onMentionsClick(e, user);\n        }\n      }\n    },\n    [onMentionsClick, onMentionsHover],\n  );\n};\n\nexport default useMentionsHandlers;\n","// @ts-check\nimport { useContext } from 'react';\nimport { ChatContext } from '../../../context';\n\n/**\n * @typedef {import('stream-chat').Message} Message\n * @typedef {import('stream-chat').UpdateMessageAPIResponse} UpdateResponse\n * @param {((cid: string, updatedMessage: Message) => Promise<UpdateResponse>) | undefined} doUpdateMessageRequest\n * @returns {(updatedMessage: Message) => Promise<UpdateResponse>}\n */\nconst useEditMessageHandler = (doUpdateMessageRequest) => {\n  const { channel, client } = useContext(ChatContext);\n  return (updatedMessage) => {\n    if (doUpdateMessageRequest && channel) {\n      return Promise.resolve(\n        doUpdateMessageRequest(channel.cid, updatedMessage),\n      );\n    }\n    return client.updateMessage(updatedMessage);\n  };\n};\n\nexport default useEditMessageHandler;\n","// @ts-check\nimport Immutable from 'seamless-immutable';\n\n/** @type {import('./types').ChannelStateReducer} */\nexport const channelReducer = (state, action) => {\n  switch (action.type) {\n    case 'initStateFromChannel': {\n      const { channel } = action;\n      return {\n        ...state,\n        messages: channel.state.messages,\n        read: channel.state.read,\n        watchers: channel.state.watchers,\n        members: channel.state.members,\n        watcherCount: channel.state.watcher_count,\n        loading: false,\n      };\n    }\n    case 'copyStateFromChannelOnEvent': {\n      const { channel } = action;\n      return {\n        ...state,\n        messages: channel.state.messages,\n        read: channel.state.read,\n        watchers: channel.state.watchers,\n        typing: channel.state.typing,\n        watcherCount: channel.state.watcher_count,\n      };\n    }\n    case 'setThread': {\n      const { message } = action;\n      return { ...state, thread: message };\n    }\n    case 'loadMoreFinished': {\n      const { hasMore, messages } = action;\n      return {\n        ...state,\n        loadingMore: false,\n        hasMore,\n        messages,\n      };\n    }\n    case 'setLoadingMore': {\n      const { loadingMore } = action;\n      return { ...state, loadingMore };\n    }\n    case 'copyMessagesFromChannel': {\n      const { channel, parentId } = action;\n      return {\n        ...state,\n        messages: channel.state.messages,\n        threadMessages: parentId\n          ? channel.state.threads[parentId] || []\n          : state.threadMessages,\n      };\n    }\n    case 'updateThreadOnEvent': {\n      const { channel, message } = action;\n      if (!state.thread) return state;\n      return {\n        ...state,\n        threadMessages: channel.state.threads[state.thread.id],\n        thread:\n          message?.id === state.thread.id\n            ? channel.state.messageToImmutable(message)\n            : state.thread,\n      };\n    }\n    case 'openThread': {\n      const { message, channel } = action;\n      return {\n        ...state,\n        thread: message,\n        threadMessages: channel.state.threads[message.id] || [],\n      };\n    }\n    case 'startLoadingThread': {\n      return {\n        ...state,\n        threadLoadingMore: true,\n      };\n    }\n    case 'loadMoreThreadFinished': {\n      const { threadHasMore, threadMessages } = action;\n      return {\n        ...state,\n        threadHasMore,\n        threadMessages,\n        threadLoadingMore: false,\n      };\n    }\n    case 'closeThread': {\n      return {\n        ...state,\n        thread: null,\n        threadMessages: Immutable([]),\n        threadLoadingMore: false,\n      };\n    }\n    case 'setError': {\n      const { error } = action;\n      return { ...state, error };\n    }\n    default:\n      return state;\n  }\n};\n\n/** @type {import('./types').ChannelState} */\nexport const initialState = {\n  error: null,\n  loading: true,\n  loadingMore: false,\n  hasMore: true,\n  messages: Immutable([]),\n  typing: Immutable(/** @type {any} infer from ChannelState */ ({})),\n  members: Immutable(/** @type {any} infer from ChannelState */ ({})),\n  watchers: Immutable(/** @type {any} infer from ChannelState */ ({})),\n  watcherCount: 0,\n  read: Immutable(/** @type {any} infer from ChannelState */ ({})),\n  thread: null,\n  threadMessages: Immutable([]),\n  threadLoadingMore: false,\n  threadHasMore: true,\n};\n","// @ts-check\nimport React, {\n  useEffect,\n  useCallback,\n  useContext,\n  useRef,\n  useReducer,\n  useLayoutEffect,\n} from 'react';\nimport { v4 as uuidv4 } from 'uuid';\nimport PropTypes from 'prop-types';\nimport debounce from 'lodash.debounce';\nimport throttle from 'lodash.throttle';\nimport { logChatPromiseExecution, Channel as StreamChannel } from 'stream-chat';\n\nimport { ChatContext, ChannelContext, TranslationContext } from '../../context';\nimport { Attachment as AttachmentComponent } from '../Attachment';\nimport { MessageSimple as MessageSimpleComponent } from '../Message';\nimport {\n  LoadingIndicator as LoadingIndicatorComponent,\n  LoadingErrorIndicator as LoadingErrorIndicatorComponent,\n} from '../Loading';\nimport useMentionsHandlers from './hooks/useMentionsHandlers';\nimport useEditMessageHandler from './hooks/useEditMessageHandler';\nimport { channelReducer, initialState } from './channelState';\n\n/** @type {React.FC<import('types').ChannelProps>}>} */\nconst Channel = ({ EmptyPlaceholder = null, ...props }) => {\n  const { channel: contextChannel } = useContext(ChatContext);\n  const channel = props.channel || contextChannel;\n  if (!channel?.cid) {\n    return EmptyPlaceholder;\n  }\n  return <ChannelInner {...props} channel={channel} key={channel.cid} />;\n};\n\nChannel.propTypes = {\n  /** Which channel to connect to, will initialize the channel if it's not initialized yet */\n  channel: PropTypes.instanceOf(StreamChannel),\n  /**\n   * Empty channel UI component. This will be shown on the screen if there is no active channel.\n   *\n   * Defaults to null which skips rendering the Channel\n   *\n   * */\n  EmptyPlaceholder: PropTypes.element,\n  /**\n   * Error indicator UI component. This will be shown on the screen if channel query fails.\n   *\n   * Defaults to and accepts same props as: [LoadingErrorIndicator](https://getstream.github.io/stream-chat-react/#loadingerrorindicator)\n   *\n   * */\n  // @ts-ignore elementType\n  LoadingErrorIndicator: PropTypes.elementType,\n  /**\n   * Loading indicator UI component. This will be shown on the screen until the messages are\n   * being queried from channelœ. Once the messages are loaded, loading indicator is removed from the screen\n   * and replaced with children of the Channel component.\n   *\n   * Defaults to and accepts same props as: [LoadingIndicator](https://github.com/GetStream/stream-chat-react/blob/master/src/components/LoadingIndicator.js)\n   */\n  // @ts-ignore elementType\n  LoadingIndicator: PropTypes.elementType,\n  /**\n   * Message UI component to display a message in message list.\n   *\n   * Available built-in components (also accepts the same props as):\n   *\n   * 1. [MessageSimple](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageSimple.js) (default)\n   * 2. [MessageTeam](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageTeam.js)\n   * 3. [MessageLivestream](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageLivestream.js)\n   * 3. [MessageCommerce](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageCommerce.js)\n   *\n   * */\n  // @ts-ignore elementType\n  Message: PropTypes.elementType,\n  /**\n   * Attachment UI component to display attachment in individual message.\n   *\n   * Defaults to and accepts same props as: [Attachment](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment.js)\n   * */\n  // @ts-ignore elementType\n  Attachment: PropTypes.elementType,\n  /**\n   * Handle for click on @mention in message\n   *\n   * @param {Event} event DOM Click event\n   * @param {User} user   Target [user object](https://getstream.io/chat/docs/#chat-doc-set-user) which is clicked\n   */\n  onMentionsClick: PropTypes.func,\n  /**\n   * Handle for hover on @mention in message\n   *\n   * @param {Event} event DOM hover event\n   * @param {User} user   Target [user object](https://getstream.io/chat/docs/#chat-doc-set-user) which is hovered\n   */\n  onMentionsHover: PropTypes.func,\n  /** Weather to allow multiple attachment uploads */\n  multipleUploads: PropTypes.bool,\n  /** List of accepted file types */\n  acceptedFiles: PropTypes.array,\n  /** Maximum number of attachments allowed per message */\n  maxNumberOfFiles: PropTypes.number,\n  /** Override send message request (Advanced usage only)\n   *\n   * @param {String} channelId full channel ID in format of `type:id`\n   * @param {Object} message\n   */\n  doSendMessageRequest: PropTypes.func,\n  /**\n   * Override mark channel read request (Advanced usage only)\n   *\n   * @param {Channel} channel object\n   * */\n  doMarkReadRequest: PropTypes.func,\n  /** Override update(edit) message request (Advanced usage only)\n   *\n   * @param {String} channelId full channel ID in format of `type:id`\n   * @param {Object} updatedMessage\n   */\n  doUpdateMessageRequest: PropTypes.func,\n};\n\n/** @type {React.FC<import('types').ChannelProps & { channel: import('stream-chat').Channel }>} */\nconst ChannelInner = ({\n  LoadingIndicator = LoadingIndicatorComponent,\n  LoadingErrorIndicator = LoadingErrorIndicatorComponent,\n  Attachment = AttachmentComponent,\n  Message = MessageSimpleComponent,\n  doMarkReadRequest,\n  ...props\n  // eslint-disable-next-line sonarjs/cognitive-complexity\n}) => {\n  const { channel } = props;\n  const [state, dispatch] = useReducer(channelReducer, initialState);\n  const originalTitle = useRef('');\n  const lastRead = useRef(new Date());\n  const chatContext = useContext(ChatContext);\n  const { t } = useContext(TranslationContext);\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const throttledCopyStateFromChannel = useCallback(\n    throttle(\n      () => {\n        dispatch({ type: 'copyStateFromChannelOnEvent', channel });\n      },\n      500,\n      { leading: true, trailing: true },\n    ),\n    [channel],\n  );\n\n  const markRead = useCallback(() => {\n    if (channel.disconnected || !channel.getConfig().read_events) {\n      return;\n    }\n    lastRead.current = new Date();\n    if (doMarkReadRequest) {\n      doMarkReadRequest(channel);\n    } else {\n      logChatPromiseExecution(channel.markRead(), 'mark read');\n    }\n    if (originalTitle.current) {\n      document.title = originalTitle.current;\n    }\n  }, [channel, doMarkReadRequest]);\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const markReadThrottled = useCallback(\n    throttle(markRead, 500, { leading: true, trailing: true }),\n    [markRead],\n  );\n\n  const handleEvent = useCallback(\n    (e) => {\n      dispatch({ type: 'updateThreadOnEvent', message: e.message, channel });\n\n      if (e.type === 'message.new') {\n        let mainChannelUpdated = true;\n        if (e.message.parent_id && !e.message.show_in_channel) {\n          mainChannelUpdated = false;\n        }\n\n        if (\n          mainChannelUpdated &&\n          e.message.user.id !== chatContext.client.userID\n        ) {\n          if (!document.hidden) {\n            markReadThrottled();\n          } else if (channel.getConfig().read_events) {\n            const unread = channel.countUnread(lastRead.current);\n            document.title = `(${unread}) ${originalTitle.current}`;\n          }\n        }\n      }\n\n      throttledCopyStateFromChannel();\n    },\n    [\n      channel,\n      throttledCopyStateFromChannel,\n      chatContext.client.userID,\n      markReadThrottled,\n    ],\n  );\n\n  // useLayoutEffect here to prevent spinner. Use Suspense when it is available in stable release\n  useLayoutEffect(() => {\n    let errored = false;\n    let done = false;\n    const onVisibilityChange = () => {\n      if (!document.hidden) {\n        markRead();\n      }\n    };\n\n    (async () => {\n      if (!channel.initialized) {\n        try {\n          await channel.watch();\n        } catch (e) {\n          dispatch({ type: 'setError', error: e });\n          errored = true;\n        }\n      }\n      done = true;\n      originalTitle.current = document.title;\n      if (!errored) {\n        dispatch({ type: 'initStateFromChannel', channel });\n        if (channel.countUnread() > 0) markRead();\n        // The more complex sync logic is done in chat.js\n        // listen to client.connection.recovered and all channel events\n        document.addEventListener('visibilitychange', onVisibilityChange);\n        chatContext.client.on('connection.recovered', handleEvent);\n        channel.on(handleEvent);\n      }\n    })();\n    return () => {\n      if (errored || !done) return;\n      document.removeEventListener('visibilitychange', onVisibilityChange);\n      channel.off(handleEvent);\n      chatContext.client.off('connection.recovered', handleEvent);\n    };\n  }, [channel, chatContext.client, handleEvent, markRead, props.channel]);\n\n  useEffect(() => {\n    if (state.thread) {\n      for (let i = state.messages.length - 1; i >= 0; i -= 1) {\n        if (state.messages[i].id === state.thread.id) {\n          dispatch({ type: 'setThread', message: state.messages[i] });\n          break;\n        }\n      }\n    }\n  }, [state.messages, state.thread]);\n\n  // Message\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const loadMoreFinished = useCallback(\n    debounce(\n      /**\n       * @param {boolean} hasMore\n       * @param {import('seamless-immutable').ImmutableArray<import('stream-chat').MessageResponse>} messages\n       */\n      (hasMore, messages) => {\n        dispatch({ type: 'loadMoreFinished', hasMore, messages });\n      },\n      2000,\n      {\n        leading: true,\n        trailing: true,\n      },\n    ),\n    [],\n  );\n\n  const loadMore = useCallback(\n    async (limit = 100) => {\n      // prevent duplicate loading events...\n      const oldestMessage = state.messages[0];\n      if (state.loadingMore || oldestMessage?.status !== 'received') return 0;\n      dispatch({ type: 'setLoadingMore', loadingMore: true });\n\n      const oldestID = oldestMessage?.id || null;\n\n      const perPage = limit;\n      let queryResponse;\n      try {\n        queryResponse = await channel.query({\n          messages: { limit: perPage, id_lt: oldestID },\n        });\n      } catch (e) {\n        console.warn('message pagination request failed with error', e);\n        dispatch({ type: 'setLoadingMore', loadingMore: false });\n        return 0;\n      }\n      const hasMoreMessages = queryResponse.messages.length === perPage;\n\n      loadMoreFinished(hasMoreMessages, channel.state.messages);\n\n      return queryResponse.messages.length;\n    },\n    [channel, loadMoreFinished, state.loadingMore, state.messages],\n  );\n\n  const updateMessage = useCallback(\n    (updatedMessage) => {\n      // adds the message to the local channel state..\n      // this adds to both the main channel state as well as any reply threads\n      channel.state.addMessageSorted(updatedMessage);\n\n      dispatch({\n        type: 'copyMessagesFromChannel',\n        parentId: state.thread && updatedMessage.parent_id,\n        channel,\n      });\n    },\n    [channel, state.thread],\n  );\n\n  const { doSendMessageRequest } = props;\n  const doSendMessage = useCallback(\n    async (message) => {\n      const { text, attachments, id, parent_id, mentioned_users } = message;\n      const messageData = {\n        text,\n        attachments,\n        mentioned_users,\n        id,\n        parent_id,\n      };\n\n      try {\n        let messageResponse;\n        if (doSendMessageRequest) {\n          messageResponse = await doSendMessageRequest(\n            channel.cid,\n            messageData,\n          );\n        } else {\n          messageResponse = await channel.sendMessage(messageData);\n        }\n\n        // replace it after send is completed\n        if (messageResponse && messageResponse.message) {\n          updateMessage({\n            ...messageResponse.message,\n            status: 'received',\n          });\n        }\n      } catch (e) {\n        // set the message to failed..\n        updateMessage({\n          ...message,\n          status: 'failed',\n        });\n      }\n    },\n    [channel, doSendMessageRequest, updateMessage],\n  );\n\n  const createMessagePreview = useCallback(\n    (text, attachments, parent, mentioned_users) => {\n      // create a preview of the message\n      const clientSideID = `${chatContext.client.userID}-${uuidv4()}`;\n      return {\n        text,\n        html: text,\n        __html: text,\n        id: clientSideID,\n        type: 'regular',\n        status: 'sending',\n        user: chatContext.client.user,\n        created_at: new Date(),\n        attachments,\n        mentioned_users,\n        reactions: [],\n        ...(parent?.id ? { parent_id: parent.id } : null),\n      };\n    },\n    [chatContext.client.user, chatContext.client.userID],\n  );\n\n  const sendMessage = useCallback(\n    async ({ text, attachments = [], mentioned_users = [], parent }) => {\n      // remove error messages upon submit\n      channel.state.filterErrorMessages();\n\n      // create a local preview message to show in the UI\n      const messagePreview = createMessagePreview(\n        text,\n        attachments,\n        parent,\n        mentioned_users,\n      );\n\n      // first we add the message to the UI\n      updateMessage(messagePreview);\n\n      await doSendMessage(messagePreview);\n    },\n    [channel.state, createMessagePreview, doSendMessage, updateMessage],\n  );\n\n  const retrySendMessage = useCallback(\n    async (message) => {\n      // set the message status to sending\n      updateMessage({\n        ...message,\n        status: 'sending',\n      });\n      // actually try to send the message...\n      await doSendMessage(message);\n    },\n    [doSendMessage, updateMessage],\n  );\n\n  const removeMessage = useCallback(\n    (message) => {\n      channel.state.removeMessage(message);\n      dispatch({\n        type: 'copyMessagesFromChannel',\n        parentId: state.thread && message.parent_id,\n        channel,\n      });\n    },\n    [channel, state.thread],\n  );\n\n  // Thread\n\n  const openThread = useCallback(\n    (message, e) => {\n      if (e && e.preventDefault) {\n        e.preventDefault();\n      }\n\n      dispatch({ type: 'openThread', message, channel });\n    },\n    [channel],\n  );\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const loadMoreThreadFinished = useCallback(\n    debounce(\n      /**\n       * @param {boolean} threadHasMore\n       * @param {import('seamless-immutable').ImmutableArray<import('stream-chat').MessageResponse>} threadMessages\n       */\n      (threadHasMore, threadMessages) => {\n        dispatch({\n          type: 'loadMoreThreadFinished',\n          threadHasMore,\n          threadMessages,\n        });\n      },\n      2000,\n      { leading: true, trailing: true },\n    ),\n    [],\n  );\n\n  const loadMoreThread = useCallback(async () => {\n    // prevent duplicate loading events...\n    if (state.threadLoadingMore || !state.thread) return;\n    dispatch({ type: 'startLoadingThread' });\n    const parentID = state.thread.id;\n    const oldMessages = channel.state.threads[parentID] || [];\n    const oldestMessageID = oldMessages[0] ? oldMessages[0].id : null;\n    const limit = 50;\n    const queryResponse = await channel.getReplies(parentID, {\n      limit,\n      id_lt: oldestMessageID,\n    });\n\n    const threadHasMoreMessages = queryResponse.messages.length === limit;\n\n    const newThreadMessages = channel.state.threads[parentID] || [];\n\n    // next set loadingMore to false so we can start asking for more data...\n    loadMoreThreadFinished(threadHasMoreMessages, newThreadMessages);\n  }, [channel, loadMoreThreadFinished, state.thread, state.threadLoadingMore]);\n\n  const closeThread = useCallback((e) => {\n    if (e && e.preventDefault) {\n      e.preventDefault();\n    }\n    dispatch({ type: 'closeThread' });\n  }, []);\n\n  const onMentionsHoverOrClick = useMentionsHandlers(\n    props.onMentionsHover,\n    props.onMentionsClick,\n  );\n\n  const editMessage = useEditMessageHandler(props.doUpdateMessageRequest);\n\n  const channelContextValue = {\n    // state\n    ...state,\n    watcher_count: state.watcherCount,\n    // props\n    channel,\n    Message,\n    Attachment,\n    multipleUploads: props.multipleUploads,\n    acceptedFiles: props.acceptedFiles,\n    maxNumberOfFiles: props.maxNumberOfFiles,\n    mutes: chatContext.mutes,\n    // handlers\n    loadMore,\n    editMessage,\n    updateMessage,\n    sendMessage,\n    retrySendMessage,\n    removeMessage,\n    openThread,\n    loadMoreThread,\n    closeThread,\n    onMentionsClick: onMentionsHoverOrClick,\n    onMentionsHover: onMentionsHoverOrClick,\n    // from chatContext, for legacy reasons\n    client: chatContext.client,\n  };\n\n  let core;\n  if (state.error) {\n    core = <LoadingErrorIndicator error={state.error} />;\n  } else if (state.loading) {\n    core = <LoadingIndicator size={25} />;\n  } else if (!props.channel?.watch) {\n    core = <div>{t('Channel Missing')}</div>;\n  } else {\n    core = (\n      <ChannelContext.Provider value={channelContextValue}>\n        <div className=\"str-chat__container\">{props.children}</div>\n      </ChannelContext.Provider>\n    );\n  }\n\n  return (\n    <div className={`str-chat str-chat-channel ${chatContext.theme}`}>\n      {core}\n    </div>\n  );\n};\n\nexport default React.memo(Channel);\n","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport { Avatar } from '../Avatar';\nimport { ChannelContext, TranslationContext, ChatContext } from '../../context';\n\n/**\n * ChannelHeader - Render some basic information about this channel\n * @example ../../docs/ChannelHeader.md\n * @type {React.FC<import('types').ChannelHeaderProps>}\n */\nconst ChannelHeader = ({ title, live }) => {\n  /** @type {import(\"types\").TranslationContextValue} */\n  const { t } = useContext(TranslationContext);\n  /** @type {import(\"types\").ChannelContextValue} */\n  const { channel, watcher_count } = useContext(ChannelContext);\n  const { openMobileNav } = useContext(ChatContext);\n\n  return (\n    <div className=\"str-chat__header-livestream\">\n      <div className=\"str-chat__header-hamburger\" onClick={openMobileNav}>\n        <span className=\"str-chat__header-hamburger--line\"></span>\n        <span className=\"str-chat__header-hamburger--line\"></span>\n        <span className=\"str-chat__header-hamburger--line\"></span>\n      </div>\n      {channel && channel.data.image && (\n        <Avatar\n          image={channel.data.image}\n          shape=\"rounded\"\n          size={channel.type === 'commerce' ? 60 : 40}\n        />\n      )}\n      <div className=\"str-chat__header-livestream-left\">\n        <p className=\"str-chat__header-livestream-left--title\">\n          {title || (channel && channel.data.name)}{' '}\n          {live && (\n            <span className=\"str-chat__header-livestream-left--livelabel\">\n              {t('live')}\n            </span>\n          )}\n        </p>\n        {channel && channel.data.subtitle && (\n          <p className=\"str-chat__header-livestream-left--subtitle\">\n            {channel.data.subtitle}\n          </p>\n        )}\n        <p className=\"str-chat__header-livestream-left--members\">\n          {!live &&\n            channel &&\n            channel.data.member_count &&\n            channel.data.member_count > 0 && (\n              <>\n                {t('{{ memberCount }} members', {\n                  memberCount: channel.data.member_count,\n                })}\n                ,{' '}\n              </>\n            )}\n          {t('{{ watcherCount }} online', { watcherCount: watcher_count })}\n        </p>\n      </div>\n    </div>\n  );\n};\n\nChannelHeader.propTypes = {\n  /** Set title manually */\n  title: PropTypes.string,\n  /** Show a little indicator that the channel is live right now */\n  live: PropTypes.bool,\n};\n\nexport default React.memo(ChannelHeader);\n","export default \"data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%3Csvg%20width%3D%2278px%22%20height%3D%2278px%22%20viewBox%3D%220%200%2078%2078%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%20%20%20%20%20%20%20%20%3Ctitle%3ECombined%20Shape%3C%2Ftitle%3E%20%20%20%20%3Cdesc%3ECreated%20with%20Sketch.%3C%2Fdesc%3E%20%20%20%20%3Cg%20id%3D%22Interactions%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%20%20%20%20%20%20%20%20%3Cg%20id%3D%22Connection-Error-_-Connectivity%22%20transform%3D%22translate%28-270.000000%2C%20-30.000000%29%22%20fill%3D%22%23CF1F25%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%3Cg%20id%3D%22109-network-connection%22%20transform%3D%22translate%28270.000000%2C%2030.000000%29%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M66.4609744%2C11.414231%20C81.6225232%2C26.5757798%2081.6225232%2C51.157545%2066.4609744%2C66.3188467%20C51.2994256%2C81.4803954%2026.7176604%2C81.4803954%2011.5563587%2C66.3188467%20C-3.60519004%2C51.1572979%20-3.60519004%2C26.5755327%2011.5563587%2C11.414231%20C26.7179075%2C-3.74731776%2051.2996727%2C-3.74731776%2066.4609744%2C11.414231%20Z%20M54.7853215%2C45.8823776%20L54.7853215%2C40.5882574%20C54.7853215%2C39.613638%2053.9952341%2C38.8235506%2053.0206147%2C38.8235506%20L44.9576695%2C38.8235506%20L41.428256%2C42.3529641%20L51.255555%2C42.3529641%20L51.255555%2C45.8823776%20L54.7853215%2C45.8823776%20Z%20M40.6659027%2C43.1153174%20L37.8988425%2C45.8823776%20L40.6659027%2C45.8823776%20L40.6659027%2C43.1153174%20Z%20M51.1764962%2C56.4702653%20L58.2353232%2C56.4702653%20C59.2099355%2C56.4702653%2060.00003%2C55.6801708%2060.00003%2C54.7055585%20L60.00003%2C51.176145%20C60.00003%2C50.2015327%2059.2099355%2C49.4114382%2058.2353232%2C49.4114382%20L51.1764962%2C49.4114382%20C50.2018839%2C49.4114382%2049.4117894%2C50.2015327%2049.4117894%2C51.176145%20L49.4117894%2C54.7055585%20C49.4117894%2C55.6801708%2050.2018839%2C56.4702653%2051.1764962%2C56.4702653%20Z%20M35.2941353%2C56.4702653%20L42.3529624%2C56.4702653%20C43.3275746%2C56.4702653%2044.1176691%2C55.6801708%2044.1176691%2C54.7055585%20L44.1176691%2C51.176145%20C44.1176691%2C50.2015327%2043.3275746%2C49.4114382%2042.3529624%2C49.4114382%20L35.2941353%2C49.4114382%20C34.319523%2C49.4114382%2033.5294285%2C50.2015327%2033.5294285%2C51.176145%20L33.5294285%2C54.7055585%20C33.5294285%2C55.6801708%2034.319523%2C56.4702653%2035.2941353%2C56.4702653%20Z%20M56.6964989%2C19.0874231%20C56.007381%2C18.3985134%2054.8903216%2C18.3985134%2054.2012036%2C19.087423%20L45.882376%2C27.4062507%20L45.882376%2C19.4117761%20C45.882376%2C18.4371568%2045.0922885%2C17.6470693%2044.1176692%2C17.6470693%20L33.5294286%2C17.6470693%20C32.5548092%2C17.6470694%2031.7647218%2C18.4371568%2031.7647218%2C19.4117761%20L31.7647218%2C30.0000167%20C31.7647219%2C30.9746363%2032.5548092%2C31.7647237%2033.5294285%2C31.7647237%20L41.5239031%2C31.7647237%20L34.4650761%2C38.8235508%20L24.7058947%2C38.8235508%20C23.7312753%2C38.8235508%2022.9411879%2C39.6136382%2022.9411879%2C40.5882575%20L22.9411879%2C45.8823778%20L26.4706014%2C45.8823778%20L26.4706014%2C42.3529643%20L30.9356624%2C42.3529643%20L23.8768354%2C49.4117914%20L19.4117743%2C49.4117914%20C18.4371549%2C49.4117914%2017.6470675%2C50.2018788%2017.6470675%2C51.1764981%20L17.6470675%2C54.7059117%20C17.6504049%2C54.9674302%2017.7129076%2C55.2248042%2017.8298886%2C55.4587302%20L16.4456526%2C56.8429662%20C15.7446193%2C57.5200453%2015.7252005%2C58.6372282%2016.4022825%2C59.3382615%20C17.0793616%2C60.0392948%2018.1965445%2C60.0587136%2018.8975778%2C59.3816316%20C18.9122847%2C59.3674273%2018.9267436%2C59.3529684%2018.940948%2C59.3382615%20L56.6964963%2C21.5830662%20C57.3856425%2C20.8939094%2057.3856425%2C19.7765747%2056.6964963%2C19.0874179%20Z%22%20id%3D%22Combined-Shape%22%3E%3C%2Fpath%3E%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fg%3E%20%20%20%20%20%20%20%20%3C%2Fg%3E%20%20%20%20%3C%2Fg%3E%3C%2Fsvg%3E\"","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { LoadingChannels } from '../Loading';\nimport { TranslationContext } from '../../context';\n\nimport placeholder from '../../assets/str-chat__connection-error.svg';\n\n/**\n * ChatDown - Indicator that chat is down or your network isn't working\n * @example ../../docs/ChatDown.md\n * @typedef {import('types').ChatDownProps} Props\n * @type {React.FC<Props>}\n */\nconst ChatDown = ({ image, type = 'Error', text }) => {\n  const { t } = useContext(TranslationContext);\n\n  return (\n    <div className=\"str-chat__down\">\n      <LoadingChannels />\n      <div className=\"str-chat__down-main\">\n        <img data-testid=\"chatdown-img\" src={image || placeholder} />\n        <h1>{type}</h1>\n        <h3>\n          {text ||\n            t('Error connecting to chat, refresh the page to try again.')}\n        </h3>\n      </div>\n    </div>\n  );\n};\n\nChatDown.propTypes = {\n  /** The image url for this error */\n  image: PropTypes.string,\n  /** The type of error */\n  type: PropTypes.string.isRequired,\n  /** The error message to show */\n  text: PropTypes.string,\n};\n\nexport default React.memo(ChatDown);\n","export default \"data:image/svg+xml,%3Csvg%20width%3D%228%22%20height%3D%225%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cdefs%3E%3Cpath%20id%3D%22b%22%20d%3D%22M.667.667L4%204%207.333.667z%22%2F%3E%3Cfilter%20x%3D%22-7.5%25%22%20y%3D%22-15%25%22%20width%3D%22115%25%22%20height%3D%22160%25%22%20filterUnits%3D%22objectBoundingBox%22%20id%3D%22a%22%3E%3CfeOffset%20dy%3D%221%22%20in%3D%22SourceAlpha%22%20result%3D%22shadowOffsetOuter1%22%2F%3E%3CfeComposite%20in%3D%22shadowOffsetOuter1%22%20in2%3D%22SourceAlpha%22%20operator%3D%22out%22%20result%3D%22shadowOffsetOuter1%22%2F%3E%3CfeColorMatrix%20values%3D%220%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.685858243%200%22%20in%3D%22shadowOffsetOuter1%22%2F%3E%3C%2Ffilter%3E%3C%2Fdefs%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cuse%20fill%3D%22%23000%22%20filter%3D%22url%28%23a%29%22%20xlink%3Ahref%3D%22%23b%22%2F%3E%3Cuse%20fill-opacity%3D%22.7%22%20fill%3D%22%23FFF%22%20xlink%3Ahref%3D%22%23b%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\"","// @ts-check\n\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { Avatar } from '../Avatar';\nimport { ChatDown } from '../ChatDown';\nimport { LoadingChannels } from '../Loading';\nimport { ChatContext } from '../../context';\n\nimport chevrondown from '../../assets/str-chat__icon-chevron-down.svg';\n\n/**\n * ChannelList - A preview list of channels, allowing you to select the channel you want to open\n * @example ../../docs/ChannelList.md\n * @type React.FC<import('types').ChannelListUIComponentProps>\n */\nconst ChannelListTeam = ({\n  error = false,\n  loading,\n  sidebarImage,\n  showSidebar,\n  LoadingErrorIndicator = ChatDown,\n  LoadingIndicator = LoadingChannels,\n  children,\n}) => {\n  const { client } = useContext(ChatContext);\n\n  if (error) {\n    return <LoadingErrorIndicator type=\"Connection Error\" />;\n  }\n  if (loading) {\n    return <LoadingIndicator />;\n  }\n  return (\n    <div className=\"str-chat__channel-list-team\">\n      {showSidebar && (\n        <div className=\"str-chat__channel-list-team__sidebar\">\n          <div className=\"str-chat__channel-list-team__sidebar--top\">\n            <Avatar image={sidebarImage} size={50} />\n          </div>\n        </div>\n      )}\n      <div className=\"str-chat__channel-list-team__main\">\n        <div className=\"str-chat__channel-list-team__header\">\n          <div className=\"str-chat__channel-list-team__header--left\">\n            <Avatar\n              image={client.user.image}\n              name={client.user.name || client.user.id}\n              size={40}\n            />\n          </div>\n          <div className=\"str-chat__channel-list-team__header--middle\">\n            <div className=\"str-chat__channel-list-team__header--title\">\n              {client.user.name || client.user.id}\n            </div>\n            <div\n              className={`str-chat__channel-list-team__header--status ${client.user.status}`}\n            >\n              {client.user.status}\n            </div>\n          </div>\n          <div className=\"str-chat__channel-list-team__header--right\">\n            <button className=\"str-chat__channel-list-team__header--button\">\n              <img src={chevrondown} />\n            </button>\n          </div>\n        </div>\n        {children}\n      </div>\n    </div>\n  );\n};\n\nChannelListTeam.propTypes = {\n  /** When true, loading indicator is shown - [LoadingChannels](https://github.com/GetStream/stream-chat-react/blob/master/src/components/LoadingChannels.js) */\n  loading: PropTypes.bool,\n  /** When true, error indicator is shown - [ChatDown](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChatDown.js) */\n  error: PropTypes.bool,\n  /** When true, sidebar containing logo of the team is visible */\n  showSidebar: PropTypes.bool,\n  /** Url for sidebar logo image. */\n  sidebarImage: PropTypes.string,\n  /**\n   * Loading indicator UI Component. It will be displayed if `loading` prop is true.\n   *\n   * Defaults to and accepts same props as:\n   * [LoadingChannels](https://github.com/GetStream/stream-chat-react/blob/master/src/components/LoadingChannels.js)\n   *\n   */\n  LoadingIndicator: /** @type {PropTypes.Validator<React.ElementType<import('types').LoadingIndicatorProps>>} */ (PropTypes.elementType),\n  /**\n   * Error indicator UI Component. It will be displayed if `error` prop is true\n   *\n   * Defaults to and accepts same props as:\n   * [ChatDown](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChatDown.js)\n   *\n   */\n  LoadingErrorIndicator: /** @type {PropTypes.Validator<React.ElementType<import('types').ChatDownProps>>} */ (PropTypes.elementType),\n};\n\nexport default ChannelListTeam;\n","// @ts-check\nimport React from 'react';\nimport PropTypes from 'prop-types';\n// @ts-ignore\nimport { LoadingIndicator } from 'react-file-utils';\n\n/**\n * @type {React.FC<import('types').LoadMoreButtonProps>}\n */\nconst LoadMoreButton = ({ onClick, refreshing, children = 'Load more' }) => (\n  <div className=\"str-chat__load-more-button\">\n    <button\n      className=\"str-chat__load-more-button__button\"\n      onClick={onClick}\n      data-testid=\"load-more-button\"\n      disabled={refreshing}\n    >\n      {refreshing ? <LoadingIndicator /> : children}\n    </button>\n  </div>\n);\n\nLoadMoreButton.propTypes = {\n  /** onClick handler load more button. Pagination logic should be executed in this handler. */\n  onClick: PropTypes.func.isRequired,\n  /** If true, LoadingIndicator is displayed instead of button */\n  refreshing: PropTypes.bool.isRequired,\n};\n\nexport default React.memo(LoadMoreButton);\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport DefaultLoadMoreButton from './LoadMoreButton';\nimport { smartRender } from '../../utils';\n\nconst LoadMorePaginator = ({\n  reverse,\n  hasNextPage,\n  refreshing,\n  loadNextPage,\n  LoadMoreButton,\n  children,\n}) => (\n  <>\n    {!reverse && children}\n    {hasNextPage &&\n      smartRender(LoadMoreButton, { refreshing, onClick: loadNextPage })}\n    {reverse && children}\n  </>\n);\n\nLoadMorePaginator.defaultProps = {\n  LoadMoreButton: DefaultLoadMoreButton,\n};\n\nLoadMorePaginator.propTypes = {\n  LoadMoreButton: PropTypes.oneOfType([\n    PropTypes.node,\n    PropTypes.func,\n    PropTypes.object,\n  ]),\n  /** callback to load the next page */\n  loadNextPage: PropTypes.func,\n  /** indicates if there is a next page to load */\n  hasNextPage: PropTypes.bool,\n  /** display the items in opposite order */\n  reverse: PropTypes.bool,\n};\n\nexport default React.memo(LoadMorePaginator);\n","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { TranslationContext } from '../../context';\n\n/**\n * @type {React.FC<import('types').EmptyStateIndicatorProps>} param0\n */\nconst EmptyStateIndicator = ({ listType }) => {\n  const { t } = useContext(TranslationContext);\n  if (listType === 'channel')\n    return <p>{t('You have no channels currently')}</p>;\n\n  if (listType === 'message') return null;\n\n  return <p>No items exist</p>;\n};\n\nEmptyStateIndicator.propTypes = {\n  /** channel | message */\n  listType: PropTypes.string.isRequired,\n};\n\nexport default React.memo(EmptyStateIndicator);\n","// @ts-check\n\n/**\n * @param {string} cid\n * @param {import('stream-chat').Channel[]} channels\n */\nexport const moveChannelUp = (cid, channels) => {\n  // get channel index\n  const channelIndex = channels.findIndex((channel) => channel.cid === cid);\n\n  if (channelIndex <= 0) return channels;\n\n  // get channel from channels\n  const channel = channels[channelIndex];\n\n  // remove channel from current position\n  channels.splice(channelIndex, 1);\n  // add channel at the start\n  channels.unshift(channel);\n\n  return [...channels];\n};\n\n/**\n * @param {import('stream-chat').StreamChat} client\n * @param {string} type\n * @param {string} [id]\n */\nexport const getChannel = async (client, type, id) => {\n  const channel = client.channel(type, id);\n  await channel.watch();\n  return channel;\n};\n\nexport const MAX_QUERY_CHANNELS_LIMIT = 30;\n","// @ts-check\n\nimport { useEffect, useContext } from 'react';\nimport { ChatContext } from '../../../context';\nimport { moveChannelUp } from '../utils';\n\n/**\n * @typedef {React.Dispatch<React.SetStateAction<import('stream-chat').Channel[]>>} SetChannels\n * @param {SetChannels} setChannels\n * @param {boolean} [lockChannelOrder]\n */\nexport const useMessageNewListener = (\n  setChannels,\n  lockChannelOrder = false,\n) => {\n  const { client } = useContext(ChatContext);\n  useEffect(() => {\n    /** @param {import('stream-chat').Event<string>} e */\n    const handleEvent = (e) => {\n      setChannels((channels) => {\n        if (!lockChannelOrder) return moveChannelUp(e.cid, channels);\n        return channels;\n      });\n    };\n\n    client.on('message.new', handleEvent);\n\n    return () => {\n      client.off('message.new', handleEvent);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [lockChannelOrder]);\n};\n","// @ts-check\n\nimport { useEffect, useContext } from 'react';\nimport uniqBy from 'lodash.uniqby';\nimport { ChatContext } from '../../../context';\nimport { getChannel } from '../utils';\n\n/**\n * @typedef {import('stream-chat').Event<string>} NotificationAddedToChannelEvent\n * @typedef {React.Dispatch<React.SetStateAction<import('stream-chat').Channel[]>>} SetChannels\n * @param {SetChannels} setChannels\n * @param {(setChannels: SetChannels, event: NotificationAddedToChannelEvent) => void} [customHandler]\n */\nexport const useNotificationMessageNewListener = (\n  setChannels,\n  customHandler,\n) => {\n  const { client } = useContext(ChatContext);\n  useEffect(() => {\n    /** @param {import('stream-chat').Event<string>} e */\n    const handleEvent = async (e) => {\n      // if new message, put move channel up\n      // get channel if not in state currently\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, e);\n      } else if (e.channel?.type) {\n        const channel = await getChannel(client, e.channel.type, e.channel.id);\n        // move channel to starting position\n        setChannels((channels) => {\n          return uniqBy([channel, ...channels], 'cid');\n        });\n      }\n    };\n\n    client.on('notification.message_new', handleEvent);\n\n    return () => {\n      client.off('notification.message_new', handleEvent);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [customHandler]);\n};\n","// @ts-check\n\nimport { useEffect, useContext } from 'react';\nimport uniqBy from 'lodash.uniqby';\nimport { ChatContext } from '../../../context';\nimport { getChannel } from '../utils';\n\n/**\n * @typedef {import('stream-chat').Event<string>} NotificationAddedToChannelEvent\n * @typedef {React.Dispatch<React.SetStateAction<import('stream-chat').Channel[]>>} SetChannels\n * @param {SetChannels} setChannels\n * @param {(setChannels: SetChannels, event: NotificationAddedToChannelEvent) => void} [customHandler]\n */\nexport const useNotificationAddedToChannelListener = (\n  setChannels,\n  customHandler,\n) => {\n  const { client } = useContext(ChatContext);\n  useEffect(() => {\n    /** @param {import('stream-chat').Event<string>} e */\n    const handleEvent = async (e) => {\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, e);\n      } else if (e.channel?.type) {\n        const channel = await getChannel(client, e.channel.type, e.channel.id);\n        setChannels((channels) => uniqBy([channel, ...channels], 'cid'));\n      }\n    };\n\n    client.on('notification.added_to_channel', handleEvent);\n\n    return () => {\n      client.off('notification.added_to_channel', handleEvent);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [customHandler]);\n};\n","// @ts-check\n\nimport { useEffect, useContext } from 'react';\nimport { ChatContext } from '../../../context';\n\n/**\n * @typedef {import('stream-chat').Event<string>} NotificationAddedToChannelEvent\n * @typedef {React.Dispatch<React.SetStateAction<import('stream-chat').Channel[]>>} SetChannels\n * @param {SetChannels} setChannels\n * @param {(setChannels: SetChannels, event: NotificationAddedToChannelEvent) => void} [customHandler]\n */\nexport const useNotificationRemovedFromChannelListener = (\n  setChannels,\n  customHandler,\n) => {\n  const { client } = useContext(ChatContext);\n  useEffect(() => {\n    /** @param {import('stream-chat').Event<string>} e */\n    const handleEvent = (e) => {\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, e);\n      } else {\n        setChannels((channels) =>\n          channels.filter((channel) => channel.cid !== e.channel?.cid),\n        );\n      }\n    };\n\n    client.on('notification.removed_from_channel', handleEvent);\n\n    return () => {\n      client.off('notification.removed_from_channel', handleEvent);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [customHandler]);\n};\n","// @ts-check\n\nimport { useEffect, useContext } from 'react';\nimport { ChatContext } from '../../../context';\n\n/**\n * @typedef {import('stream-chat').Event<string>} ChannelDeletedEvent\n * @typedef {React.Dispatch<React.SetStateAction<import('stream-chat').Channel[]>>} SetChannels\n * @param {SetChannels} setChannels\n * @param {(setChannels: SetChannels, event: ChannelDeletedEvent) => void} [customHandler]\n */\nexport const useChannelDeletedListener = (setChannels, customHandler) => {\n  const { client } = useContext(ChatContext);\n\n  useEffect(() => {\n    /** @param {import('stream-chat').Event<string>} e */\n    const handleEvent = (e) => {\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, e);\n      } else {\n        setChannels((channels) => {\n          const channelIndex = channels.findIndex(\n            (channel) => channel.cid === e?.cid,\n          );\n\n          if (channelIndex < 0) return [...channels];\n\n          // Remove the deleted channel from the list.s\n          channels.splice(channelIndex, 1);\n\n          // eslint-disable-next-line consistent-return\n          return [...channels];\n        });\n      }\n    };\n\n    client.on('channel.deleted', handleEvent);\n\n    return () => {\n      client.off('channel.deleted', handleEvent);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [customHandler]);\n};\n","// @ts-check\n\nimport { useEffect, useContext } from 'react';\nimport { ChatContext } from '../../../context';\n\n/**\n * @typedef {import('stream-chat').Event<string>} ChannelTruncatedEvent\n * @typedef {React.Dispatch<React.SetStateAction<import('stream-chat').Channel[]>>} SetChannels\n * @param {SetChannels} setChannels\n * @param {(setChannels: SetChannels, event: ChannelTruncatedEvent) => void} [customHandler]\n * @param {() => void} [forceUpdate]\n */\nexport const useChannelTruncatedListener = (\n  setChannels,\n  customHandler,\n  forceUpdate,\n) => {\n  const { client } = useContext(ChatContext);\n  useEffect(() => {\n    /** @param {import('stream-chat').Event<string>} e */\n    const handleEvent = (e) => {\n      setChannels((channels) => [...channels]);\n\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, e);\n      }\n      forceUpdate?.();\n    };\n\n    client.on('channel.truncated', handleEvent);\n\n    return () => {\n      client.off('channel.truncated', handleEvent);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [customHandler]);\n};\n","// @ts-check\n\nimport { useEffect, useContext } from 'react';\nimport { ChatContext } from '../../../context';\n\n/**\n * @typedef {import('stream-chat').Event<string>} ChannelUpdatedEvent\n * @typedef {React.Dispatch<React.SetStateAction<import('stream-chat').Channel[]>>} SetChannels\n * @param {SetChannels} setChannels\n * @param {(setChannels: SetChannels, event: ChannelUpdatedEvent) => void} [customHandler]\n * @param {() => void} [forceUpdate]\n */\nexport const useChannelUpdatedListener = (\n  setChannels,\n  customHandler,\n  forceUpdate,\n) => {\n  const { client } = useContext(ChatContext);\n\n  useEffect(() => {\n    /** @param {import('stream-chat').Event<string>} e */\n    const handleEvent = (e) => {\n      setChannels((channels) => {\n        const channelIndex = channels.findIndex(\n          (channel) => channel.cid === e.channel?.cid,\n        );\n\n        if (channelIndex > -1 && e.channel) {\n          const newChannels = channels;\n          newChannels[channelIndex].data = e.channel;\n          return [...newChannels];\n        }\n\n        return channels;\n      });\n      forceUpdate?.();\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, e);\n      }\n    };\n\n    client.on('channel.updated', handleEvent);\n\n    return () => {\n      client.off('channel.updated', handleEvent);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [customHandler]);\n};\n","// @ts-check\n\nimport { useEffect, useContext } from 'react';\nimport { ChatContext } from '../../../context';\n\n/**\n * @typedef {import('stream-chat').Event<string>} ChannelHiddenEvent\n * @typedef {React.Dispatch<React.SetStateAction<import('stream-chat').Channel[]>>} SetChannels\n * @param {SetChannels} setChannels\n * @param {(setChannels: SetChannels, event: ChannelHiddenEvent) => void} [customHandler]\n */\nexport const useChannelHiddenListener = (setChannels, customHandler) => {\n  const { client } = useContext(ChatContext);\n\n  useEffect(() => {\n    /** @param {import('stream-chat').Event<string>} e */\n    const handleEvent = (e) => {\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, e);\n      } else {\n        setChannels((channels) => {\n          const channelIndex = channels.findIndex(\n            (channel) => channel.cid === e?.cid,\n          );\n          if (channelIndex < 0) return [...channels];\n\n          // Remove the hidden channel from the list.s\n          channels.splice(channelIndex, 1);\n\n          // eslint-disable-next-line consistent-return\n          return [...channels];\n        });\n      }\n    };\n\n    client.on('channel.hidden', handleEvent);\n\n    return () => {\n      client.off('channel.hidden', handleEvent);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [customHandler]);\n};\n","// @ts-check\n\nimport { useEffect, useContext } from 'react';\nimport uniqBy from 'lodash.uniqby';\nimport { ChatContext } from '../../../context';\nimport { getChannel } from '../utils';\n\n/**\n * @typedef {import('stream-chat').Event<string>} ChannelVisibleEvent\n * @typedef {React.Dispatch<React.SetStateAction<import('stream-chat').Channel[]>>} SetChannels\n * @param {SetChannels} setChannels\n * @param {(setChannels: SetChannels, event: ChannelVisibleEvent) => void} [customHandler]\n */\nexport const useChannelVisibleListener = (setChannels, customHandler) => {\n  const { client } = useContext(ChatContext);\n  useEffect(() => {\n    /** @param {import('stream-chat').Event<string>} e */\n    const handleEvent = async (e) => {\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, e);\n      } else if (e?.type) {\n        const channel = await getChannel(client, e.channel_type, e.channel_id);\n        setChannels((channels) => uniqBy([channel, ...channels], 'cid'));\n      }\n    };\n\n    client.on('channel.visible', handleEvent);\n\n    return () => {\n      client.off('channel.visible', handleEvent);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [customHandler]);\n};\n","// @ts-check\n\nimport { useEffect, useContext } from 'react';\nimport { ChatContext } from '../../../context';\n\n/**\n * @param {() => void} [forceUpdate]\n */\nexport const useConnectionRecoveredListener = (forceUpdate) => {\n  const { client } = useContext(ChatContext);\n  useEffect(() => {\n    const handleEvent = () => {\n      forceUpdate?.();\n    };\n\n    client.on('connection.recovered', handleEvent);\n\n    return () => {\n      client.off('connection.recovered', handleEvent);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n};\n","// @ts-check\n\nimport { useEffect, useContext } from 'react';\nimport { ChatContext } from '../../../context';\n\n/**\n * @typedef {React.Dispatch<React.SetStateAction<import('stream-chat').Channel[]>>} SetChannels\n * @param {SetChannels} setChannels\n */\nexport const useUserPresenceChangedListener = (setChannels) => {\n  const { client } = useContext(ChatContext);\n  useEffect(() => {\n    /** @param {import('stream-chat').Event<string>} e */\n    const handleEvent = (e) => {\n      setChannels((channels) => {\n        const newChannels = channels.map((channel) => {\n          if (!e.user?.id || !channel.state.members[e.user.id]) return channel;\n\n          channel.state.members.setIn([e.user.id, 'user'], e.user);\n\n          return channel;\n        });\n\n        return [...newChannels];\n      });\n    };\n\n    client.on('user.presence.changed', handleEvent);\n\n    return () => {\n      client.off('user.presence.changed', handleEvent);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n};\n","// @ts-check\n\nimport { useEffect, useState } from 'react';\nimport { MAX_QUERY_CHANNELS_LIMIT } from '../utils';\n/**\n * @typedef {import('stream-chat').Channel} Channel\n * @param {import('stream-chat').StreamChat} client\n * @param {import('types').ChannelFilters} filters\n * @param {import('types').ChannelSort} [sort]\n * @param {import('types').ChannelOptions} [options]\n * @param {(channels: Channel[], setChannels: React.Dispatch<React.SetStateAction<Channel[]>>) => void} [activeChannelHandler]\n */\nexport const usePaginatedChannels = (\n  client,\n  filters,\n  sort,\n  options,\n  activeChannelHandler,\n) => {\n  const [channels, setChannels] = useState(/** @type {Channel[]} */ ([]));\n  const [loadingChannels, setLoadingChannels] = useState(true);\n  const [refreshing, setRefreshing] = useState(true);\n  const [offset, setOffset] = useState(0);\n  const [error, setError] = useState(false);\n  const [hasNextPage, setHasNextPage] = useState(true);\n\n  /**\n   * @param {string} [queryType]\n   */\n  const queryChannels = async (queryType) => {\n    if (queryType === 'reload') {\n      setChannels([]);\n      setLoadingChannels(true);\n    }\n\n    setRefreshing(true);\n\n    const newOptions = {\n      offset: queryType === 'reload' ? 0 : offset,\n      ...options,\n      limit: options?.limit ?? MAX_QUERY_CHANNELS_LIMIT,\n    };\n\n    try {\n      const channelQueryResponse = await client.queryChannels(\n        filters,\n        sort || {},\n        newOptions,\n      );\n\n      let newChannels;\n      if (queryType === 'reload') {\n        newChannels = channelQueryResponse;\n      } else {\n        newChannels = [...channels, ...channelQueryResponse];\n      }\n\n      setChannels(newChannels);\n      setRefreshing(false);\n      setHasNextPage(channelQueryResponse.length >= newOptions.limit);\n\n      // Set active channel only after first page.\n      if (offset === 0 && activeChannelHandler) {\n        activeChannelHandler(newChannels, setChannels);\n      }\n\n      setOffset(newChannels.length);\n    } catch (e) {\n      console.warn(e);\n      setError(true);\n    }\n    setLoadingChannels(false);\n    setRefreshing(false);\n  };\n\n  const loadNextPage = () => {\n    queryChannels();\n  };\n\n  useEffect(() => {\n    queryChannels('reload');\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [filters]);\n\n  return {\n    channels,\n    loadNextPage,\n    hasNextPage,\n    status: {\n      loadingChannels,\n      refreshing,\n      error,\n    },\n    setChannels,\n  };\n};\n","// @ts-check\n\nimport { useEffect } from 'react';\n\n/**\n * @param {React.MutableRefObject<HTMLDivElement | null>} channelListRef\n * @param {boolean} navOpen\n * @param {() => void} [closeMobileNav]\n */\nexport const useMobileNavigation = (\n  channelListRef,\n  navOpen,\n  closeMobileNav,\n) => {\n  useEffect(() => {\n    /** @param {MouseEvent} e */\n    const handleClickOutside = (e) => {\n      if (\n        channelListRef.current &&\n        !channelListRef.current.contains(\n          /** @type {Node | null} */ (e.target),\n        ) &&\n        navOpen\n      ) {\n        closeMobileNav?.();\n      }\n    };\n\n    document.addEventListener('click', handleClickOutside);\n\n    return () => {\n      document.removeEventListener('click', handleClickOutside);\n    };\n  }, [navOpen, channelListRef, closeMobileNav]);\n};\n","// @ts-check\n\nimport React, { useState, useEffect, useRef, useContext } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { ChatContext } from '../../context';\nimport { smartRender } from '../../utils';\n\nimport ChannelListTeam from './ChannelListTeam';\nimport { LoadMorePaginator } from '../LoadMore';\nimport { LoadingChannels } from '../Loading';\nimport { EmptyStateIndicator as DefaultEmptyStateIndicator } from '../EmptyStateIndicator';\nimport { ChannelPreview, ChannelPreviewLastMessage } from '../ChannelPreview';\nimport { ChatDown } from '../ChatDown';\n\nimport { useMessageNewListener } from './hooks/useMessageNewListener';\nimport { useNotificationMessageNewListener } from './hooks/useNotificationMessageNewListener';\nimport { useNotificationAddedToChannelListener } from './hooks/useNotificationAddedToChannelListener';\nimport { useNotificationRemovedFromChannelListener } from './hooks/useNotificationRemovedFromChannelListener';\nimport { useChannelDeletedListener } from './hooks/useChannelDeletedListener';\nimport { useChannelTruncatedListener } from './hooks/useChannelTruncatedListener';\nimport { useChannelUpdatedListener } from './hooks/useChannelUpdatedListener';\nimport { useChannelHiddenListener } from './hooks/useChannelHiddenListener';\nimport { useChannelVisibleListener } from './hooks/useChannelVisibleListener';\nimport { useConnectionRecoveredListener } from './hooks/useConnectionRecoveredListener';\nimport { useUserPresenceChangedListener } from './hooks/useUserPresenceChangedListener';\nimport { usePaginatedChannels } from './hooks/usePaginatedChannels';\nimport { useMobileNavigation } from './hooks/useMobileNavigation';\n\nimport { MAX_QUERY_CHANNELS_LIMIT, moveChannelUp } from './utils';\n\n/**\n * ChannelList - A preview list of channels, allowing you to select the channel you want to open\n * @example ../../docs/ChannelList.md\n * @type {React.FC<import('types').ChannelListProps>}\n */\nconst ChannelList = (props) => {\n  const {\n    client,\n    setActiveChannel,\n    navOpen = false,\n    closeMobileNav,\n    channel,\n    theme,\n  } = useContext(ChatContext);\n  const channelListRef = useRef(/** @type {HTMLDivElement | null} */ (null));\n  const [channelUpdateCount, setChannelUpdateCount] = useState(0);\n\n  /**\n   * Set a channel with id {customActiveChannel} as active and move it to the top of the list.\n   * If customActiveChannel prop is absent, then set the first channel in list as active channel.\n   * @param {import('stream-chat').Channel[]} channels\n   * @param {React.Dispatch<React.SetStateAction<import('stream-chat').Channel[]>>} setChannels\n   */\n  const activeChannelHandler = (channels, setChannels) => {\n    const {\n      setActiveChannelOnMount = true,\n      customActiveChannel,\n      watchers,\n      options = {},\n    } = props;\n\n    if (\n      !channels ||\n      channels.length === 0 ||\n      channels.length > (options.limit || MAX_QUERY_CHANNELS_LIMIT)\n    ) {\n      return;\n    }\n\n    if (customActiveChannel) {\n      const customActiveChannelObject = channels.find(\n        (chan) => chan.id === customActiveChannel,\n      );\n      if (customActiveChannelObject) {\n        setActiveChannel?.(customActiveChannelObject, watchers);\n        const newChannels = moveChannelUp(\n          customActiveChannelObject.cid,\n          channels,\n        );\n        setChannels(newChannels);\n      }\n\n      return;\n    }\n\n    if (setActiveChannelOnMount) {\n      setActiveChannel?.(channels[0], watchers);\n    }\n  };\n\n  // When channel list (channels array) is updated without any shallow changes (or with only deep changes), then we want\n  // to force the channel preview to re-render.\n  // This happens in case of event channel.updated, channel.truncated etc. Inner properties of channel is updated but\n  // react renderer will only make shallow comparison and choose to not to re-render the UI.\n  // By updating the dummy prop - channelUpdateCount, we can force this re-render.\n  const forceUpdate = () => {\n    setChannelUpdateCount((count) => count + 1);\n  };\n\n  const {\n    channels,\n    loadNextPage,\n    hasNextPage,\n    status,\n    setChannels,\n  } = usePaginatedChannels(\n    client,\n    props.filters || {},\n    props.sort || {},\n    props.options || {},\n    activeChannelHandler,\n  );\n\n  useMobileNavigation(channelListRef, navOpen, closeMobileNav);\n\n  // All the event listeners\n  useMessageNewListener(setChannels, props.lockChannelOrder);\n  useNotificationMessageNewListener(setChannels, props.onMessageNew);\n  useNotificationAddedToChannelListener(setChannels, props.onAddedToChannel);\n  useNotificationRemovedFromChannelListener(\n    setChannels,\n    props.onRemovedFromChannel,\n  );\n  useChannelDeletedListener(setChannels, props.onChannelDeleted);\n  useChannelHiddenListener(setChannels, props.onChannelHidden);\n  useChannelVisibleListener(setChannels, props.onChannelVisible);\n  useChannelTruncatedListener(\n    setChannels,\n    props.onChannelTruncated,\n    forceUpdate,\n  );\n  useChannelUpdatedListener(setChannels, props.onChannelUpdated, forceUpdate);\n  useConnectionRecoveredListener(forceUpdate);\n  useUserPresenceChangedListener(setChannels);\n\n  // If the active channel is deleted, then unset the active channel.\n  useEffect(() => {\n    /** @param {import('stream-chat').Event<string>} e */\n    const handleEvent = (e) => {\n      if (e?.cid === channel?.cid) {\n        setActiveChannel?.();\n      }\n    };\n\n    client.on('channel.deleted', handleEvent);\n    client.on('channel.hidden', handleEvent);\n\n    return () => {\n      client.off('channel.deleted', handleEvent);\n      client.off('channel.hidden', handleEvent);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [channel]);\n\n  // renders the channel preview or item\n  /** @param {import('stream-chat').Channel} item */\n  const renderChannel = (item) => {\n    if (!item) return null;\n\n    const { Preview = ChannelPreviewLastMessage, watchers = {} } = props;\n    const previewProps = {\n      channel: item,\n      Preview,\n      activeChannel: channel,\n      setActiveChannel,\n      watchers,\n      key: item.id,\n      // To force the update of preview component upon channel update.\n      channelUpdateCount,\n    };\n    return smartRender(ChannelPreview, { ...previewProps });\n  };\n\n  // renders the empty state indicator (when there are no channels)\n  const renderEmptyStateIndicator = () => {\n    const { EmptyStateIndicator = DefaultEmptyStateIndicator } = props;\n\n    return <EmptyStateIndicator listType=\"channel\" />;\n  };\n\n  // renders the list.\n  const renderList = () => {\n    const {\n      List = ChannelListTeam,\n      Paginator = LoadMorePaginator,\n      showSidebar,\n      LoadingIndicator = LoadingChannels,\n      LoadingErrorIndicator = ChatDown,\n    } = props;\n\n    return (\n      <List\n        loading={status.loadingChannels}\n        error={status.error}\n        showSidebar={showSidebar}\n        LoadingIndicator={LoadingIndicator}\n        LoadingErrorIndicator={LoadingErrorIndicator}\n      >\n        {!channels || channels.length === 0\n          ? renderEmptyStateIndicator()\n          : smartRender(Paginator, {\n              loadNextPage,\n              hasNextPage,\n              refreshing: status.refreshing,\n              children: channels.map((item) => renderChannel(item)),\n            })}\n      </List>\n    );\n  };\n\n  return (\n    <React.Fragment>\n      <div\n        className={`str-chat str-chat-channel-list ${theme} ${\n          navOpen ? 'str-chat-channel-list--open' : ''\n        }`}\n        ref={channelListRef}\n      >\n        {renderList()}\n      </div>\n    </React.Fragment>\n  );\n};\n\nChannelList.propTypes = {\n  /** Indicator for Empty State */\n  EmptyStateIndicator: /** @type {PropTypes.Validator<React.ElementType<import('types').EmptyStateIndicatorProps>>} */ (PropTypes.elementType),\n  /**\n   * Available built-in options (also accepts the same props as):\n   *\n   * 1. [ChannelPreviewCompact](https://getstream.github.io/stream-chat-react/#ChannelPreviewCompact) (default)\n   * 2. [ChannelPreviewLastMessage](https://getstream.github.io/stream-chat-react/#ChannelPreviewLastMessage)\n   * 3. [ChannelPreviewMessanger](https://getstream.github.io/stream-chat-react/#ChannelPreviewMessanger)\n   *\n   * The Preview to use, defaults to ChannelPreviewLastMessage\n   * */\n  Preview: /** @type {PropTypes.Validator<React.ElementType<import('types').ChannelPreviewUIComponentProps>>} */ (PropTypes.elementType),\n\n  /**\n   * Loading indicator UI Component. It will be displayed until the channels are\n   * being queried from API. Once the channels are loaded/queried, loading indicator is removed\n   * and replaced with children of the Channel component.\n   *\n   * Defaults to and accepts same props as:\n   * [LoadingChannels](https://github.com/GetStream/stream-chat-react/blob/master/src/components/LoadingChannels.js)\n   *\n   */\n  LoadingIndicator: /** @type {PropTypes.Validator<React.ElementType<import('types').LoadingIndicatorProps>>} */ (PropTypes.elementType),\n  /**\n   * Error indicator UI Component. It will be displayed if there is any error if loading the channels.\n   * This error could be related to network or failing API.\n   *\n   * Defaults to and accepts same props as:\n   * [ChatDown](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChatDown.js)\n   *\n   */\n  LoadingErrorIndicator: /** @type {PropTypes.Validator<React.ElementType<import('types').ChatDownProps>>} */ (PropTypes.elementType),\n  /**\n   * Custom UI Component for container of list of channels. Note that, list (UI component) of channels is passed\n   * to this component as children. This component is for the purpose of adding header to channel list or styling container\n   * for list of channels.\n   *\n   * Available built-in options (also accepts the same props as):\n   *\n   * 1. [ChannelListTeam](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChannelListTeam.js) (default)\n   * 2. [ChannelListMessenger](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChannelListMessenger.js)\n   *\n   * It has access to some additional props:\n   *\n   * - `setActiveChannel` {function} Check [chat context](https://getstream.github.io/stream-chat-react/#chat)\n   * - `activeChannel` Currently active channel object\n   * - `channels` {array} List of channels in channel list\n   */\n  List: /** @type {PropTypes.Validator<React.ElementType<import('types').ChannelListUIComponentProps>>} */ (PropTypes.elementType),\n  /**\n   * Paginator component for channels. It contains all the pagination logic such as\n   * - fetching next page of results when needed e.g., when scroll reaches the end of list\n   * - UI to display loading indicator when next page is being loaded\n   * - call to action button to trigger loading of next page.\n   *\n   * Available built-in options (also accepts the same props as):\n   *\n   * 1. [LoadMorePaginator](https://github.com/GetStream/stream-chat-react/blob/master/src/components/LoadMorePaginator.js)\n   * 2. [InfiniteScrollPaginator](https://github.com/GetStream/stream-chat-react/blob/master/src/components/InfiniteScrollPaginator.js)\n   */\n  Paginator: /** @type {PropTypes.Validator<React.ElementType<import('types').PaginatorProps>>} */ (PropTypes.elementType),\n  /**\n   * Function that overrides default behaviour when new message is received on channel that is not being watched\n   *\n   * @param {Component} setChannels Setter for channels value in state.\n   * @param {Event}     event       [Event object](https://getstream.io/chat/docs/event_object/?language=js) corresponding to `notification.message_new` event\n   * */\n  onMessageNew: PropTypes.func,\n  /**\n   * Function that overrides default behaviour when users gets added to a channel\n   *\n   * @param {Component} setChannels Setter for channels value in state.\n   * @param {Event}     event       [Event object](https://getstream.io/chat/docs/event_object/?language=js) corresponding to `notification.added_to_channel` event\n   * */\n  onAddedToChannel: PropTypes.func,\n  /**\n   * Function that overrides default behaviour when users gets removed from a channel\n   *\n   * @param {Component} setChannels Setter for channels value in state.\n   * @param {Event}     event       [Event object](https://getstream.io/chat/docs/event_object/?language=js) corresponding to `notification.removed_from_channel` event\n   * */\n  onRemovedFromChannel: PropTypes.func,\n  /**\n   * Function that overrides default behaviour when channel gets updated\n   *\n   * @param {Component} setChannels Setter for channels value in state.\n   * @param {Event}     event       [Event object](https://getstream.io/chat/docs/event_object/?language=js) corresponding to `notification.channel_updated` event\n   * */\n  onChannelUpdated: PropTypes.func,\n  /**\n   * Function to customize behaviour when channel gets truncated\n   *\n   * @param {Component} setChannels Setter for channels value in state.\n   * @param {Event}     event       [Event object](https://getstream.io/chat/docs/event_object/?language=js) corresponding to `channel.truncated` event\n   * */\n  onChannelTruncated: PropTypes.func,\n  /**\n   * Function that overrides default behaviour when channel gets deleted. In absence of this prop, channel will be removed from the list.\n   *\n   * @param {Component} setChannels Setter for channels value in state.\n   * @param {Event}     event       [Event object](https://getstream.io/chat/docs/event_object/?language=js) corresponding to `channel.deleted` event\n   * */\n  onChannelDeleted: PropTypes.func,\n  /**\n   * Object containing query filters\n   * @see See [Channel query documentation](https://getstream.io/chat/docs/query_channels/?language=js) for a list of available fields for filter.\n   * */\n  filters: /** @type {PropTypes.Validator<import('types').ChannelFilters>} */ (PropTypes.object),\n  /**\n   * Object containing query options\n   * @see See [Channel query documentation](https://getstream.io/chat/docs/query_channels/?language=js) for a list of available fields for options.\n   * */\n  options: PropTypes.object,\n  /**\n   * Object containing sort parameters\n   * @see See [Channel query documentation](https://getstream.io/chat/docs/query_channels/?language=js) for a list of available fields for sort.\n   * */\n  sort: /** @type {PropTypes.Validator<import('types').ChannelSort>} */ (PropTypes.object),\n  /**\n   * Object containing watcher parameters\n   * @see See [Pagination documentation](https://getstream.io/chat/docs/channel_pagination/?language=js) for a list of available fields for sort.\n   * */\n  watchers: /** @type {PropTypes.Validator<{ limit?: number | undefined; offset?: number | undefined} | null | undefined> | undefined} */ (PropTypes.object),\n\n  /**\n   * Set a Channel (of this id) to be active and move it to the top of the list of channels by ID.\n   * */\n  customActiveChannel: PropTypes.string,\n  /**\n   * Last channel will be set as active channel if true, defaults to true\n   */\n  setActiveChannelOnMount: PropTypes.bool,\n  /**\n   * If true, channels won't be dynamically sorted by most recent message.\n   */\n  lockChannelOrder: PropTypes.bool,\n};\n\nexport default React.memo(ChannelList);\n","// @ts-check\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { ChatDown } from '../ChatDown';\nimport { LoadingChannels } from '../Loading';\n\n/**\n * ChannelList - A preview list of channels, allowing you to select the channel you want to open\n * @example ../../docs/ChannelList.md\n * @type React.FC<import('types').ChannelListUIComponentProps>\n */\nexport const ChannelListMessenger = ({\n  error = false,\n  loading,\n  LoadingErrorIndicator = ChatDown,\n  LoadingIndicator = LoadingChannels,\n  children,\n}) => {\n  if (error) {\n    return <LoadingErrorIndicator type=\"Connection Error\" />;\n  }\n  if (loading) {\n    return <LoadingIndicator />;\n  }\n  return (\n    <div className=\"str-chat__channel-list-messenger\">\n      <div className=\"str-chat__channel-list-messenger__main\">{children}</div>\n    </div>\n  );\n};\n\nChannelListMessenger.propTypes = {\n  /** When true, loading indicator is shown - [LoadingChannels](https://github.com/GetStream/stream-chat-react/blob/master/src/components/LoadingChannels.js) */\n  loading: PropTypes.bool,\n  /** When true, error indicator is shown - [ChatDown](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChatDown.js) */\n  error: PropTypes.bool,\n  /**\n   * Loading indicator UI Component. It will be displayed if `loading` prop is true.\n   *\n   * Defaults to and accepts same props as:\n   * [LoadingChannels](https://github.com/GetStream/stream-chat-react/blob/master/src/components/LoadingChannels.js)\n   *\n   */\n  LoadingIndicator: /** @type {PropTypes.Validator<React.ElementType<import('types').LoadingIndicatorProps>>} */ (PropTypes.elementType),\n  /**\n   * Error indicator UI Component. It will be displayed if `error` prop is true\n   *\n   * Defaults to and accepts same props as:\n   * [ChatDown](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChatDown.js)\n   *\n   */\n  LoadingErrorIndicator: /** @type {PropTypes.Validator<React.ElementType<import('types').ChatDownProps>>} */ (PropTypes.elementType),\n};\n\nexport default ChannelListMessenger;\n","// @ts-check\nimport React from 'react';\n\n/**\n * @type {React.FC}\n */\nconst ChannelSearch = () => (\n  <div className=\"str-chat__channel-search\">\n    <input type=\"text\" placeholder=\"Search\" />\n    <button type=\"submit\">\n      <svg\n        width=\"18\"\n        height=\"17\"\n        viewBox=\"0 0 18 17\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <path\n          d=\"M0 17.015l17.333-8.508L0 0v6.617l12.417 1.89L0 10.397z\"\n          fillRule=\"evenodd\"\n        />\n      </svg>\n    </button>\n  </div>\n);\n\nexport default React.memo(ChannelSearch);\n","// @ts-check\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport PropTypes from 'prop-types';\n\nimport Dayjs from 'dayjs';\nimport { ChatContext, TranslationContext } from '../../context';\nimport { Streami18n } from '../../i18n';\n\n/**\n * Chat - Wrapper component for Chat. The needs to be placed around any other chat components.\n * This Chat component provides the ChatContext to all other components.\n *\n * The ChatContext provides the following props:\n *\n * - client (the client connection)\n * - channels (the list of channels)\n * - setActiveChannel (a function to set the currently active channel)\n * - channel (the currently active channel)\n *\n * It also exposes the withChatContext HOC which you can use to consume the ChatContext\n *\n * @example ../../docs/Chat.md\n * @typedef {import('stream-chat').Channel | undefined} ChannelState\n * @type {React.FC<{ client: import('stream-chat').StreamChat, theme?: string, i18nInstance?: Streami18n, initialNavOpen?: boolean }>}\n */\nconst Chat = ({\n  client,\n  theme = 'messaging light',\n  i18nInstance,\n  initialNavOpen = true,\n  children,\n}) => {\n  const [translators, setTranslators] = useState(\n    /** @type { Required<import('types').TranslationContextValue>} */ ({\n      t: /** @param {string} key */ (key) => key,\n      tDateTimeParser: (input) => Dayjs(input),\n    }),\n  );\n  const [mutes, setMutes] = useState(\n    /** @type {import('stream-chat').Mute[]} */ ([]),\n  );\n  const [navOpen, setNavOpen] = useState(initialNavOpen);\n  const [channel, setChannel] = useState(\n    /** @type {ChannelState} */ (undefined),\n  );\n\n  const openMobileNav = () => setTimeout(() => setNavOpen(true), 100);\n  const closeMobileNav = () => setNavOpen(false);\n  const clientMutes = client?.user?.mutes;\n\n  useEffect(() => {\n    setMutes(clientMutes || []);\n\n    /** @param {import('stream-chat').Event<string>} e */\n    const handleEvent = (e) => {\n      if (e.type === 'notification.mutes_updated') setMutes(e.me?.mutes || []);\n    };\n    if (client) client.on(handleEvent);\n    return () => client && client.off(handleEvent);\n  }, [client, clientMutes]);\n\n  useEffect(() => {\n    let streami18n;\n    if (i18nInstance instanceof Streami18n) streami18n = i18nInstance;\n    else streami18n = new Streami18n({ language: 'en' });\n\n    streami18n.registerSetLanguageCallback((t) =>\n      setTranslators((prevTranslator) => ({ ...prevTranslator, t })),\n    );\n    streami18n.getTranslators().then((translator) => {\n      if (translator) setTranslators(translator);\n    });\n  }, [i18nInstance]);\n\n  const setActiveChannel = useCallback(\n    /**\n     * @param {ChannelState} activeChannel\n     * @param {{ limit?: number; offset?: number }} [watchers]\n     * @param {React.BaseSyntheticEvent} [e]\n     */\n    async (activeChannel, watchers = {}, e) => {\n      if (e && e.preventDefault) e.preventDefault();\n\n      if (activeChannel && Object.keys(watchers).length) {\n        await activeChannel.query({ watch: true, watchers });\n      }\n      setChannel(activeChannel);\n      closeMobileNav();\n    },\n    [],\n  );\n\n  if (!translators.t) return null;\n\n  return (\n    <ChatContext.Provider\n      value={{\n        client,\n        theme,\n        channel,\n        mutes,\n        navOpen,\n        setActiveChannel,\n        openMobileNav,\n        closeMobileNav,\n      }}\n    >\n      <TranslationContext.Provider value={translators}>\n        {children}\n      </TranslationContext.Provider>\n    </ChatContext.Provider>\n  );\n};\n\nChat.propTypes = {\n  /** The StreamChat client object */\n  client: /** @type {PropTypes.Validator<import('stream-chat').StreamChat>} */ (PropTypes\n    .object.isRequired),\n  /**\n   *\n   * Theme could be used for custom styling of the components.\n   *\n   * You can override the classes used in our components under parent theme class.\n   *\n   * e.g. If you want to build a theme where background of message is black\n   *\n   * ```\n   *  <Chat client={client} theme={demo}>\n   *    <Channel>\n   *      <MessageList />\n   *    </Channel>\n   *  </Chat>\n   * ```\n   *\n   * ```scss\n   *  .demo.str-chat {\n   *    .str-chat__message-simple {\n   *      &-text-inner {\n   *        background-color: black;\n   *      }\n   *    }\n   *  }\n   * ```\n   *\n   * Built in available themes:\n   *\n   *  - `messaging light`\n   *  - `messaging dark`\n   *  - `team light`\n   *  - `team dark`\n   *  - `commerce light`\n   *  - `commerce dark`\n   *  - `livestream light`\n   *  - `livestream dark`\n   */\n  theme: PropTypes.string,\n  /** navOpen initial status */\n  initialNavOpen: PropTypes.bool,\n};\n\nexport default Chat;\n","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { TranslationContext } from '../../context';\n\n/**\n * DateSeparator - A simple date separator\n *\n * @example ../../docs/DateSeparator.md\n * @type {React.FC<import('types').DateSeparatorProps>}\n */\nconst DateSeparator = ({ position = 'right', formatDate, date }) => {\n  const { tDateTimeParser } = useContext(TranslationContext);\n  if (typeof date === 'string') return null;\n\n  return (\n    <div className=\"str-chat__date-separator\">\n      {(position === 'right' || position === 'center') && (\n        <hr className=\"str-chat__date-separator-line\" />\n      )}\n      <div className=\"str-chat__date-separator-date\">\n        {formatDate\n          ? formatDate(date)\n          : tDateTimeParser(date.toISOString()).calendar()}\n      </div>\n      {(position === 'left' || position === 'center') && (\n        <hr className=\"str-chat__date-separator-line\" />\n      )}\n    </div>\n  );\n};\n\nDateSeparator.propTypes = {\n  /** The date to format */\n  date: PropTypes.instanceOf(Date).isRequired,\n  /** Set the position of the date in the separator */\n  position: PropTypes.oneOf(['left', 'center', 'right']),\n  /** Override the default formatting of the date. This is a function that has access to the original date object. Returns a string or Node  */\n  formatDate: PropTypes.func,\n};\n\nexport default React.memo(DateSeparator);\n","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { Avatar } from '../Avatar';\nimport { TranslationContext } from '../../context';\n\n/**\n * EventComponent - Custom render component for system and channel event messages\n * @type {React.FC<import('types').EventComponentProps>}\n */\nconst EventComponent = ({ message }) => {\n  const { tDateTimeParser } = useContext(TranslationContext);\n  const { type, text, event, created_at } = message;\n\n  if (type === 'system')\n    return (\n      <div className=\"str-chat__message--system\">\n        <div className=\"str-chat__message--system__text\">\n          <div className=\"str-chat__message--system__line\" />\n          <p>{text}</p>\n          <div className=\"str-chat__message--system__line\" />\n        </div>\n        <div className=\"str-chat__message--system__date\">\n          <strong>{tDateTimeParser(created_at).format('dddd')} </strong>\n          at {tDateTimeParser(created_at).format('hh:mm A')}\n        </div>\n      </div>\n    );\n\n  if (\n    type === 'channel.event' &&\n    (event.type === 'member.removed' || event.type === 'member.added')\n  ) {\n    const name = event.user.name || event.user.id;\n    const sentence = `${name} ${\n      event.type === 'member.added'\n        ? 'has joined the chat'\n        : 'was removed from the chat'\n    }`;\n\n    return (\n      <div className=\"str-chat__event-component__channel-event\">\n        <Avatar image={event.user.image} name={name} />\n        <div className=\"str-chat__event-component__channel-event__content\">\n          <em className=\"str-chat__event-component__channel-event__sentence\">\n            {sentence}\n          </em>\n          <div className=\"str-chat__event-component__channel-event__date\">\n            {tDateTimeParser(created_at).format('LT')}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return null;\n};\n\nEventComponent.propTypes = {\n  /** Message object */\n  // @ts-ignore\n  message: PropTypes.object.isRequired,\n};\n\nexport default React.memo(EventComponent);\n","// @ts-check\nimport React, { useCallback, useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * Prevents Chrome hangups\n * See: https://stackoverflow.com/questions/47524205/random-high-content-download-time-in-chrome/47684257#47684257\n * @param {Event} e\n */\nconst mousewheelListener = (e) => {\n  if (e instanceof WheelEvent && e.deltaY === 1) {\n    e.preventDefault();\n  }\n};\n\n/**\n * @param {HTMLElement | Element | null} el\n * @returns {number}\n */\nconst calculateTopPosition = (el) => {\n  if (el instanceof HTMLElement) {\n    return el.offsetTop + calculateTopPosition(el.offsetParent);\n  }\n  return 0;\n};\n\n/**\n * Computes by recursively summing offsetTop until an element without offsetParent is reached\n * @param {HTMLElement} el\n * @param {number} scrollTop\n */\nconst calculateOffset = (el, scrollTop) => {\n  if (!el) {\n    return 0;\n  }\n\n  return (\n    calculateTopPosition(el) +\n    (el.offsetHeight - scrollTop - window.innerHeight)\n  );\n};\n\n/** @param {import(\"types\").InfiniteScrollProps} props */\nconst InfiniteScroll = ({\n  children,\n  element = 'div',\n  hasMore = false,\n  initialLoad = true,\n  isReverse = false,\n  loader,\n  loadMore,\n  threshold = 250,\n  useCapture = false,\n  useWindow = true,\n  isLoading = false,\n  listenToScroll,\n  ...elementProps\n  // eslint-disable-next-line sonarjs/cognitive-complexity\n}) => {\n  const scrollComponent = useRef(/** @type {HTMLElement | null} */ (null));\n\n  const scrollListener = useCallback(() => {\n    const el = scrollComponent.current;\n    if (!el) return;\n    const { parentElement } = el;\n\n    let offset = 0;\n    let reverseOffset = 0;\n    if (useWindow) {\n      const doc =\n        document.documentElement || document.body.parentNode || document.body;\n      const scrollTop =\n        window.pageYOffset !== undefined ? window.pageYOffset : doc.scrollTop;\n      offset = calculateOffset(el, scrollTop);\n      reverseOffset = scrollTop;\n    } else if (parentElement) {\n      offset =\n        el.scrollHeight - parentElement.scrollTop - parentElement.clientHeight;\n      reverseOffset = parentElement.scrollTop;\n    }\n    if (listenToScroll) listenToScroll(offset, reverseOffset);\n\n    // Here we make sure the element is visible as well as checking the offset\n    if (\n      (isReverse ? reverseOffset : offset) < Number(threshold) &&\n      el.offsetParent !== null &&\n      typeof loadMore === 'function'\n    ) {\n      loadMore();\n    }\n  }, [useWindow, isReverse, threshold, listenToScroll, loadMore]);\n\n  useEffect(() => {\n    const scrollEl = useWindow ? window : scrollComponent.current?.parentNode;\n    if (!hasMore || isLoading || !scrollEl) {\n      return () => {};\n    }\n\n    scrollEl.addEventListener('scroll', scrollListener, useCapture);\n    scrollEl.addEventListener('resize', scrollListener, useCapture);\n\n    if (initialLoad) {\n      scrollListener();\n    }\n\n    return () => {\n      scrollEl.removeEventListener('scroll', scrollListener, useCapture);\n      scrollEl.removeEventListener('resize', scrollListener, useCapture);\n    };\n  }, [hasMore, initialLoad, isLoading, scrollListener, useCapture, useWindow]);\n\n  useEffect(() => {\n    const scrollEl = useWindow ? window : scrollComponent.current?.parentNode;\n    if (!scrollEl) return () => {};\n    scrollEl.addEventListener('mousewheel', mousewheelListener, useCapture);\n    return () =>\n      scrollEl.removeEventListener(\n        'mousewheel',\n        mousewheelListener,\n        useCapture,\n      );\n  }, [useCapture, useWindow]);\n\n  const attributes = {\n    ...elementProps,\n    /** @param {HTMLElement} e */\n    ref: (e) => {\n      scrollComponent.current = e;\n    },\n  };\n\n  const childrenArray = [children];\n  if (isLoading && loader) {\n    if (isReverse) {\n      childrenArray.unshift(loader);\n    } else {\n      childrenArray.push(loader);\n    }\n  }\n  return React.createElement(element, attributes, childrenArray);\n};\n\nInfiniteScroll.propTypes = {\n  element: PropTypes.elementType,\n  hasMore: PropTypes.bool,\n  initialLoad: PropTypes.bool,\n  isReverse: PropTypes.bool,\n  loader: PropTypes.node,\n  loadMore: PropTypes.func.isRequired,\n  pageStart: PropTypes.number,\n  isLoading: PropTypes.bool,\n  threshold: PropTypes.number,\n  useCapture: PropTypes.bool,\n  useWindow: PropTypes.bool,\n};\n\nexport default InfiniteScroll;\n","// @ts-check\nimport React from 'react';\nimport PropTypes from 'prop-types';\n// @ts-ignore\nimport { LoadingIndicator as DefaultLoadingIndicator } from 'react-file-utils';\n\nimport InfiniteScroll from './InfiniteScroll';\n\n/**\n * @type { React.FC<import('types').InfiniteScrollPaginatorProps>}\n */\nconst InfiniteScrollPaginator = ({\n  LoadingIndicator = DefaultLoadingIndicator,\n  loadNextPage,\n  hasNextPage,\n  refreshing,\n  reverse,\n  threshold,\n  children,\n}) => (\n  <InfiniteScroll\n    loadMore={loadNextPage}\n    hasMore={hasNextPage}\n    isLoading={refreshing}\n    isReverse={reverse}\n    threshold={threshold}\n    useWindow={false}\n    loader={\n      <div\n        className=\"str-chat__infinite-scroll-paginator\"\n        key=\"loadingindicator\"\n      >\n        <LoadingIndicator />\n      </div>\n    }\n  >\n    {children}\n  </InfiniteScroll>\n);\n\nInfiniteScrollPaginator.propTypes = {\n  /** callback to load the next page */\n  loadNextPage: PropTypes.func.isRequired,\n  /** indicates if there is a next page to load */\n  hasNextPage: PropTypes.bool,\n  /** indicates if there there's currently any refreshing taking place */\n  refreshing: PropTypes.bool,\n  /** display the items in opposite order */\n  reverse: PropTypes.bool,\n  /** Offset from when to start the loadNextPage call */\n  threshold: PropTypes.number,\n  /** The loading indicator to use */\n  // @ts-ignore\n  LoadingIndicator: PropTypes.elementType,\n};\n\nexport default InfiniteScrollPaginator;\n","// @ts-check\nimport React from 'react';\nimport InfiniteScroll from './InfiniteScroll';\n\n/** @type {React.FC<import(\"types\").InfiniteScrollProps>} */\nconst ReverseInfiniteScroll = (props) => (\n  <InfiniteScroll {...props} isReverse />\n);\n\nexport default ReverseInfiniteScroll;\n","import React from 'react';\n\nconst Center = ({ children }) => (\n  <div className=\"str-chat__list__center\">{children}</div>\n);\n\nexport default React.memo(Center);\n","// @ts-check\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/** @type {React.FC<import('types').MessageNotificationProps>} */\nconst MessageNotification = ({ showNotification, onClick, children }) => {\n  if (!showNotification) return null;\n  return (\n    <button\n      data-testid=\"message-notification\"\n      className=\"str-chat__message-notification\"\n      onClick={onClick}\n    >\n      {children}\n    </button>\n  );\n};\n\nMessageNotification.defaultProps = {\n  showNotification: true,\n};\n\nMessageNotification.propTypes = {\n  /** If we should show the notification or not */\n  showNotification: PropTypes.bool.isRequired,\n  /** Onclick handler */\n  onClick: PropTypes.func.isRequired,\n};\n\nexport default React.memo(MessageNotification);\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst CustomNotification = ({ children, active, type }) => {\n  if (!active) return null;\n\n  return (\n    <div\n      className={`str-chat__custom-notification notification-${type}`}\n      data-testid=\"custom-notification\"\n    >\n      {children}\n    </div>\n  );\n};\n\nCustomNotification.propTypes = {\n  active: PropTypes.bool,\n  type: PropTypes.string,\n};\n\nexport default React.memo(CustomNotification);\n","/* eslint-disable sonarjs/cognitive-complexity */\n/* eslint-disable no-continue */\n/* eslint-disable sonarjs/no-duplicate-string */\nimport React, { useMemo } from 'react';\nimport deepequal from 'react-fast-compare';\n\nimport { Message } from '../Message';\nimport { InfiniteScroll } from '../InfiniteScrollPaginator';\n\n// fast since it usually iterates just the last few messages\nconst getLastReceived = (messages) => {\n  for (let i = messages.length - 1; i > 0; i -= 1) {\n    if (messages[i].status === 'received') return messages[i].id;\n  }\n  return null;\n};\n\nconst getReadStates = (messages, read) => {\n  // create object with empty array for each message id\n  const readData = {};\n  Object.values(read).forEach((readState) => {\n    if (!readState.last_read) return;\n\n    let userLastReadMsgId;\n    messages.forEach((msg) => {\n      if (msg.updated_at < readState.last_read) userLastReadMsgId = msg.id;\n    });\n\n    if (userLastReadMsgId) {\n      if (!readData[userLastReadMsgId]) readData[userLastReadMsgId] = [];\n      readData[userLastReadMsgId].push(readState.user);\n    }\n  });\n\n  return readData;\n};\n\nconst insertDates = (messages) => {\n  const newMessages = [];\n  for (let i = 0, l = messages.length; i < l; i += 1) {\n    const message = messages[i];\n    if (message.type === 'message.read') {\n      newMessages.push(message);\n      continue;\n    }\n    const messageDate = message.created_at.toDateString();\n    let prevMessageDate = messageDate;\n    if (i > 0) {\n      prevMessageDate = messages[i - 1].created_at.toDateString();\n    }\n\n    if (i === 0 || messageDate !== prevMessageDate) {\n      newMessages.push(\n        { type: 'message.date', date: message.created_at },\n        message,\n      );\n    } else {\n      newMessages.push(message);\n    }\n  }\n\n  return newMessages;\n};\n\nconst insertIntro = (messages, headerPosition) => {\n  const newMessages = messages;\n  // if no headerPosition is set, HeaderComponent will go at the top\n  if (!headerPosition) {\n    newMessages.unshift({ type: 'channel.intro' });\n    return newMessages;\n  }\n\n  // if no messages, intro get's inserted\n  if (!newMessages.length) {\n    newMessages.unshift({ type: 'channel.intro' });\n    return newMessages;\n  }\n\n  // else loop over the messages\n  for (let i = 0, l = messages.length; i < l; i += 1) {\n    const message = messages[i];\n\n    const messageTime = message.created_at\n      ? message.created_at.getTime()\n      : null;\n    const nextMessageTime =\n      messages[i + 1] && messages[i + 1].created_at\n        ? messages[i + 1].created_at.getTime()\n        : null;\n\n    // headerposition is smaller than message time so comes after;\n    if (messageTime < headerPosition) {\n      // if header position is also smaller than message time continue;\n      if (nextMessageTime < headerPosition) {\n        if (messages[i + 1] && messages[i + 1].type === 'message.date')\n          continue;\n        if (!nextMessageTime) {\n          newMessages.push({ type: 'channel.intro' });\n          return newMessages;\n        }\n        continue;\n      } else {\n        newMessages.splice(i + 1, 0, { type: 'channel.intro' });\n        return newMessages;\n      }\n    }\n  }\n\n  return newMessages;\n};\n\nconst getGroupStyles = (\n  message,\n  previousMessage,\n  nextMessage,\n  noGroupByUser,\n) => {\n  if (message.type === 'message.date') return '';\n  if (message.type === 'channel.event') return '';\n  if (message.type === 'channel.intro') return '';\n\n  if (noGroupByUser || message.attachments.length !== 0) return 'single';\n\n  const isTopMessage =\n    !previousMessage ||\n    previousMessage.type === 'channel.intro' ||\n    previousMessage.type === 'message.date' ||\n    previousMessage.type === 'system' ||\n    previousMessage.type === 'channel.event' ||\n    previousMessage.attachments.length !== 0 ||\n    message.user.id !== previousMessage.user.id ||\n    previousMessage.type === 'error' ||\n    previousMessage.deleted_at;\n\n  const isBottomMessage =\n    !nextMessage ||\n    nextMessage.type === 'message.date' ||\n    nextMessage.type === 'system' ||\n    nextMessage.type === 'channel.event' ||\n    nextMessage.type === 'channel.intro' ||\n    nextMessage.attachments.length !== 0 ||\n    message.user.id !== nextMessage.user.id ||\n    nextMessage.type === 'error' ||\n    nextMessage.deleted_at;\n\n  if (!isTopMessage && !isBottomMessage) {\n    if (message.deleted_at || message.type === 'error') return 'single';\n    return 'middle';\n  }\n\n  if (isBottomMessage) {\n    if (isTopMessage || message.deleted_at || message.type === 'error')\n      return 'single';\n    return 'bottom';\n  }\n\n  if (isTopMessage) return 'top';\n\n  return '';\n};\n\nconst MessageListInner = (props) => {\n  const {\n    EmptyStateIndicator,\n    MessageSystem,\n    DateSeparator,\n    HeaderComponent,\n    headerPosition,\n    bottomRef,\n    onMessageLoadCaptured,\n    messages,\n    noGroupByUser,\n    client,\n    threadList,\n    read,\n    internalMessageProps,\n    internalInfiniteScrollProps,\n  } = props;\n\n  const enrichedMessages = useMemo(() => {\n    const messageWithDates = insertDates(messages);\n    // messageWithDates.sort((a, b) => a.created_at - b.created_at); // TODO: remove if no issue came up\n    if (HeaderComponent) return insertIntro(messageWithDates, headerPosition);\n    return messageWithDates;\n  }, [HeaderComponent, headerPosition, messages]);\n\n  const messageGroupStyles = useMemo(\n    () =>\n      enrichedMessages.reduce((acc, message, i) => {\n        const style = getGroupStyles(\n          message,\n          enrichedMessages[i - 1],\n          enrichedMessages[i + 1],\n          noGroupByUser,\n        );\n        if (style) acc[message.id] = style;\n        return acc;\n      }, {}),\n    [enrichedMessages, noGroupByUser],\n  );\n\n  // get the readData, but only for messages submitted by the user themselves\n  const readData = useMemo(\n    () =>\n      getReadStates(\n        enrichedMessages.filter(({ user }) => user?.id === client.userID),\n        read,\n      ),\n    [client.userID, enrichedMessages, read],\n  );\n\n  const lastReceivedId = useMemo(() => getLastReceived(enrichedMessages), [\n    enrichedMessages,\n  ]);\n\n  const elements = useMemo(() => {\n    return enrichedMessages.map((message) => {\n      if (message.type === 'message.date') {\n        if (threadList) return null;\n\n        return (\n          <li key={`${message.date.toISOString()}-i`}>\n            <DateSeparator date={message.date} />\n          </li>\n        );\n      }\n\n      if (message.type === 'channel.intro') {\n        return (\n          <li key=\"intro\">\n            <HeaderComponent />\n          </li>\n        );\n      }\n\n      if (message.type === 'channel.event' || message.type === 'system') {\n        if (!MessageSystem) return null;\n        return (\n          <li key={message.event?.created_at || message.created_at || ''}>\n            <MessageSystem message={message} />\n          </li>\n        );\n      }\n\n      if (message.type !== 'message.read') {\n        const groupStyles = messageGroupStyles[message.id] || '';\n\n        return (\n          <li\n            className={`str-chat__li str-chat__li--${groupStyles}`}\n            key={message.id || message.created_at}\n            onLoadCapture={onMessageLoadCaptured}\n          >\n            <Message\n              client={client}\n              message={message}\n              groupStyles={[groupStyles]} /* TODO: convert to simple string */\n              readBy={readData[message.id] || []}\n              lastReceivedId={lastReceivedId}\n              threadList={threadList}\n              {...internalMessageProps}\n            />\n          </li>\n        );\n      }\n\n      return null;\n    });\n  }, [\n    MessageSystem,\n    client,\n    enrichedMessages,\n    internalMessageProps,\n    lastReceivedId,\n    messageGroupStyles,\n    onMessageLoadCaptured,\n    readData,\n    threadList,\n  ]);\n\n  if (!elements.length) return <EmptyStateIndicator listType=\"message\" />;\n\n  return (\n    <InfiniteScroll\n      isReverse\n      useWindow={false}\n      className=\"str-chat__reverse-infinite-scroll\"\n      data-testid=\"reverse-infinite-scroll\"\n      {...internalInfiniteScrollProps}\n    >\n      <ul className=\"str-chat__ul\">{elements}</ul>\n\n      <div key=\"bottom\" ref={bottomRef} />\n    </InfiniteScroll>\n  );\n};\n\nexport default React.memo(MessageListInner, deepequal);\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { Channel } from 'stream-chat';\nimport Center from './Center';\nimport MessageNotification from './MessageNotification';\nimport CustomNotification from './CustomNotification';\nimport MessageListInner from './MessageListInner';\nimport { MESSAGE_ACTIONS } from '../Message/utils';\nimport { smartRender } from '../../utils';\n\nimport { ChannelContext, withTranslationContext } from '../../context';\nimport { Attachment } from '../Attachment';\nimport { MessageSimple } from '../Message';\nimport { EmptyStateIndicator as DefaultEmptyStateIndicator } from '../EmptyStateIndicator';\nimport { LoadingIndicator as DefaultLoadingIndicator } from '../Loading';\nimport { EventComponent } from '../EventComponent';\nimport { DateSeparator as DefaultDateSeparator } from '../DateSeparator';\n\n/**\n * MessageList - The message list components renders a list of messages. Its a consumer of [Channel Context](https://getstream.github.io/stream-chat-react/#channel)\n *\n * @example ../../docs/MessageList.md\n * @extends PureComponent\n */\nclass MessageList extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      newMessagesNotification: false,\n      online: true,\n      notifications: [],\n    };\n\n    this.bottomRef = React.createRef();\n    this.messageList = React.createRef();\n    this.notificationTimeouts = [];\n  }\n\n  connectionChanged = ({ online }) => {\n    if (this.state.online !== online) this.setState({ online });\n  };\n\n  componentDidMount() {\n    // start at the bottom\n    this.scrollToBottom();\n    const messageListRect = this.messageList.current.getBoundingClientRect();\n\n    this.setState({\n      messageListRect,\n    });\n\n    this.props.client.on('connection.changed', this.connectionChanged);\n  }\n\n  componentWillUnmount() {\n    this.props.client.off('connection.changed', this.connectionChanged);\n\n    this.notificationTimeouts.forEach(clearTimeout);\n  }\n\n  getSnapshotBeforeUpdate(prevProps) {\n    if (this.props.threadList) {\n      return null;\n    }\n    // Are we adding new items to the list?\n    // Capture the scroll position so we can adjust scroll later.\n\n    if (prevProps.messages.length < this.props.messages.length) {\n      const list = this.messageList.current;\n      return {\n        offsetTop: list.scrollTop,\n        offsetBottom: list.scrollHeight - list.scrollTop,\n      };\n    }\n    return null;\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    // If we have a snapshot value, we've just added new items.\n    // Adjust scroll so these new items don't push the old ones out of view.\n    // (snapshot here is the value returned from getSnapshotBeforeUpdate)\n    const userScrolledUp = this.userScrolledUp();\n    const currentLastMessage = this.props.messages[\n      this.props.messages.length - 1\n    ];\n    const previousLastMessage =\n      prevProps.messages[prevProps.messages.length - 1];\n    if (!previousLastMessage || !currentLastMessage) {\n      return;\n    }\n\n    const hasNewMessage = currentLastMessage.id !== previousLastMessage.id;\n    const isOwner = currentLastMessage.user.id === this.props.client.userID;\n\n    const list = this.messageList.current;\n\n    // always scroll down when it's your own message that you added...\n    const scrollToBottom = hasNewMessage && (isOwner || !userScrolledUp);\n\n    if (scrollToBottom) {\n      this.scrollToBottom();\n\n      // remove the scroll notification if we already scrolled down...\n      if (this.state.newMessagesNotification)\n        this.setState({ newMessagesNotification: false });\n\n      return;\n    }\n\n    if (snapshot !== null) {\n      // Maintain the offsetTop of scroll so that content in viewport doesn't move.\n      // This is for the case where user has scroll up significantly and a new message arrives from someone.\n      if (hasNewMessage) {\n        this.scrollToTarget(snapshot.offsetTop, this.messageList.current);\n      } else {\n        // Maintain the bottomOffset of scroll.\n        // This is for the case of pagination, when more messages get loaded.\n        this.scrollToTarget(\n          list.scrollHeight - snapshot.offsetBottom,\n          this.messageList.current,\n        );\n      }\n    }\n\n    // Check the scroll position... if you're scrolled up show a little notification\n    if (hasNewMessage && !this.state.newMessagesNotification) {\n      this.setState({ newMessagesNotification: true });\n    }\n  }\n\n  scrollToBottom = () => {\n    this._scrollToRef(this.bottomRef, this.messageList);\n  };\n\n  _scrollToRef = (el, parent) => {\n    const scrollDown = () => {\n      if (el && el.current && parent && parent.current) {\n        this.scrollToTarget(el.current, parent.current);\n      }\n    };\n\n    scrollDown();\n    // scroll down after images load again\n    setTimeout(scrollDown, 200);\n  };\n\n  /**\n   * target - target to scroll to (DOM element, scrollTop Number, 'top', or 'bottom'\n   * containerEl - DOM element for the container with scrollbars\n   * source: https://stackoverflow.com/a/48429314\n   */\n  scrollToTarget = (target, containerEl) => {\n    // Moved up here for readability:\n    const isElement = target && target.nodeType === 1;\n    const isNumber =\n      Object.prototype.toString.call(target) === '[object Number]';\n\n    let scrollTop;\n    if (isElement) scrollTop = target.offsetTop;\n    else if (isNumber) scrollTop = target;\n    else if (target === 'top') scrollTop = 0;\n    else if (target === 'bottom')\n      scrollTop = containerEl.scrollHeight - containerEl.offsetHeight;\n\n    if (scrollTop !== undefined) containerEl.scrollTop = scrollTop; // eslint-disable-line no-param-reassign\n  };\n\n  goToNewMessages = () => {\n    this.scrollToBottom();\n    this.setState({ newMessagesNotification: false });\n  };\n\n  userScrolledUp = () => this.scrollOffset > 310;\n\n  listenToScroll = (offset) => {\n    this.scrollOffset = offset;\n    if (this.state.newMessagesNotification && !this.userScrolledUp()) {\n      this.setState({ newMessagesNotification: false });\n    }\n  };\n\n  /**\n   * Adds a temporary notification to message list.\n   * Notification will be removed after 5 seconds.\n   *\n   * @param notificationText  Text of notification to be added\n   * @param type              Type of notification. success | error\n   */\n  addNotification = (notificationText, type) => {\n    if (typeof notificationText !== 'string') return;\n    if (type !== 'success' && type !== 'error') return;\n\n    const id = uuidv4();\n\n    this.setState(({ notifications }) => ({\n      notifications: [...notifications, { id, text: notificationText, type }],\n    }));\n\n    // remove the notification after 5000 ms\n    const ct = setTimeout(\n      () =>\n        this.setState(({ notifications }) => ({\n          notifications: notifications.filter((n) => n.id !== id),\n        })),\n      5000,\n    );\n\n    this.notificationTimeouts.push(ct);\n  };\n\n  onMessageLoadCaptured = () => {\n    // A load event (emitted by e.g. an <img>) was captured on a message.\n    // In some cases, the loaded asset is larger than the placeholder, which means we have to scroll down.\n    if (!this.userScrolledUp()) {\n      this.scrollToBottom();\n    }\n  };\n\n  loadMore = () =>\n    this.props.messageLimit\n      ? this.props.loadMore(this.props.messageLimit)\n      : this.props.loadMore();\n\n  render() {\n    const { t } = this.props;\n\n    return (\n      <React.Fragment>\n        <div\n          className={`str-chat__list ${\n            this.props.threadList ? 'str-chat__list--thread' : ''\n          }`}\n          ref={this.messageList}\n        >\n          <MessageListInner\n            EmptyStateIndicator={this.props.EmptyStateIndicator}\n            MessageSystem={this.props.MessageSystem}\n            HeaderComponent={this.props.HeaderComponent}\n            headerPosition={this.props.headerPosition}\n            DateSeparator={this.props.DateSeparator || this.props.dateSeparator}\n            messages={this.props.messages}\n            noGroupByUser={this.props.noGroupByUser}\n            threadList={this.props.threadList}\n            client={this.props.client}\n            read={this.props.read}\n            bottomRef={this.bottomRef}\n            onMessageLoadCaptured={this.onMessageLoadCaptured}\n            internalInfiniteScrollProps={{\n              hasMore: this.props.hasMore,\n              isLoading: this.props.loadingMore,\n              listenToScroll: this.listenToScroll,\n              loadMore: this.loadMore,\n              loader: (\n                <Center key=\"loadingindicator\">\n                  {smartRender(this.props.LoadingIndicator, { size: 20 }, null)}\n                </Center>\n              ),\n            }}\n            internalMessageProps={{\n              messageListRect: this.state.messageListRect,\n              openThread: this.props.openThread,\n              members: this.props.members,\n              watchers: this.props.watchers,\n              channel: this.props.channel,\n              retrySendMessage: this.props.retrySendMessage,\n              addNotification: this.addNotification,\n              updateMessage: this.props.updateMessage,\n              removeMessage: this.props.removeMessage,\n              Message: this.props.Message,\n              mutes: this.props.mutes,\n              unsafeHTML: this.props.unsafeHTML,\n              Attachment: this.props.Attachment,\n              onMentionsClick: this.props.onMentionsClick,\n              onMentionsHover: this.props.onMentionsHover,\n              messageActions: this.props.messageActions,\n              additionalMessageInputProps: this.props\n                .additionalMessageInputProps,\n              getFlagMessageSuccessNotification: this.props\n                .getFlagMessageSuccessNotification,\n              getFlagMessageErrorNotification: this.props\n                .getFlagMessageErrorNotification,\n              getMuteUserSuccessNotification: this.props\n                .getMuteUserSuccessNotification,\n              getMuteUserErrorNotification: this.props\n                .getMuteUserErrorNotification,\n            }}\n          />\n        </div>\n\n        <div className=\"str-chat__list-notifications\">\n          {this.state.notifications.map((notification) => (\n            <CustomNotification\n              active={true}\n              key={notification.id}\n              type={notification.type}\n            >\n              {notification.text}\n            </CustomNotification>\n          ))}\n\n          <CustomNotification active={!this.state.online} type=\"error\">\n            {t('Connection failure, reconnecting now...')}\n          </CustomNotification>\n\n          <MessageNotification\n            showNotification={this.state.newMessagesNotification}\n            onClick={this.goToNewMessages}\n          >\n            {t('New Messages!')}\n          </MessageNotification>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nMessageList.propTypes = {\n  /**\n   * Date separator UI component to render\n   *\n   * Defaults to and accepts same props as: [DateSeparator](https://github.com/GetStream/stream-chat-react/blob/master/src/components/DateSeparator.js)\n   * */\n  dateSeparator: PropTypes.elementType,\n  /** Turn off grouping of messages by user */\n  noGroupByUser: PropTypes.bool,\n  /** render HTML instead of markdown. Posting HTML is only allowed server-side */\n  unsafeHTML: PropTypes.bool,\n  /** Set the limit to use when paginating messages */\n  messageLimit: PropTypes.number,\n  /**\n   * Array of allowed actions on message. e.g. ['edit', 'delete', 'mute', 'flag']\n   * If all the actions need to be disabled, empty array or false should be provided as value of prop.\n   * */\n  messageActions: PropTypes.oneOfType([PropTypes.bool, PropTypes.array]),\n  /**\n   * Boolean weather current message list is a thread.\n   */\n  threadList: PropTypes.bool,\n  /**\n   * Function that returns message/text as string to be shown as notification, when request for flagging a message is successful\n   *\n   * This function should accept following params:\n   *\n   * @param message A [message object](https://getstream.io/chat/docs/#message_format) which is flagged.\n   *\n   * */\n  getFlagMessageSuccessNotification: PropTypes.func,\n  /**\n   * Function that returns message/text as string to be shown as notification, when request for flagging a message runs into error\n   *\n   * This function should accept following params:\n   *\n   * @param message A [message object](https://getstream.io/chat/docs/#message_format) which is flagged.\n   *\n   * */\n  getFlagMessageErrorNotification: PropTypes.func,\n  /**\n   * Function that returns message/text as string to be shown as notification, when request for muting a user is successful\n   *\n   * This function should accept following params:\n   *\n   * @param user A user object which is being muted\n   *\n   * */\n  getMuteUserSuccessNotification: PropTypes.func,\n  /**\n   * Function that returns message/text as string to be shown as notification, when request for muting a user runs into error\n   *\n   * This function should accept following params:\n   *\n   * @param user A user object which is being muted\n   *\n   * */\n  getMuteUserErrorNotification: PropTypes.func,\n  /** **Available from [chat context](https://getstream.github.io/stream-chat-react/#chat)** */\n  client: PropTypes.object,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  Attachment: PropTypes.elementType,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  Message: PropTypes.elementType,\n  /**\n   * Custom UI component to display system messages.\n   *\n   * Defaults to and accepts same props as: [EventComponent](https://github.com/GetStream/stream-chat-react/blob/master/src/components/EventComponent.js)\n   */\n  MessageSystem: PropTypes.elementType,\n  /**\n   * The UI Indicator to use when MessagerList or ChannelList is empty\n   * */\n  EmptyStateIndicator: PropTypes.elementType,\n  /**\n   * Component to render at the top of the MessageList\n   * */\n  HeaderComponent: PropTypes.elementType,\n  /**\n   * Component to render at the top of the MessageList while loading new messages\n   * */\n  LoadingIndicator: PropTypes.elementType,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  messages: PropTypes.array.isRequired,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  channel: PropTypes.instanceOf(Channel).isRequired,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  updateMessage: PropTypes.func.isRequired,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  retrySendMessage: PropTypes.func,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  removeMessage: PropTypes.func,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  onMentionsClick: PropTypes.func,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  onMentionsHover: PropTypes.func,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  openThread: PropTypes.func,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  members: PropTypes.object,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  watchers: PropTypes.object,\n  /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n  read: PropTypes.object,\n  /**\n   * Additional props for underlying MessageInput component. We have instance of MessageInput\n   * component in MessageSimple component, for handling edit state.\n   * Available props - https://getstream.github.io/stream-chat-react/#messageinput\n   * */\n  additionalMessageInputProps: PropTypes.object,\n};\n\nMessageList.defaultProps = {\n  Message: MessageSimple,\n  MessageSystem: EventComponent,\n  threadList: false,\n  Attachment,\n  DateSeparator: DefaultDateSeparator,\n  LoadingIndicator: DefaultLoadingIndicator,\n  EmptyStateIndicator: DefaultEmptyStateIndicator,\n  unsafeHTML: false,\n  noGroupByUser: false,\n  messageActions: Object.keys(MESSAGE_ACTIONS),\n};\n\nexport default withTranslationContext((props) => (\n  <ChannelContext.Consumer>\n    {/* TODO: only used props needs to be passed in */}\n    {({ typing, ...channelContext }) => (\n      <MessageList {...channelContext} {...props} />\n    )}\n  </ChannelContext.Consumer>\n));\n","import React, { useEffect, useMemo, useRef, useCallback } from 'react';\nimport deepequal from 'react-fast-compare';\nimport { Virtuoso } from 'react-virtuoso';\n\nimport { ChannelContext } from '../../context';\nimport { EmptyStateIndicator } from '../EmptyStateIndicator';\nimport { Avatar } from '../Avatar';\nimport { renderText } from '../../utils';\n\nimport MessageTimestamp from '../Message/MessageTimestamp';\n\nconst ScrollSeekPlaceholder = ({ height, index }) => (\n  <div\n    style={{\n      height,\n      backgroundColor: '#fff',\n      padding: '8px',\n      boxSizing: 'border-box',\n    }}\n  >\n    <div style={{ background: '#ccc', height: '100%' }}>{index}</div>\n  </div>\n);\n\nconst Message = React.memo(function Message({ client, message, prevMessage }) {\n  const renderedText = useMemo(\n    () => renderText(message.text, message.mentioned_users),\n    [message.text, message.mentioned_users],\n  );\n\n  const isOwner = message.user.id === client.userID;\n  const prevMessageIsMine = prevMessage?.user.id === client.userID;\n\n  const bubbleClass = isOwner\n    ? 'str-chat__fast-message__bubble str-chat__fast-message__bubble--me'\n    : 'str-chat__fast-message__bubble';\n  const wrapperClass = isOwner\n    ? 'str-chat__fast-message__wrapper str-chat__fast-message__wrapper--me'\n    : 'str-chat__fast-message__wrapper';\n  const metaClass = isOwner\n    ? 'str-chat__fast-message__meta'\n    : 'str-chat__fast-message__meta';\n  return (\n    <div key={message.id} className={wrapperClass}>\n      <Avatar\n        image={message.user.image}\n        name={message.user.name || message.user.id}\n      />\n      <div className=\"str-chat__fast-message__content\">\n        <div className={bubbleClass}>{renderedText}</div>\n        <div className={metaClass}>\n          <span className=\"str-chat__fast-message__author\">\n            <strong>{message.user.name ? message.user.name : 'unknown'}</strong>\n          </span>\n          <span className=\"str-chat__fast-message__date\">\n            <MessageTimestamp\n              customClass=\"str-chat__message-simple-timestamp\"\n              message={message}\n              calendar\n            />\n          </span>\n        </div>\n      </div>\n    </div>\n  );\n}, deepequal);\n\nconst FastMessageList = ({\n  client,\n  messages,\n  loadMore,\n  hasMore,\n  hackNumber,\n}) => {\n  const virtuoso = useRef();\n  const mounted = useRef(false);\n\n  useEffect(() => {\n    if (!messages.length) return;\n\n    const lastMessage = messages[messages.length - 1];\n    const isOwner = lastMessage.user.id === client.userID;\n    if (isOwner) virtuoso.current.scrollToIndex(messages.length);\n  }, [client.userID, messages]);\n\n  const itemRenderer = useCallback(\n    (message, prevMessage) => {\n      if (!message) return null;\n      if (message.type === 'channel.event' || message.type === 'system') {\n        return null;\n      }\n\n      return (\n        <Message client={client} message={message} prevMessage={prevMessage} />\n      );\n    },\n    [client],\n  );\n\n  useEffect(() => {\n    if (mounted.current) return;\n    if (messages.length && virtuoso.current) {\n      virtuoso.current.scrollToIndex(messages.length);\n      mounted.current = true;\n    }\n  }, [messages.length]);\n\n  if (!messages.length) return <EmptyStateIndicator listType=\"message\" />;\n\n  return (\n    <div className=\"str-chat__fast-list\">\n      <Virtuoso\n        ref={virtuoso}\n        style={{ width: '100%', height: '100%' }}\n        totalCount={messages.length + (hackNumber || 0)}\n        item={(index) => itemRenderer(messages[index], messages[index - 1])}\n        rangeChanged={({ startIndex }) => {\n          if (mounted.current && hasMore && startIndex < 10)\n            loadMore().then(virtuoso.current.adjustForPrependedItems);\n        }}\n        // scrollSeek={{\n        //   enter: (velocity) => Math.abs(velocity) > 220,\n        //   exit: (velocity) => Math.abs(velocity) < 30,\n        //   change: () => null,\n        //   placeholder: ScrollSeekPlaceholder,\n        // }}\n      />\n    </div>\n  );\n};\n\nconst MemoizeFastMessageList = React.memo(FastMessageList, deepequal);\n\nexport default function FastMessageListWithContext(props) {\n  return (\n    <ChannelContext.Consumer>\n      {({ messages, client, loadMore, hasMore, loadingMore }) => {\n        return (\n          <MemoizeFastMessageList\n            messages={messages}\n            client={client}\n            loadMore={loadMore}\n            hasMore={hasMore}\n            isLoading={loadingMore}\n            {...props}\n          />\n        );\n      }}\n    </ChannelContext.Consumer>\n  );\n}\n","// @ts-check\nimport React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { Channel } from 'stream-chat';\nimport { smartRender } from '../../utils';\nimport { withChannelContext, withTranslationContext } from '../../context';\nimport { Message } from '../Message';\nimport { MessageList } from '../MessageList';\nimport { MessageInput, MessageInputSmall } from '../MessageInput';\n\n/**\n * Thread - The Thread renders a parent message with a list of replies. Use the standard message list of the main channel's messages.\n * The thread is only used for the list of replies to a message.\n * Underlying MessageList, MessageInput and Message components can be customized using props:\n * - additionalParentMessageProps\n * - additionalMessageListProps\n * - additionalMessageInputProps\n *\n * @example ../../docs/Thread.md\n * @typedef { import('types').ThreadProps & import('types').ChannelContextValue & import('types').TranslationContextValue} Props\n * @extends PureComponent<Props, any>\n */\nclass Thread extends PureComponent {\n  static propTypes = {\n    /** Display the thread on 100% width of it's container. Useful for mobile style view */\n    fullWidth: PropTypes.bool,\n    /** Make input focus on mounting thread */\n    autoFocus: PropTypes.bool,\n    /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n    channel: PropTypes.instanceOf(Channel).isRequired,\n    /** **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)** */\n    Message: /** @type {PropTypes.Validator<React.ComponentType<import('types').MessageUIComponentProps>>} */ (PropTypes.elementType),\n    /**\n     * **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)**\n     * The thread (the parent [message object](https://getstream.io/chat/docs/#message_format)) */\n    thread: /** @type {PropTypes.Validator<import('seamless-immutable').ImmutableObject<import('stream-chat').MessageResponse>>} */ (PropTypes.object),\n    /**\n     * **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)**\n     * The array of immutable messages to render. By default they are provided by parent Channel component */\n    threadMessages:\n      /** @type {PropTypes.Validator<import('seamless-immutable').ImmutableArray<import('stream-chat').MessageResponse>>} */\n      (PropTypes.array),\n    /**\n     * **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)**\n     *\n     * Function which provides next page of thread messages.\n     * loadMoreThread is called when infinite scroll wants to load more messages\n     * */\n    loadMoreThread: PropTypes.func.isRequired,\n    /**\n     * **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)**\n     * If there are more messages available, set to false when the end of pagination is reached.\n     * */\n    threadHasMore: PropTypes.bool,\n    /**\n     * **Available from [channel context](https://getstream.github.io/stream-chat-react/#channel)**\n     * If the thread is currently loading more messages. This is helpful to display a loading indicator on threadlist */\n    threadLoadingMore: PropTypes.bool,\n    /**\n     * Additional props for underlying Message component of parent message at the top.\n     * Available props - https://getstream.github.io/stream-chat-react/#message\n     * */\n    additionalParentMessageProps: PropTypes.object,\n    /**\n     * Additional props for underlying MessageList component.\n     * Available props - https://getstream.github.io/stream-chat-react/#messagelist\n     * */\n    additionalMessageListProps: PropTypes.object,\n    /**\n     * Additional props for underlying MessageInput component.\n     * Available props - https://getstream.github.io/stream-chat-react/#messageinput\n     * */\n    additionalMessageInputProps: PropTypes.object,\n    /** Customized MessageInput component to used within Thread instead of default MessageInput \n        Useable as follows:\n        ```\n        <Thread MessageInput={(props) => <MessageInput parent={props.parent} Input={MessageInputSmall} /> }/>\n        ```\n    */\n    MessageInput: /** @type {PropTypes.Validator<React.ComponentType<import('types').MessageInputProps>>} */ (PropTypes.elementType),\n  };\n\n  static defaultProps = {\n    threadHasMore: true,\n    threadLoadingMore: true,\n    fullWidth: false,\n    autoFocus: true,\n    MessageInput,\n  };\n\n  render() {\n    if (!this.props.thread) {\n      return null;\n    }\n    const parentID = this.props.thread.id;\n    const cid = this.props.channel && this.props.channel.cid;\n\n    const key = `thread-${parentID}-${cid}`;\n    // We use a wrapper to make sure the key variable is set.\n    // this ensures that if you switch thread the component is recreated\n    return <ThreadInner {...this.props} key={key} />;\n  }\n}\n\n/** @extends {PureComponent<Props, any>} */\nclass ThreadInner extends React.PureComponent {\n  static propTypes = {\n    /** Channel is passed via the Channel Context */\n    channel: PropTypes.object.isRequired,\n    /** the thread (just a message) that we're rendering */\n    thread: PropTypes.object.isRequired,\n  };\n\n  /** @param { any } props */\n  constructor(props) {\n    super(props);\n    this.messageList = React.createRef();\n  }\n\n  componentDidMount() {\n    const { thread, loadMoreThread } = this.props;\n    const parentID = thread && thread.id;\n    if (parentID && thread?.reply_count && loadMoreThread) {\n      loadMoreThread();\n    }\n  }\n\n  /** @param {Props} prevProps */\n  getSnapshotBeforeUpdate(prevProps) {\n    // Are we adding new items to the list?\n    // Capture the scroll position so we can adjust scroll later.\n    if (\n      prevProps.threadMessages &&\n      this.props.threadMessages &&\n      prevProps.threadMessages.length < this.props.threadMessages.length\n    ) {\n      const list = this.messageList.current;\n      return list.clientHeight + list.scrollTop === list.scrollHeight;\n    }\n    return null;\n  }\n\n  /**\n   * @param {Props} prevProps\n   * @param {any} prevState\n   * @param {number} snapshot\n   */\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    const { thread, threadMessages, loadMoreThread } = this.props;\n    const parentID = thread?.id;\n\n    if (\n      parentID &&\n      thread?.reply_count &&\n      thread.reply_count > 0 &&\n      threadMessages?.length === 0 &&\n      loadMoreThread\n    ) {\n      loadMoreThread();\n    }\n\n    // If we have a snapshot value, we've just added new items.\n    // Adjust scroll so these new items don't push the old ones out of view.\n    // (snapshot here is the value returned from getSnapshotBeforeUpdate)\n    if (snapshot !== null) {\n      const scrollDown = () => {\n        const list = this.messageList.current;\n        if (snapshot) list.scrollTop = list.scrollHeight;\n      };\n      scrollDown();\n      // scroll down after images load again\n      setTimeout(scrollDown, 100);\n    }\n  }\n\n  render() {\n    const { t, closeThread, thread } = this.props;\n\n    if (!thread) {\n      return null;\n    }\n\n    const read = {};\n    return (\n      <div\n        className={`str-chat__thread ${\n          this.props.fullWidth ? 'str-chat__thread--full' : ''\n        }`}\n      >\n        <div className=\"str-chat__thread-header\">\n          <div className=\"str-chat__thread-header-details\">\n            <strong>{t && t('Thread')}</strong>\n            <small>\n              {' '}\n              {t &&\n                t('{{ replyCount }} replies', {\n                  replyCount: thread.reply_count,\n                })}\n            </small>\n          </div>\n          <button\n            onClick={(e) => closeThread && closeThread(e)}\n            className=\"str-chat__square-button\"\n            data-testid=\"close-button\"\n          >\n            <svg width=\"10\" height=\"10\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path\n                d=\"M9.916 1.027L8.973.084 5 4.058 1.027.084l-.943.943L4.058 5 .084 8.973l.943.943L5 5.942l3.973 3.974.943-.943L5.942 5z\"\n                fillRule=\"evenodd\"\n              />\n            </svg>\n          </button>\n        </div>\n        <div className=\"str-chat__thread-list\" ref={this.messageList}>\n          <Message\n            // @ts-ignore\n            message={thread}\n            initialMessage\n            threadList\n            Message={this.props.Message}\n            // TODO: remove the following line in next release, since we already have additionalParentMessageProps now.\n            {...this.props}\n            {...this.props.additionalParentMessageProps}\n          />\n          <div className=\"str-chat__thread-start\">\n            {t && t('Start of a new thread')}\n          </div>\n          <MessageList\n            messages={this.props.threadMessages}\n            read={read}\n            threadList\n            loadMore={this.props.loadMoreThread}\n            hasMore={this.props.threadHasMore}\n            loadingMore={this.props.threadLoadingMore}\n            Message={this.props.Message}\n            {...this.props.additionalMessageListProps}\n          />\n        </div>\n        {smartRender(this.props.MessageInput, {\n          Input: MessageInputSmall,\n          parent: this.props.thread,\n          focus: this.props.autoFocus,\n          publishTypingEvent: false,\n          ...this.props.additionalMessageInputProps,\n        })}\n      </div>\n    );\n  }\n}\n\nexport default withChannelContext(withTranslationContext(Thread));\n","// @ts-check\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { Avatar } from '../Avatar';\n/**\n * TypingIndicator lists users currently typing\n * @typedef {import('types').TypingIndicatorProps} Props\n * @type {React.FC<Props>}\n */\nconst TypingIndicator = (props) => {\n  const typing = Object.values(props.typing);\n  let show;\n  if (\n    typing.length === 0 ||\n    (typing.length === 1 && typing[0].user.id === props.client.user.id)\n  ) {\n    show = false;\n  } else {\n    show = true;\n  }\n\n  return (\n    <div\n      className={`str-chat__typing-indicator ${\n        show ? 'str-chat__typing-indicator--typing' : ''\n      }`}\n    >\n      <div className=\"str-chat__typing-indicator__avatars\">\n        {typing\n          .filter(({ user }) => user.id !== props.client.user.id)\n          .map(({ user }) => (\n            <Avatar\n              image={user.image}\n              size={32}\n              name={user.name || user.id}\n              key={user.id}\n            />\n          ))}\n      </div>\n      <div className=\"str-chat__typing-indicator__dots\">\n        <span className=\"str-chat__typing-indicator__dot\" />\n        <span className=\"str-chat__typing-indicator__dot\" />\n        <span className=\"str-chat__typing-indicator__dot\" />\n      </div>\n    </div>\n  );\n};\n\nTypingIndicator.propTypes = {\n  /** @see See [chat context](https://getstream.github.io/stream-chat-react/#chatcontext) doc */\n  // @ts-ignore\n  client: PropTypes.object,\n  /** @see See [channel context](https://getstream.github.io/stream-chat-react/#channelcontext) doc */\n  typing: PropTypes.object.isRequired,\n};\n\nexport default React.memo(TypingIndicator);\n","// @ts-check\nimport React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { ChannelContext } from '../../context';\n\n/**\n * Window - A UI component for conditionally displaying thread or channel.\n *\n * @example ../../docs/Window.md\n * @type { React.FC<import('types').WindowProps>}\n */\nconst Window = ({ children, hideOnThread = false }) => {\n  const { thread } = useContext(ChannelContext);\n  // If thread is active and window should hide on thread. Return null\n  if (thread && hideOnThread) return null;\n\n  return <div className={`str-chat__main-panel`}>{children}</div>;\n};\n\nWindow.propTypes = {\n  /** show or hide the window when a thread is active */\n  hideOnThread: PropTypes.bool,\n};\n\nexport default React.memo(Window);\n"],"names":["ChatContext","React","createContext","client","StreamChat","setActiveChannel","withChatContext","OriginalComponent","ContextAwareComponent","ContextComponent","props","context","displayName","name","replace","ChannelContext","withChannelContext","Dayjs","extend","LocalizedFormat","TranslationContext","t","key","tDateTimeParser","input","withTranslationContext","emojiSetDef","spriteUrl","size","sheetColumns","sheetRows","sheetSize","commonEmoji","emoticons","short_names","custom","defaultMinimalEmojis","id","colons","sheet_x","sheet_y","d","Object","assign","data","emojis","emojiData","isOnlyEmojis","text","noEmojis","emojiRegex","noSpace","isPromise","thing","then","byDate","a","b","created_at","formatArray","dict","currentUserId","arr2","keys","arr3","forEach","item","i","user","push","outStr","length","join","slice","allowedMarkups","matchMarkdownLinks","message","regexMdLinks","matches","match","singleMatch","links","map","exec","truncate","end","substring","renderText","mentioned_users","newText","markdownLinks","linkifyFind","type","href","value","noParsingNeeded","filter","indexOf","displayLink","encodeURI","username","mkdown","re","RegExp","uri","startsWith","ReactMarkdown","uriTransformer","generateRandomId","S4","Math","random","toString","smartRender","ElementOrComponentOrLiteral","fallback","undefined","isValidElement","element","ComponentOrLiteral","filterEmoji","emoji","getReadByTooltipText","users","otherUsers","slicedArr","restLength","firstUser","secondUser","lastUser","splice","commaSeparatedUsers","moreCount","defaultNS","defaultLng","updateLocale","calendar","sameDay","nextDay","nextWeek","lastDay","lastWeek","sameElse","meridiemParse","meridiemHour","hour","meridiem","en_locale","weekdays","split","months","defaultStreami18nOptions","language","disableDateTimeTranslations","debug","logger","msg","console","warn","dayjsLocaleConfigForLanguage","DateTimeParser","Streami18n","options","i18n","createInstance","en","enTranslations","nl","nlTranslations","ru","ruTranslations","tr","trTranslations","fr","frTranslations","hi","hiTranslations","it","itTranslations","isCustomDateTimeParser","Ls","availableLanguages","translations","currentLanguage","getAvailableLanguages","i18nInstance","finalOptions","localeData","relativeTime","error","Error","translationsForLanguage","i18nextConfig","nsSeparator","keySeparator","fallbackLng","lng","interpolation","escapeValue","parseMissingKeyHandler","validateCurrentLanguage","addOrUpdateLocale","localeExists","timestamp","locale","init","resources","initialized","dayjsLocales","translation","customDayjsLocale","addResources","config","changeLanguage","setLanguageCallback","callback","AttachmentActions","actions","actionHandler","action","style","e","propTypes","PropTypes","string","isRequired","array","func","memo","progressUpdateInterval","Audio","og","audioRef","useRef","useState","isPlaying","setIsPlaying","progress","setProgress","updateProgress","useCallback","current","position","currentTime","duration","currentProgress","useEffect","play","interval","setInterval","clearInterval","pause","asset_url","image_url","title","description","width","SafeAnchor","children","target","className","sanitized","sanitizeUrl","Card","title_link","og_scrape_url","thumb_url","useContext","image","trimUrl","url","trimmedUrl","giphyLogo","FileAttachment","attachment","FileIcon","mime_type","file_size","prettybytes","ModalImage","src","shape","ModalComponent","images","toggleModal","index","modalIsOpen","ModalGateway","Modal","Carousel","View","number","bool","Gallery","setIndex","modalOpen","setModalOpen","selectedIndex","formattedArray","useMemo","source","renderImages","backgroundImage","imageCount","ModalWrapper","arrayOf","object","Image","currentIndex","setState","state","PureComponent","SUPPORTED_VIDEO_FORMATS","isImageAttachment","isMediaAttachment","isAudioAttachment","isFileAttachment","renderAttachmentWithinContainer","componentType","extra","renderAttachmentActions","renderImage","renderCard","renderFile","File","renderAudio","renderMedia","Media","Attachment","DefaultCard","DefaultImage","DefaultAudio","DefaultFile","DefaultMedia","DefaultAttachmentActions","rest","propsWithDefault","elementType","KEY_CODES","ESC","UP","DOWN","ENTER","TAB","SPACE","Listener","refCount","document","addEventListener","f","removeEventListener","keyCodes","fn","keyCode","listeners","code","which","values","includes","Item","onSelectHandler","Component","component","onClickHandler","selected","innerRef","selectItem","List","selectedItem","preventDefault","modifyText","getPositionInList","findIndex","getId","textToReplace","getTextToReplace","onSelect","getSelectedItem","keyboard","dropdownScroll","itemsRef","oldPosition","newPosition","Listeners","add","scroll","onPressEnter","newValues","val","cachedValues","listener","pop","remove","itemClassName","itemStyle","__html","renderHeader","ref","isSelected","defaultScrollToItem","container","itemHeight","parseInt","getComputedStyle","getPropertyValue","containerHight","itemOffsetTop","offsetTop","actualScrollTop","scrollTop","DEFAULT_CARET_POSITION","errorMessage","ReactTextareaAutocomplete","textareaRef","selectionStart","selectionEnd","substr","focus","setSelectionRange","event","trigger","currentTrigger","hasFocus","shiftKey","_replaceWord","handleSubmit","replaceWord","lastWordRegex","getCaretPosition","lastWord","spaces","newWord","textBeforeWord","textAfterCaret","CustomEvent","bubbles","dispatchEvent","onChange","newToken","textareaValue","computeCaretPosition","token","startToken","Number","isInteger","textToModify","startOfTokenPosition","search","newTokenString","caretPosition","newCaretPosition","modifiedText","dataLoading","setCaretPosition","_closeAutocomplete","triggerSettings","_getCurrentTriggerSettings","actualToken","output","String","dataProvider","Array","isArray","isValidElementType","tokenRegExp","top","left","notSafe","prop","tokens","minChar","onCaretPositionChange","movePopupAsYouType","textarea","persist","lastToken","_isCommand","tokenMatch","trim","find","getCaretCoordinates","newTop","newLeft","_getValuesFromProvider","err","closeOnClickOutside","onBlur","el","relatedTarget","dropdownRef","Node","contains","scrollToItem","loadingComponent","_createRegExp","listenerIndex","_onSpace","_onEnter","startListen","nextProps","_update","stopListen","oldValue","oldTrigger","Loader","listClassName","dropdownClassName","dropdownStyle","containerStyle","containerClassName","loaderStyle","loaderClassName","suggestionData","_getSuggestions","_getTextToReplace","_getItemOnSelect","maxRows","grow","_onSelect","_dropdownScroll","_cleanUpProps","_changeHandler","_selectHandler","_onScrollHandler","_onClickAndBlurHandler","onFocus","additionalTextareaProps","triggerPropsCheck","triggers","entries","triggerChar","settings","triggerSetting","listStyle","Avatar","onClick","onMouseOver","loaded","setLoaded","setError","initials","charAt","height","flexBasis","lineHeight","fontSize","objectFit","oneOf","ChannelPreviewCountOnly","channel","watchers","unread","displayTitle","getLatestMessagePreview","latestMessage","messages","deleted_at","command","attachments","getDisplayTitle","currentUser","members","otherMember","m","getDisplayImage","ChannelPreview","activeChannel","Preview","lastMessage","setLastMessage","setUnread","countUnread","handleEvent","isActive","cid","on","off","ChannelPreviewCompact","channelPreviewButton","unreadClass","unread_count","activeClass","active","onSelectChannel","blur","displayImage","instanceOf","Channel","ChannelPreviewLastMessage","latestMessageLength","defaultProps","ChannelPreviewMessenger","ReplyIcon","DeliveredCheckIcon","ReactionIcon","ThreadIcon","ErrorIcon","MessageRepliesCountButton","reply_count","labelSingle","labelPlural","singleReplyText","pluralReplyText","replyCount","onClose","open","handleClick","handleEscKey","KeyboardEvent","openClasses","LoadingItems","LoadingChannels","LoadingErrorIndicator","LoadingIndicator","color","stopColor","EmoticonItem","entity","native","UserItem","CommandItem","args","emojiReplace","word","found","emojiIndex","ChatAutoComplete","getMembersAndWatchers","memberUsers","watcherUsers","uniqueUsers","queryMembersdebounced","debounce","query","onReady","queryMembers","$autocomplete","response","commands","onSelectItem","getTriggers","q","result","matchingUsers","toLowerCase","selectedCommands","c","sort","nameA","nameB","updateInnerRef","AutoCompleteTextarea","rows","placeholder","onPaste","disabled","Tooltip","getAttachmentTypeFromMime","mime","emptyFileUploads","emptyImageUploads","initState","imageOrder","imageUploads","Immutable","fileOrder","fileUploads","numberOfUploads","emojiPickerIsOpen","reduce","acc","setIn","file","messageInputReducer","getNewText","imageAlreadyExists","concat","newUploadFields","fileAlreadyExists","_id","without","useMessageInputState","doImageUploadRequest","doFileUploadRequest","clearEditingState","overrideSubmitHandler","parent","noFiles","errorHandler","publishTypingEvent","useReducer","dispatch","emojiPickerRef","channelContext","editMessage","sendMessage","newCursorPosition","insertText","textToInsert","textareaElement","prevText","handleChange","logChatPromiseExecution","keystroke","closeEmojiPicker","openEmojiPicker","onSelectEmoji","getCommands","getConfig","getUsers","_user","self","getAttachmentsFromUploads","imageAttachments","upload","every","fileAttachments","trimmedMessage","isEmptyMessage","someAttachmentsUploading","some","newAttachments","actualMentionedUsers","from","Set","updatedMessage","updateMessagePromise","sendMessagePromise","stopTyping","uploadFile","fileUpload","sendFile","alreadyRemoved","removeFile","uploadImage","img","sendImage","FileReader","imageUpload","previewUri","reader","onload","readAsDataURL","removeImage","uploadNewFiles","files","items","clipboardData","dataTransferItemsHaveFiles","plainTextItem","kind","plainTextPromise","Promise","resolve","getAsString","s","dataTransferItemsToFiles","fileLikes","EmojiPicker","small","Picker","UploadsPreview","ImagePreviewer","multipleUploads","maxNumberOfFiles","FilePreviewer","SendButton","MessageInputLarge","messageInput","useMessageInput","constructTypingString","typingUsers","otherTypingUsers","ImageDropzone","acceptedFiles","autocompleteTriggers","FileUploadButton","watcher_count","watcherCount","typing","Input","SendButtonComponent","MessageInput","MessageInputFlat","MessageInputSmall","EditMessageForm","onKeyDown","log","ReactionSelectorWithRef","latest_reactions","reaction_counts","reactionOptions","reverse","handleReaction","detailedView","tooltipReactionType","setTooltipReactionType","tooltipPositions","setTooltipPositions","containerRef","tooltipRef","targetRef","useImperativeHandle","showTooltip","reactionType","hideTooltip","tooltip","getBoundingClientRect","tooltipPosition","x","arrowPosition","arrow","getUsersPerReactionType","reaction","Boolean","getLatestUserForReactionType","visibility","reactionOption","latestUser","count","NimbleEmoji","ReactionSelector","forwardRef","objectOf","ReactionsList","reactions","getTotalReactionCount","total","getOptionForType","option","getReactionTypes","allTypes","emojiDefinition","SimpleReactionsList","handleActionWarning","useActionHandler","updateMessage","removeMessage","messageID","formData","sendAction","useDeleteHandler","deleteMessage","useEditHandler","customInitialState","customSetEditing","customClearEditingHandler","editing","setEditing","setEdit","clearEdit","validateAndGetMessage","returnValue","isUserMuted","mutes","userMuted","MESSAGE_ACTIONS","edit","delete","flag","mute","getMessageActions","canDelete","canFlag","canEdit","canMute","messageActionsAfterPermission","messageActions","areMessagePropsEqual","deepequal","readBy","groupStyles","lastReceivedId","messageListRect","shouldMessageComponentUpdate","messageHasReactions","messageHasAttachments","getImages","getNonImageAttachments","MessagePropTypes","html","Date","updated_at","missingUseFlagHandlerParameterWarning","useFlagHandler","notifications","notify","getSuccessNotification","getErrorNotification","flagMessage","successMessage","createEventHandler","useMentionsHandler","customMentionHandler","channelOnMentionsClick","onMentionsClick","channelOnMentionsHover","onMentionsHover","useMentionsUIHandler","eventHandlers","missingUseMuteHandlerParamsWarning","useMuteHandler","muteUser","unmuteUser","fallbackMessage","useOpenThreadHandler","customOpenThread","channelOpenThread","openThread","reactionHandlerWarning","useReactionHandler","userExistingReaction","userID","own_reactions","originalMessage","reactionChangePromise","deleteReaction","sendReaction","useReactionClick","reactionSelectorRef","messageWrapperRef","showDetailedReactions","setShowDetailedReactions","messageDeleted","hasListener","closeDetailedReactions","messageWrapper","onReactionListClick","useRetryHandler","customRetrySendMessage","contextRetrySendMessage","retrySendMessage","useUserHandler","onUserClick","onUserClickHandler","onUserHover","onUserHoverHandler","useUserRole","isMyMessage","isAdmin","role","membership","isOwner","isModerator","canEditMessage","canDeleteMessage","MessageActionsBox","handleFlag","handleMute","handleEdit","handleDelete","mine","setReverse","checkIfReverse","containerElement","containerRect","right","MessageActions","addNotification","setEditingState","getMuteUserSuccessNotification","getMuteUserErrorNotification","getFlagMessageErrorNotification","getFlagMessageSuccessNotification","propHandleFlag","propHandleMute","propHandleDelete","inline","customWrapperClass","actionsBoxOpen","setActionsBoxOpen","isMuted","hideOptions","messageDeletedAt","MessageActionsWrapper","defaultWrapperClass","wrapperClass","onClickOptionsAction","wrapperProps","MessageOptionsComponent","displayActions","displayLeft","displayReplies","propHandleOpenThread","handleOpenThread","initialMessage","theme","threadList","channelConfig","shouldShowReplies","replies","shouldShowReactions","status","MessageTextComponent","DefaultReactionList","DefaultReactionSelector","propOnMentionsClick","onMentionsClickMessage","propOnMentionsHover","onMentionsHoverMessage","customInnerClass","unsafeHTML","customOptionProps","hasReactions","hasAttachment","messageText","innerClass","MessageDeleted","messageClasses","defaultTimestampFormat","notValidDateWarning","noParsingFunctionWarning","getDateString","messageCreatedAt","formatDate","format","parse","parsedTime","MessageTimestamp","propTDatetimeParser","customClass","contextTDateTimeParser","when","MessageSimple","propUpdateMessage","propHandleAction","handleAction","propHandleReaction","propHandleRetry","handleRetry","onUserClickCustomHandler","onUserHoverCustomHandler","propTDateTimeParser","channelUpdateMessage","createRef","DefaultAttachment","DefaultMessageDeleted","additionalMessageInputProps","retryHandler","MessageSimpleStatus","justReadByMe","lastReadUser","Message","oneOfType","node","actionsEnabled","y","bottom","toJSON","propChannel","propOnUserClick","propOnUserHover","propOpenThread","propRetrySendMessage","MessageUIComponent","contextChannel","messageActionsHandler","reaction_scores","MessageCommerce","DefaultReactionsList","firstGroupStyle","MessageLivestreamComponent","propEditing","propSetEdit","propClearEdit","propChannelConfig","propT","contextT","ownEditing","ownSetEditing","ownClearEditing","galleryImages","MessageLivestreamActions","MessageTeam","retry","marginRight","MessageTeamStatus","MessageTeamAttachments","Fragment","useMentionsHandlers","tagName","textContent","innerHTML","userName","useEditMessageHandler","doUpdateMessageRequest","channelReducer","read","loading","thread","hasMore","loadingMore","parentId","threadMessages","threads","messageToImmutable","threadLoadingMore","threadHasMore","initialState","EmptyPlaceholder","StreamChannel","doSendMessageRequest","doMarkReadRequest","ChannelInner","LoadingIndicatorComponent","LoadingErrorIndicatorComponent","AttachmentComponent","MessageSimpleComponent","originalTitle","lastRead","chatContext","throttledCopyStateFromChannel","throttle","leading","trailing","markRead","disconnected","read_events","markReadThrottled","mainChannelUpdated","parent_id","show_in_channel","hidden","useLayoutEffect","errored","done","onVisibilityChange","watch","loadMoreFinished","loadMore","limit","oldestMessage","oldestID","perPage","id_lt","queryResponse","hasMoreMessages","addMessageSorted","doSendMessage","messageData","messageResponse","createMessagePreview","clientSideID","uuidv4","filterErrorMessages","messagePreview","loadMoreThreadFinished","loadMoreThread","parentID","oldMessages","oldestMessageID","getReplies","threadHasMoreMessages","newThreadMessages","closeThread","onMentionsHoverOrClick","channelContextValue","core","ChannelHeader","live","openMobileNav","subtitle","member_count","memberCount","ChatDown","ChannelListTeam","sidebarImage","showSidebar","chevrondown","LoadMoreButton","refreshing","LoadMorePaginator","hasNextPage","loadNextPage","DefaultLoadMoreButton","EmptyStateIndicator","listType","moveChannelUp","channels","channelIndex","unshift","getChannel","MAX_QUERY_CHANNELS_LIMIT","useMessageNewListener","setChannels","lockChannelOrder","useNotificationMessageNewListener","customHandler","uniqBy","useNotificationAddedToChannelListener","useNotificationRemovedFromChannelListener","useChannelDeletedListener","useChannelTruncatedListener","forceUpdate","useChannelUpdatedListener","newChannels","useChannelHiddenListener","useChannelVisibleListener","channel_type","channel_id","useConnectionRecoveredListener","useUserPresenceChangedListener","usePaginatedChannels","filters","activeChannelHandler","loadingChannels","setLoadingChannels","setRefreshing","offset","setOffset","setHasNextPage","queryChannels","queryType","newOptions","channelQueryResponse","useMobileNavigation","channelListRef","navOpen","closeMobileNav","handleClickOutside","ChannelList","channelUpdateCount","setChannelUpdateCount","setActiveChannelOnMount","customActiveChannel","customActiveChannelObject","chan","onMessageNew","onAddedToChannel","onRemovedFromChannel","onChannelDeleted","onChannelHidden","onChannelVisible","onChannelTruncated","onChannelUpdated","renderChannel","previewProps","renderEmptyStateIndicator","DefaultEmptyStateIndicator","renderList","Paginator","ChannelListMessenger","ChannelSearch","Chat","initialNavOpen","translators","setTranslators","setMutes","setNavOpen","setChannel","setTimeout","clientMutes","me","streami18n","registerSetLanguageCallback","prevTranslator","getTranslators","translator","DateSeparator","date","toISOString","EventComponent","sentence","mousewheelListener","WheelEvent","deltaY","calculateTopPosition","HTMLElement","offsetParent","calculateOffset","offsetHeight","window","innerHeight","InfiniteScroll","initialLoad","isReverse","loader","threshold","useCapture","useWindow","isLoading","listenToScroll","elementProps","scrollComponent","scrollListener","parentElement","reverseOffset","doc","documentElement","body","parentNode","pageYOffset","scrollHeight","clientHeight","scrollEl","attributes","childrenArray","createElement","pageStart","InfiniteScrollPaginator","DefaultLoadingIndicator","ReverseInfiniteScroll","Center","MessageNotification","showNotification","CustomNotification","getLastReceived","getReadStates","readData","readState","last_read","userLastReadMsgId","insertDates","newMessages","l","messageDate","toDateString","prevMessageDate","insertIntro","headerPosition","messageTime","getTime","nextMessageTime","getGroupStyles","previousMessage","nextMessage","noGroupByUser","isTopMessage","isBottomMessage","MessageListInner","MessageSystem","HeaderComponent","bottomRef","onMessageLoadCaptured","internalMessageProps","internalInfiniteScrollProps","enrichedMessages","messageWithDates","messageGroupStyles","elements","MessageList","online","_scrollToRef","messageList","scrollDown","scrollToTarget","containerEl","isElement","nodeType","isNumber","prototype","call","scrollToBottom","newMessagesNotification","scrollOffset","userScrolledUp","notificationText","ct","n","notificationTimeouts","messageLimit","connectionChanged","clearTimeout","prevProps","list","offsetBottom","prevState","snapshot","currentLastMessage","previousLastMessage","hasNewMessage","dateSeparator","notification","goToNewMessages","DefaultDateSeparator","prevMessage","renderedText","prevMessageIsMine","bubbleClass","metaClass","FastMessageList","hackNumber","virtuoso","mounted","scrollToIndex","itemRenderer","Virtuoso","startIndex","adjustForPrependedItems","MemoizeFastMessageList","FastMessageListWithContext","Thread","fullWidth","autoFocus","additionalParentMessageProps","additionalMessageListProps","ThreadInner","TypingIndicator","show","Window","hideOnThread"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA;;;;IAIaA,WAAW,gBAAGC,cAAK,CAACC,aAAN;AACzB;AAAiC;AAC/BC,EAAAA,MAAM,EAAE,IAAIC,qBAAJ,CAAe,EAAf,CADuB;AAE/BC,EAAAA,gBAAgB,EAAE;AAAA,WAAM,IAAN;AAAA;AAFa,CADR;AAO3B;;;;;;;AAMO,SAASC,eAAT,CAAyBC,iBAAzB,EAA4C;AACjD;AACA,MAAMC,qBAAqB,GAAG,SAASC,gBAAT,CAA0BC,KAA1B,EAAiC;AAC7D,wBACET,6BAAC,WAAD,CAAa,QAAb,QACG,UAACU,OAAD;AAAA,0BAAaV,6BAAC,iBAAD,eAAuBU,OAAvB,EAAoCD,KAApC,EAAb;AAAA,KADH,CADF;AAKD,GAND;;AAQAF,EAAAA,qBAAqB,CAACI,WAAtB,GAAoC,CAClCL,iBAAiB,CAACK,WAAlB,IACAL,iBAAiB,CAACM,IADlB,IAEA,WAHkC,EAIlCC,OAJkC,CAI1B,MAJ0B,EAIlB,EAJkB,CAApC;AAMA,SAAON,qBAAP;AACD;;AClCD;;;;IAIaO,cAAc,gBAAGd,cAAK,CAACC,aAAN;AAC5B;AAAoC,EADR;AAI9B;;;;;;;AAMO,SAASc,kBAAT,CAA4BT,iBAA5B,EAA+C;AACpD;AACA,MAAMC,qBAAqB,GAAG,SAASC,gBAAT,CAA0BC,KAA1B,EAAiC;AAC7D,wBACET,6BAAC,cAAD,CAAgB,QAAhB,QACG,UAACU,OAAD;AAAA,0BAAaV,6BAAC,iBAAD,eAAuBU,OAAvB,EAAoCD,KAApC,EAAb;AAAA,KADH,CADF;AAKD,GAND;;AAQAF,EAAAA,qBAAqB,CAACI,WAAtB,GAAoC,CAClCL,iBAAiB,CAACK,WAAlB,IACAL,iBAAiB,CAACM,IADlB,IAEA,WAHkC,EAIlCC,OAJkC,CAI1B,MAJ0B,EAIlB,EAJkB,CAApC;AAMA,SAAON,qBAAP;AACD;;AC7BDS,KAAK,CAACC,MAAN,CAAaC,eAAb;AAEA;;;;IAIaC,kBAAkB,gBAAGnB,cAAK,CAACC,aAAN;AAChC;AAAwC;AACtCmB,EAAAA,CAAC;AAAE;AAA2B,aAACC,GAAD;AAAA,WAASA,GAAT;AAAA,GADQ;AAEtCC,EAAAA,eAAe,EAAE,yBAACC,KAAD;AAAA,WAAWP,KAAK,CAACO,KAAD,CAAhB;AAAA;AAFqB,CADR;AAOlC;;;;;;;AAMO,SAASC,sBAAT,CAAgClB,iBAAhC,EAAmD;AACxD;AACA,MAAMC,qBAAqB,GAAG,SAASC,gBAAT,CAA0BC,KAA1B,EAAiC;AAC7D,wBACET,6BAAC,kBAAD,CAAoB,QAApB,QACG,UAACU,OAAD;AAAA,0BAAaV,6BAAC,iBAAD,eAAuBU,OAAvB,EAAoCD,KAApC,EAAb;AAAA,KADH,CADF;AAKD,GAND;;AAQAF,EAAAA,qBAAqB,CAACI,WAAtB,GAAoC,CAClCL,iBAAiB,CAACK,WAAlB,IACAL,iBAAiB,CAACM,IADlB,IAEA,WAHkC,EAIlCC,OAJkC,CAI1B,MAJ0B,EAIlB,EAJkB,CAApC;AAMA,SAAON,qBAAP;AACD;;;;;ICnCYkB,WAAW,GAAG;AACzBC,EAAAA,SAAS,EAAE,qDADc;AAEzBC,EAAAA,IAAI,EAAE,EAFmB;AAGzBC,EAAAA,YAAY,EAAE,CAHW;AAIzBC,EAAAA,SAAS,EAAE,CAJc;AAKzBC,EAAAA,SAAS,EAAE;AALc;IAQdC,WAAW,GAAG;AACzBC,EAAAA,SAAS,EAAE,EADc;AAEzBC,EAAAA,WAAW,EAAE,EAFY;AAGzBC,EAAAA,MAAM,EAAE;AAHiB;AAK3B;;IACaC,oBAAoB,GAAG;AAEhCC,EAAAA,EAAE,EAAE,MAF4B;AAGhCxB,EAAAA,IAAI,EAAE,MAH0B;AAIhCyB,EAAAA,MAAM,EAAE,MAJwB;AAKhCC,EAAAA,OAAO,EAAE,CALuB;AAMhCC,EAAAA,OAAO,EAAE;AANuB,GAO7BR,WAP6B,GAQ7BN,WAR6B;AAWhCW,EAAAA,EAAE,EAAE,MAX4B;AAYhCxB,EAAAA,IAAI,EAAE,MAZ0B;AAahCyB,EAAAA,MAAM,EAAE,SAbwB;AAchCC,EAAAA,OAAO,EAAE,CAduB;AAehCC,EAAAA,OAAO,EAAE;AAfuB,GAgB7BR,WAhB6B,GAiB7BN,WAjB6B;AAoBhCW,EAAAA,EAAE,EAAE,MApB4B;AAqBhCxB,EAAAA,IAAI,EAAE,MArB0B;AAsBhCyB,EAAAA,MAAM,EAAE,OAtBwB;AAuBhCC,EAAAA,OAAO,EAAE,CAvBuB;AAwBhCC,EAAAA,OAAO,EAAE;AAxBuB,GAyB7BR,WAzB6B,GA0B7BN,WA1B6B;AA6BhCW,EAAAA,EAAE,EAAE,KA7B4B;AA8BhCxB,EAAAA,IAAI,EAAE,KA9B0B;AA+BhCyB,EAAAA,MAAM,EAAE,cA/BwB;AAgChCC,EAAAA,OAAO,EAAE,CAhCuB;AAiChCC,EAAAA,OAAO,EAAE;AAjCuB,GAkC7BR,WAlC6B,GAmC7BN,WAnC6B;AAsChCW,EAAAA,EAAE,EAAE,KAtC4B;AAuChCxB,EAAAA,IAAI,EAAE,KAvC0B;AAwChCyB,EAAAA,MAAM,EAAE,WAxCwB;AAyChCC,EAAAA,OAAO,EAAE,CAzCuB;AA0ChCC,EAAAA,OAAO,EAAE;AA1CuB,GA2C7BR,WA3C6B,GA4C7BN,WA5C6B;AA+ChCW,EAAAA,EAAE,EAAE,OA/C4B;AAgDhCxB,EAAAA,IAAI,EAAE,OAhD0B;AAiDhCyB,EAAAA,MAAM,EAAE,SAjDwB;AAkDhCC,EAAAA,OAAO,EAAE,CAlDuB;AAmDhCC,EAAAA,OAAO,EAAE;AAnDuB,GAoD7BR,WApD6B,GAqD7BN,WArD6B;AAyDpC,IAAMe,CAAC,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBC,IAAlB,CAAV;AACAH,CAAC,CAACI,MAAF,GAAW,EAAX;;IAGaC,SAAS,GAAGL;IAEZM,YAAY,GAAG,SAAfA,YAAe,CAACC,IAAD,EAAU;AACpC,MAAI,CAACA,IAAL,EAAW,OAAO,KAAP;AAEX,MAAMC,QAAQ,GAAGD,IAAI,CAAClC,OAAL,CAAaoC,UAAU,EAAvB,EAA2B,EAA3B,CAAjB;AACA,MAAMC,OAAO,GAAGF,QAAQ,CAACnC,OAAT,CAAiB,UAAjB,EAA6B,EAA7B,CAAhB;AACA,SAAO,CAACqC,OAAR;AACD;IAEYC,SAAS,GAAG,SAAZA,SAAY,CAACC,KAAD;AAAA,SAAWA,KAAK,IAAI,OAAOA,KAAK,CAACC,IAAb,KAAsB,UAA1C;AAAA;IAEZC,MAAM,GAAG,SAATA,MAAS,CAACC,CAAD,EAAIC,CAAJ;AAAA,SAAUD,CAAC,CAACE,UAAF,GAAeD,CAAC,CAACC,UAA3B;AAAA;;AAGtB;;;;;;IAKaC,WAAW,GAAG,SAAdA,WAAc,CAACC,IAAD,EAAOC,aAAP,EAAyB;AAClD,MAAMC,IAAI,GAAGpB,MAAM,CAACqB,IAAP,CAAYH,IAAZ,CAAb;AACA,MAAMI,IAAI,GAAG,EAAb;AACAF,EAAAA,IAAI,CAACG,OAAL,CAAa,UAACC,IAAD,EAAOC,CAAP,EAAa;AACxB,QAAIN,aAAa,KAAKD,IAAI,CAACE,IAAI,CAACK,CAAD,CAAL,CAAJ,CAAcC,IAAd,CAAmB/B,EAAzC,EAA6C;AAC3C;AACD;;AAED2B,IAAAA,IAAI,CAACK,IAAL,CAAUT,IAAI,CAACE,IAAI,CAACK,CAAD,CAAL,CAAJ,CAAcC,IAAd,CAAmBvD,IAAnB,IAA2B+C,IAAI,CAACE,IAAI,CAACK,CAAD,CAAL,CAAJ,CAAcC,IAAd,CAAmB/B,EAAxD;AACD,GAND;AAOA,MAAIiC,MAAM,GAAG,EAAb;;AACA,MAAIN,IAAI,CAACO,MAAL,KAAgB,CAApB,EAAuB;AACrBD,IAAAA,MAAM,GAAGN,IAAI,CAAC,CAAD,CAAJ,GAAU,eAAnB;AAED,GAHD,MAGO,IAAIA,IAAI,CAACO,MAAL,KAAgB,CAApB,EAAuB;AAC5B;AACA;AACAD,IAAAA,MAAM,GAAGN,IAAI,CAACQ,IAAL,CAAU,OAAV,IAAqB,gBAA9B;AACD,GAJM,MAIA,IAAIR,IAAI,CAACO,MAAL,GAAc,CAAlB,EAAqB;AAC1B;AACA;AACAD,IAAAA,MAAM,GACJN,IAAI,CAACS,KAAL,CAAW,CAAX,EAAc,CAAC,CAAf,EAAkBD,IAAlB,CAAuB,IAAvB,IACA,QADA,GAEAR,IAAI,CAACS,KAAL,CAAW,CAAC,CAAZ,CAFA,GAGA,gBAJF;AAKD;;AAED,SAAOH,MAAP;AACD;AAED,IAAMI,cAAc,GAAG,CACrB,MADqB,EAErB,MAFqB,EAGrB,MAHqB,EAIrB,OAJqB,EAKrB,WALqB,EAMrB,UANqB,EAOrB,QAPqB,EAQrB,MARqB,EASrB,MATqB,EAUrB,UAVqB,EAWrB,MAXqB,EAYrB,YAZqB,EAarB,YAbqB,EAcrB,QAdqB,CAAvB;;AAiBA,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,OAAD,EAAa;AACtC,MAAMC,YAAY,GAAG,wBAArB;AACA,MAAMC,OAAO,GAAGF,OAAO,CAACG,KAAR,CAAcF,YAAd,CAAhB;AACA,MAAMG,WAAW,GAAG,sBAApB;AAEA,MAAMC,KAAK,GAAGH,OAAO,GACjBA,OAAO,CAACI,GAAR,CAAY,UAACH,KAAD;AAAA,WAAWC,WAAW,CAACG,IAAZ,CAAiBJ,KAAjB,EAAwB,CAAxB,CAAX;AAAA,GAAZ,CADiB,GAEjB,EAFJ;AAGA,SAAOE,KAAP;AACD,CATD;;IAWaG,QAAQ,GAAG,SAAXA,QAAW,CAAC5D,KAAD,EAAQ+C,MAAR,EAAgC;AAAA,MAAhBc,GAAgB,uEAAV,KAAU;;AACtD,MAAI7D,KAAK,CAAC+C,MAAN,GAAeA,MAAnB,EAA2B;AACzB,qBAAU/C,KAAK,CAAC8D,SAAN,CAAgB,CAAhB,EAAmBf,MAAM,GAAGc,GAAG,CAACd,MAAhC,CAAV,SAAoDc,GAApD;AACD;;AACD,SAAO7D,KAAP;AACD;IAEY+D,UAAU,GAAG,SAAbA,UAAa,CAACvC,IAAD,EAAOwC,eAAP,EAA2B;AACnD;AACA;AACA,MAAI,CAACxC,IAAL,EAAW,OAAO,IAAP;AAEX,MAAIyC,OAAO,GAAGzC,IAAd;AACA,MAAI0C,aAAa,GAAGf,kBAAkB,CAACc,OAAD,CAAtC,CANmD;;AAQnDE,EAAAA,YAAW,CAACF,OAAD,CAAX,CAAqBxB,OAArB,CAA6B,gBAA2B;AAAA,QAAxB2B,IAAwB,QAAxBA,IAAwB;AAAA,QAAlBC,IAAkB,QAAlBA,IAAkB;AAAA,QAAZC,KAAY,QAAZA,KAAY;AACtD;AACA,QAAMC,eAAe,GACnBL,aAAa,IACbA,aAAa,CAACM,MAAd,CAAqB,UAAChD,IAAD;AAAA,aAAUA,IAAI,CAACiD,OAAL,CAAaJ,IAAb,MAAuB,CAAC,CAAlC;AAAA,KAArB,CAFF;AAGA,QAAIE,eAAe,CAACxB,MAAhB,GAAyB,CAA7B,EAAgC;AAEhC,QAAM2B,WAAW,GACfN,IAAI,KAAK,OAAT,GACIE,KADJ,GAEIV,QAAQ,CAACU,KAAK,CAAChF,OAAN,CAAc,0BAAd,EAA0C,EAA1C,CAAD,EAAgD,EAAhD,CAHd;AAIA2E,IAAAA,OAAO,GAAGA,OAAO,CAAC3E,OAAR,CAAgBgF,KAAhB,aAA2BI,WAA3B,eAA2CC,SAAS,CAACN,IAAD,CAApD,OAAV;AACD,GAZD;;AAcA,MAAIL,eAAe,IAAIA,eAAe,CAACjB,MAAvC,EAA+C;AAC7C,SAAK,IAAIJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqB,eAAe,CAACjB,MAApC,EAA4CJ,CAAC,EAA7C,EAAiD;AAC/C,UAAMiC,QAAQ,GAAGZ,eAAe,CAACrB,CAAD,CAAf,CAAmBtD,IAAnB,IAA2B2E,eAAe,CAACrB,CAAD,CAAf,CAAmB9B,EAA/D;AACA,UAAMgE,MAAM,gBAASD,QAAT,OAAZ;AACA,UAAME,EAAE,GAAG,IAAIC,MAAJ,YAAeH,QAAf,GAA2B,GAA3B,CAAX;AACAX,MAAAA,OAAO,GAAGA,OAAO,CAAC3E,OAAR,CAAgBwF,EAAhB,EAAoBD,MAApB,CAAV;AACD;AACF;;AAED,sBACEpG,6BAAC,aAAD;AACE,IAAA,YAAY,EAAEyE,cADhB;AAEE,IAAA,MAAM,EAAEe,OAFV;AAGE,IAAA,UAAU,EAAC,QAHb;AAIE,IAAA,OAAO,EAAE,EAJX;AAKE,IAAA,UAAU,EAAE,IALd;AAME,IAAA,QAAQ,EAAE,KANZ;AAOE,IAAA,gBAAgB,EAAE,IAPpB;AAQE,IAAA,gBAAgB,EAAE,0BAACe,GAAD,EAAS;AACzB,UAAIA,GAAG,CAACC,UAAJ,CAAe,QAAf,CAAJ,EAA8B;AAC5B,eAAOD,GAAP;AACD,OAFD,MAEO;AACL,eAAOE,aAAa,CAACC,cAAd,CAA6BH,GAA7B,CAAP;AACD;AACF;AAdH,IADF;AAkBD;;AAGM,SAASI,gBAAT,GAA4B;AACjC;AACA,SAAQC,EAAE,KAAGA,EAAE,EAAP,GAAU,GAAV,GAAcA,EAAE,EAAhB,GAAmB,GAAnB,GAAuBA,EAAE,EAAzB,GAA4B,GAA5B,GAAgCA,EAAE,EAAlC,GAAqC,GAArC,GAAyCA,EAAE,EAA3C,GAA8CA,EAAE,EAAhD,GAAmDA,EAAE,EAA7D;AACD;;AAED,SAASA,EAAT,GAAc;AACZ,SAAO,CAAE,CAAC,IAAIC,IAAI,CAACC,MAAL,EAAL,IAAsB,OAAvB,GAAkC,CAAnC,EAAsCC,QAAtC,CAA+C,EAA/C,EAAmD1B,SAAnD,CAA6D,CAA7D,CAAP;AACD;;IAEY2B,WAAW,GAAG,SAAdA,WAAc,CAACC,2BAAD,EAA8BxG,KAA9B,EAAqCyG,QAArC,EAAkD;AAC3E,MAAID,2BAA2B,KAAKE,SAApC,EAA+C;AAC7CF,IAAAA,2BAA2B,GAAGC,QAA9B;AACD;;AACD,oBAAIlH,cAAK,CAACoH,cAAN,CAAqBH,2BAArB,CAAJ,EAAuD;AACrD;AACA,QAAMI,OAAO,GAAGJ,2BAAhB,CAFqD;;AAGrD,WAAOI,OAAP;AACD,GAR0E;;;AAW3E,MAAMC,kBAAkB,GAAGL,2BAA3B;;AAEA,MACE,OAAOK,kBAAP,KAA8B,QAA9B,IACA,OAAOA,kBAAP,KAA8B,QAD9B,IAEA,OAAOA,kBAAP,KAA8B,SAF9B,IAGAA,kBAAkB,IAAI,IAJxB,EAKE;AACA,WAAOA,kBAAP;AACD;;AACD,sBAAOtH,6BAAC,kBAAD,EAAwBS,KAAxB,CAAP;AACD;IAEY8G,WAAW,GAAG,SAAdA,WAAc,CAACC,KAAD,EAAW;AACpC,MACEA,KAAK,CAAC5G,IAAN,KAAe,oBAAf,IACA4G,KAAK,CAAC5G,IAAN,KAAe,qBAFjB,EAGE;AACA,WAAO,KAAP;AACD;;AACD,SAAO,IAAP;AACD;IAEY6G,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACC,KAAD,EAAQtG,CAAR,EAAWlB,MAAX,EAAsB;AACxD,MAAImE,MAAM,GAAG,EAAb,CADwD;;AAGxD,MAAMsD,UAAU,GAAGD,KAAK,CACrB3B,MADgB,CACT,UAAC9B,IAAD;AAAA,WAAUA,IAAI,IAAIA,IAAI,CAAC7B,EAAL,KAAYlC,MAAM,CAACiE,IAAP,CAAY/B,EAA1C;AAAA,GADS,EAEhB6C,GAFgB,CAEZ,UAAChB,IAAD;AAAA,WAAUA,IAAI,CAACrD,IAAL,IAAaqD,IAAI,CAAC7B,EAA5B;AAAA,GAFY,CAAnB;AAIA,MAAMwF,SAAS,GAAGD,UAAU,CAACnD,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAlB;AACA,MAAMqD,UAAU,GAAGF,UAAU,CAACrD,MAAX,GAAoBsD,SAAS,CAACtD,MAAjD;;AAEA,MAAIsD,SAAS,CAACtD,MAAV,KAAqB,CAAzB,EAA4B;AAC1BD,IAAAA,MAAM,GAAGuD,SAAS,CAAC,CAAD,CAAT,GAAe,GAAxB;AACD,GAFD,MAEO,IAAIA,SAAS,CAACtD,MAAV,KAAqB,CAAzB,EAA4B;AACjC;AACA;AACAD,IAAAA,MAAM,GAAGjD,CAAC,CAAC,sCAAD,EAAyC;AACjD0G,MAAAA,SAAS,EAAEF,SAAS,CAAC,CAAD,CAD6B;AAEjDG,MAAAA,UAAU,EAAEH,SAAS,CAAC,CAAD;AAF4B,KAAzC,CAAV;AAID,GAPM,MAOA,IAAIA,SAAS,CAACtD,MAAV,GAAmB,CAAvB,EAA0B;AAC/B;AACA;AACA,QAAIuD,UAAU,KAAK,CAAnB,EAAsB;AACpB;AACA,UAAMG,QAAQ,GAAGJ,SAAS,CAACK,MAAV,CAAiBL,SAAS,CAACtD,MAAV,GAAmB,CAApC,EAAuC,CAAvC,CAAjB;AACAD,MAAAA,MAAM,GAAGjD,CAAC,CAAC,+CAAD,EAAkD;AAC1D8G,QAAAA,mBAAmB,EAAEN,SAAS,CAACrD,IAAV,CAAe,IAAf,CADqC;AAE1DyD,QAAAA;AAF0D,OAAlD,CAAV;AAID,KAPD,MAOO;AACL3D,MAAAA,MAAM,GAAGjD,CAAC,CAAC,oDAAD,EAAuD;AAC/D8G,QAAAA,mBAAmB,EAAEN,SAAS,CAACrD,IAAV,CAAe,IAAf,CAD0C;AAE/D4D,QAAAA,SAAS,EAAEN;AAFoD,OAAvD,CAAV;AAID;AACF;;AAED,SAAOxD,MAAP;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1RD,IAAM+D,SAAS,GAAG,aAAlB;AACA,IAAMC,UAAU,GAAG,IAAnB;AAaArH,KAAK,CAACC,MAAN,CAAaqH,YAAb;AAEAtH,KAAK,CAACsH,YAAN,CAAmB,IAAnB,EAAyB;AACvBC,EAAAA,QAAQ,EAAE;AACRC,IAAAA,OAAO,EAAE,iBADD;AAERC,IAAAA,OAAO,EAAE,gBAFD;AAGRC,IAAAA,QAAQ,EAAE,cAHF;AAIRC,IAAAA,OAAO,EAAE,kBAJD;AAKRC,IAAAA,QAAQ,EAAE,0BALF;AAMRC,IAAAA,QAAQ,EAAE;AANF;AADa,CAAzB;AAUA7H,KAAK,CAACsH,YAAN,CAAmB,IAAnB,EAAyB;AACvBC,EAAAA,QAAQ,EAAE;AACRC,IAAAA,OAAO,EAAE,gBADD;AAERC,IAAAA,OAAO,EAAE,kBAFD;AAGRC,IAAAA,QAAQ,EAAE,gBAHF;AAIRC,IAAAA,OAAO,EAAE,gBAJD;AAKRC,IAAAA,QAAQ,EAAE,4BALF;AAMRC,IAAAA,QAAQ,EAAE;AANF;AADa,CAAzB;AAUA7H,KAAK,CAACsH,YAAN,CAAmB,IAAnB,EAAyB;AACvBC,EAAAA,QAAQ,EAAE;AACRC,IAAAA,OAAO,EAAE,SADD;AAERC,IAAAA,OAAO,EAAE,SAFD;AAGRC,IAAAA,QAAQ,EAAE,UAHF;AAIRC,IAAAA,OAAO,EAAE,SAJD;AAKRC,IAAAA,QAAQ,EAAE,kBALF;AAMRC,IAAAA,QAAQ,EAAE;AANF,GADa;AASvB;AACA;AACAC,EAAAA,aAAa,EAAE,oBAXQ;;AAYvBC,EAAAA,YAAY,CAACC,IAAD,EAAOC,QAAP,EAAiB;AAC3B,QAAID,IAAI,KAAK,EAAb,EAAiB;AACfA,MAAAA,IAAI,GAAG,CAAP;AACD;;AACD,QAAIC,QAAQ,KAAK,KAAjB,EAAwB;AACtB,aAAOD,IAAI,GAAG,CAAP,GAAWA,IAAX,GAAkBA,IAAI,GAAG,EAAhC;AACD,KAFD,MAEO,IAAIC,QAAQ,KAAK,MAAjB,EAAyB;AAC9B,aAAOD,IAAP;AACD,KAFM,MAEA,IAAIC,QAAQ,KAAK,OAAjB,EAA0B;AAC/B,aAAOD,IAAI,IAAI,EAAR,GAAaA,IAAb,GAAoBA,IAAI,GAAG,EAAlC;AACD,KAFM,MAEA,IAAIC,QAAQ,KAAK,KAAjB,EAAwB;AAC7B,aAAOD,IAAI,GAAG,EAAd;AACD;AACF,GAzBsB;;AA0BvBC,EAAAA,QAAQ,CAACD,IAAD,EAAO;AACb,QAAIA,IAAI,GAAG,CAAX,EAAc;AACZ,aAAO,KAAP;AACD,KAFD,MAEO,IAAIA,IAAI,GAAG,EAAX,EAAe;AACpB,aAAO,MAAP;AACD,KAFM,MAEA,IAAIA,IAAI,GAAG,EAAX,EAAe;AACpB,aAAO,OAAP;AACD,KAFM,MAEA,IAAIA,IAAI,GAAG,EAAX,EAAe;AACpB,aAAO,KAAP;AACD,KAFM,MAEA;AACL,aAAO,KAAP;AACD;AACF;;AAtCsB,CAAzB;AAwCAhI,KAAK,CAACsH,YAAN,CAAmB,IAAnB,EAAyB;AACvBC,EAAAA,QAAQ,EAAE;AACRC,IAAAA,OAAO,EAAE,oBADD;AAERC,IAAAA,OAAO,EAAE,eAFD;AAGRC,IAAAA,QAAQ,EAAE,aAHF;AAIRC,IAAAA,OAAO,EAAE,aAJD;AAKRC,IAAAA,QAAQ,EAAE,qBALF;AAMRC,IAAAA,QAAQ,EAAE;AANF;AADa,CAAzB;AAUA7H,KAAK,CAACsH,YAAN,CAAmB,IAAnB,EAAyB;AACvBC,EAAAA,QAAQ,EAAE;AACRC,IAAAA,OAAO,EAAE,iBADD;AAERC,IAAAA,OAAO,EAAE,iBAFD;AAGRC,IAAAA,QAAQ,EAAE,0BAHF;AAIRC,IAAAA,OAAO,EAAE,UAJD;AAKRC,IAAAA,QAAQ,EAAE,wBALF;AAMRC,IAAAA,QAAQ,EAAE;AANF;AADa,CAAzB;AAUA7H,KAAK,CAACsH,YAAN,CAAmB,IAAnB,EAAyB;AACvBC,EAAAA,QAAQ,EAAE;AACRC,IAAAA,OAAO,EAAE,iBADD;AAERC,IAAAA,OAAO,EAAE,gBAFD;AAGRE,IAAAA,OAAO,EAAE;AAHD;AADa,CAAzB;AAQA,IAAMO,SAAS,GAAG;AAChBC,EAAAA,QAAQ,EAAE,2DAA2DC,KAA3D,CACR,GADQ,CADM;AAIhBC,EAAAA,MAAM,EAAE,wFAAwFD,KAAxF,CACN,GADM;AAJQ,CAAlB;AASA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmJA,IAAME,wBAAwB,GAAG;AAC/BC,EAAAA,QAAQ,EAAE,IADqB;AAE/BC,EAAAA,2BAA2B,EAAE,KAFE;AAG/BC,EAAAA,KAAK,EAAE,KAHwB;AAI/BC,EAAAA,MAAM,EAAE,gBAACC,GAAD;AAAA,WAASC,OAAO,CAACC,IAAR,CAAaF,GAAb,CAAT;AAAA,GAJuB;AAK/BG,EAAAA,4BAA4B,EAAE,IALC;AAM/BC,EAAAA,cAAc,EAAE/I;AANe,CAAjC;IAQagJ,UAAb;AAiBE;;;;;;;AAOA;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA,wBAA0B;AAAA;;AAAA,QAAdC,OAAc,uEAAJ,EAAI;;AAAA;;AAAA,0CAjDXC,IAAI,CAACC,cAAL,EAiDW;;AAAA,mCAhDlB,IAgDkB;;AAAA,iDA/CJ;AAAA,aAAM,IAAN;AAAA,KA+CI;;AAAA,yCA9CZ,KA8CY;;AAAA,+BA5CtB,IA4CsB;;AAAA,6CA3CR,IA2CQ;;AAAA,0CA1CX;AACbC,MAAAA,EAAE,EAAE;AAAE,SAAChC,SAAD,GAAaiC;AAAf,OADS;AAEbC,MAAAA,EAAE,EAAE;AAAE,SAAClC,SAAD,GAAamC;AAAf,OAFS;AAGbC,MAAAA,EAAE,EAAE;AAAE,SAACpC,SAAD,GAAaqC;AAAf,OAHS;AAIbC,MAAAA,EAAE,EAAE;AAAE,SAACtC,SAAD,GAAauC;AAAf,OAJS;AAKbC,MAAAA,EAAE,EAAE;AAAE,SAACxC,SAAD,GAAayC;AAAf,OALS;AAMbC,MAAAA,EAAE,EAAE;AAAE,SAAC1C,SAAD,GAAa2C;AAAf,OANS;AAObC,MAAAA,EAAE,EAAE;AAAE,SAAC5C,SAAD,GAAa6C;AAAf;AAPS,KA0CW;;AAAA,0CA3BX,EA2BW;;AAAA,0CA2GX,UAAC1B,QAAD,EAAc;AAC3B,UAAI,KAAI,CAAC2B,sBAAT,EAAiC,OAAO,IAAP;AAEjC,aAAOzI,MAAM,CAACqB,IAAP,CAAY9C,KAAK,CAACmK,EAAlB,EAAsBnF,OAAtB,CAA8BuD,QAA9B,IAA0C,CAAC,CAAlD;AACD,KA/GyB;;AAAA,qDAiHA,YAAM;AAC9B,UAAM6B,kBAAkB,GAAG3I,MAAM,CAACqB,IAAP,CAAY,KAAI,CAACuH,YAAjB,CAA3B;;AACA,UAAID,kBAAkB,CAACpF,OAAnB,CAA2B,KAAI,CAACsF,eAAhC,MAAqD,CAAC,CAA1D,EAA6D;AAC3D,QAAA,KAAI,CAAC5B,MAAL,CACE,uBAAgB,KAAI,CAAC4B,eAArB,yGAC+D,KAAI,CAACA,eADpE,0EAEgD,KAAI,CAACC,qBAAL,EAFhD,CADF;;AAMA,QAAA,KAAI,CAACD,eAAL,GAAuBjD,UAAvB;AACD;AACF,KA5HyB;;AAAA,4CA+HT;AAAA,aAAM,KAAI,CAACmD,YAAX;AAAA,KA/HS;;AAAA,mDAkIF;AAAA,aAAM/I,MAAM,CAACqB,IAAP,CAAY,KAAI,CAACuH,YAAjB,CAAN;AAAA,KAlIE;;AAAA,6CAqIR;AAAA,aAAM,KAAI,CAACA,YAAX;AAAA,KArIQ;;AACxB,QAAMI,YAAY,uCACbnC,wBADa,GAEbW,OAFa,CAAlB,CADwB;;;AAMxB,SAAKP,MAAL,GAAc+B,YAAY,CAAC/B,MAA3B;AAEA,SAAK4B,eAAL,GAAuBG,YAAY,CAAClC,QAApC;AACA,SAAKQ,cAAL,GAAsB0B,YAAY,CAAC1B,cAAnC;;AAEA,QAAI;AACF;AACA;AACA,UAAI,KAAKA,cAAL,IAAuB,KAAKA,cAAL,CAAoB9I,MAA/C,EAAuD;AACrD,aAAK8I,cAAL,CAAoB9I,MAApB,CAA2BC,eAA3B;AACA,aAAK6I,cAAL,CAAoB9I,MAApB,CAA2BsH,QAA3B;AACA,aAAKwB,cAAL,CAAoB9I,MAApB,CAA2ByK,UAA3B;AACA,aAAK3B,cAAL,CAAoB9I,MAApB,CAA2B0K,YAA3B;AACD;AACF,KATD,CASE,OAAOC,KAAP,EAAc;AACd,YAAMC,KAAK,sHACqGD,KADrG,EAAX;AAGD;;AAED,SAAKV,sBAAL,GAA8B,CAAC,CAACjB,OAAO,CAACF,cAAxC;AACA,QAAM+B,uBAAuB,GAAGL,YAAY,CAACK,uBAA7C;;AAEA,QAAIA,uBAAJ,EAA6B;AAC3B,WAAKT,YAAL,CAAkB,KAAKC,eAAvB,IAA0C;AACxC,SAAClD,SAAD,GAAa0D;AAD2B,OAA1C;AAGD,KAjCuB;;;AAoCxB,QAAI,CAAC,KAAKT,YAAL,CAAkB,KAAKC,eAAvB,CAAL,EAA8C;AAC5C,WAAKD,YAAL,CAAkB,KAAKC,eAAvB,IAA0C;AACxC,SAAClD,SAAD,GAAa;AAD2B,OAA1C;AAGD;;AAED,SAAK2D,aAAL,GAAqB;AACnBC,MAAAA,WAAW,EAAE,KADM;AAEnBC,MAAAA,YAAY,EAAE,KAFK;AAGnBC,MAAAA,WAAW,EAAE,KAHM;AAInBzC,MAAAA,KAAK,EAAEgC,YAAY,CAAChC,KAJD;AAKnB0C,MAAAA,GAAG,EAAE,KAAKb,eALS;AAMnBc,MAAAA,aAAa,EAAE;AAAEC,QAAAA,WAAW,EAAE;AAAf,OANI;AAQnBC,MAAAA,sBAAsB,EAAE,gCAACjL,GAAD,EAAS;AAC/B,QAAA,KAAI,CAACqI,MAAL,oDAAwDrI,GAAxD;;AAEA,eAAOA,GAAP;AACD;AAZkB,KAArB;AAeA,SAAKkL,uBAAL,CAA6B,KAAKjB,eAAlC;AAEA,QAAMxB,4BAA4B,GAChC2B,YAAY,CAAC3B,4BADf;;AAGA,QAAIA,4BAAJ,EAAkC;AAChC,WAAK0C,iBAAL,CAAuB,KAAKlB,eAA5B,sBACKxB,4BADL;AAGD,KAJD,MAIO,IAAI,CAAC,KAAK2C,YAAL,CAAkB,KAAKnB,eAAvB,CAAL,EAA8C;AACnD,WAAK5B,MAAL,CACE,0DAAmD,KAAK4B,eAAxD,0GACgE,KAAKA,eADrE,4IADF;AAKD;;AAED,SAAKhK,eAAL,GAAuB,UAACoL,SAAD,EAAe;AACpC,UACEjB,YAAY,CAACjC,2BAAb,IACA,CAAC,KAAI,CAACiD,YAAL,CAAkB,KAAI,CAACnB,eAAvB,CAFH,EAGE;AACA,eAAO,KAAI,CAACvB,cAAL,CAAoB2C,SAApB,EAA+BC,MAA/B,CAAsCtE,UAAtC,CAAP;AACD;;AACD,aAAO,KAAI,CAAC0B,cAAL,CAAoB2C,SAApB,EAA+BC,MAA/B,CAAsC,KAAI,CAACrB,eAA3C,CAAP;AACD,KARD;AASD;AAED;;;;;AAvIF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA2II,qBAAKiB,uBAAL;AA3IJ;AAAA;AAAA,uBA6IqB,KAAKf,YAAL,CAAkBoB,IAAlB,qCACV,KAAKb,aADK;AAEbc,kBAAAA,SAAS,EAAE,KAAKxB,YAFH;AAGbc,kBAAAA,GAAG,EAAE,KAAKb;AAHG,mBA7IrB;;AAAA;AA6IM,qBAAKlK,CA7IX;AAkJM,qBAAK0L,WAAL,GAAmB,IAAnB;AAlJN,iDAoJa;AACL1L,kBAAAA,CAAC,EAAE,KAAKA,CADH;AAELE,kBAAAA,eAAe,EAAE,KAAKA;AAFjB,iBApJb;;AAAA;AAAA;AAAA;AAyJM,qBAAKoI,MAAL;;AAzJN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAyLE;;;AAzLF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBA6LS,KAAKoD,WA7Ld;AAAA;AAAA;AAAA;;AA8LM,oBAAI,KAAKC,YAAL,CAAkB,KAAKzB,eAAvB,CAAJ,EAA6C;AAC3C,uBAAKkB,iBAAL,CACE,KAAKlB,eADP,EAEE,KAAKyB,YAAL,CAAkB,KAAKzB,eAAvB,CAFF;AAID;;AAnMP;AAAA,uBAoMmB,KAAKsB,IAAL,EApMnB;;AAAA;AAAA;;AAAA;AAAA,kDAsMa;AACLxL,kBAAAA,CAAC,EAAE,KAAKA,CADH;AAELE,kBAAAA,eAAe,EAAE,KAAKA;AAFjB,iBAtMb;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA6ME;;;;;;;;AA7MF;AAAA;AAAA,wCAoNsBiI,QApNtB,EAoNgCyD,WApNhC,EAoN6CC,iBApN7C,EAoNgE;AAC5D,UAAI,CAACD,WAAL,EAAkB;AAChB,aAAKtD,MAAL;AAGA;AACD;;AAED,UAAI,CAAC,KAAK2B,YAAL,CAAkB9B,QAAlB,CAAL,EAAkC;AAChC,aAAK8B,YAAL,CAAkB9B,QAAlB,IAA8B;AAAE,WAACnB,SAAD,GAAa4E;AAAf,SAA9B;AACD,OAFD,MAEO;AACL,aAAK3B,YAAL,CAAkB9B,QAAlB,EAA4BnB,SAA5B,IAAyC4E,WAAzC;AACD;;AAED,UAAIC,iBAAJ,EAAuB;AACrB,aAAKF,YAAL,CAAkBxD,QAAlB,wBAAmC0D,iBAAnC;AACD,OAFD,MAEO,IAAI,CAAC,KAAKR,YAAL,CAAkBlD,QAAlB,CAAL,EAAkC;AACvC,aAAKG,MAAL,CACE,6GACuBH,QADvB,sGAE+DA,QAF/D,4IADF;AAMD;;AAED,UAAI,KAAKuD,WAAT,EAAsB;AACpB,aAAKtB,YAAL,CAAkB0B,YAAlB,CAA+B3D,QAA/B,EAAyCnB,SAAzC,EAAoD4E,WAApD;AACD;AACF;AAhPH;AAAA;AAAA,sCAkPoB3L,GAlPpB,EAkPyB8L,MAlPzB,EAkPiC;AAC7B,UAAI,KAAKV,YAAL,CAAkBpL,GAAlB,CAAJ,EAA4B;AAC1BL,QAAAA,KAAK,CAACsH,YAAN,CAAmBjH,GAAnB,sBAA6B8L,MAA7B;AACD,OAFD,MAEO;AACL;AACAnM,QAAAA,KAAK,CAAC2L,MAAN;AAAe/L,UAAAA,IAAI,EAAES;AAArB,+CAAkC6H,SAAlC,GAAgDiE,MAAhD,IAA4D,IAA5D,EAAkE,IAAlE;AACD;AACF;AAED;;;;;AA3PF;AAAA;AAAA;AAAA,oGA+PoB5D,QA/PpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAgQI,qBAAK+B,eAAL,GAAuB/B,QAAvB;;AAhQJ,oBAkQS,KAAKuD,WAlQd;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA,uBAqQsB,KAAKtB,YAAL,CAAkB4B,cAAlB,CAAiC7D,QAAjC,CArQtB;;AAAA;AAqQYnI,gBAAAA,CArQZ;;AAsQM,oBAAI,KAAK2L,YAAL,CAAkBxD,QAAlB,CAAJ,EAAiC;AAC/B,uBAAKiD,iBAAL,CACE,KAAKlB,eADP,EAEE,KAAKyB,YAAL,CAAkB,KAAKzB,eAAvB,CAFF;AAID;;AAED,qBAAK+B,mBAAL,CAAyBjM,CAAzB;AA7QN,kDA8QaA,CA9Qb;;AAAA;AAAA;AAAA;AAgRM,qBAAKsI,MAAL;;AAhRN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAoRE;;;;AApRF;AAAA;AAAA,gDAuR8B4D,QAvR9B,EAuRwC;AACpC,WAAKD,mBAAL,GAA2BC,QAA3B;AACD;AAzRH;;AAAA;AAAA;;AC5RA;;;;;;;AAMA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB;AAAA,MAAGxK,IAAH,QAAGA,IAAH;AAAA,MAASX,EAAT,QAASA,EAAT;AAAA,MAAaoL,OAAb,QAAaA,OAAb;AAAA,MAAsBC,aAAtB,QAAsBA,aAAtB;AAAA,sBACxBzN;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAM,IAAA,GAAG,EAAE;AAAX,KAAe+C,IAAf,CADF,EAEGyK,OAAO,CAACvI,GAAR,CAAY,UAACyI,MAAD;AAAA,wBACX1N;AACE,MAAA,SAAS,qGAA8F0N,MAAM,CAACC,KAArG,CADX;AAEE,+BAAgBD,MAAM,CAAC9M,IAAvB,CAFF;AAGE,MAAA,GAAG,YAAKwB,EAAL,cAAWsL,MAAM,CAAC7H,KAAlB,CAHL;AAIE,oBAAY6H,MAAM,CAAC7H,KAJrB;AAKE,MAAA,OAAO,EAAE,iBAAC+H,CAAD;AAAA,eAAOH,aAAa,CAACC,MAAM,CAAC9M,IAAR,EAAc8M,MAAM,CAAC7H,KAArB,EAA4B+H,CAA5B,CAApB;AAAA;AALX,OAOGF,MAAM,CAAC3K,IAPV,CADW;AAAA,GAAZ,CAFH,CADF,CADwB;AAAA,CAA1B;;AAmBAwK,iBAAiB,CAACM,SAAlB,GAA8B;AAC5B;AACAzL,EAAAA,EAAE,EAAE0L,SAAS,CAACC,MAAV,CAAiBC,UAFO;;AAG5B;AACAjL,EAAAA,IAAI,EAAE+K,SAAS,CAACC,MAJY;;AAK5B;AACAP,EAAAA,OAAO,EAAEM,SAAS,CAACG,KAAV,CAAgBD,UANG;;AAO5B;;;;;;AAMAP,EAAAA,aAAa,EAAEK,SAAS,CAACI,IAAV,CAAeF;AAbF,CAA9B;AAgBA,4CAAehO,cAAK,CAACmO,IAAN,CAAWZ,iBAAX,CAAf;;ACzCA,IAAMa,sBAAsB,GAAG,GAA/B;AACA;;;;;AAIA,IAAMC,KAAK,GAAG,SAARA,KAAQ,OAAY;AAAA,MAATC,EAAS,QAATA,EAAS;AACxB,MAAMC,QAAQ,GAAGC,YAAM;AAAC;AAAwC,MAAzC,CAAvB;;AADwB,kBAEUC,cAAQ,CAAC,KAAD,CAFlB;AAAA;AAAA,MAEjBC,SAFiB;AAAA,MAENC,YAFM;;AAAA,mBAGQF,cAAQ,CAAC,CAAD,CAHhB;AAAA;AAAA,MAGjBG,QAHiB;AAAA,MAGPC,WAHO;;AAKxB,MAAMC,cAAc,GAAGC,iBAAW,CAAC,YAAM;AACvC,QAAIR,QAAQ,CAACS,OAAT,KAAqB,IAAzB,EAA+B;AAC7B,UAAMC,QAAQ,GAAGV,QAAQ,CAACS,OAAT,CAAiBE,WAAlC;AAD6B,UAErBC,QAFqB,GAERZ,QAAQ,CAACS,OAFD,CAErBG,QAFqB;AAG7B,UAAMC,eAAe,GAAI,MAAMD,QAAP,GAAmBF,QAA3C;AACAJ,MAAAA,WAAW,CAACO,eAAD,CAAX;;AACA,UAAIH,QAAQ,KAAKE,QAAjB,EAA2B;AACzBR,QAAAA,YAAY,CAAC,KAAD,CAAZ;AACD;AACF;AACF,GAViC,EAU/B,CAACJ,QAAD,CAV+B,CAAlC;AAYAc,EAAAA,eAAS,CAAC,YAAM;AACd,QAAId,QAAQ,CAACS,OAAT,KAAqB,IAAzB,EAA+B;AAC7B,UAAIN,SAAJ,EAAe;AACbH,QAAAA,QAAQ,CAACS,OAAT,CAAiBM,IAAjB;AACA,YAAMC,QAAQ,GAAGC,WAAW,CAACV,cAAD,EAAiBV,sBAAjB,CAA5B;AACA,eAAO;AAAA,iBAAMqB,aAAa,CAACF,QAAD,CAAnB;AAAA,SAAP;AACD;;AACDhB,MAAAA,QAAQ,CAACS,OAAT,CAAiBU,KAAjB;AACD;;AACD,WAAO,YAAM,EAAb;AACD,GAVQ,EAUN,CAAChB,SAAD,EAAYI,cAAZ,CAVM,CAAT;AAjBwB,MA6BhBa,SA7BgB,GA6BmCrB,EA7BnC,CA6BhBqB,SA7BgB;AAAA,MA6BLC,SA7BK,GA6BmCtB,EA7BnC,CA6BLsB,SA7BK;AAAA,MA6BMC,KA7BN,GA6BmCvB,EA7BnC,CA6BMuB,KA7BN;AAAA,MA6BaC,WA7Bb,GA6BmCxB,EA7BnC,CA6BawB,WA7Bb;AAAA,MA6B0B/M,IA7B1B,GA6BmCuL,EA7BnC,CA6B0BvL,IA7B1B;AA+BxB,sBACE/C;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAO,IAAA,GAAG,EAAEuO;AAAZ,kBACEvO;AAAQ,IAAA,GAAG,EAAE2P,SAAb;AAAwB,IAAA,IAAI,EAAC,WAA7B;AAAyC,mBAAY;AAArD,IADF,CADF,eAIE3P;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,KACG,CAAC0O,SAAD,gBACC1O;AACE,IAAA,OAAO,EAAE;AAAA,aAAM2O,YAAY,CAAC,IAAD,CAAlB;AAAA,KADX;AAEE,IAAA,SAAS,EAAC,gCAFZ;AAGE,mBAAY;AAHd,kBAKE3O;AACE,IAAA,KAAK,EAAC,IADR;AAEE,IAAA,MAAM,EAAC,IAFT;AAGE,IAAA,OAAO,EAAC,WAHV;AAIE,IAAA,KAAK,EAAC;AAJR,kBAMEA;AACE,IAAA,CAAC,EAAC,mXADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IANF,CALF,CADD,gBAmBCA;AACE,IAAA,OAAO,EAAE;AAAA,aAAM2O,YAAY,CAAC,KAAD,CAAlB;AAAA,KADX;AAEE,IAAA,SAAS,EAAC,gCAFZ;AAGE,mBAAY;AAHd,kBAKE3O;AACE,IAAA,KAAK,EAAC,IADR;AAEE,IAAA,MAAM,EAAC,IAFT;AAGE,IAAA,OAAO,EAAC,WAHV;AAIE,IAAA,KAAK,EAAC;AAJR,kBAMEA;AACE,IAAA,CAAC,EAAC,0fADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IANF,CALF,CApBJ,CADF,EAwCG4P,SAAS,iBAAI5P;AAAK,IAAA,GAAG,EAAE4P,SAAV;AAAqB,IAAA,GAAG,YAAKE,WAAL;AAAxB,IAxChB,CAJF,eA8CE9P;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAM,IAAA,SAAS,EAAC;AAAhB,kBACEA,6CAAS6P,KAAT,CADF,CADF,eAIE7P;AAAM,IAAA,SAAS,EAAC;AAAhB,KAAsD+C,IAAtD,CAJF,eAKE/C;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AACE,IAAA,KAAK,EAAE;AAAE+P,MAAAA,KAAK,YAAKnB,QAAL;AAAP,KADT;AAEE,mBAAY;AAFd,IADF,CALF,CA9CF,CADF,CADF;AA+DD,CA9FD;;AAgGA,gCAAe5O,cAAK,CAACmO,IAAN,CAAWE,KAAX,CAAf;;ACxGA,gBAAe;;ACAf;AAIA;;;;;;AAKA,IAAM2B,UAAU,GAAG,SAAbA,UAAa,OAA2C;AAAA,MAAxCpK,IAAwC,QAAxCA,IAAwC;AAAA,MAAlCqK,QAAkC,QAAlCA,QAAkC;AAAA,MAAxBC,MAAwB,QAAxBA,MAAwB;AAAA,MAAhBC,SAAgB,QAAhBA,SAAgB;AAC5D,MAAI,CAACvK,IAAL,EAAW,OAAO,IAAP;AACX,MAAMwK,SAAS,GAAGC,uBAAW,CAACzK,IAAD,CAA7B;AACA,sBACE5F;AAAG,IAAA,IAAI,EAAEoQ,SAAT;AAAoB,IAAA,MAAM,EAAEF,MAA5B;AAAoC,IAAA,SAAS,EAAEC;AAA/C,KACGF,QADH,CADF;AAKD,CARD;;AAUA,gCAAejQ,cAAK,CAACmO,IAAN,CAAW6B,UAAX,CAAf;;ACXA;;;;;;;;AAOA,IAAMM,IAAI,GAAG,SAAPA,IAAO,OAQP;AAAA,MAPJT,KAOI,QAPJA,KAOI;AAAA,MANJU,UAMI,QANJA,UAMI;AAAA,MALJC,aAKI,QALJA,aAKI;AAAA,MAJJZ,SAII,QAJJA,SAII;AAAA,MAHJa,SAGI,QAHJA,SAGI;AAAA,MAFJ1N,IAEI,QAFJA,IAEI;AAAA,MADJ4C,IACI,QADJA,IACI;;AAAA,oBACU+K,gBAAU,CAACvP,kBAAD,CADpB;AAAA,MACIC,CADJ,eACIA,CADJ;;AAEJ,MAAMuP,KAAK,GAAGF,SAAS,IAAIb,SAA3B;AAEA;;AACA,MAAMgB,OAAO,GAAG,SAAVA,OAAU,CAACC,GAAD,EAAS;AACvB,QAAIA,GAAG,KAAK1J,SAAR,IAAqB0J,GAAG,KAAK,IAAjC,EAAuC;AAAA,+BAChBA,GAAG,CACrBhQ,OADkB,CACV,8BADU,EACsB,EADtB,EAElBuI,KAFkB,CAEZ,GAFY,CADgB;AAAA;AAAA,UAC9B0H,UAD8B;;AAKrC,aAAOA,UAAP;AACD;;AACD,WAAO,IAAP;AACD,GATD;;AAWA,MAAI,CAACjB,KAAD,IAAU,CAACU,UAAX,IAAyB,CAACI,KAA9B,EAAqC;AACnC,wBACE3Q;AACE,MAAA,SAAS,iFAA0E2F,IAA1E;AADX,oBAGE3F;AAAK,MAAA,SAAS,EAAC;AAAf,oBACEA;AAAK,MAAA,SAAS,EAAC;AAAf,OACGoB,CAAC,CAAC,qCAAD,CADJ,CADF,CAHF,CADF;AAWD;;AAED,MAAI,CAACmP,UAAD,IAAe,CAACC,aAApB,EAAmC;AACjC,WAAO,IAAP;AACD;;AAED,sBACExQ;AACE,IAAA,SAAS,iFAA0E2F,IAA1E;AADX,KAGGgL,KAAK,iBACJ3Q;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,GAAG,EAAE2Q,KAAV;AAAiB,IAAA,GAAG,EAAEA;AAAtB,IADF,CAJJ,eAQE3Q;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,KACG6P,KAAK,iBACJ7P;AAAK,IAAA,SAAS,EAAC;AAAf,KACG6P,KADH,CAFJ,EAMG9M,IAAI,iBACH/C;AAAK,IAAA,SAAS,EAAC;AAAf,KACG+C,IADH,CAPJ,EAWG,CAACwN,UAAU,IAAIC,aAAf,kBACCxQ,6BAACgQ,YAAD;AACE,IAAA,IAAI,EAAEO,UAAU,IAAIC,aADtB;AAEE,IAAA,MAAM,EAAC,QAFT;AAGE,IAAA,GAAG,EAAC,qBAHN;AAIE,IAAA,SAAS,EAAC;AAJZ,KAMGI,OAAO,CAACL,UAAU,IAAIC,aAAf,CANV,CAZJ,CADF,EAuBG7K,IAAI,KAAK,OAAT,iBACC3F;AACE,IAAA,SAAS,EAAC,+CADZ;AAEE,mBAAY,YAFd;AAGE,IAAA,GAAG,EAAE+Q,SAHP;AAIE,IAAA,GAAG,EAAC;AAJN,IAxBJ,CARF,CADF;AA2CD,CArFD;;AAuFAT,IAAI,CAACzC,SAAL,GAAiB;AACf;AACAgC,EAAAA,KAAK,EAAE/B,SAAS,CAACC,MAFF;;AAGf;AACAwC,EAAAA,UAAU,EAAEzC,SAAS,CAACC,MAJP;;AAKf;AACAyC,EAAAA,aAAa,EAAE1C,SAAS,CAACC,MANV;;AAOf;AACA6B,EAAAA,SAAS,EAAE9B,SAAS,CAACC,MARN;;AASf;AACA0C,EAAAA,SAAS,EAAE3C,SAAS,CAACC,MAVN;;AAWf;AACAhL,EAAAA,IAAI,EAAE+K,SAAS,CAACC;AAZD,CAAjB;AAeA,+BAAe/N,cAAK,CAACmO,IAAN,CAAWmC,IAAX,CAAf;;AChHA;;AACA,IAAMU,cAAc,GAAG,SAAjBA,cAAiB,OAAoB;AAAA,MAAjBC,UAAiB,QAAjBA,UAAiB;AACzC,sBACEjR;AACE,mBAAY,iBADd;AAEE,IAAA,SAAS,EAAC;AAFZ,kBAIEA,6BAACkR,uBAAD;AACE,IAAA,QAAQ,EAAED,UAAU,CAACE,SADvB;AAEE,IAAA,QAAQ,EAAEF,UAAU,CAACpB,KAFvB;AAGE,IAAA,GAAG,EAAE,IAHP;AAIE,IAAA,IAAI,EAAE;AAJR,IAJF,eAUE7P;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAACgQ,YAAD;AAAY,IAAA,IAAI,EAAEiB,UAAU,CAACtB,SAA7B;AAAwC,IAAA,MAAM,EAAC,QAA/C;AAAwD,IAAA,QAAQ;AAAhE,KACGsB,UAAU,CAACpB,KADd,CADF,EAIGoB,UAAU,CAACG,SAAX,iBACCpR,2CAAOqR,WAAW,CAACJ,UAAU,CAACG,SAAZ,CAAlB,CALJ,CAVF,CADF;AAqBD,CAtBD;;AAwBA,+BAAepR,cAAK,CAACmO,IAAN,CAAW6C,cAAX,CAAf;;AC9BA;AAIA;;;;;IAIMM,UAAU,GAAG,SAAbA,UAAa;AAAA,MAAG3O,IAAH,QAAGA,IAAH;AAAA,sBACjB3C;AAAK,IAAA,SAAS,EAAC,gCAAf;AAAgD,mBAAY;AAA5D,kBACEA;AAAK,IAAA,GAAG,EAAE2C,IAAI,CAAC4O,GAAf;AAAoB,IAAA,SAAS,EAAC;AAA9B,IADF,CADiB;AAAA;;AAMnBD,UAAU,CAACzD,SAAX,GAAuB;AACrBlL,EAAAA,IAAI,EAAEmL,SAAS,CAAC0D,KAAV,CAAgB;AACpBD,IAAAA,GAAG,EAAEzD,SAAS,CAACC,MAAV,CAAiBC;AADF,GAAhB,EAEHA;AAHkB,CAAvB;;ACdA;AAMA;;;;;IAIMyD,cAAc,GAAG,SAAjBA,cAAiB;AAAA,MAAGC,MAAH,QAAGA,MAAH;AAAA,MAAWC,WAAX,QAAWA,WAAX;AAAA,MAAwBC,KAAxB,QAAwBA,KAAxB;AAAA,MAA+BC,WAA/B,QAA+BA,WAA/B;AAAA,sBACrB7R,6BAAC8R,qBAAD,QACGD,WAAW;AAAA;AACV;AACA,+BAACE,cAAD;AAAO,IAAA,OAAO,EAAEJ;AAAhB,kBACE3R,6BAACgS,iBAAD;AACE,IAAA,KAAK,EAAEN,MADT;AAEE,IAAA,YAAY,EAAEE,KAFhB;AAGE,IAAA,UAAU,EAAE;AACV;AACAK,MAAAA,IAAI,EAAEX;AAFI;AAHd,IADF,CAFU,GAYR,IAbN,CADqB;AAAA;;AAkBvBG,cAAc,CAAC5D,SAAf,GAA2B;AACzB6D,EAAAA,MAAM,EAAE5D,SAAS,CAACG,KAAV,CAAgBD,UADC;AAEzB2D,EAAAA,WAAW,EAAE7D,SAAS,CAACI,IAAV,CAAeF,UAFH;AAGzB4D,EAAAA,KAAK,EAAE9D,SAAS,CAACoE,MAHQ;AAIzBL,EAAAA,WAAW,EAAE/D,SAAS,CAACqE,IAAV,CAAenE;AAJH,CAA3B;;ACtBA;;;;;;;AAMA,IAAMoE,OAAO,GAAG,SAAVA,OAAU,OAAgB;AAAA,MAAbV,MAAa,QAAbA,MAAa;;AAAA,kBACJjD,cAAQ,CAAC,CAAD,CADJ;AAAA;AAAA,MACvBmD,KADuB;AAAA,MAChBS,QADgB;;AAAA,mBAEI5D,cAAQ,CAAC,KAAD,CAFZ;AAAA;AAAA,MAEvB6D,SAFuB;AAAA,MAEZC,YAFY;;AAAA,oBAGhB7B,gBAAU,CAACvP,kBAAD,CAHM;AAAA,MAGtBC,CAHsB,eAGtBA,CAHsB;AAK9B;;;;;AAGA,MAAMuQ,WAAW,GAAG,SAAdA,WAAc,CAACa,aAAD,EAAmB;AACrC,QAAIF,SAAJ,EAAe;AACbC,MAAAA,YAAY,CAAC,KAAD,CAAZ;AACD,KAFD,MAEO;AACLF,MAAAA,QAAQ,CAACG,aAAD,CAAR;AACAD,MAAAA,YAAY,CAAC,IAAD,CAAZ;AACD;AACF,GAPD;;AASA,MAAME,cAAc,GAAGC,aAAO,CAC5B;AAAA,WACEhB,MAAM,CAACzM,GAAP,CAAW,UAAC0L,KAAD;AAAA,aAAY;AACrBY,QAAAA,GAAG,EAAEZ,KAAK,CAACf,SAAN,IAAmBe,KAAK,CAACF,SAAzB,IAAsC,EADtB;AAErBkC,QAAAA,MAAM,EAAEhC,KAAK,CAACf,SAAN,IAAmBe,KAAK,CAACF,SAAzB,IAAsC;AAFzB,OAAZ;AAAA,KAAX,CADF;AAAA,GAD4B,EAM5B,CAACiB,MAAD,CAN4B,CAA9B;AASA,MAAMkB,YAAY,GAAGlB,MAAM,CAAClN,KAAP,CAAa,CAAb,EAAgB,CAAhB,EAAmBS,GAAnB,CAAuB,UAAC0L,KAAD,EAAQzM,CAAR;AAAA,wBAC1ClE;AACE,qBAAY,eADd;AAEE,MAAA,SAAS,EAAC,yBAFZ;AAGE,MAAA,GAAG,0BAAmBkE,CAAnB,CAHL;AAIE,MAAA,OAAO,EAAE;AAAA,eAAMyN,WAAW,CAACzN,CAAD,CAAjB;AAAA;AAJX,oBAMElE;AAAK,MAAA,GAAG,EAAE2Q,KAAK,CAACf,SAAN,IAAmBe,KAAK,CAACF;AAAnC,MANF,CAD0C;AAAA,GAAvB,CAArB;AAWA,sBACEzQ;AACE,IAAA,SAAS,8BACP0R,MAAM,CAACpN,MAAP,GAAgB,CAAhB,GAAoB,2BAApB,GAAkD,EAD3C;AADX,KAKGsO,YALH,EAMGlB,MAAM,CAACpN,MAAP,GAAgB,CAAhB,iBACCtE;AACE,IAAA,SAAS,EAAC,+BADZ;AAEE,IAAA,KAAK,EAAE;AACL6S,MAAAA,eAAe,gBAASnB,MAAM,CAAC,CAAD,CAAN,CAAU9B,SAAnB;AADV,KAFT;AAKE,IAAA,OAAO,EAAE;AAAA,aAAM+B,WAAW,CAAC,CAAD,CAAjB;AAAA;AALX,kBAOE3R,wCACGoB,CAAC,CAAC,uBAAD,EAA0B;AAC1B0R,IAAAA,UAAU,EAAEpB,MAAM,CAACpN,MAAP,GAAgB;AADF,GAA1B,CADJ,CAPF,CAPJ,eAqBEtE,6BAAC+S,cAAD;AACE,IAAA,MAAM,EAAEN,cADV;AAEE,IAAA,KAAK,EAAEb,KAFT;AAAA;AAIE,IAAA,WAAW,EAAED,WAJf;AAKE,IAAA,WAAW,EAAEW;AALf,IArBF,CADF;AA+BD,CApED;;AAsEAF,OAAO,CAACvE,SAAR,GAAoB;AAClB6D,EAAAA,MAAM,EAAE5D,SAAS,CAACkF,OAAV,CAAkBlF,SAAS,CAACmF,MAAV,CAAiBjF,UAAnC,EAA+CA;AADrC,CAApB;AAIA,6BAAehO,cAAK,CAACmO,IAAN,CAAWiE,OAAX,CAAf;;;;;AChFA;;;;;;;IAMMc;;;;;;;;;;;;;;;;4DASI;AACNrB,MAAAA,WAAW,EAAE,KADP;AAENsB,MAAAA,YAAY,EAAE;AAFR;;kEAKM,YAAM;AAClB,YAAKC,QAAL,CAAc,UAACC,KAAD;AAAA,eAAY;AACxBxB,UAAAA,WAAW,EAAE,CAACwB,KAAK,CAACxB;AADI,SAAZ;AAAA,OAAd;AAGD;;;;;;;6BAEQ;AAAA,wBACoC,KAAKpR,KADzC;AAAA,UACCmP,SADD,eACCA,SADD;AAAA,UACYa,SADZ,eACYA,SADZ;AAAA,UACuBvJ,QADvB,eACuBA,QADvB;AAEP,UAAMuL,cAAc,GAAG,CAAC;AAAElB,QAAAA,GAAG,EAAE3B,SAAS,IAAIa;AAApB,OAAD,CAAvB;AACA,0BACEzQ,6BAACA,cAAD,CAAO,QAAP,qBACEA;AACE,QAAA,SAAS,EAAC,mCADZ;AAEE,QAAA,OAAO,EAAE,KAAK2R,WAFhB;AAGE,QAAA,GAAG,EAAElB,SAAS,IAAIb,SAHpB;AAIE,QAAA,GAAG,EAAE1I,QAJP;AAKE,uBAAY;AALd,QADF,eASElH,6BAAC+S,cAAD;AACE,QAAA,MAAM,EAAEN,cADV;AAEE,QAAA,WAAW,EAAE,KAAKd,WAFpB;AAGE,QAAA,KAAK,EAAE,KAAK0B,KAAL,CAAWF,YAHpB;AAIE,QAAA,WAAW,EAAE,KAAKE,KAAL,CAAWxB;AAJ1B,QATF,CADF;AAkBD;;;;EAzCiB7R,cAAK,CAACsT;;gBAApBJ,oBACe;AACjB;AACAtD,EAAAA,SAAS,EAAE9B,SAAS,CAACC,MAFJ;;AAGjB;AACA0C,EAAAA,SAAS,EAAE3C,SAAS,CAACC,MAJJ;;AAKjB;AACA7G,EAAAA,QAAQ,EAAE4G,SAAS,CAACC;AANH;;;;;ACCd,IAAMwF,uBAAuB,GAAG,CACrC,WADqC,EAErC,WAFqC,EAGrC,YAHqC,EAIrC,iBAJqC,CAAhC;AAOP;;;;;;AAMA;;;;AAGO,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACjQ,CAAD,EAAO;AACtC,SAAOA,CAAC,CAACoC,IAAF,KAAW,OAAX,IAAsB,CAACpC,CAAC,CAACgN,UAAzB,IAAuC,CAAChN,CAAC,CAACiN,aAAjD;AACD,CAFM;AAIP;;;;AAGO,IAAMiD,iBAAiB,GAAG,SAApBA,iBAAoB,CAAClQ,CAAD,EAAO;AACtC,SACGA,CAAC,CAAC4N,SAAF,IAAeoC,uBAAuB,CAACvN,OAAxB,CAAgCzC,CAAC,CAAC4N,SAAlC,MAAiD,CAAC,CAAlE,IACA5N,CAAC,CAACoC,IAAF,KAAW,OAFb;AAID,CALM;AAOP;;;;AAGO,IAAM+N,iBAAiB,GAAG,SAApBA,iBAAoB,CAACnQ,CAAD,EAAO;AACtC,SAAOA,CAAC,CAACoC,IAAF,KAAW,OAAlB;AACD,CAFM;AAIP;;;;AAGO,IAAMgO,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACpQ,CAAD,EAAO;AACrC,SACEA,CAAC,CAACoC,IAAF,KAAW,MAAX,IACCpC,CAAC,CAAC4N,SAAF,IACCoC,uBAAuB,CAACvN,OAAxB,CAAgCzC,CAAC,CAAC4N,SAAlC,MAAiD,CAAC,CADnD,IAEC5N,CAAC,CAACoC,IAAF,KAAW,OAJf;AAMD,CAPM;AASP;;;;;;AAKO,IAAMiO,+BAA+B,GAAG,SAAlCA,+BAAkC,CAC7C3D,QAD6C,EAE7CgB,UAF6C,EAG7C4C,aAH6C,EAI1C;AACH,MAAIC,KAAK,GACP7C,UAAU,IAAIA,UAAU,CAACzD,OAAzB,IAAoCyD,UAAU,CAACzD,OAAX,CAAmBlJ,MAAvD,GACI,SADJ,GAEI,EAHN;;AAIA,MACEuP,aAAa,KAAK,MAAlB,IACA,CAAC5C,UAAU,CAACrB,SADZ,IAEA,CAACqB,UAAU,CAACR,SAHd,EAIE;AACAqD,IAAAA,KAAK,GAAG,UAAR;AACD;;AAED,sBACE9T;AACE,IAAA,SAAS,uEAAgE6T,aAAhE,4CAA+G5C,UAAU,CAACtL,IAA1H,4CAAgKkO,aAAhK,eAAkLC,KAAlL;AADX,KAGG7D,QAHH,CADF;AAOD,CAxBM;AA0BP;;;;AAGO,IAAM8D,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACtT,KAAD,EAAW;AAAA,MAC5B8C,CAD4B,GACY9C,KADZ,CACxCwQ,UADwC;AAAA,MACzB1D,iBADyB,GACY9M,KADZ,CACzB8M,iBADyB;AAAA,MACNE,aADM,GACYhN,KADZ,CACNgN,aADM;;AAEhD,MAAI,CAAClK,CAAC,CAACiK,OAAH,IAAc,CAACjK,CAAC,CAACiK,OAAF,CAAUlJ,MAA7B,EAAqC;AACnC,WAAO,IAAP;AACD;;AAED,sBACEtE,6BAAC,iBAAD,eACMuD,CADN;AAEE,IAAA,EAAE,EAAEA,CAAC,CAACnB,EAAF,IAAQ,EAFd;AAGE,IAAA,OAAO,EAAEmB,CAAC,CAACiK,OAAF,IAAa,EAHxB;AAIE,IAAA,IAAI,EAAEjK,CAAC,CAACR,IAAF,IAAU,EAJlB;AAKE,IAAA,GAAG,wBAAiBQ,CAAC,CAACnB,EAAnB,CALL;AAME,IAAA,aAAa,EAAEqL;AANjB,KADF;AAUD,CAhBM;AAkBP;;;;AAGO,IAAMuG,WAAW,GAAG,SAAdA,WAAc,CAACvT,KAAD,EAAW;AAAA,MAChB8C,CADgB,GACH9C,KADG,CAC5BwQ,UAD4B;AAAA,MACbiC,KADa,GACHzS,KADG,CACbyS,KADa;;AAEpC,MAAI3P,CAAC,CAACiK,OAAF,IAAajK,CAAC,CAACiK,OAAF,CAAUlJ,MAA3B,EAAmC;AACjC,WAAOsP,+BAA+B,eACpC5T;AAAK,MAAA,SAAS,EAAC,sBAAf;AAAsC,MAAA,GAAG,sBAAeuD,CAAC,CAACnB,EAAjB;AAAzC,oBACEpC,6BAAC,KAAD,EAAWuD,CAAX,CADF,EAEGwQ,uBAAuB,CAACtT,KAAD,CAF1B,CADoC,EAKpC8C,CALoC,EAMpC,OANoC,CAAtC;AAQD;;AAED,SAAOqQ,+BAA+B,eACpC5T,6BAAC,KAAD,eAAWuD,CAAX;AAAc,IAAA,GAAG,sBAAeA,CAAC,CAACnB,EAAjB;AAAjB,KADoC,EAEpCmB,CAFoC,EAGpC,OAHoC,CAAtC;AAKD,CAlBM;AAoBP;;;;AAGO,IAAM0Q,UAAU,GAAG,SAAbA,UAAa,CAACxT,KAAD,EAAW;AAAA,MACf8C,CADe,GACH9C,KADG,CAC3BwQ,UAD2B;AAAA,MACZX,IADY,GACH7P,KADG,CACZ6P,IADY;;AAEnC,MAAI/M,CAAC,CAACiK,OAAF,IAAajK,CAAC,CAACiK,OAAF,CAAUlJ,MAA3B,EAAmC;AACjC,WAAOsP,+BAA+B,eACpC5T;AAAK,MAAA,SAAS,EAAC,sBAAf;AAAsC,MAAA,GAAG,sBAAeuD,CAAC,CAACnB,EAAjB;AAAzC,oBACEpC,6BAAC,IAAD,eAAUuD,CAAV;AAAa,MAAA,GAAG,qBAAcA,CAAC,CAACnB,EAAhB;AAAhB,OADF,EAEG2R,uBAAuB,CAACtT,KAAD,CAF1B,CADoC,EAKpC8C,CALoC,EAMpC,MANoC,CAAtC;AAQD;;AAED,SAAOqQ,+BAA+B,eACpC5T,6BAAC,IAAD,eAAUuD,CAAV;AAAa,IAAA,GAAG,qBAAcA,CAAC,CAACnB,EAAhB;AAAhB,KADoC,EAEpCmB,CAFoC,EAGpC,MAHoC,CAAtC;AAKD,CAlBM;AAoBP;;;;AAGO,IAAM2Q,UAAU,GAAG,SAAbA,UAAa,CAACzT,KAAD,EAAW;AAAA,MACf8C,CADe,GACH9C,KADG,CAC3BwQ,UAD2B;AAAA,MACZkD,IADY,GACH1T,KADG,CACZ0T,IADY;AAEnC,MAAI,CAAC5Q,CAAC,CAACoM,SAAP,EAAkB,OAAO,IAAP;AAElB,SAAOiE,+BAA+B,eACpC5T,6BAAC,IAAD;AAAM,IAAA,UAAU,EAAEuD,CAAlB;AAAqB,IAAA,GAAG,qBAAcA,CAAC,CAACnB,EAAhB;AAAxB,IADoC,EAEpCmB,CAFoC,EAGpC,MAHoC,CAAtC;AAKD,CATM;AAWP;;;;AAGO,IAAM6Q,WAAW,GAAG,SAAdA,WAAc,CAAC3T,KAAD,EAAW;AAAA,MAChB8C,CADgB,GACH9C,KADG,CAC5BwQ,UAD4B;AAAA,MACb5C,KADa,GACH5N,KADG,CACb4N,KADa;AAEpC,SAAOuF,+BAA+B,eACpC5T;AAAK,IAAA,SAAS,EAAC,sBAAf;AAAsC,IAAA,GAAG,sBAAeuD,CAAC,CAACnB,EAAjB;AAAzC,kBACEpC,6BAAC,KAAD;AAAO,IAAA,EAAE,EAAEuD;AAAX,IADF,CADoC,EAIpCA,CAJoC,EAKpC,OALoC,CAAtC;AAOD,CATM;AAWP;;;;AAGO,IAAM8Q,WAAW,GAAG,SAAdA,WAAc,CAAC5T,KAAD,EAAW;AAAA,MAChB8C,CADgB,GACH9C,KADG,CAC5BwQ,UAD4B;AAAA,MACbqD,KADa,GACH7T,KADG,CACb6T,KADa;;AAEpC,MAAI/Q,CAAC,CAACiK,OAAF,IAAajK,CAAC,CAACiK,OAAF,CAAUlJ,MAA3B,EAAmC;AACjC,WAAOsP,+BAA+B,eACpC5T;AACE,MAAA,SAAS,EAAC,iDADZ;AAEE,MAAA,GAAG,sBAAeuD,CAAC,CAACnB,EAAjB;AAFL,oBAIEpC;AAAK,MAAA,SAAS,EAAC;AAAf,oBACEA,6BAAC,KAAD;AACE,MAAA,SAAS,EAAC,cADZ;AAEE,MAAA,GAAG,EAAEuD,CAAC,CAACoM,SAFT;AAGE,MAAA,KAAK,EAAC,MAHR;AAIE,MAAA,MAAM,EAAC,MAJT;AAKE,MAAA,QAAQ;AALV,MADF,CAJF,EAaGoE,uBAAuB,CAACtT,KAAD,CAb1B,CADoC,EAgBpC8C,CAhBoC,EAiBpC,OAjBoC,CAAtC;AAmBD;;AAED,SAAOqQ,+BAA+B,eACpC5T;AAAK,IAAA,SAAS,EAAC,0BAAf;AAA0C,IAAA,GAAG,sBAAeuD,CAAC,CAACnB,EAAjB;AAA7C,kBACEpC,6BAAC,KAAD;AACE,IAAA,SAAS,EAAC,cADZ;AAEE,IAAA,GAAG,EAAEuD,CAAC,CAACoM,SAFT;AAGE,IAAA,KAAK,EAAC,MAHR;AAIE,IAAA,MAAM,EAAC,MAJT;AAKE,IAAA,QAAQ;AALV,IADF,CADoC,EAUpCpM,CAVoC,EAWpC,OAXoC,CAAtC;AAaD,CArCM;AAuCP;;;;;;;IAMMgR,UAAU,GAAG,SAAbA,UAAa,OASb;AAAA,MARJtD,UAQI,QARJA,UAQI;AAAA,uBAPJX,IAOI;AAAA,MAPJA,IAOI,0BAPGkE,WAOH;AAAA,wBANJtB,KAMI;AAAA,MANJA,OAMI,2BANIuB,KAMJ;AAAA,wBALJpG,KAKI;AAAA,MALJA,KAKI,2BALIqG,YAKJ;AAAA,uBAJJP,IAII;AAAA,MAJJA,IAII,0BAJGQ,WAIH;AAAA,wBAHJL,KAGI;AAAA,MAHJA,KAGI,2BAHIM,YAGJ;AAAA,mCAFJrH,iBAEI;AAAA,MAFJA,iBAEI,sCAFgBsH,wBAEhB;AAAA,MADDC,IACC;;AACJ,MAAMC,gBAAgB;AACpB9D,IAAAA,UADoB;AAEpBX,IAAAA,IAFoB;AAGpB4C,WAAAA,OAHoB;AAIpB7E,IAAAA,KAJoB;AAKpB8F,IAAAA,IALoB;AAMpBG,IAAAA,KANoB;AAOpB/G,IAAAA;AAPoB,KAQjBuH,IARiB,CAAtB;;AAWA,MAAItB,iBAAiB,CAACvC,UAAD,CAArB,EAAmC;AACjC,WAAO+C,WAAW,CAACe,gBAAD,CAAlB;AACD;;AAED,MAAIpB,gBAAgB,CAAC1C,UAAD,CAApB,EAAkC;AAChC,WAAOiD,UAAU,CAACa,gBAAD,CAAjB;AACD;;AAED,MAAIrB,iBAAiB,CAACzC,UAAD,CAArB,EAAmC;AACjC,WAAOmD,WAAW,CAACW,gBAAD,CAAlB;AACD;;AAED,MAAItB,iBAAiB,CAACxC,UAAD,CAArB,EAAmC;AACjC,WAAOoD,WAAW,CAACU,gBAAD,CAAlB;AACD;;AAED,SAAOd,UAAU,CAACc,gBAAD,CAAjB;AACD;;AAEDR,UAAU,CAAC1G,SAAX,GAAuB;AACrB;;;;;AAKAoD,EAAAA,UAAU,EAAEnD,SAAS,CAACmF,MAAV,CAAiBjF,UANR;;AAOrB;;;;;;AAMAP,EAAAA,aAAa,EAAEK,SAAS,CAACI,IAbJ;;AAcrB;;;;AAIAoC,EAAAA,IAAI;AAAE;AAAoFxC,EAAAA,SAAS,CAACkH,WAlB/E;;AAmBrB;;;;AAIAb,EAAAA,IAAI;AAAE;AAA8FrG,EAAAA,SAAS,CAACkH,WAvBzF;;AAwBrB;;;;AAIA9B,EAAAA,KAAK;AAAE;AAAqFpF,EAAAA,SAAS,CAACkH,WA5BjF;;AA6BrB;;;;AAIA3G,EAAAA,KAAK;AAAE;AAAqFP,EAAAA,SAAS,CAACkH,WAjCjF;;AAkCrB;;;;AAIAV,EAAAA,KAAK;AAAE;AAAkGxG,EAAAA,SAAS,CAACkH,WAtC9F;;AAuCrB;;;;AAIAzH,EAAAA,iBAAiB;AAAE;AAAiGO,EAAAA,SAAS,CAACkH;AA3CzG,CAAvB;;ACrRA;IACaC,SAAS,GAAG;AACvBC,EAAAA,GAAG,EAAE,EADkB;AAEvBC,EAAAA,EAAE,EAAE,EAFmB;AAGvBC,EAAAA,IAAI,EAAE,EAHiB;AAIvBC,EAAAA,KAAK,EAAE,EAJgB;AAKvBC,EAAAA,GAAG,EAAE,CALkB;AAMvBC,EAAAA,KAAK,EAAE;AANgB;;IAUnBC,WACJ,oBAAc;AAAA;;AAAA;;AAAA,uCAaA,YAAM;AAClB,QAAI,CAAC,KAAI,CAACC,QAAV,EAAoB;AAClB;AACAC,MAAAA,QAAQ,CAACC,gBAAT,CAA0B,SAA1B,EAAqC,KAAI,CAACC,CAA1C;AACD;;AACD,IAAA,KAAI,CAACH,QAAL;AACD,GAnBa;;AAAA,sCAqBD,YAAM;AACjB,IAAA,KAAI,CAACA,QAAL;;AACA,QAAI,CAAC,KAAI,CAACA,QAAV,EAAoB;AAClB;AACAC,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,SAA7B,EAAwC,KAAI,CAACD,CAA7C;AACD;AACF,GA3Ba;;AAAA,+BA6BR,UAACE,QAAD,EAAWC,EAAX,EAAkB;AACtB,QAAIC,OAAO,GAAGF,QAAd;AAEA,QAAI,OAAOE,OAAP,KAAmB,QAAvB,EAAiCA,OAAO,GAAG,CAACA,OAAD,CAAV;AAEjC,IAAA,KAAI,CAACC,SAAL,CAAe,KAAI,CAACrE,KAApB,IAA6B;AAC3BoE,MAAAA,OAD2B;AAE3BD,MAAAA;AAF2B,KAA7B;AAKA,IAAA,KAAI,CAACnE,KAAL,IAAc,CAAd;AAEA,WAAO,KAAI,CAACA,KAAZ;AACD,GA1Ca;;AAAA,kCA4CL,UAACxP,EAAD,EAAQ;AACf,WAAO,KAAI,CAAC6T,SAAL,CAAe7T,EAAf,CAAP;AACD,GA9Ca;;AAAA,qCAgDF,YAAM;AAChB,IAAA,KAAI,CAAC6T,SAAL,GAAiB,EAAjB;AACA,IAAA,KAAI,CAACrE,KAAL,GAAa,CAAb;AACD,GAnDa;;AACZ,OAAKA,KAAL,GAAa,CAAb;AACA,OAAKqE,SAAL,GAAiB,EAAjB;AACA,OAAKR,QAAL,GAAgB,CAAhB;;AAEA,OAAKG,CAAL,GAAS,UAAChI,CAAD,EAAO;AACd,QAAMsI,IAAI,GAAGtI,CAAC,CAACoI,OAAF,IAAapI,CAAC,CAACuI,KAA5B;AACA1T,IAAAA,MAAM,CAAC2T,MAAP,CAAc,KAAI,CAACH,SAAnB,EAA8BjS,OAA9B,CAAsC,gBAAqB;AAAA,UAAlBgS,OAAkB,QAAlBA,OAAkB;AAAA,UAATD,EAAS,QAATA,EAAS;AACzD,UAAIC,OAAO,CAACK,QAAR,CAAiBH,IAAjB,CAAJ,EAA4BH,EAAE,CAACnI,CAAD,CAAF;AAC7B,KAFD;AAGD,GALD;AAMD;;AA2CH,gBAAe,IAAI4H,QAAJ,EAAf;;;;;IC9Dac,IAAb;AAAA;;AAAA;;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA,iEACe,YAAM;AAAA,wBACiB,MAAK7V,KADtB;AAAA,UACTwD,IADS,eACTA,IADS;AAAA,UACHsS,eADG,eACHA,eADG;AAEjBA,MAAAA,eAAe,CAACtS,IAAD,CAAf;AACD,KAJH;;AAAA;AAAA;;AAAA;AAAA;AAAA,6BAMW;AAAA,yBASH,KAAKxD,KATF;AAAA,UAEM+V,SAFN,gBAELC,SAFK;AAAA,UAGL9I,KAHK,gBAGLA,KAHK;AAAA,UAIL+I,cAJK,gBAILA,cAJK;AAAA,UAKLzS,IALK,gBAKLA,IALK;AAAA,UAML0S,QANK,gBAMLA,QANK;AAAA,UAOLxG,SAPK,gBAOLA,SAPK;AAAA,UAQLyG,QARK,gBAQLA,QARK;AAWP,0BACE5W;AAAI,QAAA,SAAS,sBAAemQ,SAAS,IAAI,EAA5B,CAAb;AAA+C,QAAA,KAAK,EAAExC;AAAtD,sBACE3N;AACE,QAAA,SAAS,wBACP2W,QAAQ,KAAK,IAAb,GAAoB,uBAApB,GAA8C,EADvC,CADX;AAIE,QAAA,IAAI,EAAC,QAJP;AAKE,QAAA,QAAQ,EAAE,CALZ;AAME,QAAA,OAAO,EAAED,cANX;AAOE,QAAA,OAAO,EAAE,KAAKG,UAPhB;AAQE,QAAA,YAAY,EAAE,KAAKA;AACnB;AATF;AAUE,QAAA,GAAG,EAAED;AAVP,sBAYE5W,6BAAC,SAAD;AAAW,QAAA,QAAQ,EAAE2W,QAArB;AAA+B,QAAA,MAAM,EAAE1S;AAAvC,QAZF,CADF,CADF;AAkBD;AAnCH;;AAAA;AAAA,EAA0BjE,cAAK,CAACwW,SAAhC;;;;;ICEaM,IAAb;AAAA;;AAAA;;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA,4DACU;AACNC,MAAAA,YAAY,EAAE;AADR,KADV;;AAAA,mEAKiB,IALjB;;AAAA,mEAkCiB,UAACnJ,CAAD,EAAO;AACpB,UAAIA,CAAC,IAAIA,CAAC,CAACoJ,cAAX,EAA2B;AACzBpJ,QAAAA,CAAC,CAACoJ,cAAF;AACD;;AAHmB,UAKZZ,MALY,GAKD,MAAK3V,KALJ,CAKZ2V,MALY;;AAOpB,YAAKa,UAAL,CAAgBb,MAAM,CAAC,MAAKc,iBAAL,EAAD,CAAtB;AACD,KA1CH;;AAAA,wEA4CsB,YAAM;AAAA,UAChBd,MADgB,GACL,MAAK3V,KADA,CAChB2V,MADgB;AAAA,UAEhBW,YAFgB,GAEC,MAAK1D,KAFN,CAEhB0D,YAFgB;AAIxB,UAAI,CAACA,YAAL,EAAmB,OAAO,CAAP;AAEnB,aAAOX,MAAM,CAACe,SAAP,CAAiB,UAAC5T,CAAD;AAAA,eAAO,MAAK6T,KAAL,CAAW7T,CAAX,MAAkB,MAAK6T,KAAL,CAAWL,YAAX,CAAzB;AAAA,OAAjB,CAAP;AACD,KAnDH;;AAAA,4DAqDU,UAAC9S,IAAD,EAAU;AAChB,UAAMoT,aAAa,GAAG,MAAK5W,KAAL,CAAW6W,gBAAX,CAA4BrT,IAA5B,CAAtB;;AACA,UAAIoT,aAAa,CAAChW,GAAlB,EAAuB;AACrB,eAAOgW,aAAa,CAAChW,GAArB;AACD;;AAED,UAAI,OAAO4C,IAAP,KAAgB,QAAhB,IAA4B,CAACA,IAAI,CAAC5C,GAAtC,EAA2C;AACzC,eAAOgW,aAAa,CAACtU,IAArB;AACD;;AAED,aAAOkB,IAAI,CAAC5C,GAAZ;AACD,KAhEH;;AAAA,gEAkEc,EAlEd;;AAAA,+DAoEa,EApEb;;AAAA,iEAsEe,UAACwE,KAAD,EAAW;AACtB,UAAI,CAACA,KAAL,EAAY;AADU,wBAGkC,MAAKpF,KAHvC;AAAA,UAGd8W,QAHc,eAGdA,QAHc;AAAA,UAGJD,gBAHI,eAGJA,gBAHI;AAAA,UAGcE,eAHd,eAGcA,eAHd;AAKtBD,MAAAA,QAAQ,CAACD,gBAAgB,CAACzR,KAAD,CAAjB,CAAR;;AACA,UAAI2R,eAAJ,EAAqB;AACnBA,QAAAA,eAAe,CAAC3R,KAAD,CAAf;AACD;AACF,KA/EH;;AAAA,iEAiFe,UAAC5B,IAAD,EAA4B;AAAA,UAArBwT,QAAqB,uEAAV,KAAU;;AACvC,YAAKrE,QAAL,CAAc;AAAE2D,QAAAA,YAAY,EAAE9S;AAAhB,OAAd,EAAsC,YAAM;AAC1C,YAAIwT,QAAJ,EAAc;AACZ,gBAAKhX,KAAL,CAAWiX,cAAX,CAA0B,MAAKC,QAAL,CAAc,MAAKP,KAAL,CAAWnT,IAAX,CAAd,CAA1B;AACD;AACF,OAJD;AAKD,KAvFH;;AAAA,6DAyFW,UAAC2J,CAAD,EAAO;AACd,UAAIA,CAAC,IAAIA,CAAC,CAACoJ,cAAX,EAA2B;AACzBpJ,QAAAA,CAAC,CAACoJ,cAAF;AACD;;AAHa,UAKNZ,MALM,GAKK,MAAK3V,KALV,CAKN2V,MALM;AAOd,UAAMF,IAAI,GAAGtI,CAAC,CAACoI,OAAF,IAAapI,CAAC,CAACuI,KAA5B;;AAEA,UAAMyB,WAAW,GAAG,MAAKV,iBAAL,EAApB;;AACA,UAAIW,WAAJ;;AACA,cAAQ3B,IAAR;AACE,aAAKjB,SAAS,CAACG,IAAf;AACEyC,UAAAA,WAAW,GAAGD,WAAW,GAAG,CAA5B;AACA;;AACF,aAAK3C,SAAS,CAACE,EAAf;AACE0C,UAAAA,WAAW,GAAGD,WAAW,GAAG,CAA5B;AACA;;AACF;AACEC,UAAAA,WAAW,GAAGD,WAAd;AACA;AATJ;;AAYAC,MAAAA,WAAW,GACT,CAAEA,WAAW,GAAGzB,MAAM,CAAC9R,MAAtB,GAAgC8R,MAAM,CAAC9R,MAAxC,IAAkD8R,MAAM,CAAC9R,MAD3D,CAvBc;;AAyBd,YAAKuS,UAAL,CACET,MAAM,CAACyB,WAAD,CADR,EAEE,CAAC5C,SAAS,CAACG,IAAX,EAAiBH,SAAS,CAACE,EAA3B,EAA+BkB,QAA/B,CAAwCH,IAAxC,CAFF;AAID,KAtHH;;AAAA,iEAwHe,UAACjS,IAAD,EAAU;AAAA,UACb8S,YADa,GACI,MAAK1D,KADT,CACb0D,YADa;AAErB,UAAI,CAACA,YAAL,EAAmB,OAAO,KAAP;AAEnB,aAAO,MAAKK,KAAL,CAAWL,YAAX,MAA6B,MAAKK,KAAL,CAAWnT,IAAX,CAApC;AACD,KA7HH;;AAAA,mEA+HiB,UAAC4B,KAAD,EAAW;AACxB,UAAIA,KAAK,CAAC,CAAD,CAAL,KAAa,GAAjB,EAAsB;AACpB,mDAAoCA,KAAK,CAAChF,OAAN,CAAc,GAAd,EAAmB,EAAnB,CAApC;AACD;;AAED,UAAIgF,KAAK,CAAC,CAAD,CAAL,KAAa,GAAjB,EAAsB;AACpB,gDAAiCA,KAAK,CAAChF,OAAN,CAAc,GAAd,EAAmB,EAAnB,CAAjC;AACD;;AAED,UAAIgF,KAAK,CAAC,CAAD,CAAL,KAAa,GAAjB,EAAsB;AACpB;AACD;AACF,KA3IH;;AAAA;AAAA;;AAAA;AAAA;AAAA,wCAOsB;AAClB,WAAKoQ,SAAL,CAAe7R,IAAf,CACE0T,SAAS,CAACC,GAAV,CAAc,CAAC9C,SAAS,CAACG,IAAX,EAAiBH,SAAS,CAACE,EAA3B,CAAd,EAA8C,KAAK6C,MAAnD,CADF,EAEEF,SAAS,CAACC,GAAV,CAAc,CAAC9C,SAAS,CAACI,KAAX,EAAkBJ,SAAS,CAACK,GAA5B,CAAd,EAAgD,KAAK2C,YAArD,CAFF;AADkB,UAMV7B,MANU,GAMC,KAAK3V,KANN,CAMV2V,MANU;AAOlB,UAAIA,MAAM,IAAIA,MAAM,CAAC,CAAD,CAApB,EAAyB,KAAKS,UAAL,CAAgBT,MAAM,CAAC,CAAD,CAAtB;AAC1B;AAfH;AAAA;AAAA,2DAiB+C;AAAA;;AAAA,UAAVA,MAAU,QAAVA,MAAU;AAC3C,UAAM8B,SAAS,GAAG9B,MAAM,CAACnR,GAAP,CAAW,UAACkT,GAAD;AAAA,eAAS,MAAI,CAACf,KAAL,CAAWe,GAAX,CAAT;AAAA,OAAX,EAAqC5T,IAArC,CAA0C,EAA1C,CAAlB;;AAEA,UAAI,KAAK6T,YAAL,KAAsBF,SAAtB,IAAmC9B,MAAnC,IAA6CA,MAAM,CAAC,CAAD,CAAvD,EAA4D;AAC1D,aAAKS,UAAL,CAAgBT,MAAM,CAAC,CAAD,CAAtB;AACA,aAAKgC,YAAL,GAAoBF,SAApB;AACD;AACF;AAxBH;AAAA;AAAA,2CA0ByB;AACrB,UAAIG,QAAJ;;AACA,aAAO,KAAKpC,SAAL,CAAe3R,MAAtB,EAA8B;AAC5B+T,QAAAA,QAAQ,GAAG,KAAKpC,SAAL,CAAeqC,GAAf,EAAX;AACAR,QAAAA,SAAS,CAACS,MAAV,CAAiBF,QAAjB;AACD;AACF;AAhCH;AAAA;AAAA,6BA6IW;AAAA;;AAAA,yBAQH,KAAK5X,KARF;AAAA,UAEL2V,MAFK,gBAELA,MAFK;AAAA,UAGLK,SAHK,gBAGLA,SAHK;AAAA,UAIL9I,KAJK,gBAILA,KAJK;AAAA,UAKL6K,aALK,gBAKLA,aALK;AAAA,UAMLrI,SANK,gBAMLA,SANK;AAAA,UAOLsI,SAPK,gBAOLA,SAPK;AAUP,0BACEzY;AAAI,QAAA,SAAS,sBAAemQ,SAAS,IAAI,EAA5B,CAAb;AAA+C,QAAA,KAAK,EAAExC;AAAtD,sBACE3N;AACE,QAAA,SAAS,EAAC,kBADZ;AAEE,QAAA,uBAAuB,EAAE;AACvB0Y,UAAAA,MAAM,EAAE,KAAKC,YAAL,CAAkB,KAAKlY,KAAL,CAAWoF,KAA7B;AADe;AAF3B,QADF,EAOGuQ,MAAM,CAACnR,GAAP,CAAW,UAAChB,IAAD;AAAA,4BACVjE,6BAAC,IAAD;AACE,UAAA,GAAG,EAAE,MAAI,CAACoX,KAAL,CAAWnT,IAAX,CADP;AAEE,UAAA,QAAQ,EAAE,kBAAC2U,GAAD,EAAS;AACjB,YAAA,MAAI,CAACjB,QAAL,CAAc,MAAI,CAACP,KAAL,CAAWnT,IAAX,CAAd,IAAkC2U,GAAlC;AACD,WAJH;AAKE,UAAA,QAAQ,EAAE,MAAI,CAACC,UAAL,CAAgB5U,IAAhB,CALZ;AAME,UAAA,IAAI,EAAEA,IANR;AAOE,UAAA,SAAS,EAAEuU,aAPb;AAQE,UAAA,KAAK,EAAEC,SART;AASE,UAAA,cAAc,EAAE,MAAI,CAACR,YATvB;AAUE,UAAA,eAAe,EAAE,MAAI,CAACpB,UAVxB;AAWE,UAAA,SAAS,EAAEJ;AAXb,UADU;AAAA,OAAX,CAPH,CADF;AAyBD;AAhLH;;AAAA;AAAA,EAA0BzW,cAAK,CAACwW,SAAhC;;ACNA;AAEO,SAASsC,mBAAT,CAA6BC,SAA7B,EAAwC9U,IAAxC,EAA8C;AACnD,MAAM+U,UAAU,GAAGC,QAAQ,CACzBC,gBAAgB,CAACjV,IAAD,CAAhB,CAAuBkV,gBAAvB,CAAwC,QAAxC,CADyB,EAEzB,EAFyB,CAA3B;AAKA,MAAMC,cAAc,GAClBH,QAAQ,CAACC,gBAAgB,CAACH,SAAD,CAAhB,CAA4BI,gBAA5B,CAA6C,QAA7C,CAAD,EAAyD,EAAzD,CAAR,GACAH,UAFF;AAIA,MAAMK,aAAa,GAAGpV,IAAI,CAACqV,SAA3B;AACA,MAAMC,eAAe,GAAGR,SAAS,CAACS,SAAlC;;AAEA,MACEH,aAAa,GAAGE,eAAe,GAAGH,cAAlC,IACAG,eAAe,GAAGF,aAFpB,EAGE;AACA;AACD,GAlBkD;;;AAqBnDN,EAAAA,SAAS,CAACS,SAAV,GAAsBH,aAAtB;AACD;;;;;;;;;ACVD,IAAMI,sBAAsB,GAAG,MAA/B;;AAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAAC/U,OAAD;AAAA,SACnBiF,OAAO,CAACgC,KAAR,oCAC8BjH,OAD9B,6IADmB;AAAA,CAArB;;IAMMgV;;;;;AAUJ,qCAAYlZ,MAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,MAAN;;AADiB,2EAqDI,YAAM;AAC3B,UAAI,CAAC,MAAKmZ,WAAV,EAAuB,OAAO,IAAP;AAEvB,aAAO;AACLC,QAAAA,cAAc,EAAE,MAAKD,WAAL,CAAiBC,cAD5B;AAELC,QAAAA,YAAY,EAAE,MAAKF,WAAL,CAAiBE;AAF1B,OAAP;AAID,KA5DkB;;AAAA,sEA8DD,YAAM;AACtB,UAAI,CAAC,MAAKF,WAAV,EAAuB,OAAO,IAAP;AADD,8BAEmB,MAAKA,WAFxB;AAAA,UAEdC,cAFc,qBAEdA,cAFc;AAAA,UAEEC,YAFF,qBAEEA,YAFF;AAItB,UAAID,cAAc,KAAKC,YAAvB,EAAqC,OAAO,IAAP;AAErC,aAAO,MAAKzG,KAAL,CAAWxN,KAAX,CAAiBkU,MAAjB,CACLF,cADK,EAELC,YAAY,GAAGD,cAFV,CAAP;AAID,KAxEkB;;AAAA,uEA0EA,YAAkB;AAAA,UAAjB5K,QAAiB,uEAAN,CAAM;AACnC,UAAI,CAAC,MAAK2K,WAAV,EAAuB;;AAEvB,YAAKA,WAAL,CAAiBI,KAAjB;;AACA,YAAKJ,WAAL,CAAiBK,iBAAjB,CAAmChL,QAAnC,EAA6CA,QAA7C;AACD,KA/EkB;;AAAA,uEAiFA,YAAM;AACvB,UAAI,CAAC,MAAK2K,WAAV,EAAuB;AACrB,eAAO,CAAP;AACD;;AAED,aAAO,MAAKA,WAAL,CAAiBE,YAAxB;AACD,KAvFkB;;AAAA,+DA0FR,UAACI,KAAD,EAAW;AACpB,UAAMC,OAAO,GAAG,MAAK9G,KAAL,CAAW+G,cAA3B;;AACA,UAAI,CAAC,MAAKR,WAAV,EAAuB;AACrB;AACD;;AAED,UAAMS,QAAQ,GAAG,MAAKT,WAAL,CAAiB/U,OAAjB,CAAyB,QAAzB,CAAjB,CANoB;;;AASpB,UAAI,CAACwV,QAAD,IAAaH,KAAK,CAACI,QAAN,KAAmB,IAApC,EAA0C;AACxC;AACD;;AACD,UAAI,CAACH,OAAD,IAAY,CAAC,MAAK9G,KAAL,CAAW1Q,IAA5B,EAAkC;AAChC;AACA,cAAK4X,YAAL;;AACA,YAAI,MAAKX,WAAT,EAAsB;AACpB,gBAAKA,WAAL,CAAiBE,YAAjB,GAAgC,CAAhC;AACD;;AACD,cAAKrZ,KAAL,CAAW+Z,YAAX,CAAwBN,KAAxB;AACD;AACF,KA9GkB;;AAAA,+DAiHR,YAAM;AACf,UAAI,CAAC,MAAKzZ,KAAL,CAAWga,WAAhB,EAA6B;AAC3B;AACD;;AAED,UAAI,CAAC,MAAKb,WAAV,EAAuB;AACrB;AACD;;AACD,UAAMS,QAAQ,GAAG,MAAKT,WAAL,CAAiB/U,OAAjB,CAAyB,QAAzB,CAAjB,CARe;;;AAWf,UAAI,CAACwV,QAAL,EAAe;AACb;AACD;;AACD,YAAKE,YAAL;AACD,KAhIkB;;AAAA,mEAkIJ,YAAM;AACnB,UAAMG,aAAa,GAAG,gBAAtB;AADmB,UAEX7U,KAFW,GAED,MAAKwN,KAFJ,CAEXxN,KAFW;AAGnB,UAAMf,KAAK,GAAG4V,aAAa,CAACxV,IAAd,CAAmBW,KAAK,CAACrB,KAAN,CAAY,CAAZ,EAAe,MAAKmW,gBAAL,EAAf,CAAnB,CAAd;AACA,UAAMC,QAAQ,GAAG9V,KAAK,IAAIA,KAAK,CAAC,CAAD,CAA/B;;AACA,UAAI,CAAC8V,QAAL,EAAe;AACb;AACD;;AACD,UAAMC,MAAM,GAAG/V,KAAK,CAAC,CAAD,CAApB;;AAEA,UAAMgW,OAAO,GAAG,MAAKra,KAAL,CAAWga,WAAX,CAAuBG,QAAvB,CAAhB;;AACA,UAAIE,OAAO,IAAI,IAAf,EAAqB;AACnB;AACD;;AACD,UAAMC,cAAc,GAAGlV,KAAK,CAACrB,KAAN,CACrB,CADqB,EAErB,MAAKmW,gBAAL,KAA0B7V,KAAK,CAAC,CAAD,CAAL,CAASR,MAFd,CAAvB;AAIA,UAAM0W,cAAc,GAAGnV,KAAK,CAACrB,KAAN,CAAY,MAAKmW,gBAAL,EAAZ,EAAqC,CAAC,CAAtC,CAAvB;AACA,UAAMnV,OAAO,GAAGuV,cAAc,GAAGD,OAAjB,GAA2BD,MAA3B,GAAoCG,cAApD;;AACA,YAAK5H,QAAL,CACE;AACEvN,QAAAA,KAAK,EAAEL;AADT,OADF,EAIE,YAAM;AACJ;AACA,YAAMoI,CAAC,GAAG,IAAIqN,WAAJ,CAAgB,QAAhB,EAA0B;AAAEC,UAAAA,OAAO,EAAE;AAAX,SAA1B,CAAV;;AACA,cAAKtB,WAAL,CAAiBuB,aAAjB,CAA+BvN,CAA/B;;AACA,YAAI,MAAKnN,KAAL,CAAW2a,QAAf,EAAyB,MAAK3a,KAAL,CAAW2a,QAAX,CAAoBxN,CAApB;AAC1B,OATH;AAWD,KAjKkB;;AAAA,gEAmKP,UAACyN,QAAD,EAAc;AAAA,wBACuC,MAAKhI,KAD5C;AAAA,UAChByG,YADgB,eAChBA,YADgB;AAAA,UACFM,cADE,eACFA,cADE;AAAA,UACqBkB,aADrB,eACczV,KADd;AAAA,wBAEM,MAAKpF,KAFX;AAAA,UAEhB2a,QAFgB,eAEhBA,QAFgB;AAAA,UAENjB,OAFM,eAENA,OAFM;AAIxB,UAAI,CAACC,cAAL,EAAqB;;AAErB,UAAMmB,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACtM,QAAD,EAAWuM,KAAX,EAAkBC,UAAlB,EAAiC;AAC5D,gBAAQxM,QAAR;AACE,eAAK,OAAL;AACE,mBAAOwM,UAAP;;AACF,eAAK,MAAL;AACA,eAAK,KAAL;AACE,mBAAOA,UAAU,GAAGD,KAAK,CAAClX,MAA1B;;AACF;AACE,gBAAI,CAACoX,MAAM,CAACC,SAAP,CAAiB1M,QAAjB,CAAL,EAAiC;AAC/B,oBAAM,IAAIpD,KAAJ,CACJ,gEADI,CAAN;AAGD;;AAED,mBAAOoD,QAAP;AAbJ;AAeD,OAhBD;;AAkBA,UAAM2M,YAAY,GAAGN,aAAa,CAAC9W,KAAd,CAAoB,CAApB,EAAuBsV,YAAvB,CAArB;AAEA,UAAM+B,oBAAoB,GAAGD,YAAY,CAACE,MAAb;AAC3B;;;AAGA,UAAIxV,MAAJ,aAAgB8T,cAAhB,gBAAwCA,cAAxC,EAAyD,KAAzD,cAJ2B,CAA7B,CA1BwB;;AAkCxB,UAAM2B,cAAc,GAClBV,QAAQ,CAACW,aAAT,KAA2B,MAA3B,aAAuCX,QAAQ,CAACtY,IAAhD,SAA0DsY,QAAQ,CAACtY,IADrE;AAGA,UAAMkZ,gBAAgB,GAAGV,oBAAoB,CAC3CF,QAAQ,CAACW,aADkC,EAE3CD,cAF2C,EAG3CF,oBAH2C,CAA7C;AAMA,UAAMK,YAAY,GAChBN,YAAY,CAACvW,SAAb,CAAuB,CAAvB,EAA0BwW,oBAA1B,IAAkDE,cADpD,CA3CwB;;AA+CxB,YAAK3I,QAAL,CACE;AACEvN,QAAAA,KAAK,EAAEyV,aAAa,CAACza,OAAd,CAAsB+a,YAAtB,EAAoCM,YAApC,CADT;AAEEC,QAAAA,WAAW,EAAE;AAFf,OADF,EAKE,YAAM;AACJ;AACA,YAAMvO,CAAC,GAAG,IAAIqN,WAAJ,CAAgB,QAAhB,EAA0B;AAAEC,UAAAA,OAAO,EAAE;AAAX,SAA1B,CAAV;;AACA,cAAKtB,WAAL,CAAiBuB,aAAjB,CAA+BvN,CAA/B;;AACA,YAAIwN,QAAJ,EAAcA,QAAQ,CAACxN,CAAD,CAAR;;AAEd,cAAKwO,gBAAL,CAAsBH,gBAAtB;AACD,OAZH;;AAcA,YAAKI,kBAAL;AACD,KAjOkB;;AAAA,uEAmOA,YAAM;AAAA,UACfjC,cADe,GACI,MAAK/G,KADT,CACf+G,cADe;;AAEvB,UAAMkC,eAAe,GAAG,MAAKC,0BAAL,EAAxB;;AAEA,UAAI,CAACnC,cAAD,IAAmB,CAACkC,eAAxB,EAAyC,OAAO,IAAP;AAJlB,UAMfhP,QANe,GAMFgP,eANE,CAMfhP,QANe;AAQvB,UAAI,CAACA,QAAL,EAAe,OAAO,IAAP;AAEf,aAAO,UAACrJ,IAAD,EAAU;AACf,YAAI,OAAOqJ,QAAP,KAAoB,UAAxB,EAAoC;AAClC,gBAAM,IAAIzB,KAAJ,CACJ,6IADI,CAAN;AAGD;;AACD,YAAIyB,QAAJ,EAAc;AACZ,iBAAOA,QAAQ,CAACrJ,IAAD,EAAOmW,cAAP,CAAf;AACD;;AACD,eAAO,IAAP;AACD,OAVD;AAWD,KAxPkB;;AAAA,wEA0PC,YAAM;AAAA,yBACgB,MAAK/G,KADrB;AAAA,UAChB+G,cADgB,gBAChBA,cADgB;AAAA,UACAoC,WADA,gBACAA,WADA;;AAExB,UAAMF,eAAe,GAAG,MAAKC,0BAAL,EAAxB;;AAEA,UAAI,CAACnC,cAAD,IAAmB,CAACkC,eAAxB,EAAyC,OAAO,IAAP;AAJjB,UAMhBG,MANgB,GAMLH,eANK,CAMhBG,MANgB;AAQxB,aAAO,UAACxY,IAAD,EAAU;AACf,YACE,OAAOA,IAAP,KAAgB,QAAhB,KACC,CAACwY,MAAD,IAAW,OAAOA,MAAP,KAAkB,UAD9B,CADF,EAGE;AACA,gBAAM,IAAI5Q,KAAJ,CACJ,8KADI,CAAN;AAGD;;AAED,YAAI4Q,MAAJ,EAAY;AACV,cAAMpF,aAAa,GAAGoF,MAAM,CAACxY,IAAD,EAAOmW,cAAP,CAA5B;;AAEA,cAAI,CAAC/C,aAAD,IAAkB,OAAOA,aAAP,KAAyB,QAA/C,EAAyD;AACvD,kBAAM,IAAIxL,KAAJ,yHAC4G6Q,MAAM,CACpHrF,aADoH,CADlH,wDAGyC+C,cAHzC,gCAG2EoC,WAH3E,+GAAN;AAKD;;AAED,cAAI,OAAOnF,aAAP,KAAyB,QAA7B,EAAuC;AACrC,mBAAO;AACLtU,cAAAA,IAAI,EAAEsU,aADD;AAEL2E,cAAAA,aAAa,EAAEvC;AAFV,aAAP;AAID;;AAED,cAAI,CAACpC,aAAa,CAACtU,IAAnB,EAAyB;AACvB,kBAAM,IAAI8I,KAAJ,0JAC2IuO,cAD3I,gCAC6KoC,WAD7K,UAAN;AAGD;;AAED,cAAI,CAACnF,aAAa,CAAC2E,aAAnB,EAAkC;AAChC,kBAAM,IAAInQ,KAAJ,mKACoJuO,cADpJ,gCACsLoC,WADtL,UAAN;AAGD;;AAED,iBAAOnF,aAAP;AACD;;AAED,YAAI,OAAOpT,IAAP,KAAgB,QAApB,EAA8B;AAC5B,gBAAM,IAAI4H,KAAJ,CAAU,gCAAV,CAAN;AACD;;AAED,eAAO;AACL9I,UAAAA,IAAI,YAAKqX,cAAL,SAAsBnW,IAAtB,SAA6BmW,cAA7B,CADC;AAEL4B,UAAAA,aAAa,EAAEvC;AAFV,SAAP;AAID,OAnDD;AAoDD,KAtTkB;;AAAA,iFAwTU,YAAM;AAAA,UACzBW,cADyB,GACN,MAAK/G,KADC,CACzB+G,cADyB;AAGjC,UAAI,CAACA,cAAL,EAAqB,OAAO,IAAP;AAErB,aAAO,MAAK3Z,KAAL,CAAW0Z,OAAX,CAAmBC,cAAnB,CAAP;AACD,KA9TkB;;AAAA,6EAgUM,YAAM;AAAA,yBACW,MAAK/G,KADhB;AAAA,UACrB+G,cADqB,gBACrBA,cADqB;AAAA,UACLoC,WADK,gBACLA,WADK;;AAE7B,UAAMF,eAAe,GAAG,MAAKC,0BAAL,EAAxB;;AACA,UAAI,CAACnC,cAAD,IAAmB,CAACkC,eAAxB,EAAyC;AACvC;AACD;;AAL4B,UAOrBK,YAPqB,GAOOL,eAPP,CAOrBK,YAPqB;AAAA,UAOPlG,SAPO,GAOO6F,eAPP,CAOP7F,SAPO;;AAS7B,UAAI,OAAOkG,YAAP,KAAwB,UAA5B,EAAwC;AACtC,cAAM,IAAI9Q,KAAJ,CAAU,wCAAV,CAAN;AACD;;AAED,YAAKuH,QAAL,CAAc;AACZ+I,QAAAA,WAAW,EAAE;AADD,OAAd,EAb6B;;;AAkB7BQ,MAAAA,YAAY,CAACH,WAAD,EAAc,MAAKnJ,KAAL,CAAWxN,KAAzB,EAAgC,UAAClD,IAAD,EAAO6Y,KAAP,EAAiB;AAC3D;AACA,YAAIA,KAAK,KAAK,MAAKnI,KAAL,CAAWmJ,WAAzB,EAAsC;;AAEtC,YAAI,CAACI,KAAK,CAACC,OAAN,CAAcla,IAAd,CAAL,EAA0B;AACxB,gBAAM,IAAIkJ,KAAJ,CAAU,2CAAV,CAAN;AACD;;AAED,YAAI,CAACiR,0BAAkB,CAACrG,SAAD,CAAvB,EAAoC;AAClC,gBAAM,IAAI5K,KAAJ,CAAU,8BAAV,CAAN;AACD,SAV0D;;;AAa3D,YAAIuO,cAAc,KAAK,MAAK/G,KAAL,CAAW+G,cAAlC,EAAkD,OAbS;;AAgB3D,YAAI,CAACzX,IAAI,CAAC2B,MAAV,EAAkB;AAChB,gBAAK+X,kBAAL;;AACA;AACD;;AAED,cAAKjJ,QAAL,CAAc;AACZ+I,UAAAA,WAAW,EAAE,KADD;AAEZxZ,UAAAA,IAFY;AAGZ8T,UAAAA;AAHY,SAAd;AAKD,OA1BW,CAAZ;AA2BD,KA7WkB;;AAAA,sEA+WD,YAAM;AAAA,yBACW,MAAKpD,KADhB;AAAA,UACd+G,cADc,gBACdA,cADc;AAAA,UACEzX,IADF,gBACEA,IADF;AAGtB,UAAI,CAACyX,cAAD,IAAmB,CAACzX,IAApB,IAA6BA,IAAI,IAAI,CAACA,IAAI,CAAC2B,MAA/C,EAAwD,OAAO,IAAP;AAExD,aAAO3B,IAAP;AACD,KArXkB;;AAAA,oEAuXH,YAAM;AAAA,UACZwX,OADY,GACA,MAAK1Z,KADL,CACZ0Z,OADY;AAIpB;;AACA,YAAK4C,WAAL,GAAmB,IAAIzW,MAAJ,aACZ7D,MAAM,CAACqB,IAAP,CAAYqW,OAAZ,EAAqB5V,IAArB,CAA0B,EAA1B,CADY,2BAAnB;AAGD,KA/XkB;;AAAA,yEAkZE,YAAM;AACzB,YAAK6O,QAAL,CAAc;AACZzQ,QAAAA,IAAI,EAAE,IADM;AAEZwZ,QAAAA,WAAW,EAAE,KAFD;AAGZ/B,QAAAA,cAAc,EAAE,IAHJ;AAIZ4C,QAAAA,GAAG,EAAE,IAJO;AAKZC,QAAAA,IAAI,EAAE;AALM,OAAd;AAOD,KA1ZkB;;AAAA,oEA4ZH,YAAM;AACpB,UAAMxc,KAAK,uBAAQ,MAAKA,KAAb,CAAX;;AACA,UAAMyc,OAAO,GAAG,CACd,kBADc,EAEd,gBAFc,EAGd,SAHc,EAId,cAJc,EAKd,KALc,EAMd,UANc,EAOd,UAPc,EAQd,uBARc,EASd,WATc,EAUd,OAVc,EAWd,SAXc,EAYd,WAZc,EAad,WAbc,EAcd,gBAdc,EAed,aAfc,EAgBd,WAhBc,EAiBd,oBAjBc,EAkBd,eAlBc,EAmBd,eAnBc,EAoBd,iBApBc,EAqBd,qBArBc,EAsBd,eAtBc,EAuBd,mBAvBc,EAwBd,oBAxBc,EAyBd,cAzBc,EA0Bd,aA1Bc,EA2Bd,MA3Bc,EA4Bd,yBA5Bc,CAAhB,CAFoB;;AAkCpB,WAAK,IAAMC,IAAX,IAAmB1c,KAAnB,EAA0B;AACxB,YAAIyc,OAAO,CAAC7G,QAAR,CAAiB8G,IAAjB,CAAJ,EAA4B,OAAO1c,KAAK,CAAC0c,IAAD,CAAZ;AAC7B;;AAED,aAAO1c,KAAP;AACD,KAnckB;;AAAA,iEAqcN,UAACsC,IAAD,EAAU;AACrB,UAAIA,IAAI,CAAC,CAAD,CAAJ,KAAY,GAAhB,EAAqB,OAAO,KAAP;AAErB,UAAMqa,MAAM,GAAGra,IAAI,CAACqG,KAAL,CAAW,GAAX,CAAf;AAEA,UAAIgU,MAAM,CAAC9Y,MAAP,GAAgB,CAApB,EAAuB,OAAO,KAAP;AAEvB,aAAO,IAAP;AACD,KA7ckB;;AAAA,qEA+cF,UAACsJ,CAAD,EAAO;AAAA,yBAOlB,MAAKnN,KAPa;AAAA,UAEpB0Z,OAFoB,gBAEpBA,OAFoB;AAAA,UAGpBiB,QAHoB,gBAGpBA,QAHoB;AAAA,UAIpBiC,OAJoB,gBAIpBA,OAJoB;AAAA,UAKpBC,qBALoB,gBAKpBA,qBALoB;AAAA,UAMpBC,kBANoB,gBAMpBA,kBANoB;AAAA,yBAQA,MAAKlK,KARL;AAAA,UAQd2J,GARc,gBAQdA,GARc;AAAA,UAQTC,IARS,gBAQTA,IARS;AAUtB,UAAMO,QAAQ,GAAG5P,CAAC,CAACsC,MAAnB;AAVsB,UAWd4J,YAXc,GAWmB0D,QAXnB,CAWd1D,YAXc;AAAA,UAWAD,cAXA,GAWmB2D,QAXnB,CAWA3D,cAXA;AAYtB,UAAMhU,KAAK,GAAG2X,QAAQ,CAAC3X,KAAvB;;AAEA,UAAIuV,QAAJ,EAAc;AACZxN,QAAAA,CAAC,CAAC6P,OAAF;AACArC,QAAAA,QAAQ,CAACxN,CAAD,CAAR;AACD;;AAED,UAAI0P,qBAAJ,EAA2B;AACzB,YAAMtB,aAAa,GAAG,MAAKrB,gBAAL,EAAtB;;AACA2C,QAAAA,qBAAqB,CAACtB,aAAD,CAArB;AACD;;AAED,YAAK5I,QAAL,CAAc;AACZvN,QAAAA;AADY,OAAd;;AAIA,UAAIuU,cAAJ;AACA,UAAIsD,SAAJ;;AAEA,UAAI,MAAKC,UAAL,CAAgB9X,KAAhB,CAAJ,EAA4B;AAC1BuU,QAAAA,cAAc,GAAG,GAAjB;AACAsD,QAAAA,SAAS,GAAG7X,KAAZ;AACD,OAHD,MAGO;AACL,YAAI+X,UAAU,GAAG/X,KAAK,CACnBrB,KADc,CACR,CADQ,EACLsV,YADK,EAEdhV,KAFc,CAER,gCAFQ,CAAjB;AAIA4Y,QAAAA,SAAS,GAAGE,UAAU,IAAIA,UAAU,CAACA,UAAU,CAACtZ,MAAX,GAAoB,CAArB,CAAV,CAAkCuZ,IAAlC,EAA1B;AAEAzD,QAAAA,cAAc,GACXsD,SAAS,IAAIjb,MAAM,CAACqB,IAAP,CAAYqW,OAAZ,EAAqB2D,IAArB,CAA0B,UAACva,CAAD;AAAA,iBAAOA,CAAC,KAAKma,SAAS,CAAC,CAAD,CAAtB;AAAA,SAA1B,CAAd,IACA,IAFF;AAGD;AAED;;;;;;AAIA,UAAI,CAACA,SAAD,IAAcA,SAAS,CAACpZ,MAAV,IAAoB+Y,OAAtC,EAA+C;AAC7C,cAAKhB,kBAAL;;AACA;AACD;;AAED,UAAMG,WAAW,GAAGkB,SAAS,CAAClZ,KAAV,CAAgB,CAAhB,CAApB,CAvDsB;;AA0DtB,UAAI,CAAC4V,cAAL,EAAqB;AACnB;AACD;;AAED,UACEmD,kBAAkB,IACjBP,GAAG,KAAK,IAAR,IAAgBC,IAAI,KAAK,IAD1B;AAGAS,MAAAA,SAAS,CAACpZ,MAAV,KAAqB,CAJvB,EAKE;AAAA,mCACuCyZ,mBAAmB,CACxDP,QADwD,EAExD1D,YAFwD,CAD1D;AAAA,YACakE,MADb,wBACQhB,GADR;AAAA,YAC2BiB,OAD3B,wBACqBhB,IADrB;;AAMA,cAAK7J,QAAL,CAAc;AACZ;AACA4J,UAAAA,GAAG,EAAEgB,MAAM,GAAG,MAAKpE,WAAL,CAAiBJ,SAA1B,IAAuC,CAFhC;AAGZyD,UAAAA,IAAI,EAAEgB;AAHM,SAAd;AAKD;;AAED,YAAK7K,QAAL,CACE;AACE0G,QAAAA,YADF;AAEED,QAAAA,cAFF;AAGEO,QAAAA,cAHF;AAIEoC,QAAAA;AAJF,OADF,EAOE,YAAM;AACJ,YAAI;AACF,gBAAK0B,sBAAL;AACD,SAFD,CAEE,OAAOC,GAAP,EAAY;AACZzE,UAAAA,YAAY,CAACyE,GAAG,CAACxZ,OAAL,CAAZ;AACD;AACF,OAbH;AAeD,KA9iBkB;;AAAA,qEAgjBF,UAACiJ,CAAD,EAAO;AAAA,yBACsB,MAAKnN,KAD3B;AAAA,UACd6c,qBADc,gBACdA,qBADc;AAAA,UACS/F,QADT,gBACSA,QADT;;AAGtB,UAAI+F,qBAAJ,EAA2B;AACzB,YAAMtB,aAAa,GAAG,MAAKrB,gBAAL,EAAtB;;AACA2C,QAAAA,qBAAqB,CAACtB,aAAD,CAArB;AACD;;AAED,UAAIzE,QAAJ,EAAc;AACZ3J,QAAAA,CAAC,CAAC6P,OAAF;AACAlG,QAAAA,QAAQ,CAAC3J,CAAD,CAAR;AACD;AACF,KA5jBkB;;AAAA,6EA8jBM,UAACA,CAAD,EAAO;AAAA,yBACU,MAAKnN,KADf;AAAA,UACtB2d,mBADsB,gBACtBA,mBADsB;AAAA,UACDC,MADC,gBACDA,MADC;AAI9B;AACA;;AACA,UAAMC,EAAE,GAAG1Q,CAAC,CAAC2Q,aAAb;;AACA,UACE,MAAKC,WAAL,IACAF,EAAE,YAAYG,IADd,IAEA,MAAKD,WAAL,CAAiBE,QAAjB,CAA0BJ,EAA1B,CAHF,EAIE;AACA;AACD;;AAED,UAAIF,mBAAJ,EAAyB;AACvB,cAAK/B,kBAAL;AACD;;AAED,UAAIgC,MAAJ,EAAY;AACVzQ,QAAAA,CAAC,CAAC6P,OAAF;AACAY,QAAAA,MAAM,CAACzQ,CAAD,CAAN;AACD;AACF,KArlBkB;;AAAA,uEAulBA,YAAM;AACvB,YAAKyO,kBAAL;AACD,KAzlBkB;;AAAA,sEA2lBD,UAACpY,IAAD,EAAU;AAAA,UAClB0a,YADkB,GACD,MAAKle,KADJ,CAClBke,YADkB;AAG1B,UAAI,CAACA,YAAL,EAAmB;;AAEnB,UAAIA,YAAY,KAAK,IAArB,EAA2B;AACzB7F,QAAAA,mBAAmB,CAAC,MAAK0F,WAAN,EAAmBva,IAAnB,CAAnB;AACA;AACD;;AAED,UAAI,OAAO0a,YAAP,KAAwB,UAAxB,IAAsCA,YAAY,CAACra,MAAb,KAAwB,CAAlE,EAAqE;AACnE,cAAM,IAAIuH,KAAJ,CACJ,sHADI,CAAN;AAGD;;AAED8S,MAAAA,YAAY,CAAC,MAAKH,WAAN,EAAmBva,IAAnB,CAAZ;AACD,KA5mBkB;;AAAA,uBAG4B,MAAKxD,KAHjC;AAAA,QAGTme,gBAHS,gBAGTA,gBAHS;AAAA,QAGSzE,QAHT,gBAGSA,OAHT;AAAA,QAGkBtU,MAHlB,gBAGkBA,KAHlB;AAMjB;;AAEA,UAAKgZ,aAAL;;AAEA,QAAI,CAACD,gBAAL,EAAuB;AACrB,YAAM,IAAI/S,KAAJ,CAAU,sCAAV,CAAN;AACD;;AAED,QAAI,CAACsO,QAAL,EAAc;AACZ,YAAM,IAAItO,KAAJ,CAAU,6BAAV,CAAN;AACD;;AACD,UAAKwH,KAAL,GAAa;AACX2J,MAAAA,GAAG,EAAE,IADM;AAEXC,MAAAA,IAAI,EAAE,IAFK;AAGX7C,MAAAA,cAAc,EAAE,IAHL;AAIXoC,MAAAA,WAAW,EAAE,EAJF;AAKX7Z,MAAAA,IAAI,EAAE,IALK;AAMXkD,MAAAA,KAAK,EAAEA,MAAK,IAAI,EANL;AAOXsW,MAAAA,WAAW,EAAE,KAPF;AAQXrC,MAAAA,YAAY,EAAE,CARH;AASXD,MAAAA,cAAc,EAAE,CATL;AAUXpD,MAAAA,SAAS,EAAE,IAVA;AAWXqI,MAAAA,aAAa,EAAE;AAXJ,KAAb;AAjBiB;AA8BlB;;;;wCAEmB;AAAA;;AAClBhH,MAAAA,SAAS,CAACC,GAAV,CAAc9C,SAAS,CAACC,GAAxB,EAA6B;AAAA,eAAM,MAAI,CAACmH,kBAAL,EAAN;AAAA,OAA7B;AACAvE,MAAAA,SAAS,CAACC,GAAV,CAAc9C,SAAS,CAACM,KAAxB,EAA+B;AAAA,eAAM,MAAI,CAACwJ,QAAL,EAAN;AAAA,OAA/B;AACA,UAAMD,aAAa,GAAGhH,SAAS,CAACC,GAAV,CAAc9C,SAAS,CAACI,KAAxB,EAA+B,UAACzH,CAAD;AAAA,eACnD,MAAI,CAACoR,QAAL,CAAcpR,CAAd,CADmD;AAAA,OAA/B,CAAtB;AAGA,WAAKwF,QAAL,CAAc;AACZ0L,QAAAA;AADY,OAAd;AAGAhH,MAAAA,SAAS,CAACmH,WAAV;AACD;;;qDAEgCC,WAAW;AAC1C,WAAKC,OAAL,CAAaD,SAAb;AACD;;;2CAEsB;AACrBpH,MAAAA,SAAS,CAACsH,UAAV;AACAtH,MAAAA,SAAS,CAACS,MAAV,CAAiB,KAAKlF,KAAL,CAAWyL,aAA5B;AACD;;;AA8UD;kCAC4B;AAAA,UAAlBjZ,KAAkB,QAAlBA,KAAkB;AAAA,UAAXsU,OAAW,QAAXA,OAAW;AAAA,UACXkF,QADW,GACE,KAAKhM,KADP,CAClBxN,KADkB;AAAA,UAETyZ,UAFS,GAEM,KAAK7e,KAFX,CAElB0Z,OAFkB;AAI1B,UAAItU,KAAK,KAAKwZ,QAAV,IAAsB,CAACA,QAA3B,EAAqC,KAAKjM,QAAL,CAAc;AAAEvN,QAAAA;AAAF,OAAd;AACrC;;;;AAGA,UAAIpD,MAAM,CAACqB,IAAP,CAAYqW,OAAZ,EAAqB5V,IAArB,CAA0B,EAA1B,MAAkC9B,MAAM,CAACqB,IAAP,CAAYwb,UAAZ,EAAwB/a,IAAxB,CAA6B,EAA7B,CAAtC,EAAwE;AACtE,aAAKsa,aAAL;AACD;AACF;AAED;;;;;;6BA+NS;AAAA;;AAAA,yBAcH,KAAKpe,KAdF;AAAA,UAEa8e,MAFb,gBAELX,gBAFK;AAAA,UAGLjR,KAHK,gBAGLA,KAHK;AAAA,UAILwC,SAJK,gBAILA,SAJK;AAAA,UAKLsI,SALK,gBAKLA,SALK;AAAA,UAML+G,aANK,gBAMLA,aANK;AAAA,UAOLhH,aAPK,gBAOLA,aAPK;AAAA,UAQLiH,iBARK,gBAQLA,iBARK;AAAA,UASLC,aATK,gBASLA,aATK;AAAA,UAULC,cAVK,gBAULA,cAVK;AAAA,UAWLC,kBAXK,gBAWLA,kBAXK;AAAA,UAYLC,WAZK,gBAYLA,WAZK;AAAA,UAaLC,eAbK,gBAaLA,eAbK;AAAA,yBAemD,KAAKzM,KAfxD;AAAA,UAeC8I,WAfD,gBAeCA,WAfD;AAAA,UAec/B,cAfd,gBAecA,cAfd;AAAA,UAe8B3D,SAf9B,gBAe8BA,SAf9B;AAAA,UAeyC5Q,KAfzC,gBAeyCA,KAfzC;;AAiBP,UAAMka,cAAc,GAAG,KAAKC,eAAL,EAAvB;;AACA,UAAM3I,aAAa,GAAG,KAAK4I,iBAAL,EAAtB;;AACA,UAAMlJ,YAAY,GAAG,KAAKmJ,gBAAL,EAArB;;AAEA,UAAIC,OAAO,GAAG,KAAK1f,KAAL,CAAW0f,OAAzB;;AACA,UAAI,CAAC,KAAK1f,KAAL,CAAW2f,IAAhB,EAAsB;AACpBD,QAAAA,OAAO,GAAG,CAAV;AACD;;AAED,0BACEngB;AACE,QAAA,SAAS,gBAASmc,WAAW,KAAK,IAAhB,GAAuB,cAAvB,GAAwC,EAAjD,cACPyD,kBAAkB,IAAI,EADf,CADX;AAIE,QAAA,KAAK,EAAED;AAJT,SAMG,CAACxD,WAAW,IAAI4D,cAAhB,KAAmC3F,cAAnC,iBACCpa;AACE,QAAA,GAAG,EAAE,aAAC4Y,KAAD,EAAS;AACZ;AACA,UAAA,MAAI,CAAC4F,WAAL,GAAmB5F,KAAnB;AACD,SAJH;AAKE,QAAA,KAAK,sBAAO8G,aAAP,CALP;AAME,QAAA,SAAS,8BAAuBD,iBAAiB,IAAI,EAA5C;AANX,SAQGM,cAAc,IAAItJ,SAAlB,IAA+BY,aAA/B,iBACCrX,6BAAC,IAAD;AACE,QAAA,KAAK,EAAE6F,KADT;AAEE,QAAA,MAAM,EAAEka,cAFV;AAGE,QAAA,SAAS,EAAEtJ,SAHb;AAIE,QAAA,SAAS,EAAE+I,aAJb;AAKE,QAAA,aAAa,EAAEhH,aALjB;AAME,QAAA,SAAS,EAAEC,SANb;AAOE,QAAA,gBAAgB,EAAEpB,aAPpB;AAQE,QAAA,eAAe,EAAEN,YARnB;AASE,QAAA,QAAQ,EAAE,KAAKsJ,SATjB;AAUE,QAAA,cAAc,EAAE,KAAKC;AAVvB,QATJ,CAPJ,eAgCEtgB,6BAAC,QAAD,eACM,KAAKugB,aAAL,EADN;AAEE,QAAA,GAAG,EAAE,aAAC3H,KAAD,EAAS;AACZ,UAAA,MAAI,CAACnY,KAAL,CAAWmW,QAAX,IAAuB,MAAI,CAACnW,KAAL,CAAWmW,QAAX,CAAoBgC,KAApB,CAAvB;AACA,UAAA,MAAI,CAACgB,WAAL,GAAmBhB,KAAnB;AACD,SALH;AAME,QAAA,OAAO,EAAEuH,OANX;AAOE,QAAA,SAAS,0BAAmBhQ,SAAS,IAAI,EAAhC,CAPX;AAQE,QAAA,QAAQ,EAAE,KAAKqQ,cARjB;AASE,QAAA,QAAQ,EAAE,KAAKC,cATjB;AAUE,QAAA,QAAQ,EAAE,KAAKC,gBAVjB;AAWE,QAAA,OAAO;AAEL,aAAKC,sBAbT;AAeE,QAAA,MAAM,EAAE,KAAKA,sBAff;AAgBE,QAAA,OAAO,EAAE,KAAKlgB,KAAL,CAAWmgB,OAhBtB;AAiBE,QAAA,KAAK,EAAE/a,KAjBT;AAkBE,QAAA,KAAK,EAAE8H;AAlBT,SAmBM,KAAKlN,KAAL,CAAWogB,uBAnBjB,EAhCF,CADF;AAwDD;;;;EA1sBqC7gB,cAAK,CAACwW;;gBAAxCmD,2CACkB;AACpByE,EAAAA,mBAAmB,EAAE,IADD;AAEpBb,EAAAA,kBAAkB,EAAE,KAFA;AAGpB1X,EAAAA,KAAK,EAAE,EAHa;AAIpBwX,EAAAA,OAAO,EAAE,CAJW;AAKpBsB,EAAAA,YAAY,EAAE,IALM;AAMpBwB,EAAAA,OAAO,EAAE;AANW;;AA4sBxB,IAAMW,iBAAiB,GAAG,SAApBA,iBAAoB,QAAiB;AAAA,MAAd3G,OAAc,SAAdA,OAAc;AACzC,MAAI,CAACA,OAAL,EAAc,OAAOtO,KAAK,CAAC,qCAAD,CAAZ;AAEd,MAAMkV,QAAQ,GAAGte,MAAM,CAACue,OAAP,CAAe7G,OAAf,CAAjB;;AAEA,OAAK,IAAIjW,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6c,QAAQ,CAACzc,MAA7B,EAAqCJ,CAAC,IAAI,CAA1C,EAA6C;AAAA,qCACX6c,QAAQ,CAAC7c,CAAD,CADG;AAAA,QACpC+c,WADoC;AAAA,QACvBC,QADuB;;AAG3C,QAAI,OAAOD,WAAP,KAAuB,QAAvB,IAAmCA,WAAW,CAAC3c,MAAZ,KAAuB,CAA9D,EAAiE;AAC/D,aAAOuH,KAAK,CACV,4EADU,CAAZ;AAGD,KAP0C;;;AAU3C,QAAMsV,cAAc,GAAGD,QAAvB;AAV2C,QAYnCzK,SAZmC,GAYW0K,cAZX,CAYnC1K,SAZmC;AAAA,QAYxBkG,YAZwB,GAYWwE,cAZX,CAYxBxE,YAZwB;AAAA,QAYVF,MAZU,GAYW0E,cAZX,CAYV1E,MAZU;AAAA,QAYFnP,QAZE,GAYW6T,cAZX,CAYF7T,QAZE;;AAc3C,QAAI,CAACwP,0BAAkB,CAACrG,SAAD,CAAvB,EAAoC;AAClC,aAAO5K,KAAK,CAAC,oDAAD,CAAZ;AACD;;AAED,QAAI,CAAC8Q,YAAD,IAAiB,OAAOA,YAAP,KAAwB,UAA7C,EAAyD;AACvD,aAAO9Q,KAAK,CAAC,uDAAD,CAAZ;AACD;;AAED,QAAI4Q,MAAM,IAAI,OAAOA,MAAP,KAAkB,UAAhC,EAA4C;AAC1C,aAAO5Q,KAAK,CAAC,oDAAD,CAAZ;AACD;;AAED,QAAIyB,QAAQ,IAAI,OAAOA,QAAP,KAAoB,UAApC,EAAgD;AAC9C,aAAOzB,KAAK,CAAC,sDAAD,CAAZ;AACD;AACF;;AAED,SAAO,IAAP;AACD,CArCD;;AAuCA8N,yBAAyB,CAAC9L,SAA1B,GAAsC;AACpC+Q,EAAAA,gBAAgB,EAAE9Q,SAAS,CAACkH,WADQ;AAEpCqI,EAAAA,OAAO,EAAEvP,SAAS,CAACoE,MAFiB;AAGpCkJ,EAAAA,QAAQ,EAAEtN,SAAS,CAACI,IAHgB;AAIpCqJ,EAAAA,QAAQ,EAAEzJ,SAAS,CAACI,IAJgB;AAKpCmQ,EAAAA,MAAM,EAAEvQ,SAAS,CAACI,IALkB;AAMpCoP,EAAAA,qBAAqB,EAAExP,SAAS,CAACI,IANG;AAOpCiC,EAAAA,SAAS,EAAErC,SAAS,CAACC,MAPe;AAQpC4R,EAAAA,cAAc,EAAE7R,SAAS,CAACmF,MARU;AASpC2M,EAAAA,kBAAkB,EAAE9R,SAAS,CAACC,MATM;AAUpCqQ,EAAAA,mBAAmB,EAAEtQ,SAAS,CAACqE,IAVK;AAWpCxE,EAAAA,KAAK,EAAEG,SAAS,CAACmF,MAXmB;AAYpCmO,EAAAA,SAAS,EAAEtT,SAAS,CAACmF,MAZe;AAapCwF,EAAAA,SAAS,EAAE3K,SAAS,CAACmF,MAbe;AAcpC4M,EAAAA,WAAW,EAAE/R,SAAS,CAACmF,MAda;AAepCyM,EAAAA,aAAa,EAAE5R,SAAS,CAACmF,MAfW;AAgBpCuM,EAAAA,aAAa,EAAE1R,SAAS,CAACC,MAhBW;AAiBpCyK,EAAAA,aAAa,EAAE1K,SAAS,CAACC,MAjBW;AAkBpC+R,EAAAA,eAAe,EAAEhS,SAAS,CAACC,MAlBS;AAmBpC0R,EAAAA,iBAAiB,EAAE3R,SAAS,CAACC,MAnBO;AAoBpClI,EAAAA,KAAK,EAAEiI,SAAS,CAACC,MApBmB;AAqBpCoM,EAAAA,OAAO,EAAE2G,iBArB2B;;AAAA,CAAtC;;ACtwBA;;;;;;;;IAOMO,MAAM,GAAG,SAATA,MAAS,OAOT;AAAA,uBANJ1f,IAMI;AAAA,MANJA,IAMI,0BANG,EAMH;AAAA,MALJf,IAKI,QALJA,IAKI;AAAA,wBAJJ4Q,KAII;AAAA,MAJJA,KAII,2BAJI,QAIJ;AAAA,MAHJb,KAGI,QAHJA,KAGI;AAAA,0BAFJ2Q,OAEI;AAAA,MAFJA,OAEI,6BAFM,YAAM,EAEZ;AAAA,8BADJC,WACI;AAAA,MADJA,WACI,iCADU,YAAM,EAChB;;AAAA,kBACwB9S,cAAQ,CAAC,KAAD,CADhC;AAAA;AAAA,MACG+S,MADH;AAAA,MACWC,SADX;;AAAA,mBAEsBhT,cAAQ,CAAC,KAAD,CAF9B;AAAA;AAAA,MAEG7C,KAFH;AAAA,MAEU8V,QAFV;;AAIJrS,EAAAA,eAAS,CAAC,YAAM;AACdoS,IAAAA,SAAS,CAAC,KAAD,CAAT;AACAC,IAAAA,QAAQ,CAAC,KAAD,CAAR;AACD,GAHQ,EAGN,CAAC/Q,KAAD,CAHM,CAAT;AAKA,MAAMgR,QAAQ,GAAG,CAAC/gB,IAAI,IAAI,EAAT,EAAaghB,MAAb,CAAoB,CAApB,CAAjB;AAEA,sBACE5hB;AACE,mBAAY,QADd;AAEE,IAAA,SAAS,+CAAwCwR,KAAxC,CAFX;AAGE,IAAA,KAAK,EAAE5Q,IAHT;AAIE,IAAA,KAAK,EAAE;AACLmP,MAAAA,KAAK,EAAEpO,IADF;AAELkgB,MAAAA,MAAM,EAAElgB,IAFH;AAGLmgB,MAAAA,SAAS,EAAEngB,IAHN;AAILogB,MAAAA,UAAU,YAAKpgB,IAAL,OAJL;AAKLqgB,MAAAA,QAAQ,EAAErgB,IAAI,GAAG;AALZ,KAJT;AAWE,IAAA,OAAO,EAAE2f,OAXX;AAYE,IAAA,WAAW,EAAEC;AAZf,KAcG5Q,KAAK,IAAI,CAAC/E,KAAV,gBACC5L;AACE,mBAAY,YADd;AAEE,IAAA,GAAG,EAAE2Q,KAFP;AAGE,IAAA,GAAG,EAAEgR,QAHP;AAIE,IAAA,SAAS,kCACPH,MAAM,GAAG,iCAAH,GAAuC,EADtC,CAJX;AAOE,IAAA,KAAK,EAAE;AACLzR,MAAAA,KAAK,EAAEpO,IADF;AAELkgB,MAAAA,MAAM,EAAElgB,IAFH;AAGLmgB,MAAAA,SAAS,EAAEngB,IAHN;AAILsgB,MAAAA,SAAS,EAAE;AAJN,KAPT;AAaE,IAAA,MAAM,EAAE;AAAA,aAAMR,SAAS,CAAC,IAAD,CAAf;AAAA,KAbV;AAcE,IAAA,OAAO,EAAE;AAAA,aAAMC,QAAQ,CAAC,IAAD,CAAd;AAAA;AAdX,IADD,gBAkBC1hB;AACE,mBAAY,iBADd;AAEE,IAAA,SAAS,EAAC;AAFZ,KAIG2hB,QAJH,CAhCJ,CADF;AA0CD;;AAEDN,MAAM,CAACxT,SAAP,GAAmB;AACjB;AACA8C,EAAAA,KAAK,EAAE7C,SAAS,CAACC,MAFA;;AAGjB;AACAnN,EAAAA,IAAI,EAAEkN,SAAS,CAACC,MAJC;;AAKjB;AACAyD,EAAAA,KAAK,EAAE1D,SAAS,CAACoU,KAAV,CAAgB,CAAC,QAAD,EAAW,SAAX,EAAsB,QAAtB,CAAhB,CANU;;AAOjB;AACAvgB,EAAAA,IAAI,EAAEmM,SAAS,CAACoE,MARC;;AASjB;AACAoP,EAAAA,OAAO,EAAExT,SAAS,CAACI,IAVF;;AAWjB;AACAqT,EAAAA,WAAW,EAAEzT,SAAS,CAACI;AAZN,CAAnB;;ACtEA;;AACA,IAAMiU,uBAAuB,GAAG,SAA1BA,uBAA0B,OAM1B;AAAA,MALJC,OAKI,QALJA,OAKI;AAAA,MAJJhiB,gBAII,QAJJA,gBAII;AAAA,MAHJiiB,QAGI,QAHJA,QAGI;AAAA,MAFJC,MAEI,QAFJA,MAEI;AAAA,MADJC,YACI,QADJA,YACI;AACJ,sBACEviB;AAAK,IAAA,SAAS,EAAEsiB,MAAM,IAAI,CAAV,GAAc,QAAd,GAAyB;AAAzC,kBACEtiB;AAAQ,IAAA,OAAO,EAAE;AAAA,aAAMI,gBAAgB,CAACgiB,OAAD,EAAUC,QAAV,CAAtB;AAAA;AAAjB,KACG,GADH,EAEGE,YAFH,oBAEiBviB,2CAAOsiB,MAAP,CAFjB,CADF,CADF;AAQD,CAfD;;AAiBAH,uBAAuB,CAACtU,SAAxB,GAAoC;AAClC;AACAuU,EAAAA,OAAO,EAAEtU,SAAS,CAACmF,MAAV,CAAiBjF,UAFQ;;AAGlC;AACA5N,EAAAA,gBAAgB,EAAE0N,SAAS,CAACI,IAAV,CAAeF,UAJC;;AAKlC;;;;AAIAqU,EAAAA,QAAQ;AAAE;AAA+HvU,EAAAA,SAAS,CAACmF,MATjH;;AAUlC;AACAqP,EAAAA,MAAM,EAAExU,SAAS,CAACoE,MAXgB;;AAYlC;AACAqQ,EAAAA,YAAY,EAAEzU,SAAS,CAACC;AAbU,CAApC;AAgBA,6CAAe/N,cAAK,CAACmO,IAAN,CAAWgU,uBAAX,CAAf;;ACrCO,IAAMK,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACJ,OAAD,EAAUhhB,CAAV,EAAgB;AACrD,MAAMqhB,aAAa,GACjBL,OAAO,CAAC/O,KAAR,CAAcqP,QAAd,CAAuBN,OAAO,CAAC/O,KAAR,CAAcqP,QAAd,CAAuBpe,MAAvB,GAAgC,CAAvD,CADF;;AAGA,MAAI,CAACme,aAAL,EAAoB;AAClB,WAAOrhB,CAAC,CAAC,gBAAD,CAAR;AACD;;AACD,MAAIqhB,aAAa,CAACE,UAAlB,EAA8B;AAC5B,WAAOvhB,CAAC,CAAC,iBAAD,CAAR;AACD;;AACD,MAAIqhB,aAAa,CAAC1f,IAAlB,EAAwB;AACtB,WAAO0f,aAAa,CAAC1f,IAArB;AACD;;AACD,MAAI0f,aAAa,CAACG,OAAlB,EAA2B;AACzB,sBAAWH,aAAa,CAACG,OAAzB;AACD;;AACD,MAAIH,aAAa,CAACI,WAAd,CAA0Bve,MAA9B,EAAsC;AACpC,WAAOlD,CAAC,CAAC,kBAAD,CAAR;AACD;;AAED,SAAOA,CAAC,CAAC,kBAAD,CAAR;AACD,CArBM;AAuBA,IAAM0hB,eAAe,GAAG,SAAlBA,eAAkB,CAACV,OAAD,EAAUW,WAAV,EAA0B;AACvD,MAAIlT,KAAK,GAAGuS,OAAO,CAACzf,IAAR,CAAa/B,IAAzB;AACA,MAAMoiB,OAAO,GAAGvgB,MAAM,CAAC2T,MAAP,CAAcgM,OAAO,CAAC/O,KAAR,CAAc2P,OAA5B,CAAhB;;AAEA,MAAI,CAACnT,KAAD,IAAUmT,OAAO,CAAC1e,MAAR,KAAmB,CAAjC,EAAoC;AAClC,QAAM2e,WAAW,GAAGD,OAAO,CAAClF,IAAR,CAAa,UAACoF,CAAD;AAAA,aAAOA,CAAC,CAAC/e,IAAF,CAAO/B,EAAP,KAAc2gB,WAAW,CAAC3gB,EAAjC;AAAA,KAAb,CAApB;AACAyN,IAAAA,KAAK,GAAGoT,WAAW,CAAC9e,IAAZ,CAAiBvD,IAAzB;AACD;;AAED,SAAOiP,KAAP;AACD,CAVM;AAYA,IAAMsT,eAAe,GAAG,SAAlBA,eAAkB,CAACf,OAAD,EAAUW,WAAV,EAA0B;AAAA,MACjDpS,KADiD,GACvCyR,OAAO,CAACzf,IAD+B,CACjDgO,KADiD;AAEvD,MAAMqS,OAAO,GAAGvgB,MAAM,CAAC2T,MAAP,CAAcgM,OAAO,CAAC/O,KAAR,CAAc2P,OAA5B,CAAhB;;AAEA,MAAI,CAACrS,KAAD,IAAUqS,OAAO,CAAC1e,MAAR,KAAmB,CAAjC,EAAoC;AAClC,QAAM2e,WAAW,GAAGD,OAAO,CAAClF,IAAR,CAAa,UAACoF,CAAD;AAAA,aAAOA,CAAC,CAAC/e,IAAF,CAAO/B,EAAP,KAAc2gB,WAAW,CAAC3gB,EAAjC;AAAA,KAAb,CAApB;AACAuO,IAAAA,KAAK,GAAGsS,WAAW,CAAC9e,IAAZ,CAAiBwM,KAAzB;AACD;;AAED,SAAOA,KAAP;AACD,CAVM;;ACtBP;;;;IAGMyS,cAAc,GAAG,SAAjBA,cAAiB,CAAC3iB,KAAD,EAAW;AAAA,oBAClBiQ,gBAAU,CAACvP,kBAAD,CADQ;AAAA,MACxBC,CADwB,eACxBA,CADwB;;AAAA,qBAE6BsP,gBAAU,CACrE3Q,WADqE,CAFvC;AAAA,MAExBG,MAFwB,gBAExBA,MAFwB;AAAA,MAEPmjB,aAFO,gBAEhBjB,OAFgB;AAAA,MAEQhiB,gBAFR,gBAEQA,gBAFR;;AAAA,MAKxBgiB,OALwB,GAKuB3hB,KALvB,CAKxB2hB,OALwB;AAAA,uBAKuB3hB,KALvB,CAKf6iB,OALe;AAAA,MAKfA,OALe,+BAKLnB,yBALK;;AAAA,kBAMM1T,cAAQ;AAC5C;AAAkEtH,EAAAA,SADtB,CANd;AAAA;AAAA,MAMzBoc,WANyB;AAAA,MAMZC,cANY;;AAAA,mBASJ/U,cAAQ,CAAC,CAAD,CATJ;AAAA;AAAA,MASzB6T,MATyB;AAAA,MASjBmB,SATiB;;AAWhCpU,EAAAA,eAAS,CAAC,YAAM;AACdoU,IAAAA,SAAS,CAACrB,OAAO,CAACsB,WAAR,EAAD,CAAT;AACD,GAFQ,EAEN,CAACtB,OAAD,CAFM,CAAT;AAIA/S,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAMsU,WAAW,GAAG,SAAdA,WAAc,CAACzJ,KAAD,EAAW;AAC7B,UAAM0J,QAAQ,GAAG,CAAAP,aAAa,SAAb,IAAAA,aAAa,WAAb,YAAAA,aAAa,CAAEQ,GAAf,MAAuBzB,OAAO,CAACyB,GAAhD;AACAL,MAAAA,cAAc,CAACtJ,KAAK,CAACvV,OAAP,CAAd;;AAEA,UAAI,CAACif,QAAL,EAAe;AACbH,QAAAA,SAAS,CAACrB,OAAO,CAACsB,WAAR,EAAD,CAAT;AACD,OAFD,MAEO;AACLD,QAAAA,SAAS,CAAC,CAAD,CAAT;AACD;AACF,KATD;;AAWArB,IAAAA,OAAO,CAAC0B,EAAR,CAAW,aAAX,EAA0BH,WAA1B;AACAvB,IAAAA,OAAO,CAAC0B,EAAR,CAAW,iBAAX,EAA8BH,WAA9B;AACAvB,IAAAA,OAAO,CAAC0B,EAAR,CAAW,iBAAX,EAA8BH,WAA9B;AAEA,WAAO,YAAM;AACXvB,MAAAA,OAAO,CAAC2B,GAAR,CAAY,aAAZ,EAA2BJ,WAA3B;AACAvB,MAAAA,OAAO,CAAC2B,GAAR,CAAY,iBAAZ,EAA+BJ,WAA/B;AACAvB,MAAAA,OAAO,CAAC2B,GAAR,CAAY,iBAAZ,EAA+BJ,WAA/B;AACD,KAJD;AAKD,GAtBQ,EAsBN,CAACvB,OAAD,EAAUiB,aAAV,CAtBM,CAAT;AAwBAhU,EAAAA,eAAS,CAAC,YAAM;AACd,QAAMuU,QAAQ,GAAG,CAAAP,aAAa,SAAb,IAAAA,aAAa,WAAb,YAAAA,aAAa,CAAEQ,GAAf,MAAuBzB,OAAO,CAACyB,GAAhD;;AAEA,QAAID,QAAJ,EAAc;AACZH,MAAAA,SAAS,CAAC,CAAD,CAAT;AACD,KAFD,MAEO;AACLA,MAAAA,SAAS,CAACrB,OAAO,CAACsB,WAAR,EAAD,CAAT;AACD;AACF,GARQ,EAQN,CAACL,aAAD,EAAgBjB,OAAhB,CARM,CAAT;;AAUA,MAAI,CAACkB,OAAL,EAAc;AACZ,WAAO,IAAP;AACD;;AAED,sBACEtjB,6BAAC,OAAD,eACMS,KADN;AAEE,IAAA,gBAAgB,EAAEL,gBAFpB;AAGE,IAAA,WAAW,EAAEmjB,WAHf;AAIE,IAAA,MAAM,EAAEjB,MAJV;AAKE,IAAA,aAAa,EAAEE,uBAAuB,CAACJ,OAAD,EAAUhhB,CAAV,CALxC;AAME,IAAA,YAAY,EAAE0hB,eAAe,CAACV,OAAD,EAAUliB,MAAM,CAACiE,IAAjB,CAN/B;AAOE,IAAA,YAAY,EAAEgf,eAAe,CAACf,OAAD,EAAUliB,MAAM,CAACiE,IAAjB,CAP/B;AAQE,IAAA,MAAM,EAAEkf,aAAa,IAAIA,aAAa,CAACQ,GAAd,KAAsBzB,OAAO,CAACyB;AARzD,KADF;AAYD;;AAEDT,cAAc,CAACvV,SAAf,GAA2B;AACzB;AACAuU,EAAAA,OAAO;AAAE;AAAmEtU,EAAAA,SAAS,CAClFmF,MADyE,CAClEjF,UAHe;;AAIzB;AACAqV,EAAAA,aAAa;AAAE;AAAsFvV,EAAAA,SAAS,CAACmF,MALtF;;AAMzB;;;;;;;;;AASAqQ,EAAAA,OAAO;AAAE;AAAyGxV,EAAAA,SAAS,CAACkH;AAfnG,CAA3B;;ACnFA;AAQA;;;;;;AAKA,IAAMgP,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACvjB,KAAD,EAAW;AACvC;;;AAGA,MAAMwjB,oBAAoB,GAAGzV,YAAM,CAAC,IAAD,CAAnC;AACA,MAAM0V,WAAW,GACfzjB,KAAK,CAAC0jB,YAAN,IAAsB,CAAtB,GAA0B,2CAA1B,GAAwE,EAD1E;AAEA,MAAMC,WAAW,GAAG3jB,KAAK,CAAC4jB,MAAN,GAChB,2CADgB,GAEhB,EAFJ;;AAIA,MAAMC,eAAe,GAAG,SAAlBA,eAAkB,GAAM;AAAA;;AAC5B7jB,IAAAA,KAAK,CAACL,gBAAN,CAAuBK,KAAK,CAAC2hB,OAA7B,EAAsC3hB,KAAK,CAAC4hB,QAA5C,EAD4B;;AAG5B4B,IAAAA,oBAAoB,SAApB,IAAAA,oBAAoB,WAApB,qCAAAA,oBAAoB,CAAEjV,OAAtB,gFAA+BuV,IAA/B;AACD,GAJD;;AAMA,sBACEvkB;AACE,mBAAY,wBADd;AAEE,IAAA,OAAO,EAAEskB,eAFX;AAGE,IAAA,GAAG,EAAEL,oBAHP;AAIE,IAAA,SAAS,8CAAuCC,WAAvC,cAAsDE,WAAtD;AAJX,kBAMEpkB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC,MAAD;AAAQ,IAAA,KAAK,EAAES,KAAK,CAAC+jB,YAArB;AAAmC,IAAA,IAAI,EAAE;AAAzC,IADF,CANF,eASExkB;AAAK,IAAA,SAAS,EAAC;AAAf,KACGS,KAAK,CAAC8hB,YADT,CATF,CADF;AAeD,CAhCD;;AAkCAyB,qBAAqB,CAACnW,SAAtB,GAAkC;AAChC;AACAuU,EAAAA,OAAO,EAAEtU,SAAS,CAAC2W,UAAV,CAAqBC,kBAArB,EAA8B1W,UAFP;;AAGhC;AACAqV,EAAAA,aAAa,EAAEvV,SAAS,CAAC2W,UAAV,CAAqBC,kBAArB,CAJiB;;AAKhC;AACAtkB,EAAAA,gBAAgB,EAAE0N,SAAS,CAACI,IAAV,CAAeF,UAND;;AAOhC;;;;AAIAqU,EAAAA,QAAQ;AAAE;AAA+HvU,EAAAA,SAAS,CAACmF,MAXnH;;AAYhC;AACAqP,EAAAA,MAAM,EAAExU,SAAS,CAACoE,MAbc;;AAchC;AACAmS,EAAAA,MAAM,EAAEvW,SAAS,CAACqE,IAfc;;AAgBhC;AACAsQ,EAAAA,aAAa,EAAE3U,SAAS,CAACC,MAjBO;;AAkBhC;AACAwU,EAAAA,YAAY,EAAEzU,SAAS,CAACC,MAnBQ;;AAoBhC;AACAyW,EAAAA,YAAY,EAAE1W,SAAS,CAACC;AArBQ,CAAlC;AAwBA,2CAAe/N,cAAK,CAACmO,IAAN,CAAW6V,qBAAX,CAAf;;ACvEA;AAQA;;;;;;;AAMA,IAAMW,yBAAyB,GAAG,SAA5BA,yBAA4B,CAAClkB,KAAD,EAAW;AAC3C;AACA,MAAMwjB,oBAAoB,GAAGzV,YAAM,CAAC,IAAD,CAAnC;;AACA,MAAM8V,eAAe,GAAG,SAAlBA,eAAkB,GAAM;AAAA;;AAC5B7jB,IAAAA,KAAK,CAACL,gBAAN,CAAuBK,KAAK,CAAC2hB,OAA7B,EAAsC3hB,KAAK,CAAC4hB,QAA5C,EAD4B;;AAG5B4B,IAAAA,oBAAoB,SAApB,IAAAA,oBAAoB,WAApB,qCAAAA,oBAAoB,CAAEjV,OAAtB,gFAA+BuV,IAA/B;AACD,GAJD;;AAMA,MAAML,WAAW,GACfzjB,KAAK,CAAC6hB,MAAN,IAAgB,CAAhB,GAAoB,mCAApB,GAA0D,EAD5D;AAEA,MAAM8B,WAAW,GAAG3jB,KAAK,CAAC4jB,MAAN,GAAe,mCAAf,GAAqD,EAAzE;AAEA,sBACErkB;AAAK,IAAA,SAAS,sCAA+BkkB,WAA/B,cAA8CE,WAA9C;AAAd,kBACEpkB;AACE,IAAA,OAAO,EAAEskB,eADX;AAEE,IAAA,GAAG,EAAEL,oBAFP;AAGE,mBAAY;AAHd,KAKGxjB,KAAK,CAAC6hB,MAAN,IAAgB,CAAhB,iBACCtiB;AAAK,IAAA,SAAS,EAAC;AAAf,IANJ,eAQEA,6BAAC,MAAD;AAAQ,IAAA,KAAK,EAAES,KAAK,CAAC+jB;AAArB,IARF,eASExkB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAM,IAAA,SAAS,EAAC;AAAhB,KACGS,KAAK,CAAC8hB,YADT,CADF,eAIEviB;AAAM,IAAA,SAAS,EAAC;AAAhB,KACGmF,QAAQ,CAAC1E,KAAK,CAACgiB,aAAP,EAAsBhiB,KAAK,CAACmkB,mBAA5B,CADX,CAJF,EAOGnkB,KAAK,CAAC6hB,MAAN,IAAgB,CAAhB,iBACCtiB;AAAM,IAAA,SAAS,EAAC;AAAhB,KACGS,KAAK,CAAC6hB,MADT,CARJ,CATF,CADF,CADF;AA2BD,CAxCD;;AA0CAqC,yBAAyB,CAAC9W,SAA1B,GAAsC;AACpC;AACAuU,EAAAA,OAAO,EAAEtU,SAAS,CAACmF,MAAV,CAAiBjF,UAFU;;AAGpC;AACAqV,EAAAA,aAAa,EAAEvV,SAAS,CAACmF,MAJW;;AAKpC;AACA7S,EAAAA,gBAAgB,EAAE0N,SAAS,CAACI,IAAV,CAAeF,UANG;;AAOpC;;;;AAIAqU,EAAAA,QAAQ,EAAEvU,SAAS,CAACmF,MAXgB;;AAYpC;AACAqP,EAAAA,MAAM,EAAExU,SAAS,CAACoE,MAbkB;;AAcpC;AACAmS,EAAAA,MAAM,EAAEvW,SAAS,CAACqE,IAfkB;;AAgBpC;AACAsQ,EAAAA,aAAa,EAAE3U,SAAS,CAACC,MAjBW;;AAkBpC;AACA6W,EAAAA,mBAAmB,EAAE9W,SAAS,CAACoE,MAnBK;;AAoBpC;AACAqQ,EAAAA,YAAY,EAAEzU,SAAS,CAACC,MArBY;;AAsBpC;AACAyW,EAAAA,YAAY,EAAE1W,SAAS,CAACC;AAvBY,CAAtC;AA0BA4W,yBAAyB,CAACE,YAA1B,GAAyC;AACvCD,EAAAA,mBAAmB,EAAE;AADkB,CAAzC;AAIA,+CAAe5kB,cAAK,CAACmO,IAAN,CAAWwW,yBAAX,CAAf;;ACtFA;AAQA;;;;;;;;AAOA,IAAMG,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACrkB,KAAD,EAAW;AACzC;AACA,MAAMwjB,oBAAoB,GAAGzV,YAAM,CAAC,IAAD,CAAnC;AACA,MAAM0V,WAAW,GACfzjB,KAAK,CAAC6hB,MAAN,IAAgB,CAAhB,GAAoB,6CAApB,GAAoE,EADtE;AAEA,MAAM8B,WAAW,GAAG3jB,KAAK,CAAC4jB,MAAN,GAChB,6CADgB,GAEhB,EAFJ;;AAGA,MAAMC,eAAe,GAAG,SAAlBA,eAAkB,GAAM;AAAA;;AAC5B7jB,IAAAA,KAAK,CAACL,gBAAN,CAAuBK,KAAK,CAAC2hB,OAA7B,EAAsC3hB,KAAK,CAAC4hB,QAA5C,EAD4B;;AAG5B4B,IAAAA,oBAAoB,SAApB,IAAAA,oBAAoB,WAApB,qCAAAA,oBAAoB,CAAEjV,OAAtB,gFAA+BuV,IAA/B;AACD,GAJD;;AAMA,sBACEvkB;AACE,IAAA,OAAO,EAAEskB,eADX;AAEE,IAAA,GAAG,EAAEL,oBAFP;AAGE,IAAA,SAAS,gDAAyCC,WAAzC,cAAwDE,WAAxD,CAHX;AAIE,mBAAY;AAJd,kBAMEpkB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACGA,6BAAC,MAAD;AAAQ,IAAA,KAAK,EAAES,KAAK,CAAC+jB,YAArB;AAAmC,IAAA,IAAI,EAAE;AAAzC,IADH,CANF,eASExkB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,2CAAOS,KAAK,CAAC8hB,YAAb,CADF,CADF,eAIEviB;AAAK,IAAA,SAAS,EAAC;AAAf,KACGmF,QAAQ,CAAC1E,KAAK,CAACgiB,aAAP,EAAsBhiB,KAAK,CAACmkB,mBAA5B,CADX,CAJF,CATF,CADF;AAoBD,CAlCD;;AAoCAE,uBAAuB,CAACjX,SAAxB,GAAoC;AAClC;AACAuU,EAAAA,OAAO,EAAEtU,SAAS,CAACmF,MAAV,CAAiBjF,UAFQ;;AAGlC;AACAqV,EAAAA,aAAa,EAAEvV,SAAS,CAACmF,MAJS;;AAKlC;AACA7S,EAAAA,gBAAgB,EAAE0N,SAAS,CAACI,IAAV,CAAeF,UANC;;AAOlC;;;;AAIAqU,EAAAA,QAAQ,EAAEvU,SAAS,CAACmF,MAXc;;AAYlC;AACAqP,EAAAA,MAAM,EAAExU,SAAS,CAACoE,MAbgB;;AAclC;AACAmS,EAAAA,MAAM,EAAEvW,SAAS,CAACqE,IAfgB;;AAgBlC;AACAsQ,EAAAA,aAAa,EAAE3U,SAAS,CAACC,MAjBS;;AAkBlC;AACA6W,EAAAA,mBAAmB,EAAE9W,SAAS,CAACoE,MAnBG;;AAoBlC;AACAqQ,EAAAA,YAAY,EAAEzU,SAAS,CAACC,MArBU;;AAsBlC;AACAyW,EAAAA,YAAY,EAAE1W,SAAS,CAACC;AAvBU,CAApC;AA0BA+W,uBAAuB,CAACD,YAAxB,GAAuC;AACrCD,EAAAA,mBAAmB,EAAE;AADgB,CAAvC;AAIA,6CAAe5kB,cAAK,CAACmO,IAAN,CAAW2W,uBAAX,CAAf;;ACjFA;AAGO,IAAMC,SAAS,GAAG,SAAZA,SAAY;AAAA,sBACvB/kB;AAAK,IAAA,KAAK,EAAC,IAAX;AAAgB,IAAA,MAAM,EAAC,IAAvB;AAA4B,IAAA,KAAK,EAAC;AAAlC,kBACEA;AACE,IAAA,CAAC,EAAC,6FADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IADF,CADuB;AAAA,CAAlB;AASA,IAAMglB,kBAAkB,GAAG,SAArBA,kBAAqB;AAAA,sBAChChlB;AAAK,IAAA,KAAK,EAAC,IAAX;AAAgB,IAAA,MAAM,EAAC,IAAvB;AAA4B,IAAA,KAAK,EAAC;AAAlC,kBACEA;AACE,IAAA,CAAC,EAAC,2KADJ;AAEE,IAAA,IAAI,EAAC,SAFP;AAGE,IAAA,QAAQ,EAAC;AAHX,IADF,CADgC;AAAA,CAA3B;AAUA,IAAMilB,YAAY,GAAG,SAAfA,YAAe;AAAA,sBAC1BjlB;AAAK,IAAA,KAAK,EAAC,IAAX;AAAgB,IAAA,MAAM,EAAC,IAAvB;AAA4B,IAAA,KAAK,EAAC;AAAlC,kBACEA;AACE,IAAA,CAAC,EAAC,g8BADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IADF,CAD0B;AAAA,CAArB;AASA,IAAMklB,UAAU,GAAG,SAAbA,UAAa;AAAA,sBACxBllB;AAAK,IAAA,KAAK,EAAC,IAAX;AAAgB,IAAA,MAAM,EAAC,IAAvB;AAA4B,IAAA,KAAK,EAAC;AAAlC,kBACEA;AACE,IAAA,CAAC,EAAC,4JADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IADF,CADwB;AAAA,CAAnB;AASA,IAAMmlB,SAAS,GAAG,SAAZA,SAAY;AAAA,sBACvBnlB;AAAK,IAAA,KAAK,EAAC,IAAX;AAAgB,IAAA,MAAM,EAAC,IAAvB;AAA4B,IAAA,KAAK,EAAC;AAAlC,kBACEA;AACE,IAAA,CAAC,EAAC,0SADJ;AAEE,IAAA,IAAI,EAAC,SAFP;AAGE,IAAA,QAAQ,EAAC;AAHX,IADF,CADuB;AAAA,CAAlB;;ACxCP;AAMA;;AACA,IAAMolB,yBAAyB,GAAG,SAA5BA,yBAA4B,OAK5B;AAAA,MAJJC,WAII,QAJJA,WAII;AAAA,MAHJC,WAGI,QAHJA,WAGI;AAAA,MAFJC,WAEI,QAFJA,WAEI;AAAA,MADJjE,OACI,QADJA,OACI;;AAAA,oBACU5Q,gBAAU,CAACvP,kBAAD,CADpB;AAAA,MACIC,CADJ,eACIA,CADJ;;AAEJ,MAAIokB,eAAJ;AACA,MAAIC,eAAJ;;AAEA,MAAIJ,WAAW,KAAK,CAApB,EAAuB;AACrB,QAAIC,WAAJ,EAAiB;AACfE,MAAAA,eAAe,eAAQF,WAAR,CAAf;AACD,KAFD,MAEO;AACLE,MAAAA,eAAe,GAAGpkB,CAAC,CAAC,SAAD,CAAnB;AACD;AACF;;AAED,MAAIikB,WAAW,IAAIA,WAAW,GAAG,CAAjC,EAAoC;AAClC,QAAIE,WAAJ,EAAiB;AACfE,MAAAA,eAAe,aAAMJ,WAAN,cAAqBE,WAArB,CAAf;AACD,KAFD,MAEO;AACLE,MAAAA,eAAe,GAAGrkB,CAAC,CAAC,0BAAD,EAA6B;AAC9CskB,QAAAA,UAAU,EAAEL;AADkC,OAA7B,CAAnB;AAGD;AACF;;AAED,MAAIA,WAAW,IAAIA,WAAW,KAAK,CAAnC,EAAsC;AACpC,wBACErlB;AACE,qBAAY,sBADd;AAEE,MAAA,SAAS,EAAC,wCAFZ;AAGE,MAAA,OAAO,EAAEshB;AAHX,oBAKEthB,6BAAC,SAAD,OALF,EAMGqlB,WAAW,KAAK,CAAhB,GAAoBG,eAApB,GAAsCC,eANzC,CADF;AAUD;;AACD,SAAO,IAAP;AACD,CAzCD;;AA2CAL,yBAAyB,CAACP,YAA1B,GAAyC;AACvCQ,EAAAA,WAAW,EAAE;AAD0B,CAAzC;AAIAD,yBAAyB,CAACvX,SAA1B,GAAsC;AACpC;AACAyX,EAAAA,WAAW,EAAExX,SAAS,CAACC,MAFa;;AAGpC;AACAwX,EAAAA,WAAW,EAAEzX,SAAS,CAACC,MAJa;;AAKpC;AACAsX,EAAAA,WAAW,EAAEvX,SAAS,CAACoE,MANa;;AAOpC;;;;;AAKAoP,EAAAA,OAAO,EAAExT,SAAS,CAACI;AAZiB,CAAtC;AAeA,+CAAelO,cAAK,CAACmO,IAAN,CAAWiX,yBAAX,CAAf;;ACrEA;AAKA;;IACMrT,KAAK,GAAG,SAARA,KAAQ,OAAiC;AAAA,MAA9B9B,QAA8B,QAA9BA,QAA8B;AAAA,MAApB0V,OAAoB,QAApBA,OAAoB;AAAA,MAAXC,IAAW,QAAXA,IAAW;;AAC7C;AACA,MAAMhP,QAAQ,GAAGpI,YAAM,CAAC,IAAD,CAAvB;;AAF6C,oBAG/BkC,gBAAU,CAACvP,kBAAD,CAHqB;AAAA,MAGrCC,CAHqC,eAGrCA,CAHqC;AAK7C;;;AACA,MAAMykB,WAAW,GAAG,SAAdA,WAAc,CAACjY,CAAD,EAAO;AAAA;;AACzB,QACEA,CAAC,CAACsC,MAAF,YAAoBuO,IAApB,IACA,uBAAC7H,QAAQ,CAAC5H,OAAV,sDAAC,kBAAkB0P,QAAlB,CAA2B9Q,CAAC,CAACsC,MAA7B,CAAD,CADA,IAEAyV,OAHF,EAIE;AACAA,MAAAA,OAAO;AACR;AACF,GARD;;AAUAtW,EAAAA,eAAS,CAAC,YAAM;AACd,QAAI,CAACuW,IAAL,EAAW,OAAO,YAAM,EAAb;AACX;;AACA,QAAME,YAAY,GAAG,SAAfA,YAAe,CAAClY,CAAD,EAAO;AAC1B,UAAIA,CAAC,YAAYmY,aAAb,IAA8BnY,CAAC,CAACoI,OAAF,KAAc,EAA5C,IAAkD2P,OAAtD,EAA+D;AAC7DA,QAAAA,OAAO;AACR;AACF,KAJD;;AAKAjQ,IAAAA,QAAQ,CAACC,gBAAT,CAA0B,UAA1B,EAAsCmQ,YAAtC,EAAoD,KAApD;AACA,WAAO;AAAA,aAAMpQ,QAAQ,CAACG,mBAAT,CAA6B,UAA7B,EAAyCiQ,YAAzC,EAAuD,KAAvD,CAAN;AAAA,KAAP;AACD,GAVQ,EAUN,CAACH,OAAD,EAAUC,IAAV,CAVM,CAAT;AAYA,MAAMI,WAAW,GAAGJ,IAAI,GACpB,uBADoB,GAEpB,yBAFJ;AAIA,sBACE5lB;AAAK,IAAA,SAAS,4BAAqBgmB,WAArB,CAAd;AAAkD,IAAA,OAAO,EAAEH;AAA3D,kBACE7lB;AAAK,IAAA,SAAS,EAAC;AAAf,KACGoB,CAAC,CAAC,OAAD,CADJ,eAEEpB;AAAK,IAAA,KAAK,EAAC,IAAX;AAAgB,IAAA,MAAM,EAAC,IAAvB;AAA4B,IAAA,KAAK,EAAC;AAAlC,kBACEA;AACE,IAAA,CAAC,EAAC,sHADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IADF,CAFF,CADF,eAUEA;AAAK,IAAA,SAAS,EAAC,wBAAf;AAAwC,IAAA,GAAG,EAAE4W;AAA7C,KACG3G,QADH,CAVF,CADF;AAgBD;;AAED8B,KAAK,CAAClE,SAAN,GAAkB;AAChB;AACA8X,EAAAA,OAAO,EAAE7X,SAAS,CAACI,IAAV,CAAeF,UAFR;;AAGhB;AACA4X,EAAAA,IAAI,EAAE9X,SAAS,CAACqE,IAAV,CAAenE;AAJL,CAAlB;;ACxDA;;AAGA,IAAMiY,YAAY,GAAG,SAAfA,YAAe;AAAA,sBACnBjmB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,IADF,eAEEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,IADF,eAEEA;AAAK,IAAA,SAAS,EAAC;AAAf,IAFF,CAFF,CADmB;AAAA,CAArB;AAUA;;;;;;;AAKA,IAAMkmB,eAAe,GAAG,SAAlBA,eAAkB;AAAA,sBACtBlmB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC,YAAD,OADF,eAEEA,6BAAC,YAAD,OAFF,eAGEA,6BAAC,YAAD,OAHF,CADsB;AAAA,CAAxB;;AAQA,qCAAeA,cAAK,CAACmO,IAAN,CAAW+X,eAAX,CAAf;;AC1BA;AAMA;;;;;;;AAMA,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,OAAe;AAAA,MAAZva,KAAY,QAAZA,KAAY;;AAAA,oBAC7B8E,gBAAU,CAACvP,kBAAD,CADmB;AAAA,MACnCC,CADmC,eACnCA,CADmC;;AAE3C,MAAI,CAACwK,KAAL,EAAY,OAAO,IAAP;AAEZ;AAAA;AACE;AACA,8CAAMxK,CAAC,CAAC,2BAAD,EAA8B;AAAEsY,MAAAA,YAAY,EAAE9N,KAAK,CAACjH;AAAtB,KAA9B,CAAP;AAFF;AAID,CARD;;AAUAwhB,qBAAqB,CAACtB,YAAtB,GAAqC;AACnCjZ,EAAAA,KAAK,EAAE;AAD4B,CAArC;AAIAua,qBAAqB,CAACtY,SAAtB,GAAkC;AAChC;AACAjC,EAAAA,KAAK,EAAEkC,SAAS,CAAC2W,UAAV,CAAqB5Y,KAArB;AAFyB,CAAlC;AAKA,kDAAe7L,cAAK,CAACmO,IAAN,CAAWgY,qBAAX,CAAf;;AC/BA;AAMA;;;;;;;AAMA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB;AAAA,uBAAGzkB,IAAH;AAAA,MAAGA,IAAH,0BAAU,EAAV;AAAA,wBAAc0kB,KAAd;AAAA,MAAcA,KAAd,2BAAsB,SAAtB;AAAA,sBACvBrmB;AACE,IAAA,SAAS,wCAAiCqmB,KAAjC,CADX;AAEE,mBAAY,2BAFd;AAGE,IAAA,KAAK,EAAE;AAAEtW,MAAAA,KAAK,EAAEpO,IAAT;AAAekgB,MAAAA,MAAM,EAAElgB;AAAvB;AAHT,kBAKE3B;AACE,IAAA,KAAK,EAAE2B,IADT;AAEE,IAAA,MAAM,EAAEA,IAFV;AAGE,IAAA,OAAO,aAHT;AAIE,IAAA,KAAK,EAAC;AAJR,kBAME3B,wDACEA;AAAgB,IAAA,EAAE,EAAC,KAAnB;AAAyB,IAAA,EAAE,EAAC,IAA5B;AAAiC,IAAA,EAAE,EAAC,KAApC;AAA0C,IAAA,EAAE,EAAC,MAA7C;AAAoD,IAAA,EAAE,EAAC;AAAvD,kBACEA;AAAM,IAAA,SAAS,EAAC,MAAhB;AAAuB,IAAA,WAAW,EAAC,GAAnC;AAAuC,IAAA,MAAM,EAAC;AAA9C,IADF,eAEEA;AACE,IAAA,MAAM,EAAC,MADT;AAEE,mBAAY,0BAFd;AAGE,IAAA,SAAS,EAAEqmB,KAHb;AAIE,IAAA,WAAW,EAAC,GAJd;AAKE,IAAA,KAAK,EAAE;AAAEC,MAAAA,SAAS,EAAED;AAAb;AALT,IAFF,CADF,CANF,eAkBErmB;AACE,IAAA,CAAC,EAAC,wKADJ;AAEE,IAAA,IAAI,EAAC,SAFP;AAGE,IAAA,QAAQ,EAAC;AAHX,IAlBF,CALF,CADuB;AAAA,CAAzB;;AAiCA,2CAAeA,cAAK,CAACmO,IAAN,CAAWiY,gBAAX,CAAf;;AC7CA;AAIA;;AACA,IAAMG,YAAY,GAAG,SAAfA,YAAe;AAAA,MAAGC,MAAH,QAAGA,MAAH;AAAA,sBACnBxmB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAM,IAAA,SAAS,EAAC;AAAhB,KAAgDwmB,MAAM,CAACC,MAAvD,CADF,eAEEzmB;AAAM,IAAA,SAAS,EAAC;AAAhB,KAA8CwmB,MAAM,CAAC5lB,IAArD,CAFF,CADmB;AAAA,CAArB;;AAOA2lB,YAAY,CAAC1Y,SAAb,GAAyB;AACvB2Y,EAAAA,MAAM,EAAE1Y,SAAS,CAAC0D,KAAV,CAAgB;AACtB;AACA5Q,IAAAA,IAAI,EAAEkN,SAAS,CAACC,MAAV,CAAiBC,UAFD;;AAGtB;AACAyY,IAAAA,MAAM,EAAE3Y,SAAS,CAACC,MAAV,CAAiBC;AAJH,GAAhB,EAKLA;AANoB,CAAzB;AASA,kCAAehO,cAAK,CAACmO,IAAN,CAAWoY,YAAX,CAAf;;ACrBA;AAMA;;;;;;AAKA,IAAMG,QAAQ,GAAG,SAAXA,QAAW;AAAA,MAAGF,MAAH,QAAGA,MAAH;AAAA,sBACfxmB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC,MAAD;AAAQ,IAAA,IAAI,EAAE,EAAd;AAAkB,IAAA,KAAK,EAAEwmB,MAAM,CAAC7V;AAAhC,IADF,eAEE3Q,uDACEA,6CAASwmB,MAAM,CAAC5lB,IAAhB,CADF,OACkC,CAAC4lB,MAAM,CAAC5lB,IAAR,GAAe4lB,MAAM,CAACpkB,EAAtB,GAA2B,EAD7D,CAFF,CADe;AAAA,CAAjB;;AASAskB,QAAQ,CAAC7Y,SAAT,GAAqB;AACnB2Y,EAAAA,MAAM,EAAE1Y,SAAS,CAAC0D,KAAV,CAAgB;AACtB;AACA5Q,IAAAA,IAAI,EAAEkN,SAAS,CAACC,MAFM;;AAGtB;AACA3L,IAAAA,EAAE,EAAE0L,SAAS,CAACC,MAJQ;;AAKtB;AACA4C,IAAAA,KAAK,EAAE7C,SAAS,CAACC;AANK,GAAhB,EAOLC;AARgB,CAArB;AAWA,8BAAehO,cAAK,CAACmO,IAAN,CAAWuY,QAAX,CAAf;;AC/BA;AAIA;;;;AAGA,IAAMC,WAAW,GAAG,SAAdA,WAAc;AAAA,MAAGH,MAAH,QAAGA,MAAH;AAAA,sBAClBxmB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAM,IAAA,SAAS,EAAC;AAAhB,kBACEA,6CAASwmB,MAAM,CAAC5lB,IAAhB,CADF,OACkC4lB,MAAM,CAACI,IADzC,CADF,eAIE5mB,wCAJF,eAKEA;AAAM,IAAA,SAAS,EAAC;AAAhB,KACGwmB,MAAM,CAAC1W,WADV,CALF,CADkB;AAAA,CAApB;;AAYA6W,WAAW,CAAC9Y,SAAZ,GAAwB;AACtB2Y,EAAAA,MAAM,EAAE1Y,SAAS,CAAC0D,KAAV,CAAgB;AACtB;AACA5Q,IAAAA,IAAI,EAAEkN,SAAS,CAACC,MAFM;;AAGtB;AACA6Y,IAAAA,IAAI,EAAE9Y,SAAS,CAACC,MAJM;;AAKtB;AACA+B,IAAAA,WAAW,EAAEhC,SAAS,CAACC;AAND,GAAhB,EAOLC;AARmB,CAAxB;AAWA,iCAAehO,cAAK,CAACmO,IAAN,CAAWwY,WAAX,CAAf;;ACfA;;AACA,IAAME,YAAY,GAAG,SAAfA,YAAe,CAACC,IAAD,EAAU;AAC7B,MAAMC,KAAK,GAAGC,oBAAU,CAAClL,MAAX,CAAkBgL,IAAlB,KAA2B,EAAzC;AACA,MAAMtf,KAAK,GAAGuf,KAAK,CAChBviB,KADW,CACL,CADK,EACF,EADE,EAEXsZ,IAFW,CAEN;AAAA,QAAG9b,SAAH,QAAGA,SAAH;AAAA,WAAmBA,SAAnB,aAAmBA,SAAnB,uBAAmBA,SAAS,CAAEqU,QAAX,CAAoByQ,IAApB,CAAnB;AAAA,GAFM,CAAd;AAGA,MAAI,CAACtf,KAAD,IAAU,EAAE,YAAYA,KAAd,CAAd,EAAoC,OAAO,IAAP;AACpC,SAAOA,KAAK,CAACif,MAAb;AACD,CAPD;AASA;;;AACA,IAAMQ,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACxmB,KAAD,EAAW;AAAA;;AAAA,oBACdiQ,gBAAU,CAAC3Q,WAAD,CADI;AAAA,MAC1BqiB,OAD0B,eAC1BA,OAD0B;;AAElC,MAAMY,OAAO,GAAGZ,OAAH,aAAGA,OAAH,yCAAGA,OAAO,CAAE/O,KAAZ,mDAAG,eAAgB2P,OAAhC;AACA,MAAMX,QAAQ,GAAGD,OAAH,aAAGA,OAAH,0CAAGA,OAAO,CAAE/O,KAAZ,oDAAG,gBAAgBgP,QAAjC;AAEA,MAAM6E,qBAAqB,GAAGnY,iBAAW,CAAC,YAAM;AAC9C,QAAMoY,WAAW,GAAGnE,OAAO,GACvBvgB,MAAM,CAAC2T,MAAP,CAAc4M,OAAd,EAAuB/d,GAAvB,CAA2B;AAAA,UAAGd,IAAH,SAAGA,IAAH;AAAA,aAAcA,IAAd;AAAA,KAA3B,CADuB,GAEvB,EAFJ;AAGA,QAAMijB,YAAY,GAAG/E,QAAQ,GAAG5f,MAAM,CAAC2T,MAAP,CAAciM,QAAd,CAAH,GAA6B,EAA1D;AACA,QAAM3a,KAAK,gCAAOyf,WAAP,sBAAuBC,YAAvB,EAAX,CAL8C;;AAO9C;;AACA,QAAMC,WAAW,GAAG,EAApB;AACA3f,IAAAA,KAAK,CAAC1D,OAAN,CAAc,UAACG,IAAD,EAAU;AACtB,UAAIA,IAAI,IAAI,CAACkjB,WAAW,CAACljB,IAAI,CAAC/B,EAAN,CAAxB,EAAmC;AACjCilB,QAAAA,WAAW,CAACljB,IAAI,CAAC/B,EAAN,CAAX,GAAuB+B,IAAvB;AACD;AACF,KAJD;AAKA,WAAO1B,MAAM,CAAC2T,MAAP,CAAciR,WAAd,CAAP;AACD,GAfwC,EAetC,CAACrE,OAAD,EAAUX,QAAV,CAfsC,CAAzC,CALkC;;AAuBlC,MAAMiF,qBAAqB,GAAGvY,iBAAW,CACvCwY,QAAQ;AAAA;;AACN;;;;AADM;AAAA,yEAKN,iBAAOC,KAAP,EAAcC,OAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACOrF,OADP,aACOA,OADP,uBACOA,OAAO,CAAEsF,YADhB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,qBAEyBtF,OAFzB,aAEyBA,OAFzB,uBAEyBA,OAAO,CAAEsF,YAAT,CAAsB;AAC3C9mB,gBAAAA,IAAI,EAAE;AAAE+mB,kBAAAA,aAAa,EAAEH;AAAjB;AADqC,eAAtB,CAFzB;;AAAA;AAEQI,cAAAA,QAFR;AAKQlgB,cAAAA,KALR,GAKgBkgB,QAAQ,CAAC5E,OAAT,CAAiB/d,GAAjB,CAAqB,UAACie,CAAD;AAAA,uBAAOA,CAAC,CAAC/e,IAAT;AAAA,eAArB,CALhB;AAME,kBAAIsjB,OAAJ,EAAaA,OAAO,CAAC/f,KAAD,CAAP;;AANf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KALM;;AAAA;AAAA;AAAA;AAAA,OAaN,GAbM,CAD+B,EAgBvC,CAAC0a,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEsF,YAAV,CAhBuC,CAAzC;AAvBkC,MA0C1BG,QA1C0B,GA0CWpnB,KA1CX,CA0C1BonB,QA1C0B;AAAA,MA0ChBC,YA1CgB,GA0CWrnB,KA1CX,CA0ChBqnB,YA1CgB;AAAA,MA0CF/G,QA1CE,GA0CWtgB,KA1CX,CA0CFsgB,QA1CE;AA2ClC;;;;;;;;;;;AAUA,MAAMgH,WAAW,GAAGhZ,iBAAW;AAE7B;AAAA,WACEgS,QAAQ,IAAI;AACV,WAAK;AACHpE,QAAAA,YAAY,EAAE,sBAACqL,CAAD,EAAIjlB,IAAJ,EAAU0kB,OAAV,EAAsB;AAClC,cAAIO,CAAC,CAAC1jB,MAAF,KAAa,CAAb,IAAkB0jB,CAAC,CAACpG,MAAF,CAAS,CAAT,EAAY9c,KAAZ,CAAkB,gBAAlB,CAAtB,EAA2D;AACzD,mBAAO,EAAP;AACD;;AACD,cAAMlC,MAAM,GAAGokB,oBAAU,CAAClL,MAAX,CAAkBkM,CAAlB,KAAwB,EAAvC;AACA,cAAMC,MAAM,GAAGrlB,MAAM,CAAC4B,KAAP,CAAa,CAAb,EAAgB,EAAhB,CAAf;AAEA,cAAIijB,OAAJ,EAAaA,OAAO,CAACQ,MAAD,EAASD,CAAT,CAAP;AAEb,iBAAOC,MAAP;AACD,SAXE;AAYHxR,QAAAA,SAAS,EAAE8P,cAZR;AAaH9J,QAAAA,MAAM,EAAE,gBAAC+J,MAAD;AAAA,iBAAa;AACnBnlB,YAAAA,GAAG,EAAEmlB,MAAM,CAACpkB,EADO;AAEnBW,YAAAA,IAAI,YAAKyjB,MAAM,CAACC,MAAZ,CAFe;AAGnBzK,YAAAA,aAAa,EAAE;AAHI,WAAb;AAAA;AAbL,OADK;AAoBV,WAAK;AACHW,QAAAA,YAAY,EAAE,sBAAC6K,KAAD,EAAQzkB,IAAR,EAAc0kB,OAAd,EAA0B;AACtC;AACA;AACA;AACA;AACA,cAAI,CAACD,KAAD,IAAU/kB,MAAM,CAAC2T,MAAP,CAAc4M,OAAO,IAAI,EAAzB,EAA6B1e,MAA7B,GAAsC,GAApD,EAAyD;AACvD,gBAAMoD,KAAK,GAAGwf,qBAAqB,EAAnC;AAEA,gBAAMgB,aAAa,GAAGxgB,KAAK,CAAC3B,MAAN,CAAa,UAAC5B,IAAD,EAAU;AAC3C,kBAAI,CAACqjB,KAAL,EAAY,OAAO,IAAP;;AACZ,kBACErjB,IAAI,CAACvD,IAAL,KAAcuG,SAAd,IACAhD,IAAI,CAACvD,IAAL,CAAUunB,WAAV,GAAwB9R,QAAxB,CAAiCmR,KAAK,CAACW,WAAN,EAAjC,CAFF,EAGE;AACA,uBAAO,IAAP;AACD;;AACD,qBAAOhkB,IAAI,CAAC/B,EAAL,CAAQ+lB,WAAR,GAAsB9R,QAAtB,CAA+BmR,KAAK,CAACW,WAAN,EAA/B,CAAP;AACD,aATqB,CAAtB;AAUA,gBAAMxlB,IAAI,GAAGulB,aAAa,CAAC1jB,KAAd,CAAoB,CAApB,EAAuB,EAAvB,CAAb;AAEA,gBAAIijB,OAAJ,EAAaA,OAAO,CAAC9kB,IAAD,EAAO6kB,KAAP,CAAP;AAEb,mBAAO7kB,IAAP;AACD;;AACD,iBAAO2kB,qBAAqB,CAC1BE,KAD0B;AAE1B;AACA,oBAAC7kB,IAAD,EAAU;AACR,gBAAI8kB,OAAJ,EAAaA,OAAO,CAAC9kB,IAAD,EAAO6kB,KAAP,CAAP;AACd,WALyB,CAA5B;AAOD,SAhCE;AAiCH/Q,QAAAA,SAAS,EAAEiQ,UAjCR;AAkCHjK,QAAAA,MAAM,EAAE,gBAAC+J,MAAD;AAAA,iBAAa;AACnBnlB,YAAAA,GAAG,EAAEmlB,MAAM,CAACpkB,EADO;AAEnBW,YAAAA,IAAI,aAAMyjB,MAAM,CAAC5lB,IAAP,IAAe4lB,MAAM,CAACpkB,EAA5B,CAFe;AAGnB4Z,YAAAA,aAAa,EAAE;AAHI,WAAb;AAAA,SAlCL;AAuCH1O,QAAAA,QAAQ,EAAE,kBAACrJ,IAAD;AAAA,iBAAU6jB,YAAY,IAAIA,YAAY,CAAC7jB,IAAD,CAAtC;AAAA;AAvCP,OApBK;AA6DV,WAAK;AACH0Y,QAAAA,YAAY,EAAE,sBAACqL,CAAD,EAAIjlB,IAAJ,EAAU0kB,OAAV,EAAsB;AAClC,cAAI1kB,IAAI,CAACiD,OAAL,CAAa,GAAb,MAAsB,CAAtB,IAA2B,CAAC6hB,QAAhC,EAA0C;AACxC,mBAAO,EAAP;AACD;;AACD,cAAMO,gBAAgB,GAAGP,QAAQ,CAAC9hB,MAAT,CACvB,UAACsiB,CAAD;AAAA,mBAAOA,CAAC,CAACznB,IAAF,CAAOoF,OAAP,CAAegiB,CAAf,MAAsB,CAAC,CAA9B;AAAA,WADuB,CAAzB,CAJkC;;AASlCI,UAAAA,gBAAgB,CAACE,IAAjB,CAAsB,UAAC/kB,CAAD,EAAIC,CAAJ,EAAU;AAC9B,gBAAI+kB,KAAK,GAAGhlB,CAAC,CAAC3C,IAAF,CAAOunB,WAAP,EAAZ;AACA,gBAAIK,KAAK,GAAGhlB,CAAC,CAAC5C,IAAF,CAAOunB,WAAP,EAAZ;;AACA,gBAAII,KAAK,CAACviB,OAAN,CAAcgiB,CAAd,MAAqB,CAAzB,EAA4B;AAC1BO,cAAAA,KAAK,cAAOA,KAAP,CAAL;AACD;;AACD,gBAAIC,KAAK,CAACxiB,OAAN,CAAcgiB,CAAd,MAAqB,CAAzB,EAA4B;AAC1BQ,cAAAA,KAAK,cAAOA,KAAP,CAAL;AACD;;AACD,gBAAID,KAAK,GAAGC,KAAZ,EAAmB;AACjB,qBAAO,CAAC,CAAR;AACD;;AACD,gBAAID,KAAK,GAAGC,KAAZ,EAAmB;AACjB,qBAAO,CAAP;AACD;;AAED,mBAAO,CAAP;AACD,WAjBD;AAmBA,cAAMP,MAAM,GAAGG,gBAAgB,CAAC5jB,KAAjB,CAAuB,CAAvB,EAA0B,EAA1B,CAAf;AACA,cAAIijB,OAAJ,EAAaA,OAAO,CAACQ,MAAD,EAASD,CAAT,CAAP;AAEb,iBAAOC,MAAP;AACD,SAjCE;AAkCHxR,QAAAA,SAAS,EAAEkQ,aAlCR;AAmCHlK,QAAAA,MAAM,EAAE,gBAAC+J,MAAD;AAAA,iBAAa;AACnBnlB,YAAAA,GAAG,EAAEmlB,MAAM,CAACpkB,EADO;AAEnBW,YAAAA,IAAI,aAAMyjB,MAAM,CAAC5lB,IAAb,CAFe;AAGnBob,YAAAA,aAAa,EAAE;AAHI,WAAb;AAAA;AAnCL;AA7DK,KADd;AAAA,GAF6B,EA0G7B,CACEgH,OADF,EAEEkE,qBAFF,EAGEW,QAHF,EAIEC,YAJF,EAKER,qBALF,EAMEvG,QANF,CA1G6B,CAA/B;AArDkC,MAyK1BnK,QAzK0B,GAyKbnW,KAzKa,CAyK1BmW,QAzK0B;AA2KlC,MAAM6R,cAAc,GAAG1Z,iBAAW,CAChC,UAAC6J,GAAD,EAAS;AACP,QAAIhC,QAAJ,EAAcA,QAAQ,CAAC5H,OAAT,GAAmB4J,GAAnB;AACf,GAH+B,EAIhC,CAAChC,QAAD,CAJgC,CAAlC;AAOA,sBACE5W,6BAAC0oB,yBAAD;AACE,IAAA,gBAAgB,EAAEtC,uBADpB;AAEE,IAAA,OAAO,EAAE2B,WAAW,EAFtB;AAGE,IAAA,WAAW,EAAElB,YAHf;AAIE,IAAA,OAAO,EAAE,CAJX;AAKE,IAAA,OAAO,EAAEpmB,KAAK,CAAC0f,OALjB;AAME,IAAA,QAAQ,EAAEsI,cANZ;AAOE,IAAA,OAAO,EAAEhoB,KAAK,CAACmgB,OAPjB;AAQE,IAAA,IAAI,EAAEngB,KAAK,CAACkoB,IARd;AASE,IAAA,SAAS,EAAC,8BATZ;AAUE,IAAA,kBAAkB,EAAC,oBAVrB;AAWE,IAAA,iBAAiB,EAAC,uBAXpB;AAYE,IAAA,aAAa,EAAC,6BAZhB;AAaE,IAAA,aAAa,EAAC,6BAbhB;AAcE,IAAA,WAAW,EAAEloB,KAAK,CAACmoB,WAdrB;AAeE,IAAA,QAAQ,EAAEnoB,KAAK,CAAC2a,QAflB;AAgBE,IAAA,YAAY,EAAE3a,KAAK,CAAC+Z,YAhBtB;AAiBE,IAAA,OAAO,EAAE/Z,KAAK,CAACooB,OAjBjB;AAkBE,IAAA,KAAK,EAAEpoB,KAAK,CAACoF,KAlBf;AAmBE,IAAA,IAAI,EAAEpF,KAAK,CAAC2f,IAnBd;AAoBE,IAAA,QAAQ,EAAE3f,KAAK,CAACqoB,QApBlB;AAqBE,IAAA,uBAAuB,EAAEroB,KAAK,CAACogB;AArBjC,IADF;AAyBD,CA3MD;;AA6MAoG,gBAAgB,CAACpZ,SAAjB,GAA6B;AAC3B;AACA8a,EAAAA,IAAI,EAAE7a,SAAS,CAACoE,MAFW;;AAG3B;AACAkO,EAAAA,IAAI,EAAEtS,SAAS,CAACqE,IAJW;;AAK3B;AACAgO,EAAAA,OAAO,EAAErS,SAAS,CAACoE,MANQ;;AAO3B;AACA4W,EAAAA,QAAQ,EAAEhb,SAAS,CAACqE,IARO;;AAS3B;AACAtM,EAAAA,KAAK,EAAEiI,SAAS,CAACC,MAVU;;AAW3B;AACA8a,EAAAA,OAAO,EAAE/a,SAAS,CAACI,IAZQ;;AAa3B;AACAsM,EAAAA,YAAY,EAAE1M,SAAS,CAACI,IAdG;;AAe3B;AACAkN,EAAAA,QAAQ,EAAEtN,SAAS,CAACI,IAhBO;;AAiB3B;AACA0a,EAAAA,WAAW,EAAE9a,SAAS,CAACC,MAlBI;;AAmB3B;AACA;AACAqY,EAAAA,gBAAgB,EAAEtY,SAAS,CAACkH,WArBD;;AAsB3B;AACAqI,EAAAA,OAAO,EAAEvP,SAAS,CAACoE,MAvBQ;;AAwB3B;;;;;AAKA4V,EAAAA,YAAY,EAAEha,SAAS,CAACI,IA7BG;;AA8B3B;AACA2Z,EAAAA,QAAQ,EAAE/Z,SAAS,CAACG,KA/BO;;AAgC3B;AACA2S,EAAAA,OAAO,EAAE9S,SAAS,CAACI,IAjCQ;;AAkC3B;;;AAGA2S,EAAAA,uBAAuB,EAAE/S,SAAS,CAACmF;AArCR,CAA7B;AAwCAgU,gBAAgB,CAACpC,YAAjB,GAAgC;AAC9B8D,EAAAA,IAAI,EAAE;AADwB,CAAhC;AAIA,sCAAe3oB,cAAK,CAACmO,IAAN,CAAW8Y,gBAAX,CAAf;;AChRA;;;;AAGA,IAAM8B,OAAO,GAAG,SAAVA,OAAU,CAACtoB,KAAD;AAAA,sBACdT;AAAK,IAAA,SAAS,EAAC;AAAf,KAAuCS,KAAvC,GACGA,KAAK,CAACwP,QADT,CADc;AAAA,CAAhB;;AAMA,6BAAejQ,cAAK,CAACmO,IAAN,CAAW4a,OAAX,CAAf;;;;;ACAA;;;;;;;AAOA;;;;;;AAKA,IAAMC,yBAAyB,GAAG,SAA5BA,yBAA4B,CAACC,IAAD,EAAU;AAC1C,MAAIA,IAAI,CAAC5S,QAAL,CAAc,QAAd,CAAJ,EAA6B,OAAO,OAAP;AAC7B,MAAI4S,IAAI,CAAC5S,QAAL,CAAc,QAAd,CAAJ,EAA6B,OAAO,OAAP;AAC7B,SAAO,MAAP;AACD,CAJD;AAMA;;;AACA,IAAM6S,gBAAgB,GAAG,EAAzB;AACA;;AACA,IAAMC,iBAAiB,GAAG,EAA1B;AAEA;;;;;;AAKA,SAASC,SAAT,CAAmBzkB,OAAnB,EAA4B;AAAA;;AAC1B,MAAI,CAACA,OAAL,EAAc;AACZ,WAAO;AACL5B,MAAAA,IAAI,EAAE,EADD;AAELsmB,MAAAA,UAAU,EAAE,EAFP;AAGLC,MAAAA,YAAY,EAAEC,SAAS,CAACJ,iBAAD,CAHlB;AAILK,MAAAA,SAAS,EAAE,EAJN;AAKLC,MAAAA,WAAW,EAAEF,SAAS,CAACL,gBAAD,CALjB;AAMLQ,MAAAA,eAAe,EAAE,CANZ;AAOL7G,MAAAA,WAAW,EAAE,EAPR;AAQLtd,MAAAA,eAAe,EAAE,EARZ;AASLokB,MAAAA,iBAAiB,EAAE;AATd,KAAP;AAWD,GAbyB;;;AAgB1B,MAAML,YAAY,GAChB,yBAAA3kB,OAAO,CAACke,WAAR,8EACI9c,MADJ,CACW;AAAA,QAAGJ,IAAH,QAAGA,IAAH;AAAA,WAAcA,IAAI,KAAK,OAAvB;AAAA,GADX,EAEGikB,MAFH,CAEU,UAACC,GAAD,EAAM5Y,UAAN,EAAqB;AAC3B,QAAM7O,EAAE,GAAGuE,gBAAgB,EAA3B;AACA,WAAOkjB,GAAG,CAACC,KAAJ,CAAU,CAAC1nB,EAAD,CAAV,EAAgB;AACrBA,MAAAA,EADqB;AAErByO,MAAAA,GAAG,EAAEI,UAAU,CAACrB,SAFK;AAGrByD,MAAAA,KAAK,EAAE,UAHc;AAIrB0W,MAAAA,IAAI,EAAE;AACJnpB,QAAAA,IAAI,EAAEqQ,UAAU,CAAC/J;AADb;AAJe,KAAhB,CAAP;AAQD,GAZH,EAYKqiB,SAAS,CAACJ,iBAAD,CAZd,MAYsCI,SAAS,CAACJ,iBAAD,CAbjD;AAcA,MAAME,UAAU,GAAG5mB,MAAM,CAACqB,IAAP,CAAYwlB,YAAZ,CAAnB;AAEA,MAAMG,WAAW,GACf,0BAAA9kB,OAAO,CAACke,WAAR,gFACI9c,MADJ,CACW;AAAA,QAAGJ,IAAH,SAAGA,IAAH;AAAA,WAAcA,IAAI,KAAK,MAAvB;AAAA,GADX,EAEGikB,MAFH,CAEU,UAACC,GAAD,EAAM5Y,UAAN,EAAqB;AAC3B,QAAM7O,EAAE,GAAGuE,gBAAgB,EAA3B;AACA,WAAOkjB,GAAG,CAACC,KAAJ,CAAU,CAAC1nB,EAAD,CAAV,EAAgB;AACrBA,MAAAA,EADqB;AAErByO,MAAAA,GAAG,EAAEI,UAAU,CAACtB,SAFK;AAGrB0D,MAAAA,KAAK,EAAE,UAHc;AAIrB0W,MAAAA,IAAI,EAAE;AACJnpB,QAAAA,IAAI,EAAEqQ,UAAU,CAACpB,KADb;AAEJlK,QAAAA,IAAI,EAAEsL,UAAU,CAACE,SAFb;AAGJxP,QAAAA,IAAI,EAAEsP,UAAU,CAACG;AAHb;AAJe,KAAhB,CAAP;AAUD,GAdH,EAcKmY,SAAS,CAACL,gBAAD,CAdd,MAcqCK,SAAS,CAACL,gBAAD,CAfhD;AAgBA,MAAMM,SAAS,GAAG/mB,MAAM,CAACqB,IAAP,CAAY2lB,WAAZ,CAAlB;AAEA,MAAMC,eAAe,GAAGF,SAAS,CAACllB,MAAV,GAAmB+kB,UAAU,CAAC/kB,MAAtD;AAEA,MAAMue,WAAW,GACf,0BAAAle,OAAO,CAACke,WAAR,gFAAqB9c,MAArB,CACE;AAAA,QAAGJ,IAAH,SAAGA,IAAH;AAAA,WAAcA,IAAI,KAAK,MAAT,IAAmBA,IAAI,KAAK,OAA1C;AAAA,GADF,MAEK,EAHP;AAKA,MAAMJ,eAAe,GAAGZ,OAAO,CAACY,eAAR,IAA2B,EAAnD;AAEA,SAAO;AACLxC,IAAAA,IAAI,EAAE4B,OAAO,CAAC5B,IAAR,IAAgB,EADjB;AAELsmB,IAAAA,UAFK;AAGLC,IAAAA,YAHK;AAILE,IAAAA,SAJK;AAKLC,IAAAA,WALK;AAMLC,IAAAA,eANK;AAOL7G,IAAAA,WAPK;AAQLtd,IAAAA,eARK;AASLokB,IAAAA,iBAAiB,EAAE;AATd,GAAP;AAWD;AACD;;;;;;;;AAMA,SAASK,mBAAT,CAA6B3W,KAA7B,EAAoC3F,MAApC,EAA4C;AAC1C,UAAQA,MAAM,CAAC/H,IAAf;AACE,SAAK,sBAAL;AACE,iDAAY0N,KAAZ;AAAmBsW,QAAAA,iBAAiB,EAAEjc,MAAM,CAAC7H;AAA7C;;AACF,SAAK,SAAL;AACE,iDAAYwN,KAAZ;AAAmBtQ,QAAAA,IAAI,EAAE2K,MAAM,CAACuc,UAAP,CAAkB5W,KAAK,CAACtQ,IAAxB;AAAzB;;AACF,SAAK,OAAL;AACE,iDACKsQ,KADL;AAEEtQ,QAAAA,IAAI,EAAE,EAFR;AAGEwC,QAAAA,eAAe,EAAE,EAHnB;AAIE8jB,QAAAA,UAAU,EAAE,EAJd;AAKEC,QAAAA,YAAY,EAAEC,SAAS,CAACJ,iBAAD,CALzB;AAMEK,QAAAA,SAAS,EAAE,EANb;AAOEC,QAAAA,WAAW,EAAEF,SAAS,CAACL,gBAAD,CAPxB;AAQEQ,QAAAA,eAAe,EAAE;AARnB;;AAUF,SAAK,gBAAL;AAAuB;AACrB,YAAMQ,kBAAkB,GAAG7W,KAAK,CAACiW,YAAN,CAAmB5b,MAAM,CAACtL,EAA1B,CAA3B;AACA,YAAMinB,UAAU,GAAGa,kBAAkB,GACjC7W,KAAK,CAACgW,UAD2B,GAEjChW,KAAK,CAACgW,UAAN,CAAiBc,MAAjB,CAAwBzc,MAAM,CAACtL,EAA/B,CAFJ;;AAFqB,YAKbuD,IALa,GAKgB+H,MALhB,CAKb/H,IALa;AAAA,YAKJykB,eALI,4BAKgB1c,MALhB;;AAMrB,mDACK2F,KADL;AAEEgW,UAAAA,UAFF;AAGEC,UAAAA,YAAY,EAAEjW,KAAK,CAACiW,YAAN,CAAmBQ,KAAnB,CAAyB,CAACpc,MAAM,CAACtL,EAAR,CAAzB,sCACTiR,KAAK,CAACiW,YAAN,CAAmB5b,MAAM,CAACtL,EAA1B,CADS,GAETgoB,eAFS,EAHhB;AAOEV,UAAAA,eAAe,EAAEQ,kBAAkB,GAC/B7W,KAAK,CAACqW,eADyB,GAE/BrW,KAAK,CAACqW,eAAN,GAAwB;AAT9B;AAWD;;AACD,SAAK,eAAL;AAAsB;AACpB,YAAMW,iBAAiB,GAAGhX,KAAK,CAACoW,WAAN,CAAkB/b,MAAM,CAACtL,EAAzB,CAA1B;AACA,YAAMonB,SAAS,GAAGa,iBAAiB,GAC/BhX,KAAK,CAACmW,SADyB,GAE/BnW,KAAK,CAACmW,SAAN,CAAgBW,MAAhB,CAAuBzc,MAAM,CAACtL,EAA9B,CAFJ;;AAFoB,YAKZuD,KALY,GAKiB+H,MALjB,CAKZ/H,IALY;AAAA,YAKHykB,gBALG,4BAKiB1c,MALjB;;AAMpB,mDACK2F,KADL;AAEEmW,UAAAA,SAFF;AAGEC,UAAAA,WAAW,EAAEpW,KAAK,CAACoW,WAAN,CAAkBK,KAAlB,CAAwB,CAACpc,MAAM,CAACtL,EAAR,CAAxB,sCACRiR,KAAK,CAACoW,WAAN,CAAkB/b,MAAM,CAACtL,EAAzB,CADQ,GAERgoB,gBAFQ,EAHf;AAOEV,UAAAA,eAAe,EAAEW,iBAAiB,GAC9BhX,KAAK,CAACqW,eADwB,GAE9BrW,KAAK,CAACqW,eAAN,GAAwB;AAT9B;AAWD;;AACD,SAAK,mBAAL;AACE,UAAI,CAACrW,KAAK,CAACiW,YAAN,CAAmB5b,MAAM,CAACtL,EAA1B,CAAL,EAAoC,OAAOiR,KAAP,CADtC;;AAEE,iDACKA,KADL;AAEEqW,QAAAA,eAAe,EAAErW,KAAK,CAACqW,eAAN,GAAwB,CAF3C;AAGEL,QAAAA,UAAU,EAAEhW,KAAK,CAACgW,UAAN,CAAiBtjB,MAAjB,CAAwB,UAACukB,GAAD;AAAA,iBAASA,GAAG,KAAK5c,MAAM,CAACtL,EAAxB;AAAA,SAAxB,CAHd;AAIEknB,QAAAA,YAAY,EAAEjW,KAAK,CAACiW,YAAN,CAAmBiB,OAAnB,CAA2B7c,MAAM,CAACtL,EAAlC;AAJhB;;AAMF,SAAK,kBAAL;AACE,UAAI,CAACiR,KAAK,CAACoW,WAAN,CAAkB/b,MAAM,CAACtL,EAAzB,CAAL,EAAmC,OAAOiR,KAAP,CADrC;;AAEE,iDACKA,KADL;AAEEqW,QAAAA,eAAe,EAAErW,KAAK,CAACqW,eAAN,GAAwB,CAF3C;AAGEF,QAAAA,SAAS,EAAEnW,KAAK,CAACmW,SAAN,CAAgBzjB,MAAhB,CAAuB,UAACukB,GAAD;AAAA,iBAASA,GAAG,KAAK5c,MAAM,CAACtL,EAAxB;AAAA,SAAvB,CAHb;AAIEqnB,QAAAA,WAAW,EAAEpW,KAAK,CAACoW,WAAN,CAAkBc,OAAlB,CAA0B7c,MAAM,CAACtL,EAAjC;AAJf;;AAMF,SAAK,uBAAL;AAA8B;AAC5B,iDAAYiR,KAAZ;AAAmBqW,QAAAA,eAAe,EAAErW,KAAK,CAACqW,eAAN,GAAwB;AAA5D;;AACF,SAAK,kBAAL;AACE,iDACKrW,KADL;AAEE9N,QAAAA,eAAe,EAAE8N,KAAK,CAAC9N,eAAN,CAAsB4kB,MAAtB,CAA6Bzc,MAAM,CAACvJ,IAApC;AAFnB;;AAIF;AACE,aAAOkP,KAAP;AA5EJ;AA8ED;AACD;;;;;;AAIe,SAASmX,oBAAT,CAA8B/pB,KAA9B,EAAqC;AAAA,MAEhDgqB,oBAFgD,GAY9ChqB,KAZ8C,CAEhDgqB,oBAFgD;AAAA,MAGhDC,mBAHgD,GAY9CjqB,KAZ8C,CAGhDiqB,mBAHgD;AAAA,MAIhD1Q,KAJgD,GAY9CvZ,KAZ8C,CAIhDuZ,KAJgD;AAAA,MAKhDrV,OALgD,GAY9ClE,KAZ8C,CAKhDkE,OALgD;AAAA,MAMhDgmB,iBANgD,GAY9ClqB,KAZ8C,CAMhDkqB,iBANgD;AAAA,MAOhDC,qBAPgD,GAY9CnqB,KAZ8C,CAOhDmqB,qBAPgD;AAAA,MAQhDC,MARgD,GAY9CpqB,KAZ8C,CAQhDoqB,MARgD;AAAA,MAShDC,OATgD,GAY9CrqB,KAZ8C,CAShDqqB,OATgD;AAAA,MAUhDC,YAVgD,GAY9CtqB,KAZ8C,CAUhDsqB,YAVgD;AAAA,MAWhDC,kBAXgD,GAY9CvqB,KAZ8C,CAWhDuqB,kBAXgD;;AAAA,oBAcxBC,gBAAU,CAACjB,mBAAD,EAAsBrlB,OAAtB,EAA+BykB,SAA/B,CAdc;AAAA;AAAA,MAc3C/V,KAd2C;AAAA,MAcpC6X,QAdoC;;AAelD,MAAMtR,WAAW,GAAGpL,YAAM;AACxB;AAAgDrH,EAAAA,SADxB,CAA1B;AAGA,MAAMgkB,cAAc,GAAG3c,YAAM;AAAC;AAAsC,MAAvC,CAA7B;AACA,MAAM4c,cAAc,GAAG1a,gBAAU,CAAC5P,cAAD,CAAjC;AAnBkD,MAqBhDiC,IArBgD,GA6B9CsQ,KA7B8C,CAqBhDtQ,IArBgD;AAAA,MAsBhDsmB,UAtBgD,GA6B9ChW,KA7B8C,CAsBhDgW,UAtBgD;AAAA,MAuBhDC,YAvBgD,GA6B9CjW,KA7B8C,CAuBhDiW,YAvBgD;AAAA,MAwBhDE,SAxBgD,GA6B9CnW,KA7B8C,CAwBhDmW,SAxBgD;AAAA,MAyBhDC,WAzBgD,GA6B9CpW,KA7B8C,CAyBhDoW,WAzBgD;AAAA,MA0BhD5G,WA1BgD,GA6B9CxP,KA7B8C,CA0BhDwP,WA1BgD;AAAA,MA2BhD6G,eA3BgD,GA6B9CrW,KA7B8C,CA2BhDqW,eA3BgD;AAAA,MA4BhDnkB,eA5BgD,GA6B9C8N,KA7B8C,CA4BhD9N,eA5BgD;AAAA,MA8B1C6c,OA9B0C,GA8BJgJ,cA9BI,CA8B1ChJ,OA9B0C;AAAA,MA8BjCiJ,WA9BiC,GA8BJD,cA9BI,CA8BjCC,WA9BiC;AAAA,MA8BpBC,WA9BoB,GA8BJF,cA9BI,CA8BpBE,WA9BoB;;AAkClDjc,EAAAA,eAAS,CAAC,YAAM;AACd,QAAI2K,KAAK,IAAIJ,WAAW,CAAC5K,OAAzB,EAAkC;AAChC4K,MAAAA,WAAW,CAAC5K,OAAZ,CAAoBgL,KAApB;AACD;AACF,GAJQ,EAIN,CAACA,KAAD,CAJM,CAAT,CAlCkD;;AAyClD,MAAMuR,iBAAiB,GAAG/c,YAAM;AAAC;AAA8B,MAA/B,CAAhC;AACA,MAAMgd,UAAU,GAAGzc,iBAAW,CAC5B,UAAC0c,YAAD,EAAkB;AAChB,QAAI,CAAC7R,WAAW,CAAC5K,OAAjB,EAA0B;AACxBkc,MAAAA,QAAQ,CAAC;AACPvlB,QAAAA,IAAI,EAAE,SADC;AAEPskB,QAAAA,UAAU,EAAE,oBAAC7oB,CAAD;AAAA,iBAAOA,CAAC,GAAGqqB,YAAX;AAAA;AAFL,OAAD,CAAR;AAIA;AACD;;AAED,QAAMC,eAAe,GAAG9R,WAAW,CAAC5K,OAApC;AATgB,QAUR6K,cAVQ,GAUyB6R,eAVzB,CAUR7R,cAVQ;AAAA,QAUQC,YAVR,GAUyB4R,eAVzB,CAUQ5R,YAVR;AAWhByR,IAAAA,iBAAiB,CAACvc,OAAlB,GAA4B6K,cAAc,GAAG4R,YAAY,CAACnnB,MAA1D;AACA4mB,IAAAA,QAAQ,CAAC;AACPvlB,MAAAA,IAAI,EAAE,SADC;AAEPskB,MAAAA,UAAU,EAAE,oBAAC0B,QAAD;AAAA,eACVA,QAAQ,CAACnnB,KAAT,CAAe,CAAf,EAAkBqV,cAAlB,IACA4R,YADA,GAEAE,QAAQ,CAACnnB,KAAT,CAAesV,YAAf,CAHU;AAAA;AAFL,KAAD,CAAR;AAOD,GApB2B,EAqB5B,CAACF,WAAD,EAAc2R,iBAAd,CArB4B,CAA9B;AAwBAlc,EAAAA,eAAS,CAAC,YAAM;AACd,QAAMqc,eAAe,GAAG9R,WAAW,CAAC5K,OAApC;;AACA,QAAI0c,eAAe,IAAIH,iBAAiB,CAACvc,OAAlB,KAA8B,IAArD,EAA2D;AACzD0c,MAAAA,eAAe,CAAC7R,cAAhB,GAAiC0R,iBAAiB,CAACvc,OAAnD;AACA0c,MAAAA,eAAe,CAAC5R,YAAhB,GAA+ByR,iBAAiB,CAACvc,OAAjD;AACAuc,MAAAA,iBAAiB,CAACvc,OAAlB,GAA4B,IAA5B;AACD;AACF,GAPQ,EAON,CAACjM,IAAD,EAAOwoB,iBAAP,CAPM,CAAT;AASA,MAAMK,YAAY,GAAG7c,iBAAW,CAC9B,UAACmL,KAAD,EAAW;AACTA,IAAAA,KAAK,CAAClD,cAAN;;AACA,QAAI,CAACkD,KAAD,IAAU,CAACA,KAAK,CAAChK,MAArB,EAA6B;AAC3B;AACD;;AAED,QAAM1K,OAAO,GAAG0U,KAAK,CAAChK,MAAN,CAAarK,KAA7B;AACAqlB,IAAAA,QAAQ,CAAC;AACPvlB,MAAAA,IAAI,EAAE,SADC;AAEPskB,MAAAA,UAAU,EAAE;AAAA,eAAMzkB,OAAN;AAAA;AAFL,KAAD,CAAR;;AAIA,QAAIwlB,kBAAkB,IAAIxlB,OAAtB,IAAiC4c,OAArC,EAA8C;AAC5CyJ,MAAAA,kCAAuB,CAACzJ,OAAO,CAAC0J,SAAR,EAAD,EAAsB,oBAAtB,CAAvB;AACD;AACF,GAf6B,EAgB9B,CAAC1J,OAAD,EAAU4I,kBAAV,CAhB8B,CAAhC,CA3EkD;;AAgGlD,MAAMe,gBAAgB,GAAGhd,iBAAW,CAClC,UAACnB,CAAD,EAAO;AACL,QACEud,cAAc,CAACnc,OAAf,IACA,CAACmc,cAAc,CAACnc,OAAf,CAAuB0P,QAAvB,CAAgC9Q,CAAC,CAACsC,MAAlC,CAFH,EAGE;AACAgb,MAAAA,QAAQ,CAAC;AACPvlB,QAAAA,IAAI,EAAE,sBADC;AAEPE,QAAAA,KAAK,EAAE;AAFA,OAAD,CAAR;AAIA6P,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,OAA7B,EAAsCkW,gBAAtC,EAAwD,KAAxD;AACD;AACF,GAZiC,EAalC,CAACZ,cAAD,CAbkC,CAApC;AAgBA,MAAMa,eAAe,GAAGjd,iBAAW,CAAC,YAAM;AACxCmc,IAAAA,QAAQ,CAAC;AACPvlB,MAAAA,IAAI,EAAE,sBADC;AAEPE,MAAAA,KAAK,EAAE;AAFA,KAAD,CAAR;AAIA6P,IAAAA,QAAQ,CAACC,gBAAT,CAA0B,OAA1B,EAAmCoW,gBAAnC,EAAqD,KAArD;AACD,GANkC,EAMhC,CAACA,gBAAD,CANgC,CAAnC;AAQA,MAAME,aAAa,GAAGld,iBAAW,CAAC,UAACvH,KAAD;AAAA,WAAWgkB,UAAU,CAAChkB,KAAK,CAACif,MAAP,CAArB;AAAA,GAAD,EAAsC,CACrE+E,UADqE,CAAtC,CAAjC,CAxHkD;;AA8HlD,MAAMU,WAAW,GAAGnd,iBAAW,CAC7B;AAAA,WAAMqT,OAAO,IAAIA,OAAO,CAAC+J,SAAR,GAAoBtE,QAArC;AAAA,GAD6B,EAE7B,CAACzF,OAAD,CAF6B,CAA/B;AAKA,MAAMgK,QAAQ,GAAGrd,iBAAW,CAAC,YAAM;AACjC,QAAI,CAACqT,OAAL,EAAc,OAAO,EAAP;AACd,WAAO,6BACF3f,MAAM,CAAC2T,MAAP,CAAcgM,OAAO,CAAC/O,KAAR,CAAc2P,OAA5B,EAAqC/d,GAArC,CAAyC;AAAA,UAAGd,IAAH,SAAGA,IAAH;AAAA,aAAcA,IAAd;AAAA,KAAzC,CADE,sBAEF1B,MAAM,CAAC2T,MAAP,CAAcgM,OAAO,CAAC/O,KAAR,CAAcgP,QAA5B,CAFE,GAGLtc,MAHK,CAIL,UAACsmB,KAAD,EAAQza,KAAR,EAAe0a,IAAf;AAAA,aACEA,IAAI,CAACnV,SAAL,CAAe,UAAChT,IAAD;AAAA,eAAU,CAAAA,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAE/B,EAAN,OAAaiqB,KAAb,aAAaA,KAAb,uBAAaA,KAAK,CAAEjqB,EAApB,CAAV;AAAA,OAAf,MAAqDwP,KADvD;AAAA,KAJK;AAAA,KAAP;AAOD,GAT2B,EASzB,CAACwQ,OAAD,CATyB,CAA5B;AAWA,MAAM0F,YAAY,GAAG/Y,iBAAW;AAC9B;AACA,YAAC9K,IAAD,EAAU;AACRinB,IAAAA,QAAQ,CAAC;AAAEvlB,MAAAA,IAAI,EAAE,kBAAR;AAA4BxB,MAAAA,IAAI,EAAEF;AAAlC,KAAD,CAAR;AACD,GAJ6B,EAK9B,EAL8B,CAAhC,CA9IkD;;AAwJlD,MAAMsoB,yBAAyB,GAAGxd,iBAAW,CAAC,YAAM;AAClD,QAAMyd,gBAAgB,GAAGnD,UAAU,CAChCpkB,GADsB,CAClB,UAAC7C,EAAD;AAAA,aAAQknB,YAAY,CAAClnB,EAAD,CAApB;AAAA,KADkB,EAEtB2D,MAFsB,CAEf,UAAC0mB,MAAD;AAAA,aAAYA,MAAM,CAACpZ,KAAP,KAAiB,QAA7B;AAAA,KAFe,EAGtBtN,MAHsB,CAGf,iBAEN6L,KAFM,EAGN0a,IAHM;AAAA,UACJlqB,EADI,SACJA,EADI;AAAA,UACAyO,GADA,SACAA,GADA;AAAA;AAIHyb,QAAAA,IAAI,CAACI,KAAL,CAAW,UAACD,MAAD;AAAA,iBAAYA,MAAM,CAACrqB,EAAP,KAAcA,EAAd,IAAoBqqB,MAAM,CAAC5b,GAAP,KAAeA,GAA/C;AAAA,SAAX;AAJG;AAAA,KAHe,EAQtB5L,GARsB,CAQlB,UAACwnB,MAAD;AAAA,aAAa;AAChB9mB,QAAAA,IAAI,EAAE,OADU;AAEhBiK,QAAAA,SAAS,EAAE6c,MAAM,CAAC5b,GAFF;AAGhB3J,QAAAA,QAAQ,EAAEulB,MAAM,CAAC1C,IAAP,CAAYnpB;AAHN,OAAb;AAAA,KARkB,CAAzB;AAcA,QAAM+rB,eAAe,GAAGnD,SAAS,CAC9BvkB,GADqB,CACjB,UAAC7C,EAAD;AAAA,aAAQqnB,WAAW,CAACrnB,EAAD,CAAnB;AAAA,KADiB,EAErB2D,MAFqB,CAEd,UAAC0mB,MAAD;AAAA,aAAYA,MAAM,CAACpZ,KAAP,KAAiB,QAA7B;AAAA,KAFc,EAGrBpO,GAHqB,CAGjB,UAACwnB,MAAD;AAAA,aAAa;AAChB9mB,QAAAA,IAAI,EAAEqjB,yBAAyB,CAACyD,MAAM,CAAC1C,IAAP,CAAYpkB,IAAb,CADf;AAEhBgK,QAAAA,SAAS,EAAE8c,MAAM,CAAC5b,GAFF;AAGhBhB,QAAAA,KAAK,EAAE4c,MAAM,CAAC1C,IAAP,CAAYnpB,IAHH;AAIhBuQ,QAAAA,SAAS,EAAEsb,MAAM,CAAC1C,IAAP,CAAYpkB,IAJP;AAKhByL,QAAAA,SAAS,EAAEqb,MAAM,CAAC1C,IAAP,CAAYpoB;AALP,OAAb;AAAA,KAHiB,CAAxB;AAWA,wCACKkhB,WADL,sBAEK2J,gBAFL,sBAGKG,eAHL;AAKD,GA/B4C,EA+B1C,CAACtD,UAAD,EAAaC,YAAb,EAA2BE,SAA3B,EAAsCC,WAAtC,EAAmD5G,WAAnD,CA/B0C,CAA7C;AAiCA;;;;AAGA,MAAMrI,YAAY,GAAG,SAAfA,YAAe,CAACN,KAAD,EAAW;AAC9BA,IAAAA,KAAK,CAAClD,cAAN;AACA,QAAM4V,cAAc,GAAG7pB,IAAI,CAAC8a,IAAL,EAAvB;AACA,QAAMgP,cAAc,GAClBD,cAAc,KAAK,EAAnB,IACAA,cAAc,KAAK,GADnB,IAEAA,cAAc,KAAK,QAFnB,IAGAA,cAAc,KAAK,IAHnB,IAIAA,cAAc,KAAK,IAJnB,IAKAA,cAAc,KAAK,MALnB,IAMAA,cAAc,KAAK,IANnB,IAOAA,cAAc,KAAK,MARrB;;AASA,QAAIC,cAAc,IAAInD,eAAe,KAAK,CAA1C,EAA6C;AAC3C;AACD,KAd6B;;;AAgB9B,QAAMoD,wBAAwB,GAC5BrqB,MAAM,CAAC2T,MAAP,CAAckT,YAAd,EAA4ByD,IAA5B,CACE,UAACN,MAAD;AAAA,aAAYA,MAAM,CAACpZ,KAAP,KAAiB,WAA7B;AAAA,KADF,KAGA5Q,MAAM,CAAC2T,MAAP,CAAcqT,WAAd,EAA2BsD,IAA3B,CAAgC,UAACN,MAAD;AAAA,aAAYA,MAAM,CAACpZ,KAAP,KAAiB,WAA7B;AAAA,KAAhC,CAJF;;AAKA,QAAIyZ,wBAAJ,EAA8B;AAC5B;AACA;AACD;;AAED,QAAME,cAAc,GAAGT,yBAAyB,EAAhD,CA1B8B;AA6B9B;AACA;;AACA,QAAMU,oBAAoB,GAAGrQ,KAAK,CAACsQ,IAAN,CAC3B,IAAIC,GAAJ,CACE5nB,eAAe,CACZQ,MADH,CAEI;AAAA,UAAGnF,IAAH,SAAGA,IAAH;AAAA,UAASwB,EAAT,SAASA,EAAT;AAAA,aACEW,IAAI,CAACsT,QAAL,YAAkBjU,EAAlB,MAA2BW,IAAI,CAACsT,QAAL,YAAkBzV,IAAlB,EAD7B;AAAA,KAFJ,EAKGqE,GALH,CAKO;AAAA,UAAG7C,EAAH,SAAGA,EAAH;AAAA,aAAYA,EAAZ;AAAA,KALP,CADF,CAD2B,CAA7B;AAWA,QAAMgrB,cAAc,GAAG;AACrBrqB,MAAAA,IADqB;AAErB8f,MAAAA,WAAW,EAAEmK,cAFQ;AAGrBznB,MAAAA,eAAe,EAAE0nB;AAHI,KAAvB;;AAMA,QAAI,CAAC,CAACtoB,OAAF,IAAa0mB,WAAjB,EAA8B;AAC5B;AACA,UAAIV,iBAAJ,EAAuBA,iBAAiB;AAExC,UAAM0C,oBAAoB,GAAGhC,WAAW,qCACnC+B,cADmC;AAEtChrB,QAAAA,EAAE,EAAEuC,OAAO,CAACvC;AAF0B,SAAX,CAG1BiB,IAH0B,CAGrBsnB,iBAHqB,CAA7B;AAKAkB,MAAAA,kCAAuB,CAACwB,oBAAD,EAAuB,gBAAvB,CAAvB;AACD,KAVD,MAUO,IACLzC,qBAAqB,IACrB,OAAOA,qBAAP,KAAiC,UADjC,IAEAxI,OAHK,EAIL;AACAwI,MAAAA,qBAAqB,qCAEdwC,cAFc;AAGjBvC,QAAAA;AAHiB,UAKnBzI,OAAO,CAACyB,GALW,CAArB;AAOAqH,MAAAA,QAAQ,CAAC;AAAEvlB,QAAAA,IAAI,EAAE;AAAR,OAAD,CAAR;AACD,KAbM,MAaA,IAAI2lB,WAAJ,EAAiB;AACtB,UAAMgC,kBAAkB,GAAGhC,WAAW,qCACjC8B,cADiC;AAEpCvC,QAAAA;AAFoC,SAAtC;AAIAgB,MAAAA,kCAAuB,CAACyB,kBAAD,EAAqB,cAArB,CAAvB;AACApC,MAAAA,QAAQ,CAAC;AAAEvlB,QAAAA,IAAI,EAAE;AAAR,OAAD,CAAR;AACD;;AACD,QAAIyc,OAAO,IAAI4I,kBAAf,EACEa,kCAAuB,CAACzJ,OAAO,CAACmL,UAAR,EAAD,EAAuB,aAAvB,CAAvB;AACH,GAjFD,CA5LkD;AAiRlD;;;AAEA,MAAMC,UAAU,GAAGze,iBAAW,CAAC,UAAC3M,EAAD,EAAQ;AACrC8oB,IAAAA,QAAQ,CAAC;AAAEvlB,MAAAA,IAAI,EAAE,eAAR;AAAyBvD,MAAAA,EAAzB;AAA6BiR,MAAAA,KAAK,EAAE;AAApC,KAAD,CAAR;AACD,GAF6B,EAE3B,EAF2B,CAA9B;AAIAhE,EAAAA,eAAS,CAAC,YAAM;AACd,6DAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACM+S,OADN;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAEOqK,cAAAA,MAFP,GAEgBhqB,MAAM,CAAC2T,MAAP,CAAcqT,WAAd,EAA2B3L,IAA3B,CACb,UAAC2P,UAAD;AAAA,uBAAgBA,UAAU,CAACpa,KAAX,KAAqB,WAArB,IAAoCoa,UAAU,CAAC1D,IAA/D;AAAA,eADa,CAFhB;;AAAA,kBAKM0C,MALN;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAOSrqB,cAAAA,EAPT,GAOsBqqB,MAPtB,CAOSrqB,EAPT,EAOa2nB,IAPb,GAOsB0C,MAPtB,CAOa1C,IAPb;AAQC;;AARD;;AAAA,mBAWOW,mBAXP;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAYsBA,mBAAmB,CAACX,IAAD,EAAO3H,OAAP,CAZzC;;AAAA;AAYKwF,cAAAA,QAZL;AAAA;AAAA;;AAAA;AAAA;AAAA,qBAcsBxF,OAAO,CAACsL,QAAR,CAAiB3D,IAAjB,CAdtB;;AAAA;AAcKnC,cAAAA,QAdL;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAiBGhe,cAAAA,OAAO,CAACC,IAAR;AACI8jB,cAAAA,cAlBP,GAkBwB,KAlBxB;AAoBGzC,cAAAA,QAAQ,CAAC;AAAEvlB,gBAAAA,IAAI,EAAE;AAAR,eAAD,CAAR;;AACA,kBAAI,CAAC8jB,WAAW,CAACrnB,EAAD,CAAhB,EAAsB;AACpBurB,gBAAAA,cAAc,GAAG,IAAjB;AACD,eAFD,MAEO;AACLzC,gBAAAA,QAAQ,CAAC;AAAEvlB,kBAAAA,IAAI,EAAE,eAAR;AAAyBvD,kBAAAA,EAAzB;AAA6BiR,kBAAAA,KAAK,EAAE;AAApC,iBAAD,CAAR;AACD;;AACD,kBAAI,CAACsa,cAAD,IAAmB5C,YAAvB,EAAqC;AACnC;AACAA,gBAAAA,YAAY,cAAI,aAAJ,EAAmBhB,IAAnB,CAAZ;AACD;;AA7BJ;;AAAA;AAgCCmB,cAAAA,QAAQ,CAAC;AACPvlB,gBAAAA,IAAI,EAAE,eADC;AAEPvD,gBAAAA,EAFO;AAGPiR,gBAAAA,KAAK,EAAE,UAHA;AAIPxC,gBAAAA,GAAG,EAAE+W,QAAQ,CAACmC;AAJP,eAAD,CAAR;;AAhCD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD;AAuCD,GAxCQ,EAwCN,CAACN,WAAD,EAAcrH,OAAd,EAAuBsI,mBAAvB,EAA4CK,YAA5C,CAxCM,CAAT;AA0CA,MAAM6C,UAAU,GAAG7e,iBAAW,CAAC,UAAC3M,EAAD,EAAQ;AACrC;AACA8oB,IAAAA,QAAQ,CAAC;AAAEvlB,MAAAA,IAAI,EAAE,kBAAR;AAA4BvD,MAAAA;AAA5B,KAAD,CAAR;AACD,GAH6B,EAG3B,EAH2B,CAA9B,CAjUkD;;AAwUlD,MAAMyrB,WAAW,GAAG9e,iBAAW;AAAA,yEAC7B,kBAAO3M,EAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACQ0rB,cAAAA,GADR,GACcxE,YAAY,CAAClnB,EAAD,CAD1B;;AAAA,oBAEM,CAAC0rB,GAAD,IAAQ,CAAC1L,OAFf;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAGU2H,cAAAA,IAHV,GAGmB+D,GAHnB,CAGU/D,IAHV;;AAIE,kBAAI+D,GAAG,CAACza,KAAJ,KAAc,WAAlB,EAA+B;AAC7B6X,gBAAAA,QAAQ,CAAC;AAAEvlB,kBAAAA,IAAI,EAAE,gBAAR;AAA0BvD,kBAAAA,EAA1B;AAA8BiR,kBAAAA,KAAK,EAAE;AAArC,iBAAD,CAAR;AACD;AACD;;;AAPF;;AAAA,mBAUQoX,oBAVR;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAWuBA,oBAAoB,CAACV,IAAD,EAAO3H,OAAP,CAX3C;;AAAA;AAWMwF,cAAAA,QAXN;AAAA;AAAA;;AAAA;AAAA;AAAA,qBAauBxF,OAAO,CAAC2L,SAAR,CAAkBhE,IAAlB,CAbvB;;AAAA;AAaMnC,cAAAA,QAbN;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAgBIhe,cAAAA,OAAO,CAACC,IAAR;AACI8jB,cAAAA,cAjBR,GAiByB,KAjBzB;AAkBIzC,cAAAA,QAAQ,CAAC;AAAEvlB,gBAAAA,IAAI,EAAE;AAAR,eAAD,CAAR;;AACA,kBAAI,CAAC2jB,YAAY,CAAClnB,EAAD,CAAjB,EAAuB;AACrBurB,gBAAAA,cAAc,GAAG,IAAjB;AACD,eAFD,MAEO;AACLzC,gBAAAA,QAAQ,CAAC;AAAEvlB,kBAAAA,IAAI,EAAE,gBAAR;AAA0BvD,kBAAAA,EAA1B;AAA8BiR,kBAAAA,KAAK,EAAE;AAArC,iBAAD,CAAR;AACD;;AACD,kBAAI,CAACsa,cAAD,IAAmB5C,YAAvB,EAAqC;AACnC;AACAA,gBAAAA,YAAY,eAAI,cAAJ,EAAoB;AAC9B3oB,kBAAAA,EAD8B;AAE9B2nB,kBAAAA;AAF8B,iBAApB,CAAZ;AAID;;AA9BL;;AAAA;AAAA,kBAiCOT,YAAY,CAAClnB,EAAD,CAjCnB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAiCiC;AAC/B8oB,cAAAA,QAAQ,CAAC;AACPvlB,gBAAAA,IAAI,EAAE,gBADC;AAEPvD,gBAAAA,EAFO;AAGPiR,gBAAAA,KAAK,EAAE,UAHA;AAIPxC,gBAAAA,GAAG,EAAE+W,QAAQ,CAACmC;AAJP,eAAD,CAAR;;AAlCF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAD6B;;AAAA;AAAA;AAAA;AAAA,OA0C7B,CAACT,YAAD,EAAelH,OAAf,EAAwBqI,oBAAxB,EAA8CM,YAA9C,CA1C6B,CAA/B;AA6CA1b,EAAAA,eAAS,CAAC,YAAM;AACd,QAAI2e,UAAJ,EAAgB;AACd,UAAMvB,MAAM,GAAGhqB,MAAM,CAAC2T,MAAP,CAAckT,YAAd,EAA4BxL,IAA5B,CACb,UAACmQ,WAAD;AAAA,eACEA,WAAW,CAAC5a,KAAZ,KAAsB,WAAtB,IACA,CAAC,CAAC4a,WAAW,CAAClE,IADd,IAEA,CAACkE,WAAW,CAACC,UAHf;AAAA,OADa,CAAf;;AAMA,UAAIzB,MAAJ,EAAY;AAAA,YACFrqB,EADE,GACWqqB,MADX,CACFrqB,EADE;AAAA,YACE2nB,IADF,GACW0C,MADX,CACE1C,IADF;AAGV;;AACA,YAAMoE,MAAM,GAAG,IAAIH,UAAJ,EAAf;;AACAG,QAAAA,MAAM,CAACC,MAAP,GAAgB,UAAClU,KAAD,EAAW;AAAA;;AACzB,cAAI,yBAAOA,KAAK,CAAChK,MAAb,kDAAO,cAAc+X,MAArB,MAAgC,QAApC,EAA8C;AAC9CiD,UAAAA,QAAQ,CAAC;AACPvlB,YAAAA,IAAI,EAAE,gBADC;AAEPvD,YAAAA,EAFO;AAGP8rB,YAAAA,UAAU,EAAEhU,KAAK,CAAChK,MAAN,CAAa+X;AAHlB,WAAD,CAAR;AAKD,SAPD;;AAQAkG,QAAAA,MAAM,CAACE,aAAP,CAAqBtE,IAArB;AACA8D,QAAAA,WAAW,CAACzrB,EAAD,CAAX;AACA,eAAO,YAAM;AACX+rB,UAAAA,MAAM,CAACC,MAAP,GAAgB,IAAhB;AACD,SAFD;AAGD;AACF;;AACD,WAAO,YAAM,EAAb;AACD,GA7BQ,EA6BN,CAAC9E,YAAD,EAAeuE,WAAf,CA7BM,CAAT;AA+BA,MAAMS,WAAW,GAAGvf,iBAAW,CAAC,UAAC3M,EAAD,EAAQ;AACtC8oB,IAAAA,QAAQ,CAAC;AAAEvlB,MAAAA,IAAI,EAAE,mBAAR;AAA6BvD,MAAAA;AAA7B,KAAD,CAAR,CADsC;AAGvC,GAH8B,EAG5B,EAH4B,CAA/B;AAKA,MAAMmsB,cAAc,GAAGxf,iBAAW;AAChC;;;AAGA,YAACyf,KAAD,EAAW;AACT5R,IAAAA,KAAK,CAACsQ,IAAN,CAAWsB,KAAX,EAAkBxqB,OAAlB,CAA0B,UAAC+lB,IAAD,EAAU;AAClC,UAAM3nB,EAAE,GAAGuE,gBAAgB,EAA3B;;AACA,UAAIojB,IAAI,CAACpkB,IAAL,CAAUa,UAAV,CAAqB,QAArB,CAAJ,EAAoC;AAClC0kB,QAAAA,QAAQ,CAAC;AAAEvlB,UAAAA,IAAI,EAAE,gBAAR;AAA0BvD,UAAAA,EAA1B;AAA8B2nB,UAAAA,IAA9B;AAAoC1W,UAAAA,KAAK,EAAE;AAA3C,SAAD,CAAR;AACD,OAFD,MAEO,IAAI0W,IAAI,YAAY5V,IAAhB,IAAwB,CAAC2W,OAA7B,EAAsC;AAC3CI,QAAAA,QAAQ,CAAC;AAAEvlB,UAAAA,IAAI,EAAE,eAAR;AAAyBvD,UAAAA,EAAzB;AAA6B2nB,UAAAA,IAA7B;AAAmC1W,UAAAA,KAAK,EAAE;AAA1C,SAAD,CAAR;AACD;AACF,KAPD;AAQD,GAb+B,EAchC,CAACyX,OAAD,CAdgC,CAAlC;AAiBA,MAAMjC,OAAO,GAAG9Z,iBAAW,CACzB,UAACnB,CAAD,EAAO;AACL;AAAA,4EAAC,kBAAOsM,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACC;AACQuU,gBAAAA,KAFT,GAEmBvU,KAAK,CAACwU,aAFzB,CAESD,KAFT;;AAAA,oBAGME,yCAA0B,CAACF,KAAD,CAHhC;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAOCvU,gBAAAA,KAAK,CAAClD,cAAN,GAPD;AASC;AACA;;AAEA;AACM4X,gBAAAA,aAbP,GAauB,mBAAIH,KAAJ,EAAW3Q,IAAX,CACpB;AAAA,sBAAG+Q,IAAH,UAAGA,IAAH;AAAA,sBAASlpB,IAAT,UAASA,IAAT;AAAA,yBAAoBkpB,IAAI,KAAK,QAAT,IAAqBlpB,IAAI,KAAK,YAAlD;AAAA,iBADoB,CAbvB;;AAgBC,oBAAIipB,aAAJ,EAAmB;AACjBE,kBAAAA,gBAAgB,GAAG,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;AAC1CJ,oBAAAA,aAAa,CAACK,WAAd,CAA0B,UAACC,CAAD,EAAO;AAC/BF,sBAAAA,OAAO,CAACE,CAAD,CAAP;AACD,qBAFD;AAGD,mBAJkB,CAAnB;AAKD;;AAtBF;AAAA,uBAwByBC,uCAAwB,CAACV,KAAD,CAxBjD;;AAAA;AAwBOW,gBAAAA,SAxBP;;AAAA,qBAyBKA,SAAS,CAAC9qB,MAzBf;AAAA;AAAA;AAAA;;AA0BGiqB,gBAAAA,cAAc,CAACa,SAAD,CAAd;AA1BH;;AAAA;AAAA,qBA8BKN,gBA9BL;AAAA;AAAA;AAAA;;AAAA;AAAA,uBA+BmBA,gBA/BnB;;AAAA;AA+BSI,gBAAAA,CA/BT;AAgCG1D,gBAAAA,UAAU,CAAC0D,CAAD,CAAV;;AAhCH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAD;;AAAA;AAAA;AAAA;AAAA,SAkCGthB,CAlCH;AAmCD,GArCwB,EAsCzB,CAAC2gB,cAAD,EAAiB/C,UAAjB,CAtCyB,CAA3B;AAyCA,6CACKnY,KADL;AAEE;AACAuG,IAAAA,WAHF;AAIEuR,IAAAA,cAJF;AAKE;AACAoD,IAAAA,cANF;AAOED,IAAAA,WAPF;AAQET,IAAAA,WARF;AASED,IAAAA,UATF;AAUEJ,IAAAA,UAVF;AAWEvB,IAAAA,aAXF;AAYEG,IAAAA,QAZF;AAaEF,IAAAA,WAbF;AAcE1R,IAAAA,YAdF;AAeEoR,IAAAA,YAfF;AAgBE/C,IAAAA,OAhBF;AAiBEf,IAAAA,YAjBF;AAkBEkE,IAAAA;AAlBF;AAoBD;;AChrBD;AAOA;;AACA,IAAMqD,WAAW,GAAG,SAAdA,WAAc,OAKd;AAAA,MAJJ1F,iBAII,QAJJA,iBAII;AAAA,MAHJwB,cAGI,QAHJA,cAGI;AAAA,MAFJc,aAEI,QAFJA,aAEI;AAAA,MADJqD,KACI,QADJA,KACI;;AAAA,oBACU5e,gBAAU,CAACvP,kBAAD,CADpB;AAAA,MACIC,CADJ,eACIA,CADJ;;AAEJ,MAAIuoB,iBAAJ,EAAuB;AACrB,QAAMxZ,SAAS,GAAGmf,KAAK,GACnB,2CADmB,GAEnB,8BAFJ;AAIA,wBACEtvB;AAAK,MAAA,SAAS,EAAEmQ,SAAhB;AAA2B,MAAA,GAAG,EAAEgb;AAAhC,oBACEnrB,6BAACuvB,gBAAD;AACE,MAAA,MAAM,MADR;AAEE,MAAA,KAAK,EAAC,UAFR;AAGE,MAAA,KAAK,EAAEnuB,CAAC,CAAC,iBAAD,CAHV;AAIE,MAAA,QAAQ,EAAE6qB,aAJZ;AAKE,MAAA,KAAK,EAAC,SALR;AAME,MAAA,WAAW,EAAE,KANf;AAOE,MAAA,SAAS,EAAE,IAPb;AAQE,MAAA,kBAAkB,EAAE1kB;AARtB,MADF,CADF;AAcD;;AACD,SAAO,IAAP;AACD,CA5BD;;ACRA;AAMA;;AACA,IAAMioB,cAAc,GAAG,SAAjBA,cAAiB,OAWjB;AAAA,MAVJnG,UAUI,QAVJA,UAUI;AAAA,MATJC,YASI,QATJA,YASI;AAAA,MARJgF,WAQI,QARJA,WAQI;AAAA,MAPJT,WAOI,QAPJA,WAOI;AAAA,MANJU,cAMI,QANJA,cAMI;AAAA,MALJ7E,eAKI,QALJA,eAKI;AAAA,MAJJF,SAII,QAJJA,SAII;AAAA,MAHJC,WAGI,QAHJA,WAGI;AAAA,MAFJmE,UAEI,QAFJA,UAEI;AAAA,MADJJ,UACI,QADJA,UACI;AACJ,MAAMpC,cAAc,GAAG1a,gBAAU,CAAC5P,cAAD,CAAjC;AACA,sBACEd,4DACGqpB,UAAU,CAAC/kB,MAAX,GAAoB,CAApB,iBACCtE,6BAACyvB,6BAAD;AACE,IAAA,YAAY,EAAEpG,UAAU,CAACpkB,GAAX,CAAe,UAAC7C,EAAD;AAAA,aAAQknB,YAAY,CAAClnB,EAAD,CAApB;AAAA,KAAf,CADhB;AAEE,IAAA,YAAY,EAAEksB,WAFhB;AAGE,IAAA,WAAW,EAAET,WAHf;AAIE,IAAA,WAAW,EAAEU,cAJf;AAKE,IAAA,QAAQ,EAAEnD,cAAc,CAACsE,eAL3B;AAME,IAAA,QAAQ,EACNtE,cAAc,CAACuE,gBAAf,KAAoCxoB,SAApC,IACAuiB,eAAe,IAAI0B,cAAc,CAACuE;AARtC,IAFJ,EAcGnG,SAAS,CAACllB,MAAV,GAAmB,CAAnB,iBACCtE,6BAAC4vB,4BAAD;AACE,IAAA,OAAO,EAAEpG,SAAS,CAACvkB,GAAV,CAAc,UAAC7C,EAAD;AAAA,aAAQqnB,WAAW,CAACrnB,EAAD,CAAnB;AAAA,KAAd,CADX;AAEE,IAAA,YAAY,EAAEwrB,UAFhB;AAGE,IAAA,WAAW,EAAEJ,UAHf;AAIE,IAAA,WAAW,EAAEe;AAJf,IAfJ,CADF;AAyBD,CAtCD;;ACPA;AAIA;;AACA,IAAMsB,UAAU,GAAG,SAAbA,UAAa,OAAqB;AAAA,MAAlBvE,WAAkB,QAAlBA,WAAkB;;AAAA,oBACxB5a,gBAAU,CAACvP,kBAAD,CADc;AAAA,MAC9BC,CAD8B,eAC9BA,CAD8B;;AAEtC,sBACEpB;AAAQ,IAAA,SAAS,EAAC,uBAAlB;AAA0C,IAAA,OAAO,EAAEsrB;AAAnD,kBACEtrB;AACE,IAAA,KAAK,EAAC,IADR;AAEE,IAAA,MAAM,EAAC,IAFT;AAGE,IAAA,OAAO,EAAC,WAHV;AAIE,IAAA,KAAK,EAAC;AAJR,kBAMEA,4CAAQoB,CAAC,CAAC,MAAD,CAAT,CANF,eAOEpB;AACE,IAAA,CAAC,EAAC,wDADJ;AAEE,IAAA,QAAQ,EAAC,SAFX;AAGE,IAAA,IAAI,EAAC;AAHP,IAPF,CADF,CADF;AAiBD,CAnBD;;AAqBA,uCAAeA,cAAK,CAACmO,IAAN,CAAW0hB,UAAX,CAAf;;AC1BA;AAkBA;;IACMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACrvB,KAAD,EAAW;AACnC,MAAMsvB,YAAY,GAAGC,oBAAe,CAACvvB,KAAD,CAApC;;AADmC,oBAErBiQ,gBAAU,CAACvP,kBAAD,CAFW;AAAA,MAE3BC,CAF2B,eAE3BA,CAF2B;;AAGnC,MAAMgqB,cAAc,GAAG1a,gBAAU,CAAC5P,cAAD,CAAjC;AAEA;;;;;AAIA,MAAMmvB,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACC,WAAD,EAAiB;AAC7C,QAAMC,gBAAgB,GAAG1tB,MAAM,CAAC2T,MAAP,CAAc8Z,WAAd,EACtBnqB,MADsB,CACf;AAAA;;AAAA,UAAG5B,IAAH,QAAGA,IAAH;AAAA,aAAc,0BAAAinB,cAAc,CAAClrB,MAAf,gFAAuBiE,IAAvB,CAA4B/B,EAA5B,OAAmC+B,IAAnC,aAAmCA,IAAnC,uBAAmCA,IAAI,CAAE/B,EAAzC,CAAd;AAAA,KADe,EAEtB6C,GAFsB,CAElB;AAAA,UAAGd,IAAH,SAAGA,IAAH;AAAA,aAAc,CAAAA,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAEvD,IAAN,MAAcuD,IAAd,aAAcA,IAAd,uBAAcA,IAAI,CAAE/B,EAApB,CAAd;AAAA,KAFkB,CAAzB;AAGA,QAAI+tB,gBAAgB,CAAC7rB,MAAjB,KAA4B,CAAhC,EAAmC,OAAO,EAAP;;AACnC,QAAI6rB,gBAAgB,CAAC7rB,MAAjB,KAA4B,CAAhC,EAAmC;AACjC,aAAOlD,CAAC,CAAC,yBAAD,EAA4B;AAAE+C,QAAAA,IAAI,EAAEgsB,gBAAgB,CAAC,CAAD;AAAxB,OAA5B,CAAR;AACD;;AACD,QAAIA,gBAAgB,CAAC7rB,MAAjB,KAA4B,CAAhC,EAAmC;AACjC;AACA;AACA,aAAOlD,CAAC,CAAC,oDAAD,EAAuD;AAC7D0G,QAAAA,SAAS,EAAEqoB,gBAAgB,CAAC,CAAD,CADkC;AAE7DpoB,QAAAA,UAAU,EAAEooB,gBAAgB,CAAC,CAAD;AAFiC,OAAvD,CAAR;AAID,KAf4C;AAiB7C;;;AACA,WAAO/uB,CAAC,CAAC,4DAAD,EAA+D;AACrE8G,MAAAA,mBAAmB,EAAEioB,gBAAgB,CAAC3rB,KAAjB,CAAuB,CAAvB,EAA0B,CAAC,CAA3B,EAA8BD,IAA9B,CAAmC,IAAnC,CADgD;AAErEyD,MAAAA,QAAQ,EAAEmoB,gBAAgB,CAACA,gBAAgB,CAAC7rB,MAAjB,GAA0B,CAA3B;AAF2C,KAA/D,CAAR;AAID,GAtBD;;AATmC,MAiC3BurB,UAjC2B,GAiCZpvB,KAjCY,CAiC3BovB,UAjC2B;AAkCnC,sBACE7vB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAACowB,4BAAD;AACE,IAAA,MAAM,EAAEhF,cAAc,CAACiF,aADzB;AAEE,IAAA,QAAQ,EAAEjF,cAAc,CAACsE,eAF3B;AAGE,IAAA,QAAQ,EACNtE,cAAc,CAACuE,gBAAf,KAAoCxoB,SAApC,IACA4oB,YAAY,CAACrG,eAAb,IAAgC0B,cAAc,CAACuE,gBALnD;AAOE,IAAA,WAAW,EAAEI,YAAY,CAACxB;AAP5B,kBASEvuB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC,WAAD,EAAiB+vB,YAAjB,CADF,eAEE/vB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC,cAAD,EAAoB+vB,YAApB,CADF,eAEE/vB,6BAACinB,kBAAD;AACE,IAAA,QAAQ,EAAE8I,YAAY,CAAC7D,WAAb,EADZ;AAEE,IAAA,QAAQ,EAAE6D,YAAY,CAACnW,WAFzB;AAGE,IAAA,YAAY,EAAEmW,YAAY,CAACvV,YAH7B;AAIE,IAAA,QAAQ,EAAEuV,YAAY,CAACnE,YAJzB;AAKE,IAAA,YAAY,EAAEmE,YAAY,CAACjI,YAL7B;AAME,IAAA,KAAK,EAAEiI,YAAY,CAAChtB,IANtB;AAOE,IAAA,IAAI,EAAE,CAPR;AAQE,IAAA,OAAO,EAAEtC,KAAK,CAAC0f,OARjB;AASE,IAAA,WAAW,EAAE/e,CAAC,CAAC,mBAAD,CAThB;AAUE,IAAA,OAAO,EAAE2uB,YAAY,CAAClH,OAVxB;AAWE,IAAA,QAAQ,EAAEpoB,KAAK,CAAC6vB,oBAXlB;AAYE,IAAA,IAAI,EAAE7vB,KAAK,CAAC2f,IAZd;AAaE,IAAA,QAAQ,EAAE3f,KAAK,CAACqoB,QAblB;AAcE,IAAA,uBAAuB,EAAEroB,KAAK,CAACogB;AAdjC,IAFF,eAkBE7gB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC+oB,SAAD,QAAU3nB,CAAC,CAAC,mBAAD,CAAX,CADF,eAEEpB;AACE,IAAA,SAAS,EAAC,6BADZ;AAEE,IAAA,OAAO,EAAE+vB,YAAY,CAAC/D,eAFxB;AAGE,IAAA,GAAG,EAAE+D,YAAY,CAAC5E;AAHpB,kBAKEnrB;AAAK,IAAA,KAAK,EAAC,IAAX;AAAgB,IAAA,MAAM,EAAC,IAAvB;AAA4B,IAAA,KAAK,EAAC;AAAlC,kBACEA,4CAAQoB,CAAC,CAAC,mBAAD,CAAT,CADF,eAEEpB;AACE,IAAA,CAAC,EAAC,g8BADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IAFF,CALF,CAFF,CAlBF,eAkCEA;AACE,IAAA,SAAS,EAAC,8BADZ;AAEE,mBAAY;AAFd,kBAIEA,6BAAC+oB,SAAD,QAAU3nB,CAAC,CAAC,cAAD,CAAX,CAJF,eAKEpB,6BAACuwB,+BAAD;AACE,IAAA,QAAQ,EAAEnF,cAAc,CAACsE,eAD3B;AAEE,IAAA,QAAQ,EACNtE,cAAc,CAACuE,gBAAf,KAAoCxoB,SAApC,IACA4oB,YAAY,CAACrG,eAAb,IACE0B,cAAc,CAACuE,gBALrB;AAOE,IAAA,OAAO,EAAEvE,cAAc,CAACiF,aAP1B;AAQE,IAAA,WAAW,EAAEN,YAAY,CAACxB;AAR5B,kBAUEvuB;AAAM,IAAA,SAAS,EAAC;AAAhB,kBACEA;AACE,IAAA,KAAK,EAAC,IADR;AAEE,IAAA,MAAM,EAAC,IAFT;AAGE,IAAA,KAAK,EAAC;AAHR,kBAKEA,4CAAQoB,CAAC,CAAC,cAAD,CAAT,CALF,eAMEpB;AACE,IAAA,CAAC,EAAC,+OADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IANF,CADF,CAVF,CALF,CAlCF,CAFF,EAmEG6vB,UAAU,iBAAI7vB,6BAAC,UAAD;AAAY,IAAA,WAAW,EAAE+vB,YAAY,CAACvV;AAAtC,IAnEjB,CATF,eA8EExa,uDACEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AACE,IAAA,SAAS,0CACP,CAACorB,cAAc,CAACoF,aAAhB,GACI,uCADJ,GAEI,EAHG;AADX,KAOGpvB,CAAC,CAAC,2BAAD,EAA8B;AAC9BqvB,IAAAA,YAAY,EAAErF,cAAc,CAACoF;AADC,GAA9B,CAPJ,CADF,eAYExwB;AAAM,IAAA,SAAS,EAAC;AAAhB,KACGiwB,qBAAqB,CAAC7E,cAAc,CAACsF,MAAf,IAAyB,EAA1B,CADxB,CAZF,CADF,CA9EF,CADF,CADF;AAqGD;;AAEDZ,iBAAiB,CAACjiB,SAAlB,GAA8B;AAC5B;AACAmM,EAAAA,KAAK,EAAElM,SAAS,CAACqE,IAAV,CAAenE,UAFM;;AAG5B;AACAoS,EAAAA,IAAI,EAAEtS,SAAS,CAACqE,IAAV,CAAenE,UAJO;;AAK5B;AACAmS,EAAAA,OAAO,EAAErS,SAAS,CAACoE,MAAV,CAAiBlE,UANE;;AAO5B;AACA8a,EAAAA,QAAQ,EAAEhb,SAAS,CAACqE,IARQ;;AAS5B;AACA6Y,EAAAA,kBAAkB,EAAEld,SAAS,CAACqE,IAVF;;AAW5B;;;AAGA0O,EAAAA,uBAAuB,EAAE/S,SAAS,CAACmF,MAdP;;AAe5B;;;AAGAqd,EAAAA,oBAAoB,EAAExiB,SAAS,CAACmF,MAlBJ;;AAmB5B;;;;AAIA2X,EAAAA,qBAAqB,EAAE9c,SAAS,CAACI,IAvBL;;AAwB5B;AACAuc,EAAAA,oBAAoB,EAAE3c,SAAS,CAACI,IAzBJ;;AA0B5B;AACAwc,EAAAA,mBAAmB,EAAE5c,SAAS,CAACI,IA3BH;;AA4B5B;;;;;AAKA;AACA2hB,EAAAA,UAAU,EAAE/hB,SAAS,CAACkH;AAlCM,CAA9B;AAqCA8a,iBAAiB,CAACjL,YAAlB,GAAiC;AAC/B7K,EAAAA,KAAK,EAAE,KADwB;AAE/B8O,EAAAA,QAAQ,EAAE,KAFqB;AAG/BkC,EAAAA,kBAAkB,EAAE,IAHW;AAI/B5K,EAAAA,IAAI,EAAE,IAJyB;AAK/BD,EAAAA,OAAO,EAAE,EALsB;AAM/BwQ,EAAAA,KAAK,EAAEb,iBANwB;AAO/BD,EAAAA,UAAU,EAAEe,mBAPmB;AAQ/B/P,EAAAA,uBAAuB,EAAE;AARM,CAAjC;;AC7LA,IAAMgQ,YAAY,GAAG,SAAfA,YAAe,CAACpwB,KAAD,EAAW;AAAA,MACtBkwB,KADsB,GACZlwB,KADY,CACtBkwB,KADsB;AAE9B,sBAAO3wB,6BAAC,KAAD,EAAWS,KAAX,CAAP;AACD,CAHD;;AAKAowB,YAAY,CAAChM,YAAb,GAA4B;AAC1B7K,EAAAA,KAAK,EAAE,KADmB;AAE1B8O,EAAAA,QAAQ,EAAE,KAFgB;AAG1BkC,EAAAA,kBAAkB,EAAE,IAHM;AAI1B5K,EAAAA,IAAI,EAAE,IAJoB;AAK1BD,EAAAA,OAAO,EAAE,EALiB;AAM1BwQ,EAAAA,KAAK,EAAEb,iBANmB;AAO1BD,cAAAA,mBAP0B;AAQ1BhP,EAAAA,uBAAuB,EAAE;AARC,CAA5B;AAWA,kCAAe7gB,cAAK,CAACmO,IAAN,CAAW0iB,YAAX,CAAf;;ACpBA;AAcA;;IACMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACrwB,KAAD,EAAW;AAClC,MAAMsvB,YAAY,GAAGC,oBAAe,CAACvvB,KAAD,CAApC;AACA,MAAM2qB,cAAc,GAAG1a,gBAAU,CAAC5P,cAAD,CAAjC;;AAFkC,oBAGpB4P,gBAAU,CAACvP,kBAAD,CAHU;AAAA,MAG1BC,CAH0B,eAG1BA,CAH0B;;AAAA,MAI1ByuB,UAJ0B,GAIXpvB,KAJW,CAI1BovB,UAJ0B;AAMlC,sBACE7vB;AACE,IAAA,SAAS,iCACP6vB,UAAU,GAAG,0CAAH,GAAgD,IADnD;AADX,kBAKE7vB,6BAACowB,4BAAD;AACE,IAAA,MAAM,EAAEhF,cAAc,CAACiF,aADzB;AAEE,IAAA,QAAQ,EAAEjF,cAAc,CAACsE,eAF3B;AAGE,IAAA,QAAQ,EACNtE,cAAc,CAACuE,gBAAf,KAAoCxoB,SAApC,IACA4oB,YAAY,CAACrG,eAAb,IAAgC0B,cAAc,CAACuE,gBALnD;AAOE,IAAA,WAAW,EAAEI,YAAY,CAACxB;AAP5B,kBASEvuB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC,WAAD,EAAiB+vB,YAAjB,CADF,eAGE/vB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC,cAAD,EAAoB+vB,YAApB,CADF,eAEE/vB,6BAACinB,kBAAD;AACE,IAAA,QAAQ,EAAE8I,YAAY,CAAC7D,WAAb,EADZ;AAEE,IAAA,QAAQ,EAAE6D,YAAY,CAACnW,WAFzB;AAGE,IAAA,YAAY,EAAEmW,YAAY,CAACvV,YAH7B;AAIE,IAAA,YAAY,EAAEuV,YAAY,CAACjI,YAJ7B;AAKE,IAAA,QAAQ,EAAEiI,YAAY,CAACnE,YALzB;AAME,IAAA,KAAK,EAAEmE,YAAY,CAAChtB,IANtB;AAOE,IAAA,IAAI,EAAE,CAPR;AAQE,IAAA,OAAO,EAAEtC,KAAK,CAAC0f,OARjB;AASE,IAAA,WAAW,EAAE/e,CAAC,CAAC,mBAAD,CAThB;AAUE,IAAA,OAAO,EAAE2uB,YAAY,CAAClH,OAVxB;AAWE,IAAA,QAAQ,EAAEpoB,KAAK,CAAC6vB,oBAXlB;AAYE,IAAA,IAAI,EAAE7vB,KAAK,CAAC2f,IAZd;AAaE,IAAA,QAAQ,EAAE3f,KAAK,CAACqoB,QAblB;AAcE,IAAA,uBAAuB,EAAEroB,KAAK,CAACogB;AAdjC,IAFF,eAmBE7gB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC+oB,SAAD,QAAU3nB,CAAC,CAAC,mBAAD,CAAX,CADF,eAEEpB;AACE,IAAA,SAAS,EAAC,kCADZ;AAEE,IAAA,OAAO,EAAE+vB,YAAY,CAAC/D;AAFxB,kBAIEhsB;AAAK,IAAA,KAAK,EAAC,IAAX;AAAgB,IAAA,MAAM,EAAC,IAAvB;AAA4B,IAAA,KAAK,EAAC;AAAlC,kBACEA,4CAAQoB,CAAC,CAAC,mBAAD,CAAT,CADF,eAEEpB;AACE,IAAA,CAAC,EAAC,4mCADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IAFF,CAJF,CAFF,CAnBF,eAkCEA;AACE,IAAA,SAAS,EAAC,8BADZ;AAEE,mBAAY;AAFd,kBAIEA,6BAAC+oB,SAAD,QAAU3nB,CAAC,CAAC,cAAD,CAAX,CAJF,eAKEpB,6BAACuwB,+BAAD;AACE,IAAA,QAAQ,EAAEnF,cAAc,CAACsE,eAD3B;AAEE,IAAA,QAAQ,EACNtE,cAAc,CAACuE,gBAAf,KAAoCxoB,SAApC,IACA4oB,YAAY,CAACrG,eAAb,IACE0B,cAAc,CAACuE,gBALrB;AAOE,IAAA,OAAO,EAAEvE,cAAc,CAACiF,aAP1B;AAQE,IAAA,WAAW,EAAEN,YAAY,CAACxB;AAR5B,kBAUEvuB;AAAM,IAAA,SAAS,EAAC;AAAhB,kBACEA;AACE,IAAA,KAAK,EAAC,IADR;AAEE,IAAA,MAAM,EAAC,IAFT;AAGE,IAAA,KAAK,EAAC;AAHR,kBAKEA,4CAAQoB,CAAC,CAAC,cAAD,CAAT,CALF,eAMEpB;AACE,IAAA,CAAC,EAAC,sQADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IANF,CADF,CAVF,CALF,CAlCF,CAHF,EAoEG6vB,UAAU,iBAAI7vB,6BAAC,UAAD;AAAY,IAAA,WAAW,EAAE+vB,YAAY,CAACvV;AAAtC,IApEjB,CATF,CALF,CADF;AAwFD;;AAEDsW,gBAAgB,CAACjjB,SAAjB,GAA6B;AAC3B;AACAmM,EAAAA,KAAK,EAAElM,SAAS,CAACqE,IAAV,CAAenE,UAFK;;AAG3B;AACAoS,EAAAA,IAAI,EAAEtS,SAAS,CAACqE,IAAV,CAAenE,UAJM;;AAK3B;AACAmS,EAAAA,OAAO,EAAErS,SAAS,CAACoE,MAAV,CAAiBlE,UANC;;AAO3B;AACA8a,EAAAA,QAAQ,EAAEhb,SAAS,CAACqE,IARO;;AAS3B;AACA6Y,EAAAA,kBAAkB,EAAEld,SAAS,CAACqE,IAVH;;AAW3B;;;AAGA0O,EAAAA,uBAAuB,EAAE/S,SAAS,CAACmF,MAdR;;AAe3B;;;AAGAqd,EAAAA,oBAAoB,EAAExiB,SAAS,CAACmF,MAlBL;;AAmB3B;;;;AAIA2X,EAAAA,qBAAqB,EAAE9c,SAAS,CAACI,IAvBN;;AAwB3B;AACAuc,EAAAA,oBAAoB,EAAE3c,SAAS,CAACI,IAzBL;;AA0B3B;AACAwc,EAAAA,mBAAmB,EAAE5c,SAAS,CAACI,IA3BJ;;AA4B3B;;;;;AAKA;AACA2hB,EAAAA,UAAU,EAAE/hB,SAAS,CAACkH;AAlCK,CAA7B;AAqCA8b,gBAAgB,CAACjM,YAAjB,GAAgC;AAC9B7K,EAAAA,KAAK,EAAE,KADuB;AAE9B8O,EAAAA,QAAQ,EAAE,KAFoB;AAG9BkC,EAAAA,kBAAkB,EAAE,IAHU;AAI9B5K,EAAAA,IAAI,EAAE,IAJwB;AAK9BD,EAAAA,OAAO,EAAE,EALqB;AAM9B0P,EAAAA,UAAU,EAAEe,mBANkB;AAO9B/P,EAAAA,uBAAuB,EAAE;AAPK,CAAhC;;ACvIA;;IACMkQ,iBAAiB,GAAG,SAApBA,iBAAoB,CAACtwB,KAAD,EAAW;AACnC,MAAMsvB,YAAY,GAAGC,oBAAe,CAACvvB,KAAD,CAApC;AACA,MAAM2qB,cAAc,GAAG1a,gBAAU,CAAC5P,cAAD,CAAjC;;AAFmC,oBAGrB4P,gBAAU,CAACvP,kBAAD,CAHW;AAAA,MAG3BC,CAH2B,eAG3BA,CAH2B;;AAAA,MAI3ByuB,UAJ2B,GAIZpvB,KAJY,CAI3BovB,UAJ2B;AAMnC,sBACE7vB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAACowB,4BAAD;AACE,IAAA,MAAM,EAAEhF,cAAc,CAACiF,aADzB;AAEE,IAAA,QAAQ,EAAEjF,cAAc,CAACsE,eAF3B;AAGE,IAAA,QAAQ,EACNtE,cAAc,CAACuE,gBAAf,KAAoCxoB,SAApC,IACA4oB,YAAY,CAACrG,eAAb,IAAgC0B,cAAc,CAACuE,gBALnD;AAOE,IAAA,WAAW,EAAEI,YAAY,CAACxB;AAP5B,kBASEvuB;AACE,IAAA,SAAS,0CACP6vB,UAAU,GACN,mDADM,GAEN,IAHG;AADX,kBAOE7vB,6BAAC,WAAD,eAAiB+vB,YAAjB;AAA+B,IAAA,KAAK;AAApC,KAPF,eAQE/vB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC,cAAD,EAAoB+vB,YAApB,CADF,eAGE/vB,6BAACinB,kBAAD;AACE,IAAA,QAAQ,EAAE8I,YAAY,CAAC7D,WAAb,EADZ;AAEE,IAAA,QAAQ,EAAE6D,YAAY,CAACnW,WAFzB;AAGE,IAAA,YAAY,EAAEmW,YAAY,CAACvV,YAH7B;AAIE,IAAA,QAAQ,EAAEuV,YAAY,CAACnE,YAJzB;AAKE,IAAA,KAAK,EAAEmE,YAAY,CAAChtB,IALtB;AAME,IAAA,IAAI,EAAE,CANR;AAOE,IAAA,OAAO,EAAEtC,KAAK,CAAC0f,OAPjB;AAQE,IAAA,YAAY,EAAE4P,YAAY,CAACjI,YAR7B;AASE,IAAA,WAAW,EAAE1mB,CAAC,CAAC,mBAAD,CAThB;AAUE,IAAA,OAAO,EAAE2uB,YAAY,CAAClH,OAVxB;AAWE,IAAA,QAAQ,EAAEpoB,KAAK,CAAC6vB,oBAXlB;AAYE,IAAA,IAAI,EAAE7vB,KAAK,CAAC2f,IAZd;AAaE,IAAA,QAAQ,EAAE3f,KAAK,CAACqoB,QAblB;AAcE,IAAA,uBAAuB,EAAEroB,KAAK,CAACogB;AAdjC,IAHF,eAoBE7gB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC+oB,SAAD,QAAU3nB,CAAC,CAAC,mBAAD,CAAX,CADF,eAEEpB;AACE,IAAA,SAAS,EAAC,2CADZ;AAEE,IAAA,OAAO,EAAE+vB,YAAY,CAAC/D;AAFxB,kBAIEhsB;AAAK,IAAA,KAAK,EAAC,IAAX;AAAgB,IAAA,MAAM,EAAC,IAAvB;AAA4B,IAAA,KAAK,EAAC;AAAlC,kBACEA,4CAAQoB,CAAC,CAAC,mBAAD,CAAT,CADF,eAEEpB;AACE,IAAA,CAAC,EAAC,g8BADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IAFF,CAJF,CAFF,CApBF,eAoCEA;AACE,IAAA,SAAS,EAAC,8BADZ;AAEE,mBAAY;AAFd,kBAIEA,6BAAC+oB,SAAD,QAAU3nB,CAAC,CAAC,cAAD,CAAX,CAJF,eAKEpB,6BAACuwB,+BAAD;AACE,IAAA,QAAQ,EAAEnF,cAAc,CAACsE,eAD3B;AAEE,IAAA,QAAQ,EACNtE,cAAc,CAACuE,gBAAf,KAAoCxoB,SAApC,IACA4oB,YAAY,CAACrG,eAAb,IACE0B,cAAc,CAACuE,gBALrB;AAOE,IAAA,OAAO,EAAEvE,cAAc,CAACiF,aAP1B;AAQE,IAAA,WAAW,EAAEN,YAAY,CAACxB;AAR5B,kBAUEvuB;AAAM,IAAA,SAAS,EAAC;AAAhB,kBACEA;AACE,IAAA,KAAK,EAAC,IADR;AAEE,IAAA,MAAM,EAAC,IAFT;AAGE,IAAA,KAAK,EAAC;AAHR,kBAKEA,4CAAQoB,CAAC,CAAC,cAAD,CAAT,CALF,eAMEpB;AACE,IAAA,CAAC,EAAC,+OADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IANF,CADF,CAVF,CALF,CApCF,CARF,EA2EG6vB,UAAU,iBAAI7vB,6BAAC,UAAD;AAAY,IAAA,WAAW,EAAE+vB,YAAY,CAACvV;AAAtC,IA3EjB,CATF,CADF,CADF;AA2FD;;AAEDuW,iBAAiB,CAACljB,SAAlB,GAA8B;AAC5B;AACAmM,EAAAA,KAAK,EAAElM,SAAS,CAACqE,IAAV,CAAenE,UAFM;;AAG5B;AACAoS,EAAAA,IAAI,EAAEtS,SAAS,CAACqE,IAAV,CAAenE,UAJO;;AAK5B;AACAmS,EAAAA,OAAO,EAAErS,SAAS,CAACoE,MAAV,CAAiBlE,UANE;;AAO5B;AACA8a,EAAAA,QAAQ,EAAEhb,SAAS,CAACqE,IARQ;;AAS5B;AACA6Y,EAAAA,kBAAkB,EAAEld,SAAS,CAACqE,IAVF;;AAW5B;;;AAGA0O,EAAAA,uBAAuB,EAAE/S,SAAS,CAACmF,MAdP;;AAe5B;;;AAGAqd,EAAAA,oBAAoB,EAAExiB,SAAS,CAACmF,MAlBJ;;AAmB5B;;;;AAIA2X,EAAAA,qBAAqB,EAAE9c,SAAS,CAACI,IAvBL;;AAwB5B;AACAuc,EAAAA,oBAAoB,EAAE3c,SAAS,CAACI,IAzBJ;;AA0B5B;AACAwc,EAAAA,mBAAmB,EAAE5c,SAAS,CAACI,IA3BH;;AA4B5B;;;;;AAKA;AACA2hB,EAAAA,UAAU,EAAE/hB,SAAS,CAACkH;AAlCM,CAA9B;AAqCA+b,iBAAiB,CAAClM,YAAlB,GAAiC;AAC/B7K,EAAAA,KAAK,EAAE,KADwB;AAE/B8O,EAAAA,QAAQ,EAAE,KAFqB;AAG/BkC,EAAAA,kBAAkB,EAAE,IAHW;AAI/B5K,EAAAA,IAAI,EAAE,IAJyB;AAK/BD,EAAAA,OAAO,EAAE,EALsB;AAM/B0P,EAAAA,UAAU,EAAEe,mBANmB;AAO/B/P,EAAAA,uBAAuB,EAAE;AAPM,CAAjC;;ACvIA;;IACMmQ,eAAe,GAAG,SAAlBA,eAAkB,CAACvwB,KAAD,EAAW;AACjC,MAAMsvB,YAAY,GAAGC,oBAAe,CAACvvB,KAAD,CAApC;AACA,MAAM2qB,cAAc,GAAG1a,gBAAU,CAAC5P,cAAD,CAAjC;;AAFiC,oBAGnB4P,gBAAU,CAACvP,kBAAD,CAHS;AAAA,MAGzBC,CAHyB,eAGzBA,CAHyB;;AAAA,MAKzBupB,iBALyB,GAKHlqB,KALG,CAKzBkqB,iBALyB;AAOjCtb,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAM4hB,SAAS,GAAG,SAAZA,SAAY,CAAC/W,KAAD,EAAW;AAC3BtQ,MAAAA,OAAO,CAACsnB,GAAR,CAAY,oBAAZ,EAAkChX,KAAK,CAAClE,OAAxC;AACA,UAAIkE,KAAK,CAAClE,OAAN,KAAkBf,SAAS,CAACC,GAA5B,IAAmCyV,iBAAvC,EACEA,iBAAiB;AACpB,KAJD;;AAMAjV,IAAAA,QAAQ,CAACC,gBAAT,CAA0B,SAA1B,EAAqCsb,SAArC;AACA,WAAO;AAAA,aAAMvb,QAAQ,CAACG,mBAAT,CAA6B,SAA7B,EAAwCob,SAAxC,CAAN;AAAA,KAAP;AACD,GAVQ,EAUN,CAACtG,iBAAD,CAVM,CAAT;AAYA,sBACE3qB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAACowB,4BAAD;AACE,IAAA,MAAM,EAAEhF,cAAc,CAACiF,aADzB;AAEE,IAAA,QAAQ,EAAEjF,cAAc,CAACsE,eAF3B;AAGE,IAAA,QAAQ,EACNtE,cAAc,CAACuE,gBAAf,KAAoCxoB,SAApC,IACA4oB,YAAY,CAACrG,eAAb,IAAgC0B,cAAc,CAACuE,gBALnD;AAOE,IAAA,WAAW,EAAEI,YAAY,CAACxB;AAP5B,kBASEvuB;AAAM,IAAA,QAAQ,EAAE+vB,YAAY,CAACvV;AAA7B,kBACExa,6BAAC,cAAD,EAAoB+vB,YAApB,CADF,eAEE/vB,6BAAC,WAAD,eAAiB+vB,YAAjB;AAA+B,IAAA,KAAK;AAApC,KAFF,eAGE/vB,6BAACinB,kBAAD;AACE,IAAA,QAAQ,EAAE8I,YAAY,CAAC7D,WAAb,EADZ;AAEE,IAAA,QAAQ,EAAE6D,YAAY,CAACnW,WAFzB;AAGE,IAAA,YAAY,EAAEmW,YAAY,CAACvV,YAH7B;AAIE,IAAA,QAAQ,EAAEuV,YAAY,CAACnE,YAJzB;AAKE,IAAA,YAAY,EAAEmE,YAAY,CAACjI,YAL7B;AAME,IAAA,WAAW,EAAE1mB,CAAC,CAAC,mBAAD,CANhB;AAOE,IAAA,KAAK,EAAE2uB,YAAY,CAAChtB,IAPtB;AAQE,IAAA,IAAI,EAAE,CARR;AASE,IAAA,OAAO,EAAEtC,KAAK,CAAC0f,OATjB;AAUE,IAAA,OAAO,EAAE4P,YAAY,CAAClH,OAVxB;AAWE,IAAA,IAAI,EAAEpoB,KAAK,CAAC2f,IAXd;AAYE,IAAA,uBAAuB,EAAE3f,KAAK,CAACogB;AAZjC,IAHF,eAiBE7gB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AACE,IAAA,SAAS,EAAC,6BADZ;AAEE,IAAA,OAAO,EAAE+vB,YAAY,CAAC/D;AAFxB,kBAIEhsB;AAAK,IAAA,KAAK,EAAC,IAAX;AAAgB,IAAA,MAAM,EAAC,IAAvB;AAA4B,IAAA,KAAK,EAAC;AAAlC,kBACEA,4CAAQoB,CAAC,CAAC,mBAAD,CAAT,CADF,eAEEpB;AACE,IAAA,CAAC,EAAC,g8BADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IAFF,CAJF,CADF,eAaEA;AACE,IAAA,SAAS,EAAC,8BADZ;AAEE,mBAAY;AAFd,kBAIEA,6BAAC+oB,SAAD,QAAU3nB,CAAC,CAAC,cAAD,CAAX,CAJF,eAKEpB,6BAACuwB,+BAAD;AACE,IAAA,QAAQ,EAAEnF,cAAc,CAACsE,eAD3B;AAEE,IAAA,QAAQ,EACNtE,cAAc,CAACuE,gBAAf,KAAoCxoB,SAApC,IACA4oB,YAAY,CAACrG,eAAb,IACE0B,cAAc,CAACuE,gBALrB;AAOE,IAAA,OAAO,EAAEvE,cAAc,CAACiF,aAP1B;AAQE,IAAA,WAAW,EAAEN,YAAY,CAACxB;AAR5B,kBAUEvuB;AAAM,IAAA,SAAS,EAAC;AAAhB,kBACEA;AACE,IAAA,KAAK,EAAC,IADR;AAEE,IAAA,MAAM,EAAC,IAFT;AAGE,IAAA,KAAK,EAAC;AAHR,kBAKEA,4CAAQoB,CAAC,CAAC,cAAD,CAAT,CALF,eAMEpB;AACE,IAAA,CAAC,EAAC,+OADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IANF,CADF,CAVF,CALF,CAbF,CADF,eA6CEA,uDACEA;AAAQ,IAAA,OAAO,EAAES,KAAK,CAACkqB;AAAvB,KAA2CvpB,CAAC,CAAC,QAAD,CAA5C,CADF,eAEEpB;AAAQ,IAAA,IAAI,EAAC;AAAb,KAAuBoB,CAAC,CAAC,MAAD,CAAxB,CAFF,CA7CF,CAjBF,CATF,CADF,CADF;AAkFD;;AAED4vB,eAAe,CAACnjB,SAAhB,GAA4B;AAC1B;AACAmM,EAAAA,KAAK,EAAElM,SAAS,CAACqE,IAAV,CAAenE,UAFI;;AAG1B;AACAoS,EAAAA,IAAI,EAAEtS,SAAS,CAACqE,IAAV,CAAenE,UAJK;;AAK1B;AACAmS,EAAAA,OAAO,EAAErS,SAAS,CAACoE,MAAV,CAAiBlE,UANA;;AAO1B;AACA8a,EAAAA,QAAQ,EAAEhb,SAAS,CAACqE,IARM;;AAS1B;AACA6Y,EAAAA,kBAAkB,EAAEld,SAAS,CAACqE,IAVJ;;AAW1B;;;AAGA0O,EAAAA,uBAAuB,EAAE/S,SAAS,CAACmF,MAdT;;AAe1B;;;;AAIA2X,EAAAA,qBAAqB,EAAE9c,SAAS,CAACI,IAnBP;;AAoB1B;AACAuc,EAAAA,oBAAoB,EAAE3c,SAAS,CAACI,IArBN;;AAsB1B;AACAwc,EAAAA,mBAAmB,EAAE5c,SAAS,CAACI,IAvBL;;AAwB1B;;;;;AAKA;AACA2hB,EAAAA,UAAU,EAAE/hB,SAAS,CAACkH,WA9BI;;AA+B1B;;;AAGA2V,EAAAA,iBAAiB,EAAE7c,SAAS,CAACI;AAlCH,CAA5B;AAqCA8iB,eAAe,CAACnM,YAAhB,GAA+B;AAC7B7K,EAAAA,KAAK,EAAE,KADsB;AAE7B8O,EAAAA,QAAQ,EAAE,KAFmB;AAG7BkC,EAAAA,kBAAkB,EAAE,IAHS;AAI7B5K,EAAAA,IAAI,EAAE,IAJuB;AAK7BD,EAAAA,OAAO,EAAE,EALoB;AAM7B0P,EAAAA,UAAU,EAAEe,mBANiB;AAO7B/P,EAAAA,uBAAuB,EAAE;AAPI,CAA/B;;AC9IA;;AACA,IAAMsQ,uBAAuB,GAAG,SAA1BA,uBAA0B,OAS9BvY,GAT8B,EAU3B;AAAA;;AAAA,MARDwY,gBAQC,QARDA,gBAQC;AAAA,MAPDC,eAOC,QAPDA,eAOC;AAAA,kCANDC,eAMC;AAAA,MANDA,eAMC,qCANiBnvB,oBAMjB;AAAA,0BALDovB,OAKC;AAAA,MALDA,OAKC,6BALS,KAKT;AAAA,MAJDC,cAIC,QAJDA,cAIC;AAAA,+BAHDC,YAGC;AAAA,MAHDA,YAGC,kCAHc,IAGd;;AAAA,kBACmDhjB,cAAQ,CAAC,IAAD,CAD3D;AAAA;AAAA,MACIijB,mBADJ;AAAA,MACyBC,sBADzB;;AAAA,mBAE6CljB,cAAQ;AACtD;AAA0D,MADJ,CAFrD;AAAA;AAAA,MAEImjB,gBAFJ;AAAA,MAEsBC,mBAFtB;;AAKH,MAAMC,YAAY,GAAGtjB,YAAM;AAAC;AAAsC,MAAvC,CAA3B;AACA,MAAMujB,UAAU,GAAGvjB,YAAM;AAAC;AAAsC,MAAvC,CAAzB;AACA,MAAMwjB,SAAS,GAAGxjB,YAAM;AAAC;AAAsC,MAAvC,CAAxB,CAPG;;AAUHyjB,EAAAA,yBAAmB,CAACrZ,GAAD,EAAM;AAAA,WAAMkZ,YAAY,CAAC9iB,OAAnB;AAAA,GAAN,CAAnB;AAEA,MAAMkjB,WAAW,GAAGnjB,iBAAW,CAAC,UAACnB,CAAD,EAAIukB,YAAJ,EAAqB;AACnDH,IAAAA,SAAS,CAAChjB,OAAV,GAAoBpB,CAAC,CAACsC,MAAtB;AACAyhB,IAAAA,sBAAsB,CAACQ,YAAD,CAAtB;AACD,GAH8B,EAG5B,EAH4B,CAA/B;AAKA,MAAMC,WAAW,GAAGrjB,iBAAW,CAAC,YAAM;AACpC4iB,IAAAA,sBAAsB,CAAC,IAAD,CAAtB;AACAE,IAAAA,mBAAmB,CAAC,IAAD,CAAnB;AACD,GAH8B,EAG5B,EAH4B,CAA/B;AAKAxiB,EAAAA,eAAS,CAAC,YAAM;AACd,QAAIqiB,mBAAJ,EAAyB;AAAA;;AACvB,UAAMW,OAAO,0BAAGN,UAAU,CAAC/iB,OAAd,wDAAG,oBAAoBsjB,qBAApB,EAAhB;AACA,UAAMpiB,MAAM,yBAAG8hB,SAAS,CAAChjB,OAAb,uDAAG,mBAAmBsjB,qBAAnB,EAAf;AACA,UAAMvZ,SAAS,4BAAG+Y,YAAY,CAAC9iB,OAAhB,0DAAG,sBAAsBsjB,qBAAtB,EAAlB;AAEA,UAAI,CAACD,OAAD,IAAY,CAACniB,MAAb,IAAuB,CAAC6I,SAA5B,EAAuC;AAEvC,UAAMwZ,eAAe,GACnBF,OAAO,CAACtiB,KAAR,KAAkBgJ,SAAS,CAAChJ,KAA5B,IAAqCsiB,OAAO,CAACG,CAAR,GAAYzZ,SAAS,CAACyZ,CAA3D,GACI,CADJ,GAEItiB,MAAM,CAAC+M,IAAP,GAAc/M,MAAM,CAACH,KAAP,GAAe,CAA7B,GAAiCgJ,SAAS,CAACkE,IAA3C,GAAkDoV,OAAO,CAACtiB,KAAR,GAAgB,CAHxE;AAIA,UAAM0iB,aAAa,GACjBviB,MAAM,CAACsiB,CAAP,GAAWH,OAAO,CAACG,CAAnB,GAAuBtiB,MAAM,CAACH,KAAP,GAAe,CAAtC,GAA0CwiB,eAD5C;AAEAV,MAAAA,mBAAmB,CAAC;AAClBQ,QAAAA,OAAO,EAAEE,eADS;AAElBG,QAAAA,KAAK,EAAED;AAFW,OAAD,CAAnB;AAID;AACF,GAnBQ,EAmBN,CAACf,mBAAD,EAAsBI,YAAtB,CAnBM,CAAT;AAqBA;;;;;AAIA,MAAMa,uBAAuB,GAAG,SAA1BA,uBAA0B,CAAChtB,IAAD;AAAA,WAC9ByrB,gBAD8B,aAC9BA,gBAD8B,uBAC9BA,gBAAgB,CACZnsB,GADJ,CACQ,UAAC2tB,QAAD,EAAc;AAClB,UAAIA,QAAQ,CAACjtB,IAAT,KAAkBA,IAAtB,EAA4B;AAAA;;AAC1B,eAAO,mBAAAitB,QAAQ,CAACzuB,IAAT,kEAAevD,IAAf,yBAAuBgyB,QAAQ,CAACzuB,IAAhC,oDAAuB,gBAAe/B,EAAtC,CAAP;AACD;;AACD,aAAO,IAAP;AACD,KANH,EAOG2D,MAPH,CAOU8sB,OAPV,CAD8B;AAAA,GAAhC;AAUA;;;;;;AAIA,MAAMC,4BAA4B,GAAG,SAA/BA,4BAA+B,CAACntB,IAAD;AAAA;;AAAA,WACnCyrB,gBADmC,aACnCA,gBADmC,gDACnCA,gBAAgB,CAAEtT,IAAlB,CACE,UAAC8U,QAAD;AAAA,aAAcA,QAAQ,CAACjtB,IAAT,KAAkBA,IAAlB,IAA0B,CAAC,CAACitB,QAAQ,CAACzuB,IAAnD;AAAA,KADF,CADmC,0DACnC,sBAEGA,IAHgC;AAAA,GAArC;;AAKA,sBACEnE;AACE,mBAAY,mBADd;AAEE,IAAA,SAAS,wCACPuxB,OAAO,GAAG,sCAAH,GAA4C,EAD5C,CAFX;AAKE,IAAA,GAAG,EAAEO;AALP,KAOG,CAAC,CAACJ,mBAAF,IAAyBD,YAAzB,iBACCzxB;AACE,IAAA,SAAS,EAAC,qCADZ;AAEE,IAAA,GAAG,EAAE+xB,UAFP;AAGE,IAAA,KAAK,EAAE;AACL9U,MAAAA,IAAI,EAAE2U,gBAAF,aAAEA,gBAAF,uBAAEA,gBAAgB,CAAES,OADnB;AAELU,MAAAA,UAAU,EAAEnB,gBAAgB,GAAG,SAAH,GAAe;AAFtC;AAHT,kBAQE5xB;AAAK,IAAA,SAAS,EAAC,OAAf;AAAuB,IAAA,KAAK,EAAE;AAAEid,MAAAA,IAAI,EAAE2U,gBAAF,aAAEA,gBAAF,uBAAEA,gBAAgB,CAAEc;AAA1B;AAA9B,IARF,2BASGC,uBAAuB,CAACjB,mBAAD,CAT1B,0DASG,sBAA8CzsB,GAA9C,CACC,UAACd,IAAD,EAAOD,CAAP,EAAUwD,KAAV;AAAA,wBACE1H;AAAM,MAAA,SAAS,EAAC,sBAAhB;AAAuC,MAAA,GAAG,gBAASkE,CAAT,cAAcC,IAAd;AAA1C,iBACMA,IADN,SACaD,CAAC,GAAGwD,KAAK,CAACpD,MAAN,GAAe,CAAnB,GAAuB,IAAvB,GAA8B,EAD3C,EADF;AAAA,GADD,CATH,CARJ,eA0BEtE;AAAI,IAAA,SAAS,EAAC;AAAd,KACGsxB,eAAe,CAACrsB,GAAhB,CAAoB,UAAC+tB,cAAD,EAAoB;AACvC,QAAMC,UAAU,GAAGH,4BAA4B,CAACE,cAAc,CAAC5wB,EAAhB,CAA/C;AAEA,QAAM8wB,KAAK,GAAG7B,eAAe,IAAIA,eAAe,CAAC2B,cAAc,CAAC5wB,EAAhB,CAAhD;AACA,wBACEpC;AACE,MAAA,GAAG,iBAAUgzB,cAAc,CAAC5wB,EAAzB,CADL;AAEE,MAAA,SAAS,EAAC,uCAFZ;AAGE,mBAAW4wB,cAAc,CAAC5wB,EAH5B;AAIE,MAAA,OAAO,EAAE;AAAA,eACPovB,cAAc,IAAIA,cAAc,CAACwB,cAAc,CAAC5wB,EAAhB,CADzB;AAAA;AAJX,OAQG,CAAC,CAAC8wB,KAAF,IAAWzB,YAAX,iBACCzxB,6BAACA,cAAD,CAAO,QAAP,qBACEA;AACE,MAAA,SAAS,EAAC,aADZ;AAEE,MAAA,YAAY,EAAE,sBAAC4N,CAAD;AAAA,eAAOskB,WAAW,CAACtkB,CAAD,EAAIolB,cAAc,CAAC5wB,EAAnB,CAAlB;AAAA,OAFhB;AAGE,MAAA,YAAY,EAAEgwB;AAHhB,OAKGa,UAAU,gBACTjzB,6BAAC,MAAD;AACE,MAAA,KAAK,EAAEizB,UAAU,CAACtiB,KADpB;AAEE,MAAA,IAAI,EAAE,EAFR;AAGE,MAAA,IAAI,EAAEsiB,UAAU,CAACryB,IAAX,IAAmB;AAH3B,MADS,gBAOTZ;AAAK,MAAA,SAAS,EAAC;AAAf,MAZJ,CADF,CATJ,eA2BEA,6BAACmzB,qBAAD;AAEE;AAFF;AAGE,MAAA,KAAK,EAAEH;AAHT,OAIMvxB,WAJN;AAKE,MAAA,IAAI,EAAEoB;AALR,OA3BF,EAmCGgwB,OAAO,CAACK,KAAD,CAAP,IAAkBzB,YAAlB,iBACCzxB;AAAM,MAAA,SAAS,EAAC;AAAhB,OACGkzB,KAAK,IAAI,EADZ,CApCJ,CADF;AA2CD,GA/CA,CADH,CA1BF,CADF;AA+ED,CA3JD;;AA6JA,IAAME,gBAAgB,gBAAGpzB,cAAK,CAACqzB,UAAN,CAAiBlC,uBAAjB,CAAzB;AAEAiC,gBAAgB,CAACvlB,SAAjB,GAA6B;AAC3B;;;;;;;;;;;;;;;AAeAujB,EAAAA,gBAAgB,EAAEtjB,SAAS,CAACG,KAhBD;;AAiB3B;AACAojB,EAAAA,eAAe,EAAEvjB,SAAS,CAACwlB,QAAV,CAAmBxlB,SAAS,CAACoE,MAAV,CAAiBlE,UAApC,CAlBU;;AAmB3B;AACAsjB,EAAAA,eAAe,EAAExjB,SAAS,CAACG,KApBA;AAqB3BsjB,EAAAA,OAAO,EAAEzjB,SAAS,CAACqE,IArBQ;;AAsB3B;;;;;AAKAqf,EAAAA,cAAc,EAAE1jB,SAAS,CAACI,IAAV,CAAeF,UA3BJ;;AA4B3B;AACAyjB,EAAAA,YAAY,EAAE3jB,SAAS,CAACqE;AA7BG,CAA7B;AAgCA,2CAAenS,cAAK,CAACmO,IAAN,CAAWilB,gBAAX,CAAf;;ACtMA;;AACA,IAAMG,aAAa,GAAG,SAAhBA,aAAgB,OAMhB;AAAA,MALJC,SAKI,QALJA,SAKI;AAAA,MAJJnC,eAII,QAJJA,eAII;AAAA,kCAHJC,eAGI;AAAA,MAHJA,eAGI,qCAHcnvB,oBAGd;AAAA,0BAFJovB,OAEI;AAAA,MAFJA,OAEI,6BAFM,KAEN;AAAA,MADJjQ,OACI,QADJA,OACI;;AACJ,MAAMmS,qBAAqB,GAAG,SAAxBA,qBAAwB;AAAA,WAC5BhxB,MAAM,CAAC2T,MAAP,CAAcib,eAAe,IAAI,EAAjC,EAAqCzH,MAArC,CACE,UAAC8J,KAAD,EAAQR,KAAR;AAAA,aAAkBQ,KAAK,GAAGR,KAA1B;AAAA,KADF,EAEE,CAFF,CAD4B;AAAA,GAA9B;AAMA;;;AACA,MAAMS,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAChuB,IAAD;AAAA,WACvB2rB,eAAe,CAACxT,IAAhB,CAAqB,UAAC8V,MAAD;AAAA,aAAYA,MAAM,CAACxxB,EAAP,KAAcuD,IAA1B;AAAA,KAArB,CADuB;AAAA,GAAzB;;AAGA,MAAMkuB,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;AAC7B,QAAI,CAACL,SAAL,EAAgB,OAAO,EAAP;AAChB,QAAMM,QAAQ,GAAG,IAAI3G,GAAJ,EAAjB;AACAqG,IAAAA,SAAS,CAACxvB,OAAV,CAAkB,iBAAc;AAAA,UAAX2B,IAAW,SAAXA,IAAW;AAC9BmuB,MAAAA,QAAQ,CAAC/b,GAAT,CAAapS,IAAb;AACD,KAFD;AAGA,WAAOiX,KAAK,CAACsQ,IAAN,CAAW4G,QAAX,CAAP;AACD,GAPD;;AASA,sBACE9zB;AACE,mBAAY,eADd;AAEE,IAAA,SAAS,oCACPuxB,OAAO,GAAG,kCAAH,GAAwC,EADxC,CAFX;AAKE,IAAA,OAAO,EAAEjQ;AALX,kBAOEthB,yCACG6zB,gBAAgB,GAAG5uB,GAAnB,CAAuB,UAACktB,YAAD,EAAkB;AACxC,QAAM4B,eAAe,GAAGJ,gBAAgB,CAACxB,YAAD,CAAxC;AACA,WAAO4B,eAAe,gBACpB/zB;AAAI,MAAA,GAAG,EAAE+zB,eAAe,CAAC3xB;AAAzB,oBACEpC,6BAACmzB,qBAAD;AAEE;AACA;AAHF;AAIE,MAAA,KAAK,EAAEY;AAJT,OAKMtyB,WALN;AAME,MAAA,IAAI,EAAE,EANR;AAOE,MAAA,IAAI,EAAEoB;AAPR,OADF,EASK,GATL,SADoB,GAalB,IAbJ;AAcD,GAhBA,CADH,eAkBE7C,sDACEA;AAAM,IAAA,SAAS,EAAC;AAAhB,KACGyzB,qBAAqB,EADxB,CADF,CAlBF,CAPF,CADF;AAkCD,CA5DD;;AA8DAF,aAAa,CAAC1lB,SAAd,GAA0B;AACxB2lB,EAAAA,SAAS,EAAE1lB,SAAS,CAACG,KADG;;AAExB;AACAojB,EAAAA,eAAe,EAAEvjB,SAAS,CAACwlB,QAAV,CAAmBxlB,SAAS,CAACoE,MAAV,CAAiBlE,UAApC,CAHO;;AAIxB;AACAsjB,EAAAA,eAAe,EAAExjB,SAAS,CAACG,KALH;AAMxBsjB,EAAAA,OAAO,EAAEzjB,SAAS,CAACqE,IANK;AAOxBmP,EAAAA,OAAO,EAAExT,SAAS,CAACI;AAPK,CAA1B;AAUA,wCAAelO,cAAK,CAACmO,IAAN,CAAWolB,aAAX,CAAf;;AC1EA;;AACA,IAAMS,mBAAmB,GAAG,SAAtBA,mBAAsB,OAKtB;AAAA,MAJJR,SAII,QAJJA,SAII;AAAA,MAHJnC,eAGI,QAHJA,eAGI;AAAA,kCAFJC,eAEI;AAAA,MAFJA,eAEI,qCAFcnvB,oBAEd;AAAA,MADJqvB,cACI,QADJA,cACI;;AAAA,kBACkD/iB,cAAQ,CAAC,IAAD,CAD1D;AAAA;AAAA,MACGijB,mBADH;AAAA,MACwBC,sBADxB;;AAGJ,MAAI,CAAC6B,SAAD,IAAcA,SAAS,CAAClvB,MAAV,KAAqB,CAAvC,EAA0C;AACxC,WAAO,IAAP;AACD;AAED;;;AACA,MAAMquB,uBAAuB,GAAG,SAA1BA,uBAA0B,CAAChtB,IAAD;AAAA,WAC9B6tB,SAD8B,aAC9BA,SAD8B,uBAC9BA,SAAS,CACLvuB,GADJ,CACQ,UAAC2tB,QAAD,EAAc;AAClB,UAAIA,QAAQ,CAACjtB,IAAT,KAAkBA,IAAtB,EAA4B;AAAA;;AAC1B,eAAO,mBAAAitB,QAAQ,CAACzuB,IAAT,kEAAevD,IAAf,yBAAuBgyB,QAAQ,CAACzuB,IAAhC,oDAAuB,gBAAe/B,EAAtC,CAAP;AACD;;AACD,aAAO,IAAP;AACD,KANH,EAOG2D,MAPH,CAOU8sB,OAPV,CAD8B;AAAA,GAAhC;;AAUA,MAAMY,qBAAqB,GAAG,SAAxBA,qBAAwB;AAAA,WAC5BhxB,MAAM,CAAC2T,MAAP,CAAcib,eAAe,IAAI,EAAjC,EAAqCzH,MAArC,CACE,UAAC8J,KAAD,EAAQR,KAAR;AAAA,aAAkBQ,KAAK,GAAGR,KAA1B;AAAA,KADF,EAEE,CAFF,CAD4B;AAAA,GAA9B;;AAMA,MAAMW,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;AAC7B,QAAI,CAACL,SAAL,EAAgB,OAAO,EAAP;AAChB,QAAMM,QAAQ,GAAG,IAAI3G,GAAJ,EAAjB;AACAqG,IAAAA,SAAS,CAACxvB,OAAV,CAAkB,iBAAc;AAAA,UAAX2B,IAAW,SAAXA,IAAW;AAC9BmuB,MAAAA,QAAQ,CAAC/b,GAAT,CAAapS,IAAb;AACD,KAFD;AAGA,WAAOiX,KAAK,CAACsQ,IAAN,CAAW4G,QAAX,CAAP;AACD,GAPD;AASA;;;AACA,MAAMH,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAChuB,IAAD;AAAA,WACvB2rB,eAAe,CAACxT,IAAhB,CAAqB,UAAC8V,MAAD;AAAA,aAAYA,MAAM,CAACxxB,EAAP,KAAcuD,IAA1B;AAAA,KAArB,CADuB;AAAA,GAAzB;;AAGA,sBACE3F;AACE,mBAAY,sBADd;AAEE,IAAA,SAAS,EAAC,iCAFZ;AAGE,IAAA,YAAY,EAAE;AAAA,aAAM2xB,sBAAsB,CAAC,IAAD,CAA5B;AAAA;AAHhB,KAKGkC,gBAAgB,GAAG5uB,GAAnB,CAAuB,UAACktB,YAAD,EAAejuB,CAAf,EAAqB;AAAA;;AAC3C,QAAM6vB,eAAe,GAAGJ,gBAAgB,CAACxB,YAAD,CAAxC;AACA,WAAO4B,eAAe,gBACpB/zB;AACE,MAAA,SAAS,EAAC,sCADZ;AAEE,MAAA,GAAG,YAAK+zB,eAAL,aAAKA,eAAL,uBAAKA,eAAe,CAAE3xB,EAAtB,cAA4B8B,CAA5B,CAFL;AAGE,MAAA,OAAO,EAAE;AAAA,eAAMstB,cAAc,IAAIA,cAAc,CAACW,YAAD,CAAtC;AAAA;AAHX,oBAKEnyB;AAAM,MAAA,YAAY,EAAE;AAAA,eAAM2xB,sBAAsB,CAACQ,YAAD,CAA5B;AAAA;AAApB,oBACEnyB,6BAACmzB,qBAAD;AAEE;AACA;AAHF;AAIE,MAAA,KAAK,EAAEY;AAJT,OAKMtyB,WALN;AAME,MAAA,IAAI,EAAE,EANR;AAOE,MAAA,IAAI,EAAEoB;AAPR,OADF,SALF,EAkBG6uB,mBAAmB,2BAAKiC,gBAAgB,CAACxB,YAAD,CAArB,sDAAK,kBAAgC/vB,EAArC,CAAnB,iBACCpC;AAAK,MAAA,SAAS,EAAC;AAAf,oBACEA;AAAK,MAAA,SAAS,EAAC;AAAf,MADF,2BAEG2yB,uBAAuB,CAACjB,mBAAD,CAF1B,0DAEG,sBAA8CntB,IAA9C,CAAmD,IAAnD,CAFH,CAnBJ,CADoB,GA0BlB,IA1BJ;AA2BD,GA7BA,CALH,EAmCG,CAAAivB,SAAS,SAAT,IAAAA,SAAS,WAAT,YAAAA,SAAS,CAAElvB,MAAX,MAAsB,CAAtB,iBACCtE;AAAI,IAAA,SAAS,EAAC;AAAd,KACGyzB,qBAAqB,EADxB,CApCJ,CADF;AA2CD,CArFD;;AAuFAO,mBAAmB,CAACnmB,SAApB,GAAgC;AAC9B2lB,EAAAA,SAAS,EAAE1lB,SAAS,CAACG,KADS;;AAE9B;AACAojB,EAAAA,eAAe,EAAEvjB,SAAS,CAACwlB,QAAV,CAAmBxlB,SAAS,CAACoE,MAAV,CAAiBlE,UAApC,CAHa;;AAI9B;AACAsjB,EAAAA,eAAe,EAAExjB,SAAS,CAACG,KALG;;AAM9B;;;;;AAKAujB,EAAAA,cAAc,EAAE1jB,SAAS,CAACI;AAXI,CAAhC;AAcA,0CAAelO,cAAK,CAACmO,IAAN,CAAW6lB,mBAAX,CAAf;;ICzGaC,mBAAmB;AAEhC;;;;IAGaC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACvvB,OAAD,EAAa;AAAA,oBACO+L,gBAAU,CAAC5P,cAAD,CADjB;AAAA,MACnCshB,OADmC,eACnCA,OADmC;AAAA,MAC1B+R,aAD0B,eAC1BA,aAD0B;AAAA,MACXC,aADW,eACXA,aADW;;AAE3C;AAAA,wEAAO,iBAAOxzB,IAAP,EAAaiF,KAAb,EAAoBqU,KAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AACLA,cAAAA,KAAK,CAAClD,cAAN;;AADK,oBAED,CAACrS,OAAD,IAAY,CAACwvB,aAAb,IAA8B,CAACC,aAA/B,IAAgD,CAAChS,OAFhD;AAAA;AAAA;AAAA;;AAGHxY,cAAAA,OAAO,CAACC,IAAR,CAAaoqB,mBAAb;AAHG;;AAAA;AAMCI,cAAAA,SAND,GAMa1vB,OAAO,CAACvC,EANrB;AAOCkyB,cAAAA,QAPD,GAOY;AACf,iBAAC1zB,IAAD,GAAQiF;AADO,eAPZ;AAAA;AAAA,qBAWcuc,OAAO,CAACmS,UAAR,CAAmBF,SAAnB,EAA8BC,QAA9B,CAXd;;AAAA;AAWC3xB,cAAAA,IAXD;;AAaL,kBAAIA,IAAI,IAAIA,IAAI,CAACgC,OAAjB,EAA0B;AACxBwvB,gBAAAA,aAAa,CAACxxB,IAAI,CAACgC,OAAN,CAAb;AACD,eAFD,MAEO;AACLyvB,gBAAAA,aAAa,CAACzvB,OAAD,CAAb;AACD;;AAjBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA;AAmBD;;AC1BD;;;;IAGa6vB,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAC7vB,OAAD,EAAa;AAAA,oBACT+L,gBAAU,CAAC5P,cAAD,CADD;AAAA,MACnCqzB,aADmC,eACnCA,aADmC;AAAA,MACpBj0B,MADoB,eACpBA,MADoB;;AAE3C;AAAA,wEAAO,iBAAOga,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACLA,cAAAA,KAAK,CAAClD,cAAN;;AADK,oBAED,CAACrS,OAAD,IAAY,CAACzE,MAAb,IAAuB,CAACi0B,aAFvB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,qBAKcj0B,MAAM,CAACu0B,aAAP,CAAqB9vB,OAAO,CAACvC,EAA7B,CALd;;AAAA;AAKCO,cAAAA,IALD;AAMLwxB,cAAAA,aAAa,CAACxxB,IAAI,CAACgC,OAAN,CAAb;;AANK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA;AAQD;;ACdD;;;;;;;;;;;;IAWa+vB,cAAc,GAAG,SAAjBA,cAAiB,GAIzB;AAAA,MAHHC,kBAGG,uEAHkB,KAGlB;AAAA,MAFHC,gBAEG;AAAA,MADHC,yBACG;;AAAA,kBAC2BpmB,cAAQ,CAACkmB,kBAAD,CADnC;AAAA;AAAA,MACIG,OADJ;AAAA,MACaC,UADb;;AAGH,MAAMC,OAAO,GACXJ,gBAAgB,IACf,UAAC1a,KAAD,EAAW;AACVA,IAAAA,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAElD,cAAP;AACA+d,IAAAA,UAAU,CAAC,IAAD,CAAV;AACD,GALH;;AAMA,MAAME,SAAS,GACbJ,yBAAyB,IACxB,UAAC3a,KAAD,EAAW;AACVA,IAAAA,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAElD,cAAP;AACA+d,IAAAA,UAAU,CAAC,KAAD,CAAV;AACD,GALH;;AAMA,SAAO;AAAED,IAAAA,OAAF;AAAWE,IAAAA,OAAX;AAAoBC,IAAAA;AAApB,GAAP;AACD;;AC9BD;;;;;;;IAMaC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAChnB,IAAD,EAAO0Y,IAAP,EAAgB;AACnD,MAAI,CAAC1Y,IAAD,IAAS,OAAOA,IAAP,KAAgB,UAA7B,EAAyC,OAAO,IAAP;AAEzC,MAAMinB,WAAW,GAAGjnB,IAAI,MAAJ,4BAAQ0Y,IAAR,EAApB;AAEA,MAAI,OAAOuO,WAAP,KAAuB,QAA3B,EAAqC,OAAO,IAAP;AAErC,SAAOA,WAAP;AACD;AAED;;;;;;IAKaC,WAAW,GAAG,SAAdA,WAAc,CAACzwB,OAAD,EAAU0wB,KAAV,EAAoB;AAC7C,MAAI,CAACA,KAAD,IAAU,CAAC1wB,OAAf,EAAwB;AACtB,WAAO,KAAP;AACD;;AAED,MAAM2wB,SAAS,GAAGD,KAAK,CAACtvB,MAAN;AAChB;AACA,YAACuY,EAAD;AAAA;;AAAA,WAAQA,EAAE,CAACpO,MAAH,CAAU9N,EAAV,uBAAiBuC,OAAO,CAACR,IAAzB,kDAAiB,cAAc/B,EAA/B,CAAR;AAAA,GAFgB,CAAlB;AAIA,SAAO,CAAC,CAACkzB,SAAS,CAAChxB,MAAnB;AACD;IAEYixB,eAAe,GAAG;AAC7BC,EAAAA,IAAI,EAAE,MADuB;AAE7BC,EAAAA,MAAM,EAAE,QAFqB;AAG7BC,EAAAA,IAAI,EAAE,MAHuB;AAI7BC,EAAAA,IAAI,EAAE;AAJuB;AAO/B;;;;;;;;;;IASaC,iBAAiB,GAAG,SAApBA,iBAAoB,CAC/BpoB,OAD+B,QAG5B;AAAA,MADDqoB,SACC,QADDA,SACC;AAAA,MADUC,OACV,QADUA,OACV;AAAA,MADmBC,OACnB,QADmBA,OACnB;AAAA,MAD4BC,OAC5B,QAD4BA,OAC5B;AACH,MAAMC,6BAA6B,GAAG,EAAtC;AACA,MAAIC,cAAc,GAAG,EAArB;;AAEA,MAAI1oB,OAAO,IAAI,OAAOA,OAAP,KAAmB,SAAlC,EAA6C;AAC3C;AACA0oB,IAAAA,cAAc,GAAGzzB,MAAM,CAACqB,IAAP,CAAYyxB,eAAZ,CAAjB;AACD,GAHD,MAGO,IAAI/nB,OAAO,IAAIA,OAAO,CAAClJ,MAAR,GAAiB,CAAhC,EAAmC;AACxC4xB,IAAAA,cAAc,sBAAO1oB,OAAP,CAAd;AACD,GAFM,MAEA;AACL,WAAO,EAAP;AACD;;AAED,MAAIuoB,OAAO,IAAIG,cAAc,CAAClwB,OAAf,CAAuBuvB,eAAe,CAACC,IAAvC,IAA+C,CAAC,CAA/D,EAAkE;AAChES,IAAAA,6BAA6B,CAAC7xB,IAA9B,CAAmCmxB,eAAe,CAACC,IAAnD;AACD;;AAED,MAAIK,SAAS,IAAIK,cAAc,CAAClwB,OAAf,CAAuBuvB,eAAe,CAACE,MAAvC,IAAiD,CAAC,CAAnE,EAAsE;AACpEQ,IAAAA,6BAA6B,CAAC7xB,IAA9B,CAAmCmxB,eAAe,CAACE,MAAnD;AACD;;AAED,MAAIK,OAAO,IAAII,cAAc,CAAClwB,OAAf,CAAuBuvB,eAAe,CAACG,IAAvC,IAA+C,CAAC,CAA/D,EAAkE;AAChEO,IAAAA,6BAA6B,CAAC7xB,IAA9B,CAAmCmxB,eAAe,CAACG,IAAnD;AACD;;AAED,MAAIM,OAAO,IAAIE,cAAc,CAAClwB,OAAf,CAAuBuvB,eAAe,CAACI,IAAvC,IAA+C,CAAC,CAA/D,EAAkE;AAChEM,IAAAA,6BAA6B,CAAC7xB,IAA9B,CAAmCmxB,eAAe,CAACI,IAAnD;AACD;;AAED,SAAOM,6BAAP;AACD;AAED;;;;;IAIaE,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAC11B,KAAD,EAAQye,SAAR,EAAsB;AACxD;AAEEA,IAAAA,SAAS,CAACva,OAAV,KAAsBlE,KAAK,CAACkE,OAA5B;AAEAyxB,IAAAA,SAAS,CAAClX,SAAS,CAACmX,MAAX,EAAmB51B,KAAK,CAAC41B,MAAzB,CAFT;AAIAD,IAAAA,SAAS,CAAClX,SAAS,CAACoX,WAAX,EAAwB71B,KAAK,CAAC61B,WAA9B,CAJT;AAMAF,IAAAA,SAAS,CAAClX,SAAS,CAACmW,KAAX,EAAkB50B,KAAK,CAAC40B,KAAxB,CANT;AAQAe,IAAAA,SAAS,CAAClX,SAAS,CAACqX,cAAX,EAA2B91B,KAAK,CAAC81B,cAAjC,CART;AAUA;AACArX,IAAAA,SAAS,CAAC4V,OAAV,KAAsBr0B,KAAK,CAACq0B,OAX5B;AAaA5V,IAAAA,SAAS,CAACsX,eAAV,KAA8B/1B,KAAK,CAAC+1B;AAftC;AAiBD;AAED;;;;IAGaC,4BAA4B,GAAG,SAA/BA,4BAA+B,CAACh2B,KAAD,EAAQye,SAAR,EAAsB;AAChE;AACA,SAAO,CAACiX,oBAAoB,CAAC11B,KAAD,EAAQye,SAAR,CAA5B;AACD;AAED;;IACawX,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAC/xB,OAAD,EAAa;AAC9C,SAAO,CAAC,EAACA,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEysB,gBAAV,CAAD,IAA+B,CAAC,CAACzsB,OAAO,CAACysB,gBAAR,CAAyB9sB,MAAjE;AACD;AAED;;IACaqyB,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAChyB,OAAD,EAAa;AAChD,SAAO,CAAC,EAACA,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEke,WAAV,CAAD,IAA0B,CAAC,CAACle,OAAO,CAACke,WAAR,CAAoBve,MAAvD;AACD;AAED;;;;IAGasyB,SAAS,GAAG,SAAZA,SAAY,CAACjyB,OAAD,EAAa;AACpC,MAAI,EAACA,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEke,WAAV,CAAJ,EAA2B;AACzB,WAAO,EAAP;AACD;;AACD,SAAOle,OAAO,CAACke,WAAR,CAAoB9c,MAApB;AACL;AACA,YAAC9B,IAAD;AAAA,WAAUA,IAAI,CAAC0B,IAAL,KAAc,OAAxB;AAAA,GAFK,CAAP;AAID;AAED;;;;IAGakxB,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAClyB,OAAD,EAAa;AACjD,MAAI,EAACA,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEke,WAAV,CAAJ,EAA2B;AACzB,WAAO,EAAP;AACD;;AACD,SAAOle,OAAO,CAACke,WAAR,CAAoB9c,MAApB;AACL;AACA,YAAC9B,IAAD;AAAA,WAAUA,IAAI,CAAC0B,IAAL,KAAc,OAAxB;AAAA,GAFK,CAAP;AAID;IAEYmxB,gBAAgB,GAAGhpB,SAAS,CAAC0D,KAAV,CAAgB;AAC9CpP,EAAAA,EAAE,EAAE0L,SAAS,CAACC,MAAV,CAAiBC,UADyB;AAE9CrI,EAAAA,IAAI,EAAEmI,SAAS,CAACC,MAAV,CAAiBC,UAFuB;AAG9CjL,EAAAA,IAAI,EAAE+K,SAAS,CAACC,MAAV,CAAiBC,UAHuB;AAI9C+oB,EAAAA,IAAI,EAAEjpB,SAAS,CAACC,MAAV,CAAiBC,UAJuB;AAK9CvK,EAAAA,UAAU,EAAEqK,SAAS,CAAC2W,UAAV,CAAqBuS,IAArB,EAA2BhpB,UALO;AAM9CipB,EAAAA,UAAU,EAAEnpB,SAAS,CAAC2W,UAAV,CAAqBuS,IAArB,EAA2BhpB;AANO,CAAhB,EAO7BA;;IC9JUkpB,qCAAqC,GAChD;AAEF;;;;;;;;;IAQaC,cAAc,GAAG,SAAjBA,cAAiB,CAACxyB,OAAD,EAAiC;AAAA,MAAvByyB,aAAuB,uEAAP,EAAO;;AAAA,oBAC1C1mB,gBAAU,CAAC5P,cAAD,CADgC;AAAA,MACrDZ,MADqD,eACrDA,MADqD;;AAAA,qBAE/CwQ,gBAAU,CAACvP,kBAAD,CAFqC;AAAA,MAErDC,CAFqD,gBAErDA,CAFqD;AAI7D;;;AACA;AAAA,wEAAO,iBAAO8Y,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACLA,cAAAA,KAAK,CAAClD,cAAN;AAEEqgB,cAAAA,MAHG,GAMDD,aANC,CAGHC,MAHG,EAIHC,sBAJG,GAMDF,aANC,CAIHE,sBAJG,EAKHC,oBALG,GAMDH,aANC,CAKHG,oBALG;;AAAA,oBAQD,CAACr3B,MAAD,IAAW,CAACkB,CAAZ,IAAiB,CAACi2B,MAAlB,IAA4B,CAAC1yB,OAR5B;AAAA;AAAA;AAAA;;AASHiF,cAAAA,OAAO,CAACC,IAAR,CAAaqtB,qCAAb;AATG;;AAAA;AAAA;AAAA;AAAA,qBAcGh3B,MAAM,CAACs3B,WAAP,CAAmB7yB,OAAO,CAACvC,EAA3B,CAdH;;AAAA;AAeGq1B,cAAAA,cAfH,GAgBDH,sBAAsB,IACtBpC,qBAAqB,CAACoC,sBAAD,EAAyB,CAAC3yB,OAAD,CAAzB,CAjBpB;AAkBH0yB,cAAAA,MAAM,CACJI,cAAc,IAAIr2B,CAAC,CAAC,uCAAD,CADf,EAEJ,SAFI,CAAN;AAlBG;AAAA;;AAAA;AAAA;AAAA;AAuBGsY,cAAAA,YAvBH,GAwBD6d,oBAAoB,IACpBrC,qBAAqB,CAACqC,oBAAD,EAAuB,CAAC5yB,OAAD,CAAvB,CAzBpB;AA0BH0yB,cAAAA,MAAM,CACJ3d,YAAY,IACVtY,CAAC,CACC,gGADD,CAFC,EAKJ,OALI,CAAN;;AA1BG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA;AAmCD;;ACxDD;AAIA;;AACA,SAASs2B,kBAAT,CAA4B3hB,EAA5B,EAAgCpR,OAAhC,EAAyC;AACvC,SAAO,UAACiJ,CAAD,EAAO;AACZ,QAAI,OAAOmI,EAAP,KAAc,UAAd,IAA4B,EAACpR,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEY,eAAV,CAAhC,EAA2D;AACzD;AACD;;AACDwQ,IAAAA,EAAE,CAACnI,CAAD,EAAIjJ,OAAO,CAACY,eAAZ,CAAF;AACD,GALD;AAMD;AAED;;;;;;;;;;;;;;IAYaoyB,kBAAkB,GAAG,SAArBA,kBAAqB,CAAChzB,OAAD,EAAUizB,oBAAV,EAAmC;AACnE;;;AADmE,oBAO/DlnB,gBAAU,CAAC5P,cAAD,CAPqD;AAAA,MAKhD+2B,sBALgD,eAKjEC,eALiE;AAAA,MAMhDC,sBANgD,eAMjEC,eANiE;;AAQnE,MAAMF,eAAe,GACnB,CAAAF,oBAAoB,SAApB,IAAAA,oBAAoB,WAApB,YAAAA,oBAAoB,CAAEE,eAAtB,KACAD,sBADA,IAEC,YAAM,EAHT;;AAIA,MAAMG,eAAe,GACnB,CAAAJ,oBAAoB,SAApB,IAAAA,oBAAoB,WAApB,YAAAA,oBAAoB,CAAEI,eAAtB,KACAD,sBADA,IAEC,YAAM,EAHT;;AAKA,SAAO;AACL;AACAD,IAAAA,eAAe,EAAEJ,kBAAkB,CAACI,eAAD,EAAkBnzB,OAAlB,CAF9B;;AAGL;AACAqzB,IAAAA,eAAe,EAAEN,kBAAkB,CAACM,eAAD,EAAkBrzB,OAAlB;AAJ9B,GAAP;AAMD;AAED;;;;;;;;;;IASaszB,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACtzB,OAAD,EAAUuzB,aAAV,EAA4B;AAC9D;;;AAD8D,qBAIjBxnB,gBAAU,CAAC5P,cAAD,CAJO;AAAA,MAItDg3B,eAJsD,gBAItDA,eAJsD;AAAA,MAIrCE,eAJqC,gBAIrCA,eAJqC;;AAM9D,SAAO;AACL;AACAF,IAAAA,eAAe,EACb,CAAAI,aAAa,SAAb,IAAAA,aAAa,WAAb,YAAAA,aAAa,CAAEJ,eAAf,KACAJ,kBAAkB,CAACI,eAAD,EAAkBnzB,OAAlB,CAJf;;AAKL;AACAqzB,IAAAA,eAAe,EACb,CAAAE,aAAa,SAAb,IAAAA,aAAa,WAAb,YAAAA,aAAa,CAAEF,eAAf,KACAN,kBAAkB,CAACM,eAAD,EAAkBrzB,OAAlB;AARf,GAAP;AAUD;;ICvEYwzB,kCAAkC,GAC7C;AAEF;;;;;;;;;IAQaC,cAAc,GAAG,SAAjBA,cAAiB,CAACzzB,OAAD,EAAiC;AAAA,MAAvByyB,aAAuB,uEAAP,EAAO;;AAAA,oBACnC1mB,gBAAU,CAAC5P,cAAD,CADyB;AAAA,MACrDZ,MADqD,eACrDA,MADqD;AAAA,MAC7Cm1B,KAD6C,eAC7CA,KAD6C;;AAAA,qBAE/C3kB,gBAAU,CAACvP,kBAAD,CAFqC;AAAA,MAErDC,CAFqD,gBAErDA,CAFqD;AAI7D;;;AACA;AAAA,wEAAO,iBAAO8Y,KAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AACLA,cAAAA,KAAK,CAAClD,cAAN;AAEEqgB,cAAAA,MAHG,GAMDD,aANC,CAGHC,MAHG,EAIHC,sBAJG,GAMDF,aANC,CAIHE,sBAJG,EAKHC,oBALG,GAMDH,aANC,CAKHG,oBALG;;AAAA,oBAQD,CAACn2B,CAAD,IAAM,EAACuD,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAER,IAAV,CAAN,IAAwB,CAACkzB,MAAzB,IAAmC,CAACn3B,MARnC;AAAA;AAAA;AAAA;;AASH0J,cAAAA,OAAO,CAACC,IAAR,CAAasuB,kCAAb;AATG;;AAAA;AAAA,kBAYA/C,WAAW,CAACzwB,OAAD,EAAU0wB,KAAV,CAZX;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,qBAcKn1B,MAAM,CAACm4B,QAAP,CAAgB1zB,OAAO,CAACR,IAAR,CAAa/B,EAA7B,CAdL;;AAAA;AAeKq1B,cAAAA,cAfL,GAgBCH,sBAAsB,IACtBpC,qBAAqB,CAACoC,sBAAD,EAAyB,CAAC3yB,OAAO,CAACR,IAAT,CAAzB,CAjBtB;AAmBDkzB,cAAAA,MAAM,CACJI,cAAc,IACZr2B,CAAC,8BAA8B;AAC7B+C,gBAAAA,IAAI,EAAEQ,OAAO,CAACR,IAAR,CAAavD,IAAb,IAAqB+D,OAAO,CAACR,IAAR,CAAa/B;AADX,eAA9B,CAFC,EAKJ,SALI,CAAN;AAnBC;AAAA;;AAAA;AAAA;AAAA;AA2BKsX,cAAAA,YA3BL,GA4BC6d,oBAAoB,IACpBrC,qBAAqB,CAACqC,oBAAD,EAAuB,CAAC5yB,OAAO,CAACR,IAAT,CAAvB,CA7BtB;AA+BDkzB,cAAAA,MAAM,CAAC3d,YAAY,IAAItY,CAAC,CAAC,yBAAD,CAAlB,EAA+C,OAA/C,CAAN;;AA/BC;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,qBAmCKlB,MAAM,CAACo4B,UAAP,CAAkB3zB,OAAO,CAACR,IAAR,CAAa/B,EAA/B,CAnCL;;AAAA;AAoCKm2B,cAAAA,eApCL,GAoCuBn3B,CAAC,gCAAgC;AACvD+C,gBAAAA,IAAI,EAAEQ,OAAO,CAACR,IAAR,CAAavD,IAAb,IAAqB+D,OAAO,CAACR,IAAR,CAAa/B;AADe,eAAhC,CApCxB;AAuCKq1B,cAAAA,eAvCL,GAwCEH,sBAAsB,IACrBpC,qBAAqB,CAACoC,sBAAD,EAAyB,CAAC3yB,OAAO,CAACR,IAAT,CAAzB,CADvB,IAEAo0B,eA1CD;;AA4CD,kBAAI,OAAOd,eAAP,KAA0B,QAA9B,EAAwC;AACtCJ,gBAAAA,MAAM,CAACI,eAAD,EAAiB,SAAjB,CAAN;AACD;;AA9CA;AAAA;;AAAA;AAAA;AAAA;AAgDK/d,cAAAA,aAhDL,GAiDE6d,oBAAoB,IACnBrC,qBAAqB,CAACqC,oBAAD,EAAuB,CAAC5yB,OAAO,CAACR,IAAT,CAAvB,CADvB,IAEA/C,CAAC,CAAC,2BAAD,CAnDF;;AAoDD,kBAAI,OAAOsY,aAAP,KAAwB,QAA5B,EAAsC;AACpC2d,gBAAAA,MAAM,CAAC3d,aAAD,EAAe,OAAf,CAAN;AACD;;AAtDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA;AA0DD;;AC/ED;AAIA;;;;;;;IAMa8e,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAC7zB,OAAD,EAAU8zB,gBAAV,EAA+B;AACjE;;;AADiE,oBAIvB/nB,gBAAU,CAAC5P,cAAD,CAJa;AAAA,MAI7C43B,iBAJ6C,eAIzDC,UAJyD;;AAMjE,MAAMA,UAAU,GAAGF,gBAAgB,IAAIC,iBAAvC;AACA,SAAO,UAACxe,KAAD,EAAW;AAChB,QAAI,CAACye,UAAD,IAAe,CAACh0B,OAApB,EAA6B;AAC3BiF,MAAAA,OAAO,CAACC,IAAR,CACE,wEADF;AAGA;AACD;;AACD8uB,IAAAA,UAAU,CAACh0B,OAAD,EAAUuV,KAAV,CAAV;AACD,GARD;AASD;;ICtBY0e,sBAAsB;AAEnC;;;;IAGaC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACl0B,OAAD,EAAa;AAAA,oBACF+L,gBAAU,CAAC5P,cAAD,CADR;AAAA,MACrCZ,MADqC,eACrCA,MADqC;AAAA,MAC7BkiB,OAD6B,eAC7BA,OAD6B;AAAA,MACpB+R,aADoB,eACpBA,aADoB;;AAG7C;AAAA,wEAAO,iBAAOhC,YAAP,EAAqBjY,KAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AACL,kBAAIA,KAAK,IAAIA,KAAK,CAAClD,cAAnB,EAAmC;AACjCkD,gBAAAA,KAAK,CAAClD,cAAN;AACD;;AAHI,oBAKD,CAACmd,aAAD,IAAkB,CAACxvB,OAAnB,IAA8B,CAACyd,OAA/B,IAA0C,CAACliB,MAL1C;AAAA;AAAA;AAAA;;AAMH0J,cAAAA,OAAO,CAACC,IAAR,CAAa+uB,sBAAb;AANG;;AAAA;AAUDE,cAAAA,oBAVC,GAUsB,IAVtB;AAYC/V,cAAAA,WAZD,GAYe7iB,MAAM,CAAC64B,MAZtB;;AAaL,kBAAIp0B,OAAO,CAACq0B,aAAZ,EAA2B;AACzBr0B,gBAAAA,OAAO,CAACq0B,aAAR,CAAsBh1B,OAAtB,CAA8B,UAAC4uB,QAAD,EAAc;AAC1C;AACA;AACA,sBACEA,QAAQ,CAACzuB,IAAT,IACA4e,WAAW,KAAK6P,QAAQ,CAACzuB,IAAT,CAAc/B,EAD9B,IAEAwwB,QAAQ,CAACjtB,IAAT,KAAkBwsB,YAHpB,EAIE;AACA2G,oBAAAA,oBAAoB,GAAGlG,QAAvB;AACD,mBAND,MAMO,IAAIA,QAAQ,CAACzuB,IAAT,IAAiB4e,WAAW,KAAK6P,QAAQ,CAACzuB,IAAT,CAAc/B,EAAnD,EAAuD;AAC5DwH,oBAAAA,OAAO,CAACC,IAAR;AAGD;AACF,iBAdD;AAeD;;AAEKovB,cAAAA,eA/BD,GA+BmBt0B,OA/BnB;;AAkCL;;;;AAIA,kBAAIm0B,oBAAJ,EAA0B;AACxBI,gBAAAA,qBAAqB,GAAG9W,OAAO,CAAC+W,cAAR,CACtBx0B,OAAO,CAACvC,EADc;AAGtB02B,gBAAAA,oBAAoB,CAACnzB,IAHC,CAAxB;AAKD,eAND,MAMO;AACL;AACM0uB,gBAAAA,SAFD,GAEa1vB,OAAO,CAACvC,EAFrB;AAICwwB,gBAAAA,QAJD,GAIY;AAAEjtB,kBAAAA,IAAI,EAAEwsB;AAAR,iBAJZ;;AAOL+G,gBAAAA,qBAAqB,GAAG9W,OAAO,CAACgX,YAAR,CAAqB/E,SAArB,EAAgCzB,QAAhC,CAAxB;AACD;;AApDI;AAAA;AAAA,qBAwDGsG,qBAxDH;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AA0DH;AACA/E,cAAAA,aAAa,CAAC8E,eAAD,CAAb;;AA3DG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA;AA8DD;AAED;;;;;;;;;IAQaI,gBAAgB,GAAG,SAAnBA,gBAAmB,CAC9B10B,OAD8B,EAE9B20B,mBAF8B,EAG9BC,iBAH8B,EAI3B;AAAA,kBACuD9qB,cAAQ,CAAC,KAAD,CAD/D;AAAA;AAAA,MACI+qB,qBADJ;AAAA,MAC2BC,wBAD3B;;AAEH,MAAMC,cAAc,GAAG,CAAC,EAAC/0B,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEge,UAAV,CAAxB;AACA,MAAMgX,WAAW,GAAGnrB,YAAM,CAAC,KAAD,CAA1B;AACA;;AACA,MAAMorB,sBAAsB,GAAG7qB,iBAAW,CACxC,UAACmL,KAAD,EAAW;AAAA;;AACT,QACEA,KAAK,CAAChK,MAAN;AAEAopB,IAAAA,mBAFA,aAEAA,mBAFA,gDAEAA,mBAAmB,CAAEtqB,OAFrB,0DAEA,sBAA8B0P,QAA9B,CAAuCxE,KAAK,CAAChK,MAA7C,CAFA,CADF,EAIE;AACA;AACD;;AACDupB,IAAAA,wBAAwB,CAAC,KAAD,CAAxB;AACD,GAVuC,EAWxC,CAACA,wBAAD,EAA2BH,mBAA3B,CAXwC,CAA1C;AAcAjqB,EAAAA,eAAS,CAAC,YAAM;AACd,QAAMwqB,cAAc,GAAGN,iBAAH,aAAGA,iBAAH,uBAAGA,iBAAiB,CAAEvqB,OAA1C;;AACA,QAAIwqB,qBAAqB,IAAI,CAACG,WAAW,CAAC3qB,OAA1C,EAAmD;AACjD2qB,MAAAA,WAAW,CAAC3qB,OAAZ,GAAsB,IAAtB;AACA0G,MAAAA,QAAQ,CAACC,gBAAT,CAA0B,OAA1B,EAAmCikB,sBAAnC;AACAlkB,MAAAA,QAAQ,CAACC,gBAAT,CAA0B,UAA1B,EAAsCikB,sBAAtC;;AACA,UAAIC,cAAJ,EAAoB;AAClBA,QAAAA,cAAc,CAAClkB,gBAAf,CAAgC,YAAhC,EAA8CikB,sBAA9C;AACD;AACF;;AACD,QAAI,CAACJ,qBAAD,IAA0BG,WAAW,CAAC3qB,OAA1C,EAAmD;AACjD0G,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,OAA7B,EAAsC+jB,sBAAtC;AACAlkB,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,UAA7B,EAAyC+jB,sBAAzC;;AACA,UAAIC,cAAJ,EAAoB;AAClBA,QAAAA,cAAc,CAAChkB,mBAAf,CACE,YADF,EAEE+jB,sBAFF;AAID;;AACDD,MAAAA,WAAW,CAAC3qB,OAAZ,GAAsB,KAAtB;AACD;;AACD,WAAO,YAAM;AACX,UAAI2qB,WAAW,CAAC3qB,OAAhB,EAAyB;AACvB0G,QAAAA,QAAQ,CAACG,mBAAT,CAA6B,OAA7B,EAAsC+jB,sBAAtC;AACAlkB,QAAAA,QAAQ,CAACG,mBAAT,CAA6B,UAA7B,EAAyC+jB,sBAAzC;;AACA,YAAIC,cAAJ,EAAoB;AAClBA,UAAAA,cAAc,CAAChkB,mBAAf,CACE,YADF,EAEE+jB,sBAFF;AAID;;AACDD,QAAAA,WAAW,CAAC3qB,OAAZ,GAAsB,KAAtB;AACD;AACF,KAZD;AAaD,GAlCQ,EAkCN,CAACwqB,qBAAD,EAAwBI,sBAAxB,EAAgDL,iBAAhD,CAlCM,CAAT;AAoCAlqB,EAAAA,eAAS,CAAC,YAAM;AACd,QAAMwqB,cAAc,GAAGN,iBAAH,aAAGA,iBAAH,uBAAGA,iBAAiB,CAAEvqB,OAA1C;;AACA,QAAI0qB,cAAc,IAAIC,WAAW,CAAC3qB,OAAlC,EAA2C;AACzC0G,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,OAA7B,EAAsC+jB,sBAAtC;AACAlkB,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,UAA7B,EAAyC+jB,sBAAzC;;AACA,UAAIC,cAAJ,EAAoB;AAClBA,QAAAA,cAAc,CAAChkB,mBAAf,CACE,YADF,EAEE+jB,sBAFF;AAID;;AACDD,MAAAA,WAAW,CAAC3qB,OAAZ,GAAsB,KAAtB;AACD;AACF,GAbQ,EAaN,CAAC0qB,cAAD,EAAiBE,sBAAjB,EAAyCL,iBAAzC,CAbM,CAAT;AAeA;;AACA,MAAMO,mBAAmB,GAAG,SAAtBA,mBAAsB,GAAM;AAChCL,IAAAA,wBAAwB,CAAC,IAAD,CAAxB;AACD,GAFD;;AAGA,SAAO;AACLK,IAAAA,mBADK;AAELN,IAAAA;AAFK,GAAP;AAID;;AClKD;;;;;;IAKaO,eAAe,GAAG,SAAlBA,eAAkB,CAACC,sBAAD,EAA4B;AACzD;;;AADyD,oBAIHtpB,gBAAU,CAC9D5P,cAD8D,CAJP;AAAA,MAI/Bm5B,uBAJ+B,eAIjDC,gBAJiD;;AAOzD,MAAMA,gBAAgB,GAAGF,sBAAsB,IAAIC,uBAAnD;AACA;AAAA,wEAAO,iBAAOt1B,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA,oBACDu1B,gBAAgB,IAAIv1B,OADnB;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAEGu1B,gBAAgB,CAACv1B,OAAD,CAFnB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA;AAKD;;ACtBD;;AACA;;;;;IAKaw1B,cAAc,GAAG,SAAjBA,cAAiB,CAACx1B,OAAD,EAAUuzB,aAAV,EAA4B;AACxD,SAAO;AACL;AACAkC,IAAAA,WAAW,EAAE,qBAACxsB,CAAD,EAAO;AAClB,UACE,QAAOsqB,aAAP,aAAOA,aAAP,uBAAOA,aAAa,CAAEmC,kBAAtB,MAA6C,UAA7C,IACA,EAAC11B,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAER,IAAV,CAFF,EAGE;AACA;AACD;;AACD+zB,MAAAA,aAAa,CAACmC,kBAAd,CAAiCzsB,CAAjC,EAAoCjJ,OAAO,CAACR,IAA5C;AACD,KAVI;;AAWL;AACAm2B,IAAAA,WAAW,EAAE,qBAAC1sB,CAAD,EAAO;AAClB,UACE,QAAOsqB,aAAP,aAAOA,aAAP,uBAAOA,aAAa,CAAEqC,kBAAtB,MAA6C,UAA7C,IACA,EAAC51B,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAER,IAAV,CAFF,EAGE;AACA;AACD;;AAED+zB,MAAAA,aAAa,CAACqC,kBAAd,CAAiC3sB,CAAjC,EAAoCjJ,OAAO,CAACR,IAA5C;AACD;AArBI,GAAP;AAuBD;;AC9BD;AAIA;;;;;;;;;;;;IAWaq2B,WAAW,GAAG,SAAdA,WAAc,CAAC71B,OAAD,EAAa;AAAA;;AAAA,oBACV+L,gBAAU,CAAC5P,cAAD,CADA;AAAA,MAC9BZ,MAD8B,eAC9BA,MAD8B;AAAA,MACtBkiB,OADsB,eACtBA,OADsB;;AAGtC,MAAMqY,WAAW,GACf,CAAC,EAAC91B,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAER,IAAV,CAAD,IAAmB,CAAC,EAACjE,MAAD,aAACA,MAAD,uBAACA,MAAM,CAAEiE,IAAT,CAApB,IAAqCjE,MAAM,CAACiE,IAAP,CAAY/B,EAAZ,KAAmBuC,OAAO,CAACR,IAAR,CAAa/B,EADvE;AAGA,MAAMs4B,OAAO,GACX,CAAAx6B,MAAM,SAAN,IAAAA,MAAM,WAAN,4BAAAA,MAAM,CAAEiE,IAAR,8DAAcw2B,IAAd,MAAuB,OAAvB,IACA,CAAAvY,OAAO,SAAP,IAAAA,OAAO,WAAP,8BAAAA,OAAO,CAAE/O,KAAT,2FAAgBunB,UAAhB,gFAA4BD,IAA5B,MAAqC,OAFvC;AAGA,MAAME,OAAO,GAAG,CAAAzY,OAAO,SAAP,IAAAA,OAAO,WAAP,+BAAAA,OAAO,CAAE/O,KAAT,6FAAgBunB,UAAhB,gFAA4BD,IAA5B,MAAqC,OAArD;AACA,MAAMG,WAAW,GACf,CAAA1Y,OAAO,SAAP,IAAAA,OAAO,WAAP,+BAAAA,OAAO,CAAE/O,KAAT,6FAAgBunB,UAAhB,gFAA4BD,IAA5B,MAAqC,mBAArC,IACA,CAAAvY,OAAO,SAAP,IAAAA,OAAO,WAAP,+BAAAA,OAAO,CAAE/O,KAAT,6FAAgBunB,UAAhB,gFAA4BD,IAA5B,MAAqC,WAFvC;AAGA,MAAMI,cAAc,GAAGN,WAAW,IAAIK,WAAf,IAA8BD,OAA9B,IAAyCH,OAAhE;AACA,MAAMM,gBAAgB,GAAGD,cAAzB;AAEA,SAAO;AACLN,IAAAA,WADK;AAELC,IAAAA,OAFK;AAGLG,IAAAA,OAHK;AAILC,IAAAA,WAJK;AAKLC,IAAAA,cALK;AAMLC,IAAAA;AANK,GAAP;AAQD;;AChCD;;AACA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,OAUpB;AAAA,MATJC,UASI,QATJA,UASI;AAAA,MARJC,UAQI,QARJA,UAQI;AAAA,MAPJC,UAOI,QAPJA,UAOI;AAAA,MANJC,YAMI,QANJA,YAMI;AAAA,MALJzF,iBAKI,QALJA,iBAKI;AAAA,MAJJR,WAII,QAJJA,WAII;AAAA,uBAHJxP,IAGI;AAAA,MAHJA,IAGI,0BAHG,KAGH;AAAA,MAFJ0V,IAEI,QAFJA,IAEI;AAAA,MADJ9E,eACI,QADJA,eACI;;AAAA,oBACU9lB,gBAAU,CAACvP,kBAAD,CADpB;AAAA,MACIC,CADJ,eACIA,CADJ;;AAEJ,MAAM80B,cAAc,GAAGN,iBAAiB,EAAxC;;AAFI,kBAG0BnnB,cAAQ,CAAC,KAAD,CAHlC;AAAA;AAAA,MAGG8iB,OAHH;AAAA,MAGYgK,UAHZ;;AAKJ,MAAMC,cAAc,GAAGzsB,iBAAW,CAChC,UAAC0sB,gBAAD,EAAsB;AACpB,QAAI,CAACA,gBAAL,EAAuB;AACrBF,MAAAA,UAAU,CAAC,KAAD,CAAV;AACA;AACD;;AACD,QAAI3V,IAAJ,EAAU;AACR,UAAM8V,aAAa,GAAGD,gBAAgB,CAACnJ,qBAAjB,EAAtB;;AAEA,UAAIgJ,IAAJ,EAAU;AACRC,QAAAA,UAAU,CACR,CAAC,CAAC/E,eAAF,IAAqBkF,aAAa,CAACze,IAAd,GAAqBuZ,eAAe,CAACvZ,IADlD,CAAV;AAGD,OAJD,MAIO;AACLse,QAAAA,UAAU,CACR,CAAC,CAAC/E,eAAF,IACEkF,aAAa,CAACC,KAAd,GAAsB,CAAtB,GAA0BnF,eAAe,CAACmF,KAFpC,CAAV;AAID;AACF;AACF,GApB+B,EAqBhC,CAACnF,eAAD,EAAkB8E,IAAlB,EAAwB1V,IAAxB,CArBgC,CAAlC;AAwBA,sBACE5lB;AACE,mBAAY,qBADd;AAEE,IAAA,SAAS,mDACL4lB,IAAI,GAAG,qCAAH,GAA2C,EAD1C,uBAEL0V,IAAI,GAAG,qCAAH,GAA2C,EAF1C,uBAGL/J,OAAO,GAAG,wCAAH,GAA8C,EAHhD,aAFX;AAOE,IAAA,GAAG,EAAEiK;AAPP,kBASEx7B;AAAI,IAAA,SAAS,EAAC;AAAd,KACGk2B,cAAc,CAAClwB,OAAf,CAAuBuvB,eAAe,CAACG,IAAvC,IAA+C,CAAC,CAAhD,iBACC11B;AAAQ,IAAA,OAAO,EAAEk7B;AAAjB,kBACEl7B;AAAI,IAAA,SAAS,EAAC;AAAd,KAAqDoB,CAAC,CAAC,MAAD,CAAtD,CADF,CAFJ,EAMG80B,cAAc,CAAClwB,OAAf,CAAuBuvB,eAAe,CAACI,IAAvC,IAA+C,CAAC,CAAhD,iBACC31B;AAAQ,IAAA,OAAO,EAAEm7B;AAAjB,kBACEn7B;AAAI,IAAA,SAAS,EAAC;AAAd,KACGo1B,WAAW,IAAIA,WAAW,EAA1B,GAA+Bh0B,CAAC,CAAC,QAAD,CAAhC,GAA6CA,CAAC,CAAC,MAAD,CADjD,CADF,CAPJ,EAaG80B,cAAc,CAAClwB,OAAf,CAAuBuvB,eAAe,CAACC,IAAvC,IAA+C,CAAC,CAAhD,iBACCx1B;AAAQ,IAAA,OAAO,EAAEo7B;AAAjB,kBACEp7B;AAAI,IAAA,SAAS,EAAC;AAAd,KACGoB,CAAC,CAAC,cAAD,CADJ,CADF,CAdJ,EAoBG80B,cAAc,CAAClwB,OAAf,CAAuBuvB,eAAe,CAACE,MAAvC,IAAiD,CAAC,CAAlD,iBACCz1B;AAAQ,IAAA,OAAO,EAAEq7B;AAAjB,kBACEr7B;AAAI,IAAA,SAAS,EAAC;AAAd,KACGoB,CAAC,CAAC,QAAD,CADJ,CADF,CArBJ,CATF,CADF;AAwCD,CA/ED;;AAiFA65B,iBAAiB,CAACptB,SAAlB,GAA8B;AAC5B;AACA+X,EAAAA,IAAI,EAAE9X,SAAS,CAACqE,IAFY;;AAG5B;AACAmpB,EAAAA,IAAI,EAAExtB,SAAS,CAACqE,IAJY;;AAK5B;AACAqkB,EAAAA,eAAe;AAAE;AAA6C1oB,EAAAA,SAAS,CAACmF,MAN5C;;AAO5B;;;;;;AAMAioB,EAAAA,UAAU,EAAEptB,SAAS,CAACI,IAbM;;AAc5B;;;;;;AAMAitB,EAAAA,UAAU,EAAErtB,SAAS,CAACI,IApBM;;AAqB5B;;;;;;AAMAktB,EAAAA,UAAU,EAAEttB,SAAS,CAACI,IA3BM;;AA4B5B;;;;;;AAMAmtB,EAAAA,YAAY,EAAEvtB,SAAS,CAACI,IAlCI;;AAmC5B;;;;AAIA0nB,EAAAA,iBAAiB,EAAE9nB,SAAS,CAACI,IAAV,CAAeF;AAvCN,CAA9B;AAyCA,uCAAehO,cAAK,CAACmO,IAAN,CAAW8sB,iBAAX,CAAf;;ACtHA;;;;IAGaW,cAAc,GAAG,SAAjBA,cAAiB,CAACn7B,KAAD,EAAW;AAAA,MAErCo7B,eAFqC,GAiBnCp7B,KAjBmC,CAErCo7B,eAFqC;AAAA,MAGrCl3B,OAHqC,GAiBnClE,KAjBmC,CAGrCkE,OAHqC;AAAA,MAIrCixB,iBAJqC,GAiBnCn1B,KAjBmC,CAIrCm1B,iBAJqC;AAAA,MAKrCY,eALqC,GAiBnC/1B,KAjBmC,CAKrC+1B,eALqC;AAAA,MAMrC+C,iBANqC,GAiBnC94B,KAjBmC,CAMrC84B,iBANqC;AAAA,MAOrCuC,eAPqC,GAiBnCr7B,KAjBmC,CAOrCq7B,eAPqC;AAAA,MAQrCC,8BARqC,GAiBnCt7B,KAjBmC,CAQrCs7B,8BARqC;AAAA,MASrCC,4BATqC,GAiBnCv7B,KAjBmC,CASrCu7B,4BATqC;AAAA,MAUrCC,+BAVqC,GAiBnCx7B,KAjBmC,CAUrCw7B,+BAVqC;AAAA,MAWrCC,iCAXqC,GAiBnCz7B,KAjBmC,CAWrCy7B,iCAXqC;AAAA,MAYzBC,cAZyB,GAiBnC17B,KAjBmC,CAYrCy6B,UAZqC;AAAA,MAazBkB,cAbyB,GAiBnC37B,KAjBmC,CAarC06B,UAbqC;AAAA,MAcvBkB,gBAduB,GAiBnC57B,KAjBmC,CAcrC46B,YAdqC;AAAA,MAerCiB,MAfqC,GAiBnC77B,KAjBmC,CAerC67B,MAfqC;AAAA,MAgBrCC,kBAhBqC,GAiBnC97B,KAjBmC,CAgBrC87B,kBAhBqC;;AAAA,oBAkBrB7rB,gBAAU,CAAC3Q,WAAD,CAlBW;AAAA,MAkB/Bs1B,KAlB+B,eAkB/BA,KAlB+B;;AAmBvC,MAAMa,cAAc,GAAGN,iBAAiB,EAAxC;;AAnBuC,kBAoBKnnB,cAAQ,CAAC,KAAD,CApBb;AAAA;AAAA,MAoBhC+tB,cApBgC;AAAA,MAoBhBC,iBApBgB;;AAAA,qBAqBfjC,WAAW,CAAC71B,OAAD,CArBI;AAAA,MAqB/B81B,WArB+B,gBAqB/BA,WArB+B;;AAsBvC,MAAMY,YAAY,GAAG7G,gBAAgB,CAAC7vB,OAAD,CAArC;AACA,MAAMu2B,UAAU,GAAG/D,cAAc,CAACxyB,OAAD,EAAU;AACzC0yB,IAAAA,MAAM,EAAEwE,eADiC;AAEzCvE,IAAAA,sBAAsB,EAAE2E,+BAFiB;AAGzC1E,IAAAA,oBAAoB,EAAE2E;AAHmB,GAAV,CAAjC;AAKA,MAAMf,UAAU,GAAG/C,cAAc,CAACzzB,OAAD,EAAU;AACzC0yB,IAAAA,MAAM,EAAEwE,eADiC;AAEzCtE,IAAAA,oBAAoB,EAAEwE,8BAFmB;AAGzCzE,IAAAA,sBAAsB,EAAE0E;AAHiB,GAAV,CAAjC;AAKA,MAAMU,OAAO,GAAG3tB,iBAAW,CAAC,YAAM;AAChC,WAAOqmB,WAAW,CAACzwB,OAAD,EAAU0wB,KAAV,CAAlB;AACD,GAF0B,EAExB,CAAC1wB,OAAD,EAAU0wB,KAAV,CAFwB,CAA3B;AAIA;;AACA,MAAMsH,WAAW,GAAG5tB,iBAAW,CAAC;AAAA,WAAM0tB,iBAAiB,CAAC,KAAD,CAAvB;AAAA,GAAD,EAAiC,EAAjC,CAA/B;AACA,MAAMG,gBAAgB,GAAG,CAAC,EAACj4B,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEge,UAAV,CAA1B;AACAtT,EAAAA,eAAS,CAAC,YAAM;AACd,QAAIkqB,iBAAJ,aAAIA,iBAAJ,uBAAIA,iBAAiB,CAAEvqB,OAAvB,EAAgC;AAC9BuqB,MAAAA,iBAAiB,CAACvqB,OAAlB,CAA0B2G,gBAA1B,CAA2C,cAA3C,EAA2DgnB,WAA3D;AACD;AACF,GAJQ,EAIN,CAACpD,iBAAD,EAAoBoD,WAApB,CAJM,CAAT;AAKAttB,EAAAA,eAAS,CAAC,YAAM;AACd,QAAIutB,gBAAJ,EAAsB;AACpBlnB,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,OAA7B,EAAsC8mB,WAAtC;AACD;AACF,GAJQ,EAIN,CAACC,gBAAD,EAAmBD,WAAnB,CAJM,CAAT;AAMAttB,EAAAA,eAAS,CAAC,YAAM;AACd,QAAImtB,cAAJ,EAAoB;AAClB9mB,MAAAA,QAAQ,CAACC,gBAAT,CAA0B,OAA1B,EAAmCgnB,WAAnC;AACD,KAFD,MAEO;AACLjnB,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,OAA7B,EAAsC8mB,WAAtC;AACD;;AACD,WAAO,YAAM;AACXjnB,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,OAA7B,EAAsC8mB,WAAtC;AACD,KAFD;AAGD,GATQ,EASN,CAACH,cAAD,EAAiBG,WAAjB,CATM,CAAT;;AAUA,MAAIzG,cAAc,CAAC5xB,MAAf,KAA0B,CAA9B,EAAiC;AAC/B,WAAO,IAAP;AACD;;AAED,sBACEtE,6BAAC,qBAAD;AACE,IAAA,MAAM,EAAEs8B,MADV;AAEE,IAAA,kBAAkB,EAAEC,kBAFtB;AAGE,IAAA,iBAAiB,EAAEE;AAHrB,kBAKEz8B,6BAACi7B,mBAAD;AACE,IAAA,iBAAiB,EAAErF,iBADrB;AAEE,IAAA,IAAI,EAAE4G,cAFR;AAGE,IAAA,eAAe,EAAEhG,eAHnB;AAIE,IAAA,UAAU,EAAE2F,cAAc,IAAIjB,UAJhC;AAKE,IAAA,WAAW,EAAEwB,OALf;AAME,IAAA,UAAU,EAAEN,cAAc,IAAIjB,UANhC;AAOE,IAAA,UAAU,EAAEW,eAPd;AAQE,IAAA,YAAY,EAAEO,gBAAgB,IAAIhB,YARpC;AASE,IAAA,IAAI,EAAEZ;AATR,IALF,eAgBEz6B;AACE,IAAA,KAAK,EAAC,IADR;AAEE,IAAA,MAAM,EAAC,GAFT;AAGE,IAAA,OAAO,EAAC,UAHV;AAIE,IAAA,KAAK,EAAC;AAJR,kBAMEA;AACE,IAAA,CAAC,EAAC,+HADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IANF,CAhBF,CADF;AA8BD;AAED;;;;;;AAKA,IAAM68B,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACp8B,KAAD,EAAW;AAAA,MAC/BwP,QAD+B,GAC6BxP,KAD7B,CAC/BwP,QAD+B;AAAA,MACrBssB,kBADqB,GAC6B97B,KAD7B,CACrB87B,kBADqB;AAAA,MACDD,MADC,GAC6B77B,KAD7B,CACD67B,MADC;AAAA,MACOG,iBADP,GAC6Bh8B,KAD7B,CACOg8B,iBADP;AAEvC,MAAMK,mBAAmB,GACvB,8FADF;AAEA,MAAMC,YAAY,GAChB,OAAOR,kBAAP,KAA8B,QAA9B,GACIA,kBADJ,GAEIO,mBAHN;AAIA;;AACA,MAAME,oBAAoB,GAAG,SAAvBA,oBAAuB;AAAA,WAAMP,iBAAiB,CAAC,IAAD,CAAvB;AAAA,GAA7B;;AACA,MAAMQ,YAAY,GAAG;AACnB,mBAAe,iBADI;AAEnB3b,IAAAA,OAAO,EAAE0b,oBAFU;AAGnB7sB,IAAAA,SAAS,EAAE4sB;AAHQ,GAArB;;AAKA,MAAIT,MAAJ,EAAY;AACV,wBAAOt8B,qCAAUi9B,YAAV,EAAyBhtB,QAAzB,CAAP;AACD;;AACD,sBAAOjQ,oCAASi9B,YAAT,EAAwBhtB,QAAxB,CAAP;AACD,CAnBD;;AC9GA;;;;AAGA,IAAMitB,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACz8B,KAAD,EAAW;AAAA,8BAYrCA,KAZqC,CAEvC08B,cAFuC;AAAA,MAEvCA,cAFuC,sCAEtB,IAFsB;AAAA,2BAYrC18B,KAZqC,CAGvC28B,WAHuC;AAAA,MAGvCA,WAHuC,mCAGzB,IAHyB;AAAA,8BAYrC38B,KAZqC,CAIvC48B,cAJuC;AAAA,MAIvCA,cAJuC,sCAItB,IAJsB;AAAA,MAKrBC,oBALqB,GAYrC78B,KAZqC,CAKvC88B,gBALuC;AAAA,MAMvCC,cANuC,GAYrC/8B,KAZqC,CAMvC+8B,cANuC;AAAA,MAOvC74B,OAPuC,GAYrClE,KAZqC,CAOvCkE,OAPuC;AAAA,MAQvC40B,iBARuC,GAYrC94B,KAZqC,CAQvC84B,iBARuC;AAAA,MASvCO,mBATuC,GAYrCr5B,KAZqC,CASvCq5B,mBATuC;AAAA,qBAYrCr5B,KAZqC,CAUvCg9B,KAVuC;AAAA,MAUvCA,KAVuC,6BAU/B,QAV+B;AAAA,MAWvCC,UAXuC,GAYrCj9B,KAZqC,CAWvCi9B,UAXuC;;AAAA,qBAajBlD,WAAW,CAAC71B,OAAD,CAbM;AAAA,MAajC81B,WAbiC,gBAajCA,WAbiC;;AAczC,MAAM8C,gBAAgB,GAAG/E,oBAAoB,CAAC7zB,OAAD,CAA7C;AACA;;;;AAfyC,oBAkBrB+L,gBAAU,CAAC5P,cAAD,CAlBW;AAAA,MAkBjCshB,OAlBiC,eAkBjCA,OAlBiC;;AAmBzC,MAAMub,aAAa,GAAGvb,OAAH,aAAGA,OAAH,uBAAGA,OAAO,CAAE+J,SAAT,EAAtB;AACA,MAAMyR,iBAAiB,GACrBP,cAAc,IAAI,CAACK,UAAnB,IAAiCC,aAAjC,IAAkDA,aAAa,CAACE,OADlE;AAEA,MAAMC,mBAAmB,GAAGH,aAAa,IAAIA,aAAa,CAACnK,SAA3D;;AACA,MACE,CAAC7uB,OAAD,IACAA,OAAO,CAACgB,IAAR,KAAiB,OADjB,IAEAhB,OAAO,CAACgB,IAAR,KAAiB,QAFjB,IAGAhB,OAAO,CAACgB,IAAR,KAAiB,WAHjB,IAIAhB,OAAO,CAACo5B,MAAR,KAAmB,QAJnB,IAKAp5B,OAAO,CAACo5B,MAAR,KAAmB,SALnB,IAMAP,cAPF,EAQE;AACA,WAAO,IAAP;AACD;;AACD,MAAI/C,WAAW,IAAI2C,WAAnB,EAAgC;AAC9B,wBACEp9B;AACE,qBAAY,sBADd;AAEE,MAAA,SAAS,8BAAuBy9B,KAAvB;AAFX,oBAIGz9B,6BAAC,cAAD,eAAoBS,KAApB;AAA2B,MAAA,iBAAiB,EAAE84B;AAA9C,OAJH,EAKGqE,iBAAiB,iBAChB59B;AACE,qBAAY,eADd;AAEE,MAAA,OAAO,EAAEs9B,oBAAoB,IAAIC,gBAFnC;AAGE,MAAA,SAAS,8BAAuBE,KAAvB,gCAAkDA,KAAlD;AAHX,oBAKEz9B,6BAAC,UAAD,OALF,CANJ,EAcG89B,mBAAmB,iBAClB99B;AACE,qBAAY,yBADd;AAEE,MAAA,SAAS,8BAAuBy9B,KAAvB,iDAAmEA,KAAnE,iCAFX;AAGE,MAAA,OAAO,EAAE3D;AAHX,oBAKE95B,6BAAC,YAAD,OALF,CAfJ,CADF;AA0BD;;AACD,sBACEA;AACE,mBAAY,iBADd;AAEE,IAAA,SAAS,8BAAuBy9B,KAAvB;AAFX,KAIGK,mBAAmB,iBAClB99B;AACE,mBAAY,yBADd;AAEE,IAAA,SAAS,8BAAuBy9B,KAAvB,iDAAmEA,KAAnE,iCAFX;AAGE,IAAA,OAAO,EAAE3D;AAHX,kBAKE95B,6BAAC,YAAD,OALF,CALJ,EAaG49B,iBAAiB,iBAChB59B;AACE,IAAA,OAAO,EAAEs9B,oBAAoB,IAAIC,gBADnC;AAEE,mBAAY,eAFd;AAGE,IAAA,SAAS,8BAAuBE,KAAvB,iDAAmEA,KAAnE;AAHX,kBAKEz9B,6BAAC,UAAD,OALF,CAdJ,EAsBGm9B,cAAc,iBACbn9B,6BAAC,cAAD,eAAoBS,KAApB;AAA2B,IAAA,iBAAiB,EAAE84B;AAA9C,KAvBJ,CADF;AA4BD,CA1FD;;AA4FA,kCAAev5B,cAAK,CAACmO,IAAN,CAAW+uB,uBAAX,CAAf;;ACtFA;;;;AAGA,IAAMc,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACv9B,KAAD,EAAW;AAAA,6BAYlCA,KAZkC,CAEpC8yB,aAFoC;AAAA,MAEpCA,aAFoC,qCAEpB0K,oBAFoB;AAAA,8BAYlCx9B,KAZkC,CAGpC2yB,gBAHoC;AAAA,MAGpCA,gBAHoC,sCAGjB8K,uBAHiB;AAAA,MAIZC,mBAJY,GAYlC19B,KAZkC,CAIpC29B,sBAJoC;AAAA,MAKZC,mBALY,GAYlC59B,KAZkC,CAKpC69B,sBALoC;AAAA,MAMpC/B,kBANoC,GAYlC97B,KAZkC,CAMpC87B,kBANoC;AAAA,MAOpCgC,gBAPoC,GAYlC99B,KAZkC,CAOpC89B,gBAPoC;AAAA,qBAYlC99B,KAZkC,CAQpCg9B,KARoC;AAAA,MAQpCA,KARoC,6BAQ5B,QAR4B;AAAA,MASpC94B,OAToC,GAYlClE,KAZkC,CASpCkE,OAToC;AAAA,MAUpC65B,UAVoC,GAYlC/9B,KAZkC,CAUpC+9B,UAVoC;AAAA,MAWpCC,iBAXoC,GAYlCh+B,KAZkC,CAWpCg+B,iBAXoC;AAatC,MAAMnF,mBAAmB,GAAG9qB,YAAM;AAChC;AAAsC,MADN,CAAlC;;AAbsC,8BAgBOypB,oBAAoB,CAACtzB,OAAD,EAAU;AACzEmzB,IAAAA,eAAe,EAAEqG,mBADwD;AAEzEnG,IAAAA,eAAe,EAAEqG;AAFwD,GAAV,CAhB3B;AAAA,MAgB9BvG,eAhB8B,yBAgB9BA,eAhB8B;AAAA,MAgBbE,eAhBa,yBAgBbA,eAhBa;;AAAA,0BAoBiBqB,gBAAgB,CACrE10B,OADqE,EAErE20B,mBAFqE,CApBjC;AAAA,MAoB9BQ,mBApB8B,qBAoB9BA,mBApB8B;AAAA,MAoBTN,qBApBS,qBAoBTA,qBApBS;;AAAA,oBAwBxB9oB,gBAAU,CAACvP,kBAAD,CAxBc;AAAA,MAwB9BC,CAxB8B,eAwB9BA,CAxB8B;;AAyBtC,MAAMs9B,YAAY,GAAGhI,mBAAmB,CAAC/xB,OAAD,CAAxC;AACA,MAAMg6B,aAAa,GAAGhI,qBAAqB,CAAChyB,OAAD,CAA3C;AACA,MAAM6sB,cAAc,GAAGqH,kBAAkB,CAACl0B,OAAD,CAAzC;AACA,MAAMi6B,WAAW,GAAGlsB,aAAO,CACzB;AAAA,WAAMpN,UAAU,CAACX,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAE5B,IAAV,EAAgB4B,OAAhB,aAAgBA,OAAhB,uBAAgBA,OAAO,CAAEY,eAAzB,CAAhB;AAAA,GADyB,EAEzB,CAACZ,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAE5B,IAAV,EAAgB4B,OAAhB,aAAgBA,OAAhB,uBAAgBA,OAAO,CAAEY,eAAzB,CAFyB,CAA3B;AAIA,MAAMw3B,YAAY,GAAGR,kBAAkB,IAAI,wBAA3C;AACA,MAAMsC,UAAU,GACdN,gBAAgB,6DACkCd,KADlC,gBADlB;;AAIA,MAAI,EAAC94B,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAE5B,IAAV,CAAJ,EAAoB;AAClB,WAAO,IAAP;AACD;;AAED,sBACE/C;AAAK,IAAA,SAAS,EAAE+8B;AAAhB,kBACE/8B;AACE,mBAAY,4BADd;AAEE,IAAA,SAAS,EAAE,sBACP6+B,UADO,yBAGPF,aAAa,gCACalB,KADb,mCAET,EALG,yBAQP36B,YAAY,CAAC6B,OAAO,CAAC5B,IAAT,CAAZ,gCAC0B06B,KAD1B,6BAEI,EAVG,gBAYT5f,IAZS,EAFb;AAeE,IAAA,WAAW,EAAEma,eAff;AAgBE,IAAA,OAAO,EAAEF;AAhBX,KAkBGnzB,OAAO,CAACgB,IAAR,KAAiB,OAAjB,iBACC3F;AAAK,IAAA,SAAS,sBAAey9B,KAAf;AAAd,KACGr8B,CAAC,IAAIA,CAAC,CAAC,gBAAD,CADT,CAnBJ,EAuBGuD,OAAO,CAACo5B,MAAR,KAAmB,QAAnB,iBACC/9B;AAAK,IAAA,SAAS,sBAAey9B,KAAf;AAAd,KACGr8B,CAAC,IAAIA,CAAC,CAAC,qCAAD,CADT,CAxBJ,EA6BGo9B,UAAU,gBACTx+B;AAAK,IAAA,uBAAuB,EAAE;AAAE0Y,MAAAA,MAAM,EAAE/T,OAAO,CAACoyB;AAAlB;AAA9B,IADS,GAGT6H,WAhCJ,EAoCGF,YAAY,IAAI,CAAClF,qBAAjB,iBACCx5B,6BAAC,aAAD;AACE,IAAA,SAAS,EAAE2E,OAAO,CAACysB,gBADrB;AAEE,IAAA,eAAe,EAAEzsB,OAAO,CAAC0sB,eAF3B;AAGE,IAAA,OAAO,EAAEyI,mBAHX;AAIE,IAAA,OAAO,EAAE;AAJX,IArCJ,EA4CGN,qBAAqB,iBACpBx5B,6BAAC,gBAAD;AACE,IAAA,cAAc,EAAEwxB,cADlB;AAEE,IAAA,YAAY,MAFd;AAGE,IAAA,eAAe,EAAE7sB,OAAO,CAAC0sB,eAH3B;AAIE,IAAA,gBAAgB,EAAE1sB,OAAO,CAACysB,gBAJ5B;AAKE,IAAA,GAAG,EAAEkI;AALP,IA7CJ,CADF,eAuDEt5B,6BAAC,cAAD,eACMS,KADN,EAEMg+B,iBAFN;AAGE,IAAA,mBAAmB,EAAE3E;AAHvB,KAvDF,CADF;AA+DD,CAxGD;;AA0GA,+BAAe95B,cAAK,CAACmO,IAAN,CAAW6vB,oBAAX,CAAf;;AC7HA;AAOA;;;;AAGA,IAAMc,cAAc,GAAG,SAAjBA,cAAiB,CAACr+B,KAAD,EAAW;AAAA,MACxBkE,OADwB,GACZlE,KADY,CACxBkE,OADwB;;AAAA,oBAElB+L,gBAAU,CAACvP,kBAAD,CAFQ;AAAA,MAExBC,CAFwB,eAExBA,CAFwB;;AAAA,qBAGRo5B,WAAW,CAAC71B,OAAD,CAHH;AAAA,MAGxB81B,WAHwB,gBAGxBA,WAHwB;;AAIhC,MAAIh6B,KAAK,CAACg6B,WAAV,EAAuB;AACrB7wB,IAAAA,OAAO,CAACC,IAAR,CACE,+EADF;AAGD;;AACD,MAAMk1B,cAAc,GACjBt+B,KAAK,CAACg6B,WAAN,IAAqBh6B,KAAK,CAACg6B,WAAN,CAAkB91B,OAAlB,CAAtB,IAAqD81B,WAArD,GACI,+FADJ,GAEI,4CAHN;AAKA,sBACEz6B;AACE,IAAA,GAAG,EAAE2E,OAAO,CAACvC,EADf;AAEE,IAAA,SAAS,YAAK28B,cAAL,yCAAkDp6B,OAAO,CAACgB,IAA1D,MAFX;AAGE,mBAAa;AAHf,kBAKE3F;AAAK,IAAA,SAAS,EAAC;AAAf,KACGoB,CAAC,IAAIA,CAAC,CAAC,6BAAD,CADT,CALF,CADF;AAWD,CAzBD;;AA2BA09B,cAAc,CAACjxB,SAAf,GAA2B;AACzB;AACA;AACA;AACAlJ,EAAAA,OAAO,EAAEmyB,gBAJgB;;AAKzB;AACA2D,EAAAA,WAAW,EAAE3sB,SAAS,CAACI;AANE,CAA3B;;ACrCA;AAIO,IAAM8wB,sBAAsB,GAAG,OAA/B;AACA,IAAMC,mBAAmB,GAC9B,wFADK;AAEA,IAAMC,wBAAwB,GACnC,iFADK;AAEP;;;;;;;;;;AASA,SAASC,aAAT,CACEC,gBADF,EAEEC,UAFF,EAGE92B,QAHF,EAIEjH,eAJF,EAKEg+B,MALF,EAME;AACA,MAAI,CAACF,gBAAD,IAAqB,CAACpI,IAAI,CAACuI,KAAL,CAAWH,gBAAX,CAA1B,EAAwD;AACtDx1B,IAAAA,OAAO,CAACC,IAAR,CAAao1B,mBAAb;AACA,WAAO,IAAP;AACD;;AAED,MAAI,OAAOI,UAAP,KAAsB,UAA1B,EAAsC;AACpC,WAAOA,UAAU,CAAC,IAAIrI,IAAJ,CAASoI,gBAAT,CAAD,CAAjB;AACD;;AAED,MAAI,CAAC99B,eAAL,EAAsB;AACpBsI,IAAAA,OAAO,CAACC,IAAR,CAAaq1B,wBAAb;AACA,WAAO,IAAP;AACD;;AAED,MAAMM,UAAU,GAAGl+B,eAAe,CAAC89B,gBAAD,CAAlC;;AACA,MAAI72B,QAAQ,IAAI,OAAOi3B,UAAU,CAACj3B,QAAlB,KAA+B,UAA/C,EAA2D;AACzD,WAAO,IAAP;AACD;;AAED,SAAOA,QAAQ,GAAGi3B,UAAU,CAACj3B,QAAX,EAAH,GAA2Bi3B,UAAU,CAACF,MAAX,CAAkBA,MAAlB,CAA1C;AACD;AACD;;;;;;AAIA,IAAMG,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACh/B,KAAD,EAAW;AAAA,MAEhCkE,OAFgC,GAQ9BlE,KAR8B,CAEhCkE,OAFgC;AAAA,MAGhC06B,UAHgC,GAQ9B5+B,KAR8B,CAGhC4+B,UAHgC;AAAA,MAIfK,mBAJe,GAQ9Bj/B,KAR8B,CAIhCa,eAJgC;AAAA,2BAQ9Bb,KAR8B,CAKhCk/B,WALgC;AAAA,MAKhCA,WALgC,mCAKlB,EALkB;AAAA,sBAQ9Bl/B,KAR8B,CAMhC6+B,MANgC;AAAA,MAMhCA,MANgC,8BAMvBN,sBANuB;AAAA,wBAQ9Bv+B,KAR8B,CAOhC8H,QAPgC;AAAA,MAOhCA,QAPgC,gCAOrB,KAPqB;;AAAA,oBASkBmI,gBAAU,CAC5DvP,kBAD4D,CAT5B;AAAA,MASTy+B,sBATS,eAS1Bt+B,eAT0B;;AAYlC,MAAMA,eAAe,GAAGo+B,mBAAmB,IAAIE,sBAA/C;AACA,MAAMC,IAAI,GAAGntB,aAAO,CAClB;AAAA,WACEysB,aAAa,CACXx6B,OADW,aACXA,OADW,uBACXA,OAAO,CAAElB,UADE,EAEX47B,UAFW,EAGX92B,QAHW,EAIXjH,eAJW,EAKXg+B,MALW,CADf;AAAA,GADkB,EASlB,CAACD,UAAD,EAAa92B,QAAb,EAAuBjH,eAAvB,EAAwCg+B,MAAxC,EAAgD36B,OAAhD,aAAgDA,OAAhD,uBAAgDA,OAAO,CAAElB,UAAzD,CATkB,CAApB;;AAYA,MAAI,CAACo8B,IAAL,EAAW;AACT,WAAO,IAAP;AACD;;AAED,sBACE7/B;AACE,IAAA,SAAS,EAAE2/B,WADb;AAEE,IAAA,QAAQ,EAAEh7B,OAAF,aAAEA,OAAF,uBAAEA,OAAO,CAAElB,UAFrB;AAGE,IAAA,KAAK,EAAEkB,OAAF,aAAEA,OAAF,uBAAEA,OAAO,CAAElB;AAHlB,KAKGo8B,IALH,CADF;AASD,CAtCD;;AAwCA,sCAAe7/B,cAAK,CAACmO,IAAN,CAAWsxB,gBAAX,CAAf;;ACrDA;;;;;;AAMA;;AACA,IAAMK,aAAa,GAAG,SAAhBA,aAAgB,CAACr/B,KAAD,EAAW;AAAA;;AAAA,MAE7BkqB,iBAF6B,GAe3BlqB,KAf2B,CAE7BkqB,iBAF6B;AAAA,MAG7BmK,OAH6B,GAe3Br0B,KAf2B,CAG7Bq0B,OAH6B;AAAA,MAI7BnwB,OAJ6B,GAe3BlE,KAf2B,CAI7BkE,OAJ6B;AAAA,MAK7B+4B,UAL6B,GAe3Bj9B,KAf2B,CAK7Bi9B,UAL6B;AAAA,MAM7B2B,UAN6B,GAe3B5+B,KAf2B,CAM7B4+B,UAN6B;AAAA,MAOdU,iBAPc,GAe3Bt/B,KAf2B,CAO7B0zB,aAP6B;AAAA,MAQf6L,gBARe,GAe3Bv/B,KAf2B,CAQ7Bw/B,YAR6B;AAAA,MASX3C,oBATW,GAe3B78B,KAf2B,CAS7B88B,gBAT6B;AAAA,MAUb2C,kBAVa,GAe3Bz/B,KAf2B,CAU7B+wB,cAV6B;AAAA,MAWhB2O,eAXgB,GAe3B1/B,KAf2B,CAW7B2/B,WAX6B;AAAA,MAYhBC,wBAZgB,GAe3B5/B,KAf2B,CAY7B25B,WAZ6B;AAAA,MAahBkG,wBAbgB,GAe3B7/B,KAf2B,CAa7B65B,WAb6B;AAAA,MAcZiG,mBAdY,GAe3B9/B,KAf2B,CAc7Ba,eAd6B;;AAAA,oBAgBiBoP,gBAAU,CAAC5P,cAAD,CAhB3B;AAAA,MAgBR0/B,oBAhBQ,eAgBvBrM,aAhBuB;;AAiB/B,MAAMA,aAAa,GAAG4L,iBAAiB,IAAIS,oBAA3C;;AAjB+B,qBAkBPhG,WAAW,CAAC71B,OAAD,CAlBJ;AAAA,MAkBvB81B,WAlBuB,gBAkBvBA,WAlBuB;;AAmB/B,MAAM8C,gBAAgB,GAAG/E,oBAAoB,CAAC7zB,OAAD,CAA7C;AACA,MAAM6sB,cAAc,GAAGqH,kBAAkB,CAACl0B,OAAD,CAAzC;AACA,MAAMs7B,YAAY,GAAG/L,gBAAgB,CAACvvB,OAAD,CAArC;AACA,MAAMy7B,WAAW,GAAGrG,eAAe,EAAnC;;AAtB+B,wBAuBMI,cAAc,CAACx1B,OAAD,EAAU;AAC3D01B,IAAAA,kBAAkB,EAAEgG,wBADuC;AAE3D9F,IAAAA,kBAAkB,EAAE+F;AAFuC,GAAV,CAvBpB;AAAA,MAuBvBlG,WAvBuB,mBAuBvBA,WAvBuB;AAAA,MAuBVE,WAvBU,mBAuBVA,WAvBU;;AA2B/B,MAAMhB,mBAAmB,gBAAGt5B,cAAK,CAACygC,SAAN,EAA5B;AACA,MAAMlH,iBAAiB,GAAG/qB,YAAM,CAAC,IAAD,CAAhC;;AA5B+B,0BA6BwB6qB,gBAAgB,CACrE10B,OADqE,EAErE20B,mBAFqE,CA7BxC;AAAA,MA6BvBQ,mBA7BuB,qBA6BvBA,mBA7BuB;AAAA,MA6BFN,qBA7BE,qBA6BFA,qBA7BE;;AAAA,0BAsC3B/4B,KAtC2B,CAkC7B8T,UAlC6B;AAAA,MAkC7BA,YAlC6B,kCAkChBmsB,UAlCgB;AAAA,8BAsC3BjgC,KAtC2B,CAmC7Bq+B,cAnC6B;AAAA,MAmC7BA,gBAnC6B,sCAmCZ6B,cAnCY;AAAA,8BAsC3BlgC,KAtC2B,CAoC7B2yB,gBApC6B;AAAA,MAoC7BA,gBApC6B,sCAoCV8K,uBApCU;AAAA,6BAsC3Bz9B,KAtC2B,CAqC7B8yB,aArC6B;AAAA,MAqC7BA,aArC6B,qCAqCb0K,oBArCa;AAwC/B,MAAMS,YAAY,GAAGhI,mBAAmB,CAAC/xB,OAAD,CAAxC;AACA,MAAMg6B,aAAa,GAAGhI,qBAAqB,CAAChyB,OAAD,CAA3C;AAEA,MAAMo6B,cAAc,GAAGtE,WAAW,GAC9B,+FAD8B,GAE9B,4CAFJ;AAIA,MAAM/oB,MAAM,GACVitB,aAAa,KACbh6B,OADa,aACbA,OADa,+CACbA,OAAO,CAAEke,WADI,yDACb,qBAAsB9c,MAAtB;AACE;AACA,YAAC9B,IAAD;AAAA,WAAUA,IAAI,CAAC0B,IAAL,KAAc,OAAxB;AAAA,GAFF,CADa,CADf;;AAOA,MAAI,CAAAhB,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEgB,IAAT,MAAkB,cAAlB,IAAoC,CAAAhB,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEgB,IAAT,MAAkB,cAA1D,EAA0E;AACxE,WAAO,IAAP;AACD;;AAED,MAAIhB,OAAJ,aAAIA,OAAJ,uBAAIA,OAAO,CAAEge,UAAb,EAAyB;AACvB,WAAO3b,WAAW,CAAC83B,gBAAD,EAAiB;AAAEn6B,MAAAA;AAAF,KAAjB,EAA8B,IAA9B,CAAlB;AACD;;AACD,sBACE3E,6BAACA,cAAD,CAAO,QAAP,QACG80B,OAAO,iBACN90B,6BAAC,KAAD;AAAO,IAAA,IAAI,EAAE80B,OAAb;AAAsB,IAAA,OAAO,EAAEnK;AAA/B,kBACE3qB,6BAAC6wB,cAAD;AACE,IAAA,KAAK,EAAEG,eADT;AAEE,IAAA,OAAO,EAAErsB,OAFX;AAGE,IAAA,iBAAiB,EAAEgmB,iBAHrB;AAIE,IAAA,aAAa,EAAEwJ;AAJjB,KAKM1zB,KAAK,CAACmgC,2BALZ,EADF,CAFJ,EAYGj8B,OAAO,iBACN3E;AACE,IAAA,GAAG,EAAE2E,OAAO,CAACvC,EAAR,IAAc,EADrB;AAEE,IAAA,SAAS,EAAE,wBACb28B,cADa,8CAEMp6B,OAAO,CAACgB,IAFd,8CAGMhB,OAAO,CAACo5B,MAHd,2BAIbp5B,OAAO,CAAC5B,IAAR,GAAe,6BAAf,GAA+C,aAJlC,2BAKb47B,aAAa,GAAG,mCAAH,GAAyC,EALzC,2BAMbD,YAAY,GAAG,mCAAH,GAAyC,EANxC,kBAOd7gB,IAPc,EAFb;AAUE,IAAA,GAAG,EAAE0b;AAVP,kBAYEv5B,6BAAC,mBAAD,EAAyBS,KAAzB,CAZF,EAcGkE,OAAO,CAACR,IAAR,iBACCnE,6BAAC,MAAD;AACE,IAAA,KAAK,EAAE2E,OAAO,CAACR,IAAR,CAAawM,KADtB;AAEE,IAAA,IAAI,EAAEhM,OAAO,CAACR,IAAR,CAAavD,IAAb,IAAqB+D,OAAO,CAACR,IAAR,CAAa/B,EAF1C;AAGE,IAAA,OAAO,EAAEg4B,WAHX;AAIE,IAAA,WAAW,EAAEE;AAJf,IAfJ,eAsBEt6B;AACE,mBAAY,eADd;AAEE,IAAA,SAAS,EAAC,yBAFZ;AAGE,IAAA,OAAO,EAAE,mBAAM;AACb,UACE2E,OAAO,CAACo5B,MAAR,KAAmB,QAAnB,KACCoC,eAAe,IAAIC,WADpB,CADF,EAGE;AACA,YAAMS,YAAY,GAAGV,eAAe,IAAIC,WAAxC,CADA;AAGA;AACA;AACA;;AACAS,QAAAA,YAAY,CAACl8B,OAAD,CAAZ;AACD;AACF;AAfH,KAiBG,CAACA,OAAO,CAAC5B,IAAT,iBACC/C,6BAACA,cAAD,CAAO,QAAP,qBAEIA,6BAAC,cAAD,eACMS,KADN;AAEE,IAAA,iBAAiB,EAAE84B,iBAFrB;AAGE,IAAA,mBAAmB,EAAEO,mBAHvB;AAIE,IAAA,gBAAgB,EAAEwD;AAJpB,KAFJ,EAUGoB,YAAY,IAAI,CAAClF,qBAAjB,iBACCx5B,6BAAC,aAAD;AACE,IAAA,SAAS,EAAE2E,OAAO,CAACysB,gBADrB;AAEE,IAAA,eAAe,EAAEzsB,OAAO,CAAC0sB,eAF3B;AAGE,IAAA,OAAO,EAAEyI,mBAHX;AAIE,IAAA,OAAO,EAAE;AAJX,IAXJ,EAkBGN,qBAAqB,iBACpBx5B,6BAAC,gBAAD;AACE,IAAA,cAAc,EAAEkgC,kBAAkB,IAAI1O,cADxC;AAEE,IAAA,YAAY,MAFd;AAGE,IAAA,eAAe,EAAE7sB,OAAO,CAAC0sB,eAH3B;AAIE,IAAA,gBAAgB,EAAE1sB,OAAO,CAACysB,gBAJ5B;AAKE,IAAA,GAAG,EAAEkI;AALP,IAnBJ,CAlBJ,eAgDEt5B;AAAK,IAAA,SAAS,EAAC;AAAf,KACG2+B,aAAa,8BACZh6B,OAAO,CAACke,WADI,0DACZ,sBAAqB5d,GAArB;AACE;AACA,YAACgM,UAAD,EAAaW,KAAb,EAAuB;AACrB,QACEX,UAAU,CAACtL,IAAX,KAAoB,OAApB,IACA+L,MADA,IAEAA,MAAM,CAACpN,MAAP,GAAgB,CAHlB,EAKE,OAAO,IAAP;AACF,wBACEtE,6BAACuU,YAAD;AACE,MAAA,GAAG,YAAK5P,OAAO,CAACvC,EAAb,cAAmBwP,KAAnB,CADL;AAEE,MAAA,UAAU,EAAEX,UAFd;AAGE,MAAA,aAAa,EAAE+uB,gBAAgB,IAAIC;AAHrC,MADF;AAOD,GAhBH,CADY,CADhB,CAhDF,EAqEGvuB,MAAM,IAAIA,MAAM,CAACpN,MAAP,GAAgB,CAA1B,iBAA+BtE,6BAACoS,SAAD;AAAS,IAAA,MAAM,EAAEV;AAAjB,IArElC,EAsEG/M,OAAO,CAAC5B,IAAR,iBACC/C,6BAAC,WAAD,eACMS,KADN;AAEE,IAAA,iBAAiB,EAAE;AACjB84B,MAAAA,iBADiB;AAEjBgE,MAAAA,gBAAgB,EAAED;AAFD,KAFrB;AAOE;AACA;AARF;AASE,IAAA,mBAAmB,EAAEhE;AATvB,KAvEJ,EAmFG,CAACoE,UAAD,IAAe/4B,OAAO,CAAC0gB,WAAR,KAAwB,CAAvC,iBACCrlB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAColB,2BAAD;AACE,IAAA,OAAO,EAAEkY,oBAAoB,IAAIC,gBADnC;AAEE,IAAA,WAAW,EAAE54B,OAAO,CAAC0gB;AAFvB,IADF,CApFJ,eA2FErlB;AACE,IAAA,SAAS;AADX,KAGG,CAACy6B,WAAD,IAAgB91B,OAAO,CAACR,IAAxB,gBACCnE;AAAM,IAAA,SAAS,EAAC;AAAhB,KACG2E,OAAO,CAACR,IAAR,CAAavD,IAAb,IAAqB+D,OAAO,CAACR,IAAR,CAAa/B,EADrC,CADD,GAIG,IAPN,eAQEpC,6BAACy/B,kBAAD;AACE,IAAA,WAAW,EAAC,oCADd;AAEE,IAAA,eAAe,EAAEc,mBAFnB;AAGE,IAAA,UAAU,EAAElB,UAHd;AAIE,IAAA,OAAO,EAAE16B,OAJX;AAKE,IAAA,QAAQ;AALV,IARF,CA3FF,CAtBF,CAbJ,CADF;AAoJD,CAjND;AAmNA;;;AACA,IAAMm8B,mBAAmB,GAAG,SAAtBA,mBAAsB,OAKtB;AAAA,MAJJzK,MAII,QAJJA,MAII;AAAA,MAHJ1xB,OAGI,QAHJA,OAGI;AAAA,MAFJ+4B,UAEI,QAFJA,UAEI;AAAA,MADJnH,cACI,QADJA,cACI;;AAAA,qBACU7lB,gBAAU,CAACvP,kBAAD,CADpB;AAAA,MACIC,CADJ,gBACIA,CADJ;;AAAA,qBAEesP,gBAAU,CAAC5P,cAAD,CAFzB;AAAA,MAEIZ,MAFJ,gBAEIA,MAFJ;;AAAA,sBAGoBs6B,WAAW,CAAC71B,OAAD,CAH/B;AAAA,MAGI81B,WAHJ,iBAGIA,WAHJ;;AAIJ,MAAI,CAACA,WAAD,IAAgB,CAAA91B,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEgB,IAAT,MAAkB,OAAtC,EAA+C;AAC7C,WAAO,IAAP;AACD;;AACD,MAAMo7B,YAAY,GAChB1K,MAAM,IACNA,MAAM,CAAC/xB,MAAP,KAAkB,CADlB,IAEA+xB,MAAM,CAAC,CAAD,CAFN,IAGAn2B,MAHA,IAIAm2B,MAAM,CAAC,CAAD,CAAN,CAAUj0B,EAAV,KAAiBlC,MAAM,CAACiE,IAAP,CAAY/B,EAL/B;;AAMA,MAAIuC,OAAO,IAAIA,OAAO,CAACo5B,MAAR,KAAmB,SAAlC,EAA6C;AAC3C,wBACE/9B;AACE,MAAA,SAAS,EAAC,iCADZ;AAEE,qBAAY;AAFd,oBAIEA,6BAAC+oB,SAAD,QAAU3nB,CAAC,IAAIA,CAAC,CAAC,YAAD,CAAhB,CAJF,eAKEpB,6BAAComB,uBAAD,OALF,CADF;AASD;;AACD,MAAIiQ,MAAM,IAAIA,MAAM,CAAC/xB,MAAP,KAAkB,CAA5B,IAAiC,CAACo5B,UAAlC,IAAgD,CAACqD,YAArD,EAAmE;AACjE,QAAMC,YAAY,GAAG3K,MAAM,CAACtwB,MAAP;AACnB;AACA,cAAC9B,IAAD;AAAA,aAAU,CAAC,CAACA,IAAF,IAAU,CAAC,CAAC/D,MAAZ,IAAsB+D,IAAI,CAAC7B,EAAL,KAAYlC,MAAM,CAACiE,IAAP,CAAY/B,EAAxD;AAAA,KAFmB,EAGnB,CAHmB,CAArB;AAIA,wBACEpC;AACE,MAAA,SAAS,EAAC,iCADZ;AAEE,qBAAY;AAFd,oBAIEA,6BAAC+oB,SAAD,QAAUsN,MAAM,IAAI5uB,oBAAoB,CAAC4uB,MAAD,EAASj1B,CAAT,EAAYlB,MAAZ,CAAxC,CAJF,eAKEF,6BAAC,MAAD;AACE,MAAA,IAAI,EAAEghC,YAAY,IAAIA,YAAY,CAACpgC,IAA7B,GAAoCogC,YAAY,CAACpgC,IAAjD,GAAwD,IADhE;AAEE,MAAA,KAAK,EAAEogC,YAAY,IAAIA,YAAY,CAACrwB,KAA7B,GAAqCqwB,YAAY,CAACrwB,KAAlD,GAA0D,IAFnE;AAGE,MAAA,IAAI,EAAE;AAHR,MALF,EAUG0lB,MAAM,CAAC/xB,MAAP,GAAgB,CAAhB,iBACCtE;AACE,MAAA,SAAS,EAAC,wCADZ;AAEE,qBAAY;AAFd,OAIGq2B,MAAM,CAAC/xB,MAAP,GAAgB,CAJnB,CAXJ,CADF;AAqBD;;AACD,MACEK,OAAO,IACPA,OAAO,CAACo5B,MAAR,KAAmB,UADnB,IAEAp5B,OAAO,CAACvC,EAAR,KAAem0B,cAFf,IAGA,CAACmH,UAJH,EAKE;AACA,wBACE19B;AACE,MAAA,SAAS,EAAC,iCADZ;AAEE,qBAAY;AAFd,oBAIEA,6BAAC+oB,SAAD,QAAU3nB,CAAC,IAAIA,CAAC,CAAC,WAAD,CAAhB,CAJF,eAKEpB,6BAAC,kBAAD,OALF,CADF;AASD;;AACD,SAAO,IAAP;AACD,CAzED;;AA2EA8/B,aAAa,CAACjyB,SAAd,GAA0B;AACxB;AACAlJ,EAAAA,OAAO;AAAE;AAA2EmJ,EAAAA,SAAS,CAC1FmF,MADiF,CAC1EjF,UAHc;;AAIxB;;;;AAIAuG,EAAAA,UAAU;AAAE;AAAmGzG,EAAAA,SAAS,CAACkH,WARjG;;AASxB;;;;;;;AAOAisB,EAAAA,OAAO;AAAE;AAAgGnzB,EAAAA,SAAS,CAACozB,SAAV,CACvG,CAACpzB,SAAS,CAACqzB,IAAX,EAAiBrzB,SAAS,CAACI,IAA3B,EAAiCJ,SAAS,CAACmF,MAA3C,CADuG,CAhBjF;;AAmBxB;AACAurB,EAAAA,UAAU,EAAE1wB,SAAS,CAACqE,IApBE;;AAqBxB;AACA;AACAjS,EAAAA,MAAM,EAAE4N,SAAS,CAACmF,MAvBM;;AAwBxB;AACAuqB,EAAAA,cAAc,EAAE1vB,SAAS,CAACqE,IAzBF;;AA0BxB;AACAwrB,EAAAA,aAAa;AAAE;AAAyE7vB,EAAAA,SAAS,CAACmF,MA3B1E;;AA4BxB;AACAosB,EAAAA,UAAU,EAAEvxB,SAAS,CAACI,IA7BE;;AA8BxB;AACAwvB,EAAAA,UAAU,EAAE5vB,SAAS,CAACqE,IA/BE;;AAgCxB;;;;;AAKAorB,EAAAA,gBAAgB,EAAEzvB,SAAS,CAACI,IArCJ;;AAsCxB;AACA4mB,EAAAA,OAAO,EAAEhnB,SAAS,CAACqE,IAvCK;;AAwCxB;AACAwY,EAAAA,iBAAiB,EAAE7c,SAAS,CAACI,IAzCL;;AA0CxB;AACAusB,EAAAA,WAAW,EAAE3sB,SAAS,CAACI,IA3CC;;AA4CxB;;;;AAIA0nB,EAAAA,iBAAiB,EAAE9nB,SAAS,CAACI,IAAV,CAAeF,UAhDV;;AAiDxB;;;;;AAKAmmB,EAAAA,aAAa,EAAErmB,SAAS,CAACI,IAtDD;;AAuDxB;;;;;AAKAkyB,EAAAA,WAAW,EAAEtyB,SAAS,CAACI,IA5DC;;AA6DxB;;;;;;;AAOAsjB,EAAAA,cAAc,EAAE1jB,SAAS,CAACI,IApEF;;AAqExB;;;AAGAklB,EAAAA,gBAAgB;AAAE;AAA8FtlB,EAAAA,SAAS,CAACkH,WAxElG;;AAyExB;;;AAGAue,EAAAA,aAAa;AAAE;AAA2FzlB,EAAAA,SAAS,CAACkH,WA5E5F;;AA6ExB;AACAosB,EAAAA,cAAc,EAAEtzB,SAAS,CAACqE,IA9EF;;AA+ExB;AACAqkB,EAAAA,eAAe,EAAE1oB,SAAS,CAAC0D,KAAV,CAAgB;AAC/BghB,IAAAA,CAAC,EAAE1kB,SAAS,CAACoE,MAAV,CAAiBlE,UADW;AAE/BqzB,IAAAA,CAAC,EAAEvzB,SAAS,CAACoE,MAAV,CAAiBlE,UAFW;AAG/B6T,IAAAA,MAAM,EAAE/T,SAAS,CAACoE,MAAV,CAAiBlE,UAHM;AAI/B+B,IAAAA,KAAK,EAAEjC,SAAS,CAACoE,MAAV,CAAiBlE,UAJO;AAK/BgP,IAAAA,GAAG,EAAElP,SAAS,CAACoE,MAAV,CAAiBlE,UALS;AAM/B2tB,IAAAA,KAAK,EAAE7tB,SAAS,CAACoE,MAAV,CAAiBlE,UANO;AAO/BszB,IAAAA,MAAM,EAAExzB,SAAS,CAACoE,MAAV,CAAiBlE,UAPM;AAQ/BiP,IAAAA,IAAI,EAAEnP,SAAS,CAACoE,MAAV,CAAiBlE,UARQ;AAS/BuzB,IAAAA,MAAM,EAAEzzB,SAAS,CAACI,IAAV,CAAeF;AATQ,GAAhB,CAhFO;;AA2FxB;;;;;;AAMAiyB,EAAAA,YAAY,EAAEnyB,SAAS,CAACI,IAjGA;;AAkGxB;;;;;;;;AAQAowB,EAAAA,sBAAsB,EAAExwB,SAAS,CAACI,IA1GV;;AA2GxB;;;;;;;;AAQAkwB,EAAAA,sBAAsB,EAAEtwB,SAAS,CAACI,IAnHV;;AAoHxB;;;;;AAKAksB,EAAAA,WAAW,EAAEtsB,SAAS,CAACI,IAzHC;;AA0HxB;;;;;AAKAosB,EAAAA,WAAW,EAAExsB,SAAS,CAACI,IA/HC;;AAgIxB;;;;AAIA0yB,EAAAA,2BAA2B,EAAE9yB,SAAS,CAACmF,MApIf;;AAqIxB;;;;AAIA6rB,EAAAA,cAAc;AAAE;AAA4FhxB,EAAAA,SAAS,CAACkH;AAzI9F,CAA1B;AA4IA,mCAAehV,cAAK,CAACmO,IAAN,CAAW2xB,aAAX,EAA0B3J,oBAA1B,CAAf;;AC9bA;;;;;;;;AAOA,IAAM8K,OAAO,GAAG,SAAVA,OAAU,CAACxgC,KAAD,EAAW;AAAA,MAEvBo7B,eAFuB,GAmBrBp7B,KAnBqB,CAEvBo7B,eAFuB;AAAA,MAGvBI,+BAHuB,GAmBrBx7B,KAnBqB,CAGvBw7B,+BAHuB;AAAA,MAIvBC,iCAJuB,GAmBrBz7B,KAnBqB,CAIvBy7B,iCAJuB;AAAA,MAKvBF,4BALuB,GAmBrBv7B,KAnBqB,CAKvBu7B,4BALuB;AAAA,MAMvBD,8BANuB,GAmBrBt7B,KAnBqB,CAMvBs7B,8BANuB;AAAA,MAOvBp3B,OAPuB,GAmBrBlE,KAnBqB,CAOvBkE,OAPuB;AAAA,MAQd68B,WARc,GAmBrB/gC,KAnBqB,CAQvB2hB,OARuB;AAAA,MASVqf,eATU,GAmBrBhhC,KAnBqB,CASvB25B,WATuB;AAAA,MAUVsH,eAVU,GAmBrBjhC,KAnBqB,CAUvB65B,WAVuB;AAAA,MAWXqH,cAXW,GAmBrBlhC,KAnBqB,CAWvBk4B,UAXuB;AAAA,MAYLiJ,oBAZK,GAmBrBnhC,KAnBqB,CAYvBy5B,gBAZuB;AAAA,MAaNiE,mBAbM,GAmBrB19B,KAnBqB,CAavBq3B,eAbuB;AAAA,MAcNuG,mBAdM,GAmBrB59B,KAnBqB,CAcvBu3B,eAduB;AAAA,uBAmBrBv3B,KAnBqB,CAevBwgC,OAfuB;AAAA,MAedY,kBAfc,+BAeO/B,eAfP;AAAA,8BAmBrBr/B,KAnBqB,CAgBvBy1B,cAhBuB;AAAA,MAgBvBA,cAhBuB,sCAgBNzzB,MAAM,CAACqB,IAAP,CAAYyxB,eAAZ,CAhBM;AAAA,MAiBvB8J,UAjBuB,GAmBrB5+B,KAnBqB,CAiBvB4+B,UAjBuB;AAAA,2BAmBrB5+B,KAnBqB,CAkBvB61B,WAlBuB;AAAA,MAkBvBA,WAlBuB,mCAkBT,EAlBS;;AAAA,oBAoBW5lB,gBAAU,CAAC5P,cAAD,CApBrB;AAAA,MAoBRghC,cApBQ,eAoBjB1f,OApBiB;;AAqBzB,MAAMA,OAAO,GAAGof,WAAW,IAAIM,cAA/B;AACA,MAAMnE,aAAa,GAAG,CAAAvb,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAE+J,SAAT,KAAsB/J,OAAO,CAAC+J,SAAR,EAA5C;;AAtByB,wBAuBeuI,cAAc,EAvB7B;AAAA,MAuBjBI,OAvBiB,mBAuBjBA,OAvBiB;AAAA,MAuBRE,OAvBQ,mBAuBRA,OAvBQ;AAAA,MAuBCC,SAvBD,mBAuBCA,SAvBD;;AAwBzB,MAAMoG,YAAY,GAAG7G,gBAAgB,CAAC7vB,OAAD,CAArC;AACA,MAAM6sB,cAAc,GAAGqH,kBAAkB,CAACl0B,OAAD,CAAzC;AACA,MAAMs7B,YAAY,GAAG/L,gBAAgB,CAACvvB,OAAD,CAArC;AACA,MAAMy7B,WAAW,GAAGrG,eAAe,CAAC6H,oBAAD,CAAnC;AACA,MAAMrE,gBAAgB,GAAG/E,oBAAoB,CAAC7zB,OAAD,EAAUg9B,cAAV,CAA7C;AACA,MAAMzG,UAAU,GAAG/D,cAAc,CAACxyB,OAAD,EAAU;AACzC0yB,IAAAA,MAAM,EAAEwE,eADiC;AAEzCvE,IAAAA,sBAAsB,EAAE4E,iCAFiB;AAGzC3E,IAAAA,oBAAoB,EAAE0E;AAHmB,GAAV,CAAjC;AAKA,MAAMd,UAAU,GAAG/C,cAAc,CAACzzB,OAAD,EAAU;AACzC0yB,IAAAA,MAAM,EAAEwE,eADiC;AAEzCvE,IAAAA,sBAAsB,EAAEyE,8BAFiB;AAGzCxE,IAAAA,oBAAoB,EAAEyE;AAHmB,GAAV,CAAjC;;AAlCyB,4BAuCoBrE,kBAAkB,CAAChzB,OAAD,EAAU;AACvEmzB,IAAAA,eAAe,EAAEqG,mBADsD;AAEvEnG,IAAAA,eAAe,EAAEqG;AAFsD,GAAV,CAvCtC;AAAA,MAuCjBvG,eAvCiB,uBAuCjBA,eAvCiB;AAAA,MAuCAE,eAvCA,uBAuCAA,eAvCA;;AAAA,wBA2CYmC,cAAc,CAACx1B,OAAD,EAAU;AAC3D01B,IAAAA,kBAAkB,EAAEoH,eADuC;AAE3DlH,IAAAA,kBAAkB,EAAEmH;AAFuC,GAAV,CA3C1B;AAAA,MA2CjBtH,WA3CiB,mBA2CjBA,WA3CiB;AAAA,MA2CJE,WA3CI,mBA2CJA,WA3CI;;AAAA,qBA+C8BE,WAAW,CAAC71B,OAAD,CA/CzC;AAAA,MA+CjB81B,YA/CiB,gBA+CjBA,WA/CiB;AAAA,MA+CJC,OA/CI,gBA+CJA,OA/CI;AAAA,MA+CKI,WA/CL,gBA+CKA,WA/CL;AAAA,MA+CkBD,OA/ClB,gBA+CkBA,OA/ClB;;AAgDzB,MAAM9E,OAAO,GAAG0E,YAAW,IAAIK,WAAf,IAA8BD,OAA9B,IAAyCH,OAAzD;AACA,MAAM7E,SAAS,GAAGE,OAAlB;AACA,MAAMgM,qBAAqB,GAAGhzB,iBAAW,CAAC,YAAM;AAC9C,QAAI,CAACpK,OAAD,IAAY,CAACuxB,cAAjB,EAAiC;AAC/B,aAAO,EAAP;AACD;;AAED,WAAON,iBAAiB,CAACM,cAAD,EAAiB;AACvCL,MAAAA,SADuC;AAEvCE,MAAAA,OAFuC;AAGvCD,MAAAA,OAAO,EAAE,CAAC2E,YAH6B;AAIvCzE,MAAAA,OAAO,EAAE,CAACyE,YAAD,IAAgB,CAAC,EAACkD,aAAD,aAACA,aAAD,uBAACA,aAAa,CAAEtI,KAAhB;AAJa,KAAjB,CAAxB;AAMD,GAXwC,EAWtC,CAACsI,aAAD,EAAgBh5B,OAAhB,EAAyBuxB,cAAzB,EAAyCL,SAAzC,EAAoDE,OAApD,EAA6D0E,YAA7D,CAXsC,CAAzC;AAaA,MAAM2G,cAAc,GAClBz8B,OAAO,IAAIA,OAAO,CAACgB,IAAR,KAAiB,SAA5B,IAAyChB,OAAO,CAACo5B,MAAR,KAAmB,UAD9D;AAGA,SACE8D,kBAAkB,iBAChB7hC,6BAAC,kBAAD,eACMS,KADN;AAEE,IAAA,OAAO,EAAEq0B,OAFX;AAGE,IAAA,UAAU,EAAEuK,UAHd;AAIE,IAAA,iBAAiB,EAAEpK,SAJrB;AAKE,IAAA,eAAe,EAAED,OALnB;AAME,IAAA,WAAW,EAAEsB,WANf;AAOE,IAAA,cAAc,EAAE8K,cAPlB;AAQE,IAAA,OAAO,EAAES,kBARX;AASE,IAAA,cAAc,EAAErQ,cATlB;AAUE,IAAA,iBAAiB,EAAEuQ,qBAVrB;AAWE,IAAA,UAAU,EAAE7G,UAXd;AAYE,IAAA,UAAU,EAAEC,UAZd;AAaE,IAAA,YAAY,EAAE8E,YAbhB;AAcE,IAAA,YAAY,EAAE5E,YAdhB;AAeE,IAAA,UAAU,EAAErG,OAfd;AAgBE,IAAA,WAAW,EAAEoL,WAhBf;AAiBE,IAAA,gBAAgB,EAAE7C,gBAjBpB;AAkBE,IAAA,WAAW,EAAE;AAAA,aAAM9C,YAAN;AAAA,KAlBf;AAmBE,IAAA,aAAa,EAAEkD,aAnBjB;AAoBE,IAAA,sBAAsB,EAAE7F,eApB1B;AAqBE,IAAA,sBAAsB,EAAEE,eArB1B;AAsBE,IAAA,WAAW,EAAEoC,WAtBf;AAuBE,IAAA,WAAW,EAAEE;AAvBf,KAFJ;AA6BD,CA/FD;;AAiGA2G,OAAO,CAACpzB,SAAR,GAAoB;AAClB;AACAlJ,EAAAA,OAAO;AAAE;AAA2EmJ,EAAAA,SAAS,CAAC0D,KAAV,CAClF;AACEzO,IAAAA,IAAI,EAAE+K,SAAS,CAACC,MAAV,CAAiBC,UADzB;AAEE+oB,IAAAA,IAAI,EAAEjpB,SAAS,CAACC,MAAV,CAAiBC,UAFzB;AAGErI,IAAAA,IAAI,EAAEmI,SAAS,CAACC,MAAV,CAAiBC,UAHzB;AAIEqjB,IAAAA,eAAe,EAAEvjB,SAAS,CAACwlB,QAAV,CAAmBxlB,SAAS,CAACoE,MAAV,CAAiBlE,UAApC,CAJnB;AAKEg0B,IAAAA,eAAe,EAAEl0B,SAAS,CAACwlB,QAAV,CAAmBxlB,SAAS,CAACoE,MAAV,CAAiBlE,UAApC,CALnB;AAMEvK,IAAAA,UAAU,EAAEqK,SAAS,CAACC,MAAV,CAAiBC,UAN/B;AAOEipB,IAAAA,UAAU,EAAEnpB,SAAS,CAACC,MAAV,CAAiBC;AAP/B,GADkF,EAUlFA,UAZgB;;AAalB;AACA9N,EAAAA,MAAM,EAAE4N,SAAS,CAAC2W,UAAV,CAAqBtkB,qBAArB,EAAiC6N,UAdvB;;AAelB;AACAoU,EAAAA,OAAO,EAAEtU,SAAS,CAAC2W,UAAV,CAAqBC,kBAArB,EAA8B1W,UAhBrB;;AAiBlB;AACAqoB,EAAAA,MAAM,EAAEvoB,SAAS,CAACG,KAlBA;;AAmBlB;AACAqoB,EAAAA,WAAW,EAAExoB,SAAS,CAACG,KApBL;;AAsBlB;AACAoxB,EAAAA,UAAU,EAAEvxB,SAAS,CAACI,IAvBJ;;AAwBlB;;;;AAIA+yB,EAAAA,OAAO;AAAE;AAAgGnzB,EAAAA,SAAS,CAACkH,WA5BjG;;AA6BlB;;;;AAIA8pB,EAAAA,cAAc;AAAE;AAA4FhxB,EAAAA,SAAS,CAACkH,WAjCpG;;AAmClB;;;AAGAoe,EAAAA,gBAAgB;AAAE;AAA8FtlB,EAAAA,SAAS,CAACkH,WAtCxG;;AAuClB;;;AAGAue,EAAAA,aAAa;AAAE;AAA2FzlB,EAAAA,SAAS,CAACkH,WA1ClG;;AA2ClB;;;;AAIAT,EAAAA,UAAU;AAAE;AAAmGzG,EAAAA,SAAS,CAACkH,WA/CvG;;AAgDlB;AACAwpB,EAAAA,UAAU,EAAE1wB,SAAS,CAACqE,IAjDJ;;AAkDlB;;;;AAIA+jB,EAAAA,cAAc,EAAEpoB,SAAS,CAACozB,SAAV,CAAoB,CAACpzB,SAAS,CAACqE,IAAX,EAAiBrE,SAAS,CAACG,KAA3B,CAApB,CAtDE;;AAuDlB;;;;;;;;AAQAiuB,EAAAA,iCAAiC,EAAEpuB,SAAS,CAACI,IA/D3B;;AAgElB;;;;;;;;AAQA+tB,EAAAA,+BAA+B,EAAEnuB,SAAS,CAACI,IAxEzB;;AAyElB;;;;;;;;AAQA6tB,EAAAA,8BAA8B,EAAEjuB,SAAS,CAACI,IAjFxB;;AAkFlB;;;;;;;;AAQA8tB,EAAAA,4BAA4B,EAAEluB,SAAS,CAACI,IA1FtB;;AA2FlB;AACAqoB,EAAAA,cAAc,EAAEzoB,SAAS,CAACC,MA5FR;;AA6FlB;AACAyoB,EAAAA,eAAe;AAAE;AAA6C1oB,EAAAA,SAAS,CAACmF,MA9FtD;;AA+FlB;AACA+P,EAAAA,OAAO;AAAE;AAAwJlV,EAAAA,SAAS,CAACmF,MAhGzJ;;AAiGlB;;;;;;AAMA4oB,EAAAA,eAAe,EAAE/tB,SAAS,CAACI,IAvGT;;AAwGlB;AACAimB,EAAAA,aAAa,EAAErmB,SAAS,CAACI,IAzGP;;AA0GlB;AACAkmB,EAAAA,aAAa,EAAEtmB,SAAS,CAACI,IA3GP;;AA4GlB;AACAgsB,EAAAA,gBAAgB,EAAEpsB,SAAS,CAACI,IA7GV;;AA8GlB;AACA4pB,EAAAA,eAAe,EAAEhqB,SAAS,CAACI,IA/GT;;AAgHlB;AACA8pB,EAAAA,eAAe,EAAElqB,SAAS,CAACI,IAjHT;;AAkHlB;;;;;;AAMAksB,EAAAA,WAAW,EAAEtsB,SAAS,CAACI,IAxHL;;AAyHlB;;;;;;AAMAosB,EAAAA,WAAW,EAAExsB,SAAS,CAACI,IA/HL;;AAgIlB;AACAyqB,EAAAA,UAAU,EAAE7qB,SAAS,CAACI,IAjIJ;;AAkIlB;;;;AAIA0yB,EAAAA,2BAA2B,EAAE9yB,SAAS,CAACmF;AAtIrB,CAApB;AAyIAguB,OAAO,CAACpc,YAAR,GAAuB;AACrBoc,EAAAA,OAAO,EAAEnB,eADY;AAErBzJ,EAAAA,MAAM,EAAE,EAFa;AAGrBC,EAAAA,WAAW,EAAE,EAHQ;AAIrBJ,EAAAA,cAAc,EAAEzzB,MAAM,CAACqB,IAAP,CAAYyxB,eAAZ;AAJK,CAAvB;AAOA,6BAAev1B,cAAK,CAACmO,IAAN,CAAW8yB,OAAX,EAAoB9K,oBAApB,CAAf;;ACnPA;;;;;;;AAMA,IAAM8L,eAAe,GAAG,SAAlBA,eAAkB,CAACxhC,KAAD,EAAW;AAAA;;AAAA,MAE/BkE,OAF+B,GAiB7BlE,KAjB6B,CAE/BkE,OAF+B;AAAA,MAG/B06B,UAH+B,GAiB7B5+B,KAjB6B,CAG/B4+B,UAH+B;AAAA,MAI/B/I,WAJ+B,GAiB7B71B,KAjB6B,CAI/B61B,WAJ+B;AAAA,MAK/B8K,cAL+B,GAiB7B3gC,KAjB6B,CAK/B2gC,cAL+B;AAAA,MAM/B1D,UAN+B,GAiB7Bj9B,KAjB6B,CAM/Bi9B,UAN+B;AAAA,MAO/BoB,cAP+B,GAiB7Br+B,KAjB6B,CAO/Bq+B,cAP+B;AAAA,MAQ/BlJ,iBAR+B,GAiB7Bn1B,KAjB6B,CAQ/Bm1B,iBAR+B;AAAA,6BAiB7Bn1B,KAjB6B,CAS/B8yB,aAT+B;AAAA,MAS/BA,aAT+B,qCASf2O,oBATe;AAAA,8BAiB7BzhC,KAjB6B,CAU/B2yB,gBAV+B;AAAA,MAU/BA,gBAV+B,sCAUZ8K,uBAVY;AAAA,MAWfgC,kBAXe,GAiB7Bz/B,KAjB6B,CAW/B+wB,cAX+B;AAAA,MAYjBwO,gBAZiB,GAiB7Bv/B,KAjB6B,CAY/Bw/B,YAZ+B;AAAA,MAab3C,oBAba,GAiB7B78B,KAjB6B,CAa/B88B,gBAb+B;AAAA,MAclBkE,eAdkB,GAiB7BhhC,KAjB6B,CAc/B25B,WAd+B;AAAA,MAelBsH,eAfkB,GAiB7BjhC,KAjB6B,CAe/B65B,WAf+B;AAAA,MAgBdiG,mBAhBc,GAiB7B9/B,KAjB6B,CAgB/Ba,eAhB+B;AAkBjC,MAAMiT,YAAU,GAAG9T,KAAK,CAAC8T,UAAN,IAAoBmsB,UAAvC;AACA,MAAMhC,YAAY,GAAGhI,mBAAmB,CAAC/xB,OAAD,CAAxC;AACA,MAAMs7B,YAAY,GAAG/L,gBAAgB,CAACvvB,OAAD,CAArC;AACA,MAAM6sB,cAAc,GAAGqH,kBAAkB,CAACl0B,OAAD,CAAzC;AACA,MAAM44B,gBAAgB,GAAG/E,oBAAoB,CAAC7zB,OAAD,CAA7C;AACA,MAAM20B,mBAAmB,GAAG9qB,YAAM,CAAC,IAAD,CAAlC;;AAvBiC,0BAwBsB6qB,gBAAgB,CACrE10B,OADqE,EAErE20B,mBAFqE,CAxBtC;AAAA,MAwBzBQ,mBAxByB,qBAwBzBA,mBAxByB;AAAA,MAwBJN,qBAxBI,qBAwBJA,qBAxBI;;AAAA,wBA4BIW,cAAc,CAACx1B,OAAD,EAAU;AAC3D01B,IAAAA,kBAAkB,EAAEoH,eADuC;AAE3DlH,IAAAA,kBAAkB,EAAEmH;AAFuC,GAAV,CA5BlB;AAAA,MA4BzBtH,WA5ByB,mBA4BzBA,WA5ByB;AAAA,MA4BZE,WA5BY,mBA4BZA,WA5BY;;AAAA,qBAgCTE,WAAW,CAAC71B,OAAD,CAhCF;AAAA,MAgCzB81B,WAhCyB,gBAgCzBA,WAhCyB;;AAiCjC,MAAMsE,cAAc,oEAClBtE,WAAW,GAAG,OAAH,GAAa,MADN,CAApB;AAIA,MAAMkE,aAAa,GAAGhI,qBAAqB,CAAChyB,OAAD,CAA3C;AACA,MAAM+M,MAAM,GAAGklB,SAAS,CAACjyB,OAAD,CAAxB;AAEA,MAAMw9B,eAAe,GAAG7L,WAAW,GAAGA,WAAW,CAAC,CAAD,CAAd,GAAoB,EAAvD;;AAEA,MAAI3xB,OAAJ,aAAIA,OAAJ,uBAAIA,OAAO,CAAEge,UAAb,EAAyB;AACvB,WAAO3b,WAAW,CAAC83B,cAAD,EAAiBr+B,KAAjB,EAAwB,IAAxB,CAAlB;AACD;;AAED,MACEkE,OAAO,KACNA,OAAO,CAACgB,IAAR,KAAiB,cAAjB,IAAmChB,OAAO,CAACgB,IAAR,KAAiB,cAD9C,CADT,EAGE;AACA,WAAO,IAAP;AACD,GAnDgC;;;AAsDjC,sBACE3F,6BAACA,cAAD,CAAO,QAAP,qBACEA;AACE,mBAAY,0BADd;AAEE,IAAA,GAAG,EAAE,CAAA2E,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEvC,EAAT,KAAe,EAFtB;AAGE,IAAA,SAAS,EAAE,wBACX28B,cADW,uDAEiBp6B,OAFjB,aAEiBA,OAFjB,uBAEiBA,OAAO,CAAEgB,IAF1B,2BAIL,CAAAhB,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAE5B,IAAT,IACI,sCADJ,GAEI,yCANC,2BAQX47B,aAAa,GAAG,4CAAH,GAAkD,EARpD,2BASXD,YAAY,GAAG,4CAAH,GAAkD,EATnD,0DAUoByD,eAVpB,mBAWZtkB,IAXY;AAHb,KAgBG,CAACskB,eAAe,KAAK,QAApB,IAAgCA,eAAe,KAAK,QAArD,kBACCniC,6BAAC,MAAD;AACE,IAAA,KAAK,EAAE2E,OAAF,aAAEA,OAAF,wCAAEA,OAAO,CAAER,IAAX,kDAAE,cAAewM,KADxB;AAEE,IAAA,IAAI,EAAE,EAFR;AAGE,IAAA,IAAI,EAAE,CAAAhM,OAAO,SAAP,IAAAA,OAAO,WAAP,8BAAAA,OAAO,CAAER,IAAT,kEAAevD,IAAf,MAAuB+D,OAAvB,aAAuBA,OAAvB,yCAAuBA,OAAO,CAAER,IAAhC,mDAAuB,eAAe/B,EAAtC,CAHR;AAIE,IAAA,OAAO,EAAEg4B,WAJX;AAKE,IAAA,WAAW,EAAEE;AALf,IAjBJ,eAyBEt6B;AAAK,IAAA,SAAS,EAAC;AAAf,KACG2E,OAAO,IAAI,CAACA,OAAO,CAAC5B,IAApB,iBACC/C,6BAACA,cAAD,CAAO,QAAP,qBAEIA,6BAAC,cAAD,eACMS,KADN;AAEE,IAAA,WAAW,EAAE,KAFf;AAGE,IAAA,cAAc,EAAE,KAHlB;AAIE,IAAA,cAAc,EAAE,KAJlB;AAKE,IAAA,mBAAmB,EAAEq5B,mBALvB;AAME,IAAA,KAAK,EAAE;AANT,KAFJ,EAYG4E,YAAY,IAAI,CAAClF,qBAAjB,iBACCx5B,6BAAC,aAAD;AACE,IAAA,SAAS,EAAE2E,OAAO,CAACysB,gBADrB;AAEE,IAAA,eAAe,EAAEzsB,OAAO,CAAC0sB,eAF3B;AAGE,IAAA,OAAO,EAAEyI;AAHX,IAbJ,EAmBGN,qBAAqB,iBACpBx5B,6BAAC,gBAAD;AACE,IAAA,OAAO,EAAE,KADX;AAEE,IAAA,cAAc,EAAEkgC,kBAAkB,IAAI1O,cAFxC;AAGE,IAAA,YAAY,MAHd;AAIE,IAAA,eAAe,EAAE7sB,OAAO,CAAC0sB,eAJ3B;AAKE,IAAA,gBAAgB,EAAE1sB,OAAO,CAACysB,gBAL5B;AAME,IAAA,GAAG,EAAEkI;AANP,IApBJ,CAFJ,EAkCG,CAAA30B,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEke,WAAT,MACE,CAACnR,MAAD,IAAWA,MAAM,CAACpN,MAAP,IAAiB,CAD9B,KAECK,OAAO,CAACke,WAAR,CAAoB5d,GAApB,CAAwB,UAACgM,UAAD,EAAaW,KAAb;AAAA,wBACtB5R,6BAACuU,YAAD;AACE,MAAA,GAAG,YAAK5P,OAAO,CAACvC,EAAb,cAAmBwP,KAAnB,CADL;AAEE,MAAA,UAAU,EAAEX,UAFd;AAGE,MAAA,aAAa,EAAE+uB,gBAAgB,IAAIC;AAHrC,MADsB;AAAA,GAAxB,CApCJ,EA4CG,CAAC,CAACvuB,MAAM,CAACpN,MAAT,iBAAmBtE,6BAACoS,SAAD;AAAS,IAAA,MAAM,EAAEV;AAAjB,IA5CtB,EA8CG,CAAA/M,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAE5B,IAAT,kBACC/C,6BAAC,WAAD;AACE,IAAA,gBAAgB,EAAEozB,gBADpB;AAEE,IAAA,aAAa,EAAEG,aAFjB;AAGE,IAAA,cAAc,EAAE6N,cAHlB;AAIE,IAAA,kBAAkB,EAAC,iCAJrB;AAKE,IAAA,gBAAgB,EAAC,uCALnB;AAME,IAAA,iBAAiB,EAAE;AACjBhE,MAAAA,WAAW,EAAE,KADI;AAEjBC,MAAAA,cAAc,EAAE,KAFC;AAGjBF,MAAAA,cAAc,EAAE,KAHC;AAIjBM,MAAAA,KAAK,EAAE;AAJU,KANrB;AAYE,IAAA,iBAAiB,EAAE7H,iBAZrB;AAaE,IAAA,OAAO,EAAEjxB,OAbX;AAcE,IAAA,eAAe,EAAElE,KAAK,CAAC+1B,eAdzB;AAeE,IAAA,UAAU,EAAE/1B,KAAK,CAAC+9B,UAfpB;AAgBE,IAAA,sBAAsB,EAAE/9B,KAAK,CAAC29B,sBAhBhC;AAiBE,IAAA,sBAAsB,EAAE39B,KAAK,CAAC69B,sBAjBhC;AAkBE,IAAA,KAAK,EAAC;AAlBR,IA/CJ,EAoEG,CAACZ,UAAD,iBACC19B;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAColB,2BAAD;AACE,IAAA,OAAO,EAAEkY,oBAAoB,IAAIC,gBADnC;AAEE,IAAA,WAAW,EAAE54B,OAAF,aAAEA,OAAF,uBAAEA,OAAO,CAAE0gB;AAFxB,IADF,CArEJ,eA4EErlB;AAAK,IAAA,SAAS,EAAC;AAAf,KACG,CAACy6B,WAAD,gBACCz6B;AAAM,IAAA,SAAS,EAAC;AAAhB,KACG,CAAA2E,OAAO,SAAP,IAAAA,OAAO,WAAP,8BAAAA,OAAO,CAAER,IAAT,kEAAevD,IAAf,MAAuB+D,OAAvB,aAAuBA,OAAvB,yCAAuBA,OAAO,CAAER,IAAhC,mDAAuB,eAAe/B,EAAtC,CADH,CADD,GAIG,IALN,eAMEpC,6BAACy/B,kBAAD;AACE,IAAA,UAAU,EAAEJ,UADd;AAEE,IAAA,WAAW,EAAC,sCAFd;AAGE,IAAA,OAAO,EAAE16B,OAHX;AAIE,IAAA,eAAe,EAAE47B,mBAJnB;AAKE,IAAA,MAAM,EAAC;AALT,IANF,CA5EF,CAzBF,CADF,CADF;AAyHD,CA/KD;;AAiLA0B,eAAe,CAACp0B,SAAhB,GAA4B;AAC1B;AACAlJ,EAAAA,OAAO;AAAE;AAA2EmJ,EAAAA,SAAS,CAC1FmF,MADiF,CAC1EjF,UAHgB;;AAI1B;;;;AAIAuG,EAAAA,UAAU;AAAE;AAAmGzG,EAAAA,SAAS,CAACkH,WAR/F;;AAS1B;;;;;;;;AAQAisB,EAAAA,OAAO;AAAE;AAAgGnzB,EAAAA,SAAS,CAACozB,SAAV,CACvG,CAACpzB,SAAS,CAACqzB,IAAX,EAAiBrzB,SAAS,CAACI,IAA3B,EAAiCJ,SAAS,CAACmF,MAA3C,CADuG,CAjB/E;;AAoB1B;AACAurB,EAAAA,UAAU,EAAE1wB,SAAS,CAACqE,IArBI;;AAsB1B;AACAqrB,EAAAA,cAAc,EAAE1vB,SAAS,CAACqE,IAvBA;;AAwB1B;AACAwrB,EAAAA,aAAa;AAAE;AAAyE7vB,EAAAA,SAAS,CAACmF,MAzBxE;;AA2B1B;AACAosB,EAAAA,UAAU,EAAEvxB,SAAS,CAACI,IA5BI;;AA8B1B;AACAwvB,EAAAA,UAAU,EAAE5vB,SAAS,CAACqE,IA/BI;;AAgC1B;;;;;AAKAorB,EAAAA,gBAAgB,EAAEzvB,SAAS,CAACI,IArCF;;AAsC1B;AACAusB,EAAAA,WAAW,EAAE3sB,SAAS,CAACI,IAvCG;;AAwC1B;AACA0nB,EAAAA,iBAAiB,EAAE9nB,SAAS,CAACI,IAAV,CAAeF,UAzCR;;AA0C1B;;;;;;;AAOAwjB,EAAAA,cAAc,EAAE1jB,SAAS,CAACI,IAjDA;;AAkD1B;;;AAGAklB,EAAAA,gBAAgB;AAAE;AAA8FtlB,EAAAA,SAAS,CAACkH,WArDhG;;AAsD1B;;;AAGAue,EAAAA,aAAa;AAAE;AAA2FzlB,EAAAA,SAAS,CAACkH,WAzD1F;;AA0D1B;AACAosB,EAAAA,cAAc,EAAEtzB,SAAS,CAACqE,IA3DA;;AA4D1B;;;;;;AAMA8tB,EAAAA,YAAY,EAAEnyB,SAAS,CAACI,IAlEE;;AAmE1B;;;;;;AAMAowB,EAAAA,sBAAsB,EAAExwB,SAAS,CAACI,IAzER;;AA0E1B;;;;;;AAMAkwB,EAAAA,sBAAsB,EAAEtwB,SAAS,CAACI,IAhFR;;AAiF1B;AACAooB,EAAAA,WAAW,EAAExoB,SAAS,CAACG,KAlFG;;AAmF1B;;;;;;AAMAmsB,EAAAA,WAAW,EAAEtsB,SAAS,CAACI,IAzFG;;AA0F1B;;;;;;AAMAosB,EAAAA,WAAW,EAAExsB,SAAS,CAACI,IAhGG;;AAiG1B;;;AAGA4wB,EAAAA,cAAc;AAAE;AAA4FhxB,EAAAA,SAAS,CAACkH;AApG5F,CAA5B;AAuGA,qCAAehV,cAAK,CAACmO,IAAN,CAAW8zB,eAAX,EAA4B9L,oBAA5B,CAAf;;AChRA;;;;;;;;AAQA;;AACA,IAAMiM,0BAA0B,GAAG,SAA7BA,0BAA6B,CAAC3hC,KAAD,EAAW;AAAA;;AAAA,MAE1CkE,OAF0C,GA0BxClE,KA1BwC,CAE1CkE,OAF0C;AAAA,MAG1C2xB,WAH0C,GA0BxC71B,KA1BwC,CAG1C61B,WAH0C;AAAA,MAIjC+L,WAJiC,GA0BxC5hC,KA1BwC,CAI1Cq0B,OAJ0C;AAAA,MAKzBwN,WALyB,GA0BxC7hC,KA1BwC,CAK1Cq7B,eAL0C;AAAA,MAMvByG,aANuB,GA0BxC9hC,KA1BwC,CAM1CkqB,iBAN0C;AAAA,MAO1C6S,cAP0C,GA0BxC/8B,KA1BwC,CAO1C+8B,cAP0C;AAAA,MAQ1CgB,UAR0C,GA0BxC/9B,KA1BwC,CAQ1C+9B,UAR0C;AAAA,MAS1Ca,UAT0C,GA0BxC5+B,KA1BwC,CAS1C4+B,UAT0C;AAAA,MAU3BmD,iBAV2B,GA0BxC/hC,KA1BwC,CAU1Ck9B,aAV0C;AAAA,6BA0BxCl9B,KA1BwC,CAW1C8yB,aAX0C;AAAA,MAW1CA,aAX0C,qCAW1B2O,sBAX0B;AAAA,8BA0BxCzhC,KA1BwC,CAY1C2yB,gBAZ0C;AAAA,MAY1CA,gBAZ0C,sCAYvB8K,uBAZuB;AAAA,MAa7BuD,eAb6B,GA0BxChhC,KA1BwC,CAa1C25B,WAb0C;AAAA,MAc1B8F,kBAd0B,GA0BxCz/B,KA1BwC,CAc1C+wB,cAd0C;AAAA,MAexB8L,oBAfwB,GA0BxC78B,KA1BwC,CAe1C88B,gBAf0C;AAAA,MAgB7BmE,eAhB6B,GA0BxCjhC,KA1BwC,CAgB1C65B,WAhB0C;AAAA,MAiB7B6F,eAjB6B,GA0BxC1/B,KA1BwC,CAiB1C2/B,WAjB0C;AAAA,MAkB5BJ,gBAlB4B,GA0BxCv/B,KA1BwC,CAkB1Cw/B,YAlB0C;AAAA,MAmB3BF,iBAnB2B,GA0BxCt/B,KA1BwC,CAmB1C0zB,aAnB0C;AAAA,MAoBlBgK,mBApBkB,GA0BxC19B,KA1BwC,CAoB1C29B,sBApB0C;AAAA,MAqBlBC,mBArBkB,GA0BxC59B,KA1BwC,CAqB1C69B,sBArB0C;AAAA,0BA0BxC79B,KA1BwC,CAsB1C8T,UAtB0C;AAAA,MAsB1CA,YAtB0C,kCAsB7BmsB,UAtB6B;AAAA,MAuBvC+B,KAvBuC,GA0BxChiC,KA1BwC,CAuB1CW,CAvB0C;AAAA,MAwBzBm/B,mBAxByB,GA0BxC9/B,KA1BwC,CAwB1Ca,eAxB0C;AAAA,MAyB1Cw9B,cAzB0C,GA0BxCr+B,KA1BwC,CAyB1Cq+B,cAzB0C;;AAAA,oBA2BpBpuB,gBAAU,CAACvP,kBAAD,CA3BU;AAAA,MA2BjCuhC,QA3BiC,eA2BpCthC,CA3BoC;;AA4B5C,MAAMA,CAAC,GAAGqhC,KAAK,IAAIC,QAAnB;AACA,MAAMnJ,iBAAiB,GAAG/qB,YAAM,CAAC,IAAD,CAAhC;AACA,MAAM8qB,mBAAmB,GAAG9qB,YAAM,CAAC,IAAD,CAAlC;AACA;;;;AA/B4C,qBAkCakC,gBAAU,CACjE5P,cADiE,CAlCvB;AAAA,MAkCrB0/B,oBAlCqB,gBAkCpCrM,aAlCoC;AAAA,MAkCC/R,OAlCD,gBAkCCA,OAlCD;;AAqC5C,MAAMub,aAAa,GAAG6E,iBAAiB,KAAIpgB,OAAJ,aAAIA,OAAJ,uBAAIA,OAAO,CAAE+J,SAAT,EAAJ,CAAvC;;AArC4C,8BAsCC8L,oBAAoB,CAACtzB,OAAD,EAAU;AACzEmzB,IAAAA,eAAe,EAAEqG,mBADwD;AAEzEnG,IAAAA,eAAe,EAAEqG;AAFwD,GAAV,CAtCrB;AAAA,MAsCpCvG,eAtCoC,yBAsCpCA,eAtCoC;AAAA,MAsCnBE,eAtCmB,yBAsCnBA,eAtCmB;;AA0C5C,MAAMiI,YAAY,GAAG/L,gBAAgB,CAACvvB,OAAD,CAArC;AACA,MAAM6sB,cAAc,GAAGqH,kBAAkB,CAACl0B,OAAD,CAAzC;AACA,MAAM44B,gBAAgB,GAAG/E,oBAAoB,CAAC7zB,OAAD,CAA7C;;AA5C4C,wBAiDxC+vB,cAAc,EAjD0B;AAAA,MA8CjCiO,UA9CiC,mBA8C1C7N,OA9C0C;AAAA,MA+CjC8N,aA/CiC,mBA+C1C5N,OA/C0C;AAAA,MAgD/B6N,eAhD+B,mBAgD1C5N,SAhD0C;;AAkD5C,MAAMH,OAAO,GAAGuN,WAAW,IAAIM,UAA/B;AACA,MAAM3N,OAAO,GAAGsN,WAAW,IAAIM,aAA/B;AACA,MAAM3N,SAAS,GAAGsN,aAAa,IAAIM,eAAnC;AACA,MAAMzC,WAAW,GAAGrG,eAAe,EAAnC;AACA,MAAM8G,YAAY,GAAGV,eAAe,IAAIC,WAAxC;;AAtD4C,0BAuDW/G,gBAAgB,CACrE10B,OADqE,EAErE20B,mBAFqE,EAGrEC,iBAHqE,CAvD3B;AAAA,MAuDpCO,mBAvDoC,qBAuDpCA,mBAvDoC;AAAA,MAuDfN,qBAvDe,qBAuDfA,qBAvDe;;AAAA,wBA4DPW,cAAc,CAACx1B,OAAD,EAAU;AAC3D01B,IAAAA,kBAAkB,EAAEoH,eADuC;AAE3DlH,IAAAA,kBAAkB,EAAEmH;AAFuC,GAAV,CA5DP;AAAA,MA4DpCtH,WA5DoC,mBA4DpCA,WA5DoC;AAAA,MA4DvBE,WA5DuB,mBA4DvBA,WA5DuB;;AAgE5C,MAAMsE,WAAW,GAAGlsB,aAAO,CACzB;AAAA,WAAMpN,UAAU,CAACX,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAE5B,IAAV,EAAgB4B,OAAhB,aAAgBA,OAAhB,uBAAgBA,OAAO,CAAEY,eAAzB,CAAhB;AAAA,GADyB,EAEzB,CAACZ,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAE5B,IAAV,EAAgB4B,OAAhB,aAAgBA,OAAhB,uBAAgBA,OAAO,CAAEY,eAAzB,CAFyB,CAA3B;AAKA,MAAMo5B,aAAa,GAAGhI,qBAAqB,CAAChyB,OAAD,CAA3C;AACA,MAAMm+B,aAAa,GAAGlM,SAAS,CAACjyB,OAAD,CAA/B;AACA,MAAMke,WAAW,GAAGgU,sBAAsB,CAAClyB,OAAD,CAA1C;AACA,MAAMw9B,eAAe,GAAG7L,WAAW,GAAGA,WAAW,CAAC,CAAD,CAAd,GAAoB,EAAvD;;AAEA,MACE,CAAC3xB,OAAD,IACAA,OAAO,CAACgB,IAAR,KAAiB,cADjB,IAEAhB,OAAO,CAACgB,IAAR,KAAiB,cAHnB,EAIE;AACA,WAAO,IAAP;AACD;;AAED,MAAIhB,OAAO,CAACge,UAAZ,EAAwB;AACtB,WAAO3b,WAAW,CAAC83B,cAAD,EAAiBr+B,KAAjB,EAAwB,IAAxB,CAAlB;AACD;;AACD,MAAIq0B,OAAJ,EAAa;AAAA;;AACX,wBACE90B;AACE,qBAAa,yBADf;AAEE,MAAA,SAAS,2DAAoDmiC,eAApD;AAFX,OAIG,CAACA,eAAe,KAAK,KAApB,IAA6BA,eAAe,KAAK,QAAlD,kBACCniC;AAAK,MAAA,SAAS,EAAC;AAAf,oBACEA,6BAAC,MAAD;AACE,MAAA,KAAK,mBAAE2E,OAAO,CAACR,IAAV,kDAAE,cAAcwM,KADvB;AAEE,MAAA,IAAI,EAAE,mBAAAhM,OAAO,CAACR,IAAR,kEAAcvD,IAAd,wBAAsB+D,OAAO,CAACR,IAA9B,mDAAsB,eAAc/B,EAApC,CAFR;AAGE,MAAA,IAAI,EAAE,EAHR;AAIE,MAAA,OAAO,EAAEg4B,WAJX;AAKE,MAAA,WAAW,EAAEE;AALf,MADF,CALJ,eAeEt6B,6BAAC6wB,cAAD;AACE,MAAA,KAAK,EAAEG,eADT;AAEE,MAAA,OAAO,EAAErsB,OAFX;AAGE,MAAA,iBAAiB,EAAEswB,SAHrB;AAIE,MAAA,aAAa,EAAE8K,iBAAiB,IAAIS;AAJtC,MAfF,CADF;AAwBD;;AAED,sBACExgC,6BAACA,cAAD,CAAO,QAAP,qBACEA;AACE,mBAAY,oBADd;AAEE,IAAA,SAAS,uEAAgEmiC,eAAhE,4CACPx9B,OAAO,CAACgB,IADD,4CAEyBhB,OAAO,CAACo5B,MAFjC,cAGPP,cAAc,GAAG,+CAAH,GAAqD,EAH5D,CAFX;AAOE,IAAA,GAAG,EAAEjE;AAPP,KASGC,qBAAqB,iBACpBx5B,6BAAC,gBAAD;AACE,IAAA,OAAO,EAAE,KADX;AAEE,IAAA,cAAc,EAAEwxB,cAFlB;AAGE,IAAA,YAAY,MAHd;AAIE,IAAA,gBAAgB,EAAE7sB,OAAF,aAAEA,OAAF,uBAAEA,OAAO,CAAEysB,gBAJ7B;AAKE,IAAA,eAAe,EAAEzsB,OAAF,aAAEA,OAAF,uBAAEA,OAAO,CAAE0sB,eAL5B;AAME,IAAA,GAAG,EAAEiI;AANP,IAVJ,eAmBEt5B,6BAAC,wBAAD;AACE,IAAA,cAAc,EAAEw9B,cADlB;AAEE,IAAA,OAAO,EAAE74B,OAFX;AAGE,IAAA,UAAU,EAAE06B,UAHd;AAIE,IAAA,mBAAmB,EAAEvF,mBAJvB;AAKE,IAAA,iBAAiB,EAAEP,iBALrB;AAME,IAAA,iBAAiB,EAAE94B,KAAK,CAACm1B,iBAN3B;AAOE,IAAA,eAAe,EAAE2K,mBAPnB;AAQE,IAAA,aAAa,EAAE5C,aARjB;AASE,IAAA,UAAU,EAAEl9B,KAAK,CAACi9B,UATpB;AAUE,IAAA,gBAAgB,EAAEJ,oBAAoB,IAAIC,gBAV5C;AAWE,IAAA,eAAe,EAAEvI;AAXnB,IAnBF,eAgCEh1B;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC,MAAD;AACE,IAAA,KAAK,oBAAE2E,OAAO,CAACR,IAAV,mDAAE,eAAcwM,KADvB;AAEE,IAAA,IAAI,EAAE,mBAAAhM,OAAO,CAACR,IAAR,kEAAcvD,IAAd,MAAsB+D,OAAtB,aAAsBA,OAAtB,yCAAsBA,OAAO,CAAER,IAA/B,mDAAsB,eAAe/B,EAArC,CAFR;AAGE,IAAA,IAAI,EAAE,EAHR;AAIE,IAAA,OAAO,EAAEg4B,WAJX;AAKE,IAAA,WAAW,EAAEE;AALf,IADF,CAhCF,eAyCEt6B;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6CAAS,mBAAA2E,OAAO,CAACR,IAAR,kEAAcvD,IAAd,wBAAsB+D,OAAO,CAACR,IAA9B,mDAAsB,eAAc/B,EAApC,CAAT,CADF,EAEG,CAAAuC,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEgB,IAAT,MAAkB,OAAlB,iBACC3F;AAAK,IAAA,SAAS,EAAC;AAAf,KACGoB,CAAC,CAAC,qBAAD,CADJ,CAHJ,CADF,eAUEpB;AACE,mBAAY,yBADd;AAEE,IAAA,SAAS,EACP8C,YAAY,CAAC6B,OAAO,CAAC5B,IAAT,CAAZ,GACI,6CADJ,GAEI,EALR;AAOE,IAAA,WAAW,EAAEi1B,eAPf;AAQE,IAAA,OAAO,EAAEF;AARX,KAUGnzB,OAAO,CAACgB,IAAR,KAAiB,OAAjB,IACChB,OAAO,CAACo5B,MAAR,KAAmB,QADpB,IAEC,CAACS,UAFF,IAGCI,WAbJ,EAeGj6B,OAAO,CAACgB,IAAR,KAAiB,OAAjB,IACChB,OAAO,CAACo5B,MAAR,KAAmB,QADpB,IAECS,UAFD,iBAGGx+B;AAAK,IAAA,uBAAuB,EAAE;AAAE0Y,MAAAA,MAAM,EAAE/T,OAAO,CAACoyB;AAAlB;AAA9B,IAlBN,EAqBGpyB,OAAO,CAACgB,IAAR,KAAiB,OAAjB,IAA4B,CAAChB,OAAO,CAACie,OAArC,iBACC5iB;AAAG,mBAAY;AAAf,kBACEA,6BAAC,SAAD,OADF,EAEG2E,OAAO,CAAC5B,IAFX,CAtBJ,EA4BG4B,OAAO,CAACgB,IAAR,KAAiB,OAAjB,IAA4BhB,OAAO,CAACie,OAApC,iBACC5iB;AAAG,mBAAY;AAAf,kBACEA,6BAAC,SAAD,OADF,eAGEA,kDAAU2E,OAAO,CAACie,OAAlB,CAHF,4BA7BJ,EAmCGje,OAAO,CAACo5B,MAAR,KAAmB,QAAnB,iBACC/9B;AACE,IAAA,OAAO,EAAE,mBAAM;AACb,UAAI6gC,YAAJ,EAAkB;AAChB;AACA;AACA;AACA;AACAA,QAAAA,YAAY,CAACl8B,OAAD,CAAZ;AACD;AACF;AATH,kBAWE3E,6BAAC,SAAD,OAXF,EAYGoB,CAAC,CAAC,qCAAD,CAZJ,CApCJ,CAVF,EA+DGu9B,aAAa,IACZ9b,WAAW,CAAC5d,GAAZ;AACE;AACA,YAACgM,UAAD,EAAaW,KAAb;AAAA,wBACE5R,6BAACuU,YAAD;AACE,MAAA,GAAG,YAAK5P,OAAL,aAAKA,OAAL,uBAAKA,OAAO,CAAEvC,EAAd,cAAoBwP,KAApB,CADL;AAEE,MAAA,UAAU,EAAEX,UAFd;AAGE,MAAA,aAAa,EAAE+uB,gBAAgB,IAAIC;AAHrC,MADF;AAAA,GAFF,CAhEJ,EA2EG6C,aAAa,CAACx+B,MAAd,KAAyB,CAAzB,iBAA8BtE,6BAACoS,SAAD;AAAS,IAAA,MAAM,EAAE0wB;AAAjB,IA3EjC,eA6EE9iC,6BAAC,aAAD;AACE,IAAA,eAAe,EAAE2E,OAAO,CAAC0sB,eAD3B;AAEE,IAAA,SAAS,EAAE1sB,OAAO,CAACysB,gBAFrB;AAGE,IAAA,cAAc,EAAE8O,kBAAkB,IAAI1O;AAHxC,IA7EF,EAmFG,CAACgM,cAAD,iBACCx9B,6BAAColB,2BAAD;AACE,IAAA,OAAO,EAAEkY,oBAAoB,IAAIC,gBADnC;AAEE,IAAA,WAAW,EAAE54B,OAAO,CAAC0gB;AAFvB,IApFJ,CADF,CAzCF,CADF,CADF;AA0ID,CA1PD;AA4PA;;;;;AAGA,IAAM0d,wBAAwB,GAAG,SAA3BA,wBAA2B,CAACtiC,KAAD,EAAW;AAAA,MAExC+8B,cAFwC,GAYtC/8B,KAZsC,CAExC+8B,cAFwC;AAAA,MAGxC74B,OAHwC,GAYtClE,KAZsC,CAGxCkE,OAHwC;AAAA,MAIxCg5B,aAJwC,GAYtCl9B,KAZsC,CAIxCk9B,aAJwC;AAAA,MAKxCD,UALwC,GAYtCj9B,KAZsC,CAKxCi9B,UALwC;AAAA,MAMxC2B,UANwC,GAYtC5+B,KAZsC,CAMxC4+B,UANwC;AAAA,MAOxC9F,iBAPwC,GAYtC94B,KAZsC,CAOxC84B,iBAPwC;AAAA,MAQxCO,mBARwC,GAYtCr5B,KAZsC,CAQxCq5B,mBARwC;AAAA,MASxClE,iBATwC,GAYtCn1B,KAZsC,CASxCm1B,iBATwC;AAAA,MAUxC2H,gBAVwC,GAYtC98B,KAZsC,CAUxC88B,gBAVwC;AAAA,MAWvBgD,mBAXuB,GAYtC9/B,KAZsC,CAWxCa,eAXwC;;AAAA,kBAaEmN,cAAQ,CAAC,KAAD,CAbV;AAAA;AAAA,MAanC+tB,cAbmC;AAAA,MAanBC,iBAbmB;AAc1C;;;AACA,MAAME,WAAW,GAAG5tB,iBAAW,CAAC;AAAA,WAAM0tB,iBAAiB,CAAC,KAAD,CAAvB;AAAA,GAAD,EAAiC,EAAjC,CAA/B;AACA,MAAMG,gBAAgB,GAAG,CAAC,EAACj4B,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEge,UAAV,CAA1B;AACA,MAAMkX,cAAc,GAAGN,iBAAH,aAAGA,iBAAH,uBAAGA,iBAAiB,CAAEvqB,OAA1C;AACAK,EAAAA,eAAS,CAAC,YAAM;AACd,QAAIwqB,cAAJ,EAAoB;AAClBA,MAAAA,cAAc,CAAClkB,gBAAf,CAAgC,YAAhC,EAA8CgnB,WAA9C;AACD;;AAED,WAAO,YAAM;AACX,UAAI9C,cAAJ,EAAoB;AAClBA,QAAAA,cAAc,CAAChkB,mBAAf,CAAmC,YAAnC,EAAiD8mB,WAAjD;AACD;AACF,KAJD;AAKD,GAVQ,EAUN,CAAC9C,cAAD,EAAiB8C,WAAjB,CAVM,CAAT;AAWAttB,EAAAA,eAAS,CAAC,YAAM;AACd,QAAIutB,gBAAJ,EAAsB;AACpBlnB,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,OAA7B,EAAsC8mB,WAAtC;AACD;AACF,GAJQ,EAIN,CAACC,gBAAD,EAAmBD,WAAnB,CAJM,CAAT;AAMAttB,EAAAA,eAAS,CAAC,YAAM;AACd,QAAImtB,cAAJ,EAAoB;AAClB9mB,MAAAA,QAAQ,CAACC,gBAAT,CAA0B,OAA1B,EAAmCgnB,WAAnC;AACD,KAFD,MAEO;AACLjnB,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,OAA7B,EAAsC8mB,WAAtC;AACD;;AACD,WAAO,YAAM;AACXjnB,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,OAA7B,EAAsC8mB,WAAtC;AACD,KAFD;AAGD,GATQ,EASN,CAACH,cAAD,EAAiBG,WAAjB,CATM,CAAT;;AAWA,MACEa,cAAc,IACd,CAAC74B,OADD,IAEAA,OAAO,CAACgB,IAAR,KAAiB,OAFjB,IAGAhB,OAAO,CAACgB,IAAR,KAAiB,QAHjB,IAIAhB,OAAO,CAACgB,IAAR,KAAiB,WAJjB,IAKAhB,OAAO,CAACo5B,MAAR,KAAmB,QALnB,IAMAp5B,OAAO,CAACo5B,MAAR,KAAmB,SAPrB,EAQE;AACA,WAAO,IAAP;AACD;;AAED,sBACE/9B;AACE,mBAAa,4BADf;AAEE,IAAA,SAAS;AAFX,kBAIEA,6BAACy/B,kBAAD;AACE,IAAA,WAAW,EAAC,mCADd;AAEE,IAAA,OAAO,EAAE96B,OAFX;AAGE,IAAA,UAAU,EAAE06B,UAHd;AAIE,IAAA,eAAe,EAAEkB;AAJnB,IAJF,EAUG5C,aAAa,IAAIA,aAAa,CAACnK,SAA/B,iBACCxzB;AACE,IAAA,OAAO,EAAE85B,mBADX;AAEE,mBAAY;AAFd,kBAIE95B,wDACEA,6BAAC,YAAD,OADF,CAJF,CAXJ,EAoBG,CAAC09B,UAAD,IAAeC,aAAf,IAAgCA,aAAa,CAACE,OAA9C,iBACC79B;AACE,mBAAY,kCADd;AAEE,IAAA,OAAO,EAAEu9B;AAFX,kBAIEv9B,6BAAC,UAAD,OAJF,CArBJ,eA4BEA,6BAAC,cAAD,eACMS,KADN;AAEE,IAAA,iBAAiB,EAAEm1B,iBAFrB;AAGE,IAAA,kBAAkB,EAAE,EAHtB;AAIE,IAAA,MAAM;AAJR,KA5BF,CADF;AAqCD,CA/FD;;AAiGAwM,0BAA0B,CAACv0B,SAA3B,GAAuC;AACrC;AACAlJ,EAAAA,OAAO;AAAE;AAA2EmJ,EAAAA,SAAS,CAC1FmF,MADiF,CAC1EjF,UAH2B;;AAIrC;;;;AAIAuG,EAAAA,UAAU;AAAE;AAAmGzG,EAAAA,SAAS,CAACkH,WARpF;;AASrC;;;;;;;;AAQAisB,EAAAA,OAAO;AAAE;AAAgGnzB,EAAAA,SAAS,CAACozB,SAAV,CACvG,CAACpzB,SAAS,CAACqzB,IAAX,EAAiBrzB,SAAS,CAACI,IAA3B,EAAiCJ,SAAS,CAACmF,MAA3C,CADuG,CAjBpE;;AAoBrC;AACAurB,EAAAA,UAAU,EAAE1wB,SAAS,CAACqE,IArBe;;AAsBrC;AACAqrB,EAAAA,cAAc,EAAE1vB,SAAS,CAACqE,IAvBW;;AAyBrC;AACAktB,EAAAA,UAAU,EAAEvxB,SAAS,CAACI,IA1Be;;AA4BrC;AACAyvB,EAAAA,aAAa;AAAE;AAAyE7vB,EAAAA,SAAS,CAACmF,MA7B7D;;AA8BrC;AACAyqB,EAAAA,UAAU,EAAE5vB,SAAS,CAACqE,IA/Be;;AAgCrC;AACAorB,EAAAA,gBAAgB,EAAEzvB,SAAS,CAACI,IAjCS;;AAkCrC;AACA4mB,EAAAA,OAAO,EAAEhnB,SAAS,CAACqE,IAnCkB;;AAoCrC;AACAwY,EAAAA,iBAAiB,EAAE7c,SAAS,CAACI,IArCQ;;AAsCrC;AACAusB,EAAAA,WAAW,EAAE3sB,SAAS,CAACI,IAvCc;;AAwCrC;;;;AAIA0nB,EAAAA,iBAAiB,EAAE9nB,SAAS,CAACI,IAAV,CAAeF,UA5CG;;AA6CrC;;;;;AAKAmmB,EAAAA,aAAa,EAAErmB,SAAS,CAACI,IAlDY;;AAmDrC;;;;AAIAkyB,EAAAA,WAAW,EAAEtyB,SAAS,CAACI,IAvDc;;AAwDrC;;;;;;AAMAsjB,EAAAA,cAAc,EAAE1jB,SAAS,CAACI,IA9DW;;AA+DrC;;;AAGAklB,EAAAA,gBAAgB;AAAE;AAA8FtlB,EAAAA,SAAS,CAACkH,WAlErF;;AAmErC;;;AAGAue,EAAAA,aAAa;AAAE;AAA2FzlB,EAAAA,SAAS,CAACkH,WAtE/E;;AAwErC;;AACA;AACAosB,EAAAA,cAAc,EAAEtzB,SAAS,CAACqE,IA1EW;;AA2ErC;AACAqkB,EAAAA,eAAe,EAAE1oB,SAAS,CAAC0D,KAAV,CAAgB;AAC/BghB,IAAAA,CAAC,EAAE1kB,SAAS,CAACoE,MAAV,CAAiBlE,UADW;AAE/BqzB,IAAAA,CAAC,EAAEvzB,SAAS,CAACoE,MAAV,CAAiBlE,UAFW;AAG/B6T,IAAAA,MAAM,EAAE/T,SAAS,CAACoE,MAAV,CAAiBlE,UAHM;AAI/B+B,IAAAA,KAAK,EAAEjC,SAAS,CAACoE,MAAV,CAAiBlE,UAJO;AAK/BgP,IAAAA,GAAG,EAAElP,SAAS,CAACoE,MAAV,CAAiBlE,UALS;AAM/B2tB,IAAAA,KAAK,EAAE7tB,SAAS,CAACoE,MAAV,CAAiBlE,UANO;AAO/BszB,IAAAA,MAAM,EAAExzB,SAAS,CAACoE,MAAV,CAAiBlE,UAPM;AAQ/BiP,IAAAA,IAAI,EAAEnP,SAAS,CAACoE,MAAV,CAAiBlE,UARQ;AAS/BuzB,IAAAA,MAAM,EAAEzzB,SAAS,CAACI,IAAV,CAAeF;AATQ,GAAhB,CA5EoB;;AAuFrC;;;;;AAKAiyB,EAAAA,YAAY,EAAEnyB,SAAS,CAACI,IA5Fa;;AA6FrC;;;;;;AAMAowB,EAAAA,sBAAsB,EAAExwB,SAAS,CAACI,IAnGG;;AAoGrC;;;;;;AAMAkwB,EAAAA,sBAAsB,EAAEtwB,SAAS,CAACI,IA1GG;;AA2GrC;;;;;AAKAksB,EAAAA,WAAW,EAAEtsB,SAAS,CAACI,IAhHc;;AAiHrC;;;;;AAKAosB,EAAAA,WAAW,EAAExsB,SAAS,CAACI,IAtHc;;AAuHrC;;;;AAIA4wB,EAAAA,cAAc;AAAE;AAA4FhxB,EAAAA,SAAS,CAACkH;AA3HjF,CAAvC;AA8HA,qCAAehV,cAAK,CAACmO,IAAN,CAAWi0B,0BAAX,EAAuCjM,oBAAvC,CAAf;;ACnhBA;AA+CA;;;;;;;;;AASA;;AACA,IAAM6M,WAAW,GAAG,SAAdA,WAAc,CAACviC,KAAD,EAAW;AAAA;;AAAA,MAE3BkE,OAF2B,GAyBzBlE,KAzByB,CAE3BkE,OAF2B;AAAA,MAG3B+4B,UAH2B,GAyBzBj9B,KAzByB,CAG3Bi9B,UAH2B;AAAA,MAI3B2B,UAJ2B,GAyBzB5+B,KAzByB,CAI3B4+B,UAJ2B;AAAA,MAK3B7B,cAL2B,GAyBzB/8B,KAzByB,CAK3B+8B,cAL2B;AAAA,MAM3BgB,UAN2B,GAyBzB/9B,KAzByB,CAM3B+9B,UAN2B;AAAA,MAO3B5I,iBAP2B,GAyBzBn1B,KAzByB,CAO3Bm1B,iBAP2B;AAAA,MAQ3BkJ,cAR2B,GAyBzBr+B,KAzByB,CAQ3Bq+B,cAR2B;AAAA,6BAyBzBr+B,KAzByB,CAS3B8yB,aAT2B;AAAA,MAS3BA,aAT2B,qCASX2O,sBATW;AAAA,8BAyBzBzhC,KAzByB,CAU3B2yB,gBAV2B;AAAA,MAU3BA,gBAV2B,sCAUR8K,uBAVQ;AAAA,MAWlBmE,WAXkB,GAyBzB5hC,KAzByB,CAW3Bq0B,OAX2B;AAAA,MAYVwN,WAZU,GAyBzB7hC,KAzByB,CAY3Bq7B,eAZ2B;AAAA,MAaRyG,aAbQ,GAyBzB9hC,KAzByB,CAa3BkqB,iBAb2B;AAAA,MAcH0T,mBAdG,GAyBzB59B,KAzByB,CAc3B69B,sBAd2B;AAAA,MAeHH,mBAfG,GAyBzB19B,KAzByB,CAe3B29B,sBAf2B;AAAA,MAgBZoE,iBAhBY,GAyBzB/hC,KAzByB,CAgB3Bk9B,aAhB2B;AAAA,MAiBbqC,gBAjBa,GAyBzBv/B,KAzByB,CAiB3Bw/B,YAjB2B;AAAA,MAkBT3C,oBAlBS,GAyBzB78B,KAzByB,CAkB3B88B,gBAlB2B;AAAA,MAmBX2C,kBAnBW,GAyBzBz/B,KAzByB,CAmB3B+wB,cAnB2B;AAAA,MAoBd2O,eApBc,GAyBzB1/B,KAzByB,CAoB3B2/B,WApB2B;AAAA,MAqBZL,iBArBY,GAyBzBt/B,KAzByB,CAqB3B0zB,aArB2B;AAAA,MAsBdsN,eAtBc,GAyBzBhhC,KAzByB,CAsB3B25B,WAtB2B;AAAA,MAuBdsH,eAvBc,GAyBzBjhC,KAzByB,CAuB3B65B,WAvB2B;AAAA,MAwBxBmI,KAxBwB,GAyBzBhiC,KAzByB,CAwB3BW,CAxB2B;AA2B7B;;;;AA3B6B,oBA8B4BsP,gBAAU,CACjE5P,cADiE,CA9BtC;AAAA,MA8BrBshB,OA9BqB,eA8BrBA,OA9BqB;AAAA,MA8BGoe,oBA9BH,eA8BZrM,aA9BY;;AAiC7B,MAAMwJ,aAAa,GAAG6E,iBAAiB,KAAIpgB,OAAJ,aAAIA,OAAJ,uBAAIA,OAAO,CAAE+J,SAAT,EAAJ,CAAvC;;AAjC6B,qBAkCLzb,gBAAU,CAACvP,kBAAD,CAlCL;AAAA,MAkClBuhC,QAlCkB,gBAkCrBthC,CAlCqB;;AAmC7B,MAAMA,CAAC,GAAGqhC,KAAK,IAAIC,QAAnB;AACA,MAAMpM,WAAW,GAAG71B,KAAK,CAAC61B,WAAN,IAAqB,CAAC,QAAD,CAAzC;AACA,MAAMgD,mBAAmB,GAAG9qB,YAAM,CAAC,IAAD,CAAlC;AACA,MAAM+qB,iBAAiB,GAAG/qB,YAAM,CAAC,IAAD,CAAhC;;AAtC6B,wBA2CzBkmB,cAAc,EA3CW;AAAA,MAwClBiO,UAxCkB,mBAwC3B7N,OAxC2B;AAAA,MAyClB8N,aAzCkB,mBAyC3B5N,OAzC2B;AAAA,MA0ChB6N,eA1CgB,mBA0C3B5N,SA1C2B;;AA4C7B,MAAMH,OAAO,GAAGuN,WAAW,IAAIM,UAA/B;AACA,MAAM3N,OAAO,GAAGsN,WAAW,IAAIM,aAA/B;AACA,MAAM3N,SAAS,GAAGsN,aAAa,IAAIM,eAAnC;AACA,MAAMtF,gBAAgB,GAAG/E,oBAAoB,CAAC7zB,OAAD,CAA7C;AACA,MAAM6sB,cAAc,GAAGqH,kBAAkB,CAACl0B,OAAD,CAAzC;AACA,MAAMk8B,YAAY,GAAG9G,eAAe,EAApC;AACA,MAAMkJ,KAAK,GAAG9C,eAAe,IAAIU,YAAjC;;AAlD6B,8BAmDgB5I,oBAAoB,CAACtzB,OAAD,EAAU;AACzEmzB,IAAAA,eAAe,EAAEqG,mBADwD;AAEzEnG,IAAAA,eAAe,EAAEqG;AAFwD,GAAV,CAnDpC;AAAA,MAmDrBvG,eAnDqB,yBAmDrBA,eAnDqB;AAAA,MAmDJE,eAnDI,yBAmDJA,eAnDI;;AAAA,0BAuD0BqB,gBAAgB,CACrE10B,OADqE,EAErE20B,mBAFqE,EAGrEC,iBAHqE,CAvD1C;AAAA,MAuDrBO,mBAvDqB,qBAuDrBA,mBAvDqB;AAAA,MAuDAN,qBAvDA,qBAuDAA,qBAvDA;;AAAA,wBA4DQW,cAAc,CAACx1B,OAAD,EAAU;AAC3D01B,IAAAA,kBAAkB,EAAEoH,eADuC;AAE3DlH,IAAAA,kBAAkB,EAAEmH;AAFuC,GAAV,CA5DtB;AAAA,MA4DrBtH,WA5DqB,mBA4DrBA,WA5DqB;AAAA,MA4DRE,WA5DQ,mBA4DRA,WA5DQ;;AAgE7B,MAAMsE,WAAW,GAAGlsB,aAAO,CACzB;AAAA,WAAMpN,UAAU,CAACX,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAE5B,IAAV,EAAgB4B,OAAhB,aAAgBA,OAAhB,uBAAgBA,OAAO,CAAEY,eAAzB,CAAhB;AAAA,GADyB,EAEzB,CAACZ,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAE5B,IAAV,EAAgB4B,OAAhB,aAAgBA,OAAhB,uBAAgBA,OAAO,CAAEY,eAAzB,CAFyB,CAA3B;AAIA,MAAMu9B,aAAa,GAAGlM,SAAS,CAACjyB,OAAD,CAA/B;AACA,MAAMke,WAAW,GAAGgU,sBAAsB,CAAClyB,OAAD,CAA1C;AACA,MAAMw9B,eAAe,GAAG7L,WAAW,GAAGA,WAAW,CAAC,CAAD,CAAd,GAAoB,EAAvD;;AAEA,MAAI,CAAA3xB,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEgB,IAAT,MAAkB,cAAtB,EAAsC;AACpC,WAAO,IAAP;AACD;;AAED,MAAIhB,OAAJ,aAAIA,OAAJ,uBAAIA,OAAO,CAAEge,UAAb,EAAyB;AACvB,WAAO3b,WAAW,CAAC83B,cAAD,EAAiBr+B,KAAjB,EAAwB,IAAxB,CAAlB;AACD;;AAED,MAAIq0B,OAAJ,EAAa;AAAA;;AACX,wBACE90B;AACE,qBAAY,mBADd;AAEE,MAAA,SAAS,2DAAoDmiC,eAApD;AAFX,OAIG,CAACA,eAAe,KAAK,KAApB,IAA6BA,eAAe,KAAK,QAAlD,kBACCniC;AAAK,MAAA,SAAS,EAAC;AAAf,oBACEA,6BAAC,MAAD;AACE,MAAA,KAAK,EAAE2E,OAAF,aAAEA,OAAF,wCAAEA,OAAO,CAAER,IAAX,kDAAE,cAAewM,KADxB;AAEE,MAAA,IAAI,EAAE,CAAAhM,OAAO,SAAP,IAAAA,OAAO,WAAP,8BAAAA,OAAO,CAAER,IAAT,kEAAevD,IAAf,MAAuB+D,OAAvB,aAAuBA,OAAvB,yCAAuBA,OAAO,CAAER,IAAhC,mDAAuB,eAAe/B,EAAtC,CAFR;AAGE,MAAA,IAAI,EAAE,EAHR;AAIE,MAAA,OAAO,EAAEg4B,WAJX;AAKE,MAAA,WAAW,EAAEE;AALf,MADF,CALJ,eAeEt6B,6BAAC6wB,cAAD;AACE,MAAA,KAAK,EAAEG,eADT;AAEE,MAAA,OAAO,EAAErsB,OAFX;AAGE,MAAA,iBAAiB,EAAEswB,SAHrB;AAIE,MAAA,aAAa,EAAE8K,iBAAiB,IAAIS;AAJtC,MAfF,CADF;AAwBD;;AACD,sBACExgC,6BAACA,cAAD,CAAO,QAAP,qBACEA;AACE,mBAAY,cADd;AAEE,IAAA,SAAS,2DAAoDmiC,eAApD,sCACPx9B,OADO,aACPA,OADO,uBACPA,OAAO,CAAEgB,IADF,cAEL+3B,UAAU,GAAG,aAAH,GAAmB,EAFxB,sCAGP/4B,OAHO,aAGPA,OAHO,uBAGPA,OAAO,CAAEo5B,MAHF,CAFX;AAOE,IAAA,GAAG,EAAExE;AAPP,kBASEv5B;AAAK,IAAA,SAAS,EAAC;AAAf,KACGmiC,eAAe,KAAK,KAApB,IACDA,eAAe,KAAK,QADnB,IAED3E,cAFC,gBAGCx9B,6BAAC,MAAD;AACE,IAAA,KAAK,EAAE2E,OAAF,aAAEA,OAAF,yCAAEA,OAAO,CAAER,IAAX,mDAAE,eAAewM,KADxB;AAEE,IAAA,IAAI,EAAE,CAAAhM,OAAO,SAAP,IAAAA,OAAO,WAAP,8BAAAA,OAAO,CAAER,IAAT,kEAAevD,IAAf,MAAuB+D,OAAvB,aAAuBA,OAAvB,yCAAuBA,OAAO,CAAER,IAAhC,mDAAuB,eAAe/B,EAAtC,CAFR;AAGE,IAAA,IAAI,EAAE,EAHR;AAIE,IAAA,OAAO,EAAEg4B,WAJX;AAKE,IAAA,WAAW,EAAEE;AALf,IAHD,gBAWCt6B;AACE,mBAAY,kBADd;AAEE,IAAA,KAAK,EAAE;AAAE+P,MAAAA,KAAK,EAAE,EAAT;AAAamzB,MAAAA,WAAW,EAAE;AAA1B;AAFT,IAZJ,eAiBEljC,6BAACy/B,kBAAD;AACE,IAAA,OAAO,EAAE96B,OADX;AAEE,IAAA,eAAe,EAAElE,KAAK,CAACa,eAFzB;AAGE,IAAA,UAAU,EAAE+9B;AAHd,IAjBF,CATF,eAgCEr/B;AAAK,IAAA,SAAS,EAAC;AAAf,KACG2E,OAAO,KACLw9B,eAAe,KAAK,KAApB,IACCA,eAAe,KAAK,QADrB,IAEC3E,cAHI,CAAP,iBAIGx9B;AACE,mBAAY,qBADd;AAEE,IAAA,SAAS,EAAC,+BAFZ;AAGE,IAAA,OAAO,EAAEo6B;AAHX,kBAKEp6B,6CAAS,mBAAA2E,OAAO,CAACR,IAAR,kEAAcvD,IAAd,wBAAsB+D,OAAO,CAACR,IAA9B,mDAAsB,eAAc/B,EAApC,CAAT,CALF,EAMGuC,OAAO,CAACgB,IAAR,KAAiB,OAAjB,iBACC3F;AAAK,IAAA,SAAS,EAAC;AAAf,KACGoB,CAAC,CAAC,qBAAD,CADJ,CAPJ,CALN,eAkBEpB;AACE,mBAAY,sBADd;AAEE,IAAA,SAAS,2EAAoEmiC,eAApE,8CACP,CAAAx9B,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAE5B,IAAT,MAAkB,EAAlB,GAAuB,OAAvB,GAAiC,MAD1B;AAFX,KAMG,CAACy6B,cAAD,IACC74B,OADD,IAECA,OAAO,CAACo5B,MAAR,KAAmB,SAFpB,IAGCp5B,OAAO,CAACo5B,MAAR,KAAmB,QAHpB,IAICp5B,OAAO,CAACgB,IAAR,KAAiB,QAJlB,IAKChB,OAAO,CAACgB,IAAR,KAAiB,WALlB,IAMChB,OAAO,CAACgB,IAAR,KAAiB,OANlB,iBAOG3F;AACE,mBAAY,sBADd;AAEE,IAAA,SAAS;AAFX,KAIG2E,OAAO,IAAI60B,qBAAX,iBACCx5B,6BAAC,gBAAD;AACE,IAAA,cAAc,EAAEkgC,kBAAkB,IAAI1O,cADxC;AAEE,IAAA,gBAAgB,EAAE7sB,OAAO,CAACysB,gBAF5B;AAGE,IAAA,eAAe,EAAEzsB,OAAO,CAAC0sB,eAH3B;AAIE,IAAA,YAAY,EAAE,IAJhB;AAKE,IAAA,GAAG,EAAEiI;AALP,IALJ,EAcGqE,aAAa,IAAIA,aAAa,CAACnK,SAA/B,iBACCxzB;AACE,mBAAY,4BADd;AAEE,IAAA,KAAK,EAAC,WAFR;AAGE,IAAA,OAAO,EAAE85B;AAHX,kBAKE95B,6BAAC,YAAD,OALF,CAfJ,EAuBG,CAAC09B,UAAD,IAAeC,aAAf,IAAgCA,aAAa,CAACE,OAA9C,iBACC79B;AACE,mBAAY,0BADd;AAEE,IAAA,KAAK,EAAC,gBAFR;AAGE,IAAA,OAAO,EAAEs9B,oBAAoB,IAAIC;AAHnC,kBAKEv9B,6BAAC,UAAD,OALF,CAxBJ,EAgCG2E,OAAO,IACNixB,iBADD,IAECA,iBAAiB,GAAGtxB,MAApB,GAA6B,CAF9B,iBAGGtE,6BAAC,cAAD;AACE,IAAA,eAAe,EAAES,KAAK,CAACo7B,eADzB;AAEE,IAAA,OAAO,EAAEl3B,OAFX;AAGE,IAAA,iBAAiB,EAAElE,KAAK,CAACm1B,iBAH3B;AAIE,IAAA,eAAe,EAAEn1B,KAAK,CAAC+1B,eAJzB;AAKE,IAAA,iBAAiB,EAAE+C,iBALrB;AAME,IAAA,eAAe,EAAEvE,OANnB;AAOE,IAAA,8BAA8B,EAC5Bv0B,KAAK,CAACs7B,8BARV;AAUE,IAAA,4BAA4B,EAC1Bt7B,KAAK,CAACu7B,4BAXV;AAaE,IAAA,+BAA+B,EAC7Bv7B,KAAK,CAACw7B,+BAdV;AAgBE,IAAA,iCAAiC,EAC/Bx7B,KAAK,CAACy7B,iCAjBV;AAmBE,IAAA,UAAU,EAAEz7B,KAAK,CAACy6B,UAnBpB;AAoBE,IAAA,UAAU,EAAEz6B,KAAK,CAAC06B,UApBpB;AAqBE,IAAA,UAAU,EAAE16B,KAAK,CAAC26B,UArBpB;AAsBE,IAAA,YAAY,EAAE36B,KAAK,CAAC46B,YAtBtB;AAuBE,IAAA,kBAAkB,EAAE,EAvBtB;AAwBE,IAAA,MAAM;AAxBR,IAnCN,CAbN,EA6EG12B,OAAO,iBACN3E;AACE,mBAAY,sBADd;AAEE,IAAA,SAAS,EACP8C,YAAY,CAAC6B,OAAO,CAAC5B,IAAT,CAAZ,GACI,uCADJ,GAEI,EALR;AAOE,IAAA,WAAW,EAAEi1B,eAPf;AAQE,IAAA,OAAO,EAAEF;AARX,KAUG0G,UAAU,gBACTx+B;AAAK,IAAA,uBAAuB,EAAE;AAAE0Y,MAAAA,MAAM,EAAE/T,OAAO,CAACoyB;AAAlB;AAA9B,IADS,GAGT6H,WAbJ,CA9EJ,EAgGGkE,aAAa,CAACx+B,MAAd,KAAyB,CAAzB,iBAA8BtE,6BAACoS,SAAD;AAAS,IAAA,MAAM,EAAE0wB;AAAjB,IAhGjC,EAkGGn+B,OAAO,IAAIA,OAAO,CAAC5B,IAAR,KAAiB,EAA5B,iBACC/C,6BAAC,sBAAD;AACE,IAAA,UAAU,EAAES,KAAK,CAAC8T,UADpB;AAEE,IAAA,OAAO,EAAE5P,OAFX;AAGE,IAAA,YAAY,EAAEq7B;AAHhB,IAnGJ,EA0GG,CAAAr7B,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEysB,gBAAT,KACCzsB,OAAO,CAACysB,gBAAR,CAAyB9sB,MAAzB,KAAoC,CADrC,IAECK,OAAO,CAAC5B,IAAR,KAAiB,EAFlB,iBAGG/C,6BAAC,aAAD;AACE,IAAA,eAAe,EAAE2E,OAAO,CAAC0sB,eAD3B;AAEE,IAAA,cAAc,EAAE6O,kBAAkB,IAAI1O,cAFxC;AAGE,IAAA,SAAS,EAAE7sB,OAAO,CAACysB;AAHrB,IA7GN,EAmHG,CAAAzsB,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEo5B,MAAT,MAAoB,QAApB,iBACC/9B;AACE,mBAAY,qBADd;AAEE,IAAA,SAAS,EAAC,+BAFZ;AAGE,IAAA,OAAO,EAAE,mBAAM;AACb,UAAI2E,OAAO,CAACo5B,MAAR,KAAmB,QAAnB,IAA+BkF,KAAnC,EAA0C;AACxC;AACA;AACA;AACA;AACAA,QAAAA,KAAK,CAACt+B,OAAD,CAAL;AACD;AACF;AAXH,kBAaE3E,6BAAC,SAAD,OAbF,EAcGoB,CAAC,CAAC,qCAAD,CAdJ,CApHJ,CAlBF,eAwJEpB,6BAAC,iBAAD;AACE,IAAA,MAAM,EAAES,KAAK,CAAC41B,MADhB;AAEE,IAAA,OAAO,EAAE1xB,OAFX;AAGE,IAAA,UAAU,EAAE+4B,UAHd;AAIE,IAAA,cAAc,EAAEj9B,KAAK,CAAC81B,cAJxB;AAKE,IAAA,CAAC,EAAEkM;AALL,IAxJF,EA+JG99B,OAAO,IAAIA,OAAO,CAAC5B,IAAR,KAAiB,EAA5B,IAAkC8f,WAAlC,iBACC7iB,6BAAC,sBAAD;AACE,IAAA,UAAU,EAAES,KAAK,CAAC8T,UADpB;AAEE,IAAA,OAAO,EAAE5P,OAFX;AAGE,IAAA,YAAY,EAAEq7B;AAHhB,IAhKJ,EAsKG,CAAAr7B,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEysB,gBAAT,KACCzsB,OAAO,CAACysB,gBAAR,CAAyB9sB,MAAzB,KAAoC,CADrC,IAECK,OAAO,CAAC5B,IAAR,KAAiB,EAFlB,iBAGG/C,6BAAC,aAAD;AACE,IAAA,eAAe,EAAE2E,OAAO,CAAC0sB,eAD3B;AAEE,IAAA,cAAc,EAAE6O,kBAAkB,IAAI1O,cAFxC;AAGE,IAAA,SAAS,EAAE7sB,OAAO,CAACysB;AAHrB,IAzKN,EA+KG,CAACsM,UAAD,IAAe/4B,OAAf,iBACC3E,6BAAColB,2BAAD;AACE,IAAA,OAAO,EAAEkY,oBAAoB,IAAIC,gBADnC;AAEE,IAAA,WAAW,EAAE54B,OAAO,CAAC0gB;AAFvB,IAhLJ,CAhCF,CADF,CADF;AA2ND,CArUD;AAuUA;;;AACA,IAAM8d,iBAAiB,GAAG,SAApBA,iBAAoB,CAAC1iC,KAAD,EAAW;AAAA,MAC3B41B,MAD2B,GAC+B51B,KAD/B,CAC3B41B,MAD2B;AAAA,MACnB1xB,OADmB,GAC+BlE,KAD/B,CACnBkE,OADmB;AAAA,MACV+4B,UADU,GAC+Bj9B,KAD/B,CACVi9B,UADU;AAAA,MACEnH,cADF,GAC+B91B,KAD/B,CACE81B,cADF;AAAA,MACqBkM,KADrB,GAC+BhiC,KAD/B,CACkBW,CADlB;;AAAA,qBAEhBsP,gBAAU,CAAC5P,cAAD,CAFM;AAAA,MAE3BZ,MAF2B,gBAE3BA,MAF2B;;AAAA,qBAGXwQ,gBAAU,CAACvP,kBAAD,CAHC;AAAA,MAGxBuhC,QAHwB,gBAG3BthC,CAH2B;;AAInC,MAAMA,CAAC,GAAGqhC,KAAK,IAAIC,QAAnB;;AAJmC,qBAKXlI,WAAW,CAAC71B,OAAD,CALA;AAAA,MAK3B81B,WAL2B,gBAK3BA,WAL2B;;AAMnC,MAAI,CAACA,WAAD,IAAgB,CAAA91B,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEgB,IAAT,MAAkB,OAAtC,EAA+C;AAC7C,WAAO,IAAP;AACD;;AACD,MAAMo7B,YAAY,GAChB1K,MAAM,KACNn2B,MADM,aACNA,MADM,uBACNA,MAAM,CAAEiE,IADF,CAAN,IAEAkyB,MAAM,CAAC/xB,MAAP,KAAkB,CAFlB,IAGA+xB,MAAM,CAAC,CAAD,CAHN,IAIAA,MAAM,CAAC,CAAD,CAAN,CAAUj0B,EAAV,KAAiBlC,MAAM,CAACiE,IAAP,CAAY/B,EAL/B;;AAMA,MAAIuC,OAAO,IAAIA,OAAO,CAACo5B,MAAR,KAAmB,SAAlC,EAA6C;AAC3C,wBACE/9B;AACE,MAAA,SAAS,EAAC,+BADZ;AAEE,qBAAY;AAFd,oBAIEA,6BAAC+oB,SAAD,QAAU3nB,CAAC,IAAIA,CAAC,CAAC,YAAD,CAAhB,CAJF,eAKEpB,6BAAComB,uBAAD,OALF,CADF;AASD;;AAED,MAAIiQ,MAAM,IAAIA,MAAM,CAAC/xB,MAAP,KAAkB,CAA5B,IAAiC,CAACo5B,UAAlC,IAAgD,CAACqD,YAArD,EAAmE;AACjE,QAAMC,YAAY,GAAG3K,MAAM,CAACtwB,MAAP,CACnB,UAAC9B,IAAD;AAAA,aAAUA,IAAI,KAAI/D,MAAJ,aAAIA,MAAJ,uBAAIA,MAAM,CAAEiE,IAAZ,CAAJ,IAAwBF,IAAI,CAAC7B,EAAL,KAAYlC,MAAM,CAACiE,IAAP,CAAY/B,EAA1D;AAAA,KADmB,EAEnB,CAFmB,CAArB;AAGA,wBACEpC;AAAM,MAAA,SAAS,EAAC;AAAhB,oBACEA,6BAAC+oB,SAAD,QAAUthB,oBAAoB,CAAC4uB,MAAD,EAASj1B,CAAT,EAAYlB,MAAZ,CAA9B,CADF,eAEEF,6BAAC,MAAD;AACE,MAAA,IAAI,EAAEghC,YAAY,IAAIA,YAAY,CAACpgC,IAA7B,GAAoCogC,YAAY,CAACpgC,IAAjD,GAAwD,IADhE;AAEE,MAAA,KAAK,EAAEogC,YAAY,IAAIA,YAAY,CAACrwB,KAA7B,GAAqCqwB,YAAY,CAACrwB,KAAlD,GAA0D,IAFnE;AAGE,MAAA,IAAI,EAAE;AAHR,MAFF,EAOG0lB,MAAM,CAAC/xB,MAAP,GAAgB,CAAhB,GAAoB,CAApB,iBACCtE;AACE,qBAAY,4BADd;AAEE,MAAA,SAAS,EAAC;AAFZ,OAIGq2B,MAAM,CAAC/xB,MAAP,GAAgB,CAJnB,CARJ,CADF;AAkBD;;AAED,MACEK,OAAO,IACPA,OAAO,CAACo5B,MAAR,KAAmB,UADnB,IAEAp5B,OAAO,CAACvC,EAAR,KAAem0B,cAFf,IAGA,CAACmH,UAJH,EAKE;AACA,wBACE19B;AACE,qBAAY,uBADd;AAEE,MAAA,SAAS,EAAC;AAFZ,oBAIEA,6BAAC+oB,SAAD,QAAU3nB,CAAC,IAAIA,CAAC,CAAC,WAAD,CAAhB,CAJF,eAKEpB,6BAAC,kBAAD,OALF,CADF;AASD;;AAED,SAAO,IAAP;AACD,CArED;AAuEA;;;AACA,IAAMojC,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAC3iC,KAAD,EAAW;AAAA,0BAKpCA,KALoC,CAEtC8T,UAFsC;AAAA,MAEtCA,YAFsC,kCAEzBmsB,UAFyB;AAAA,MAGtC/7B,OAHsC,GAKpClE,KALoC,CAGtCkE,OAHsC;AAAA,MAIxBq7B,gBAJwB,GAKpCv/B,KALoC,CAItCw/B,YAJsC;AAMxC,MAAMA,YAAY,GAAG/L,gBAAgB,CAACvvB,OAAD,CAArC;AACA,MAAMke,WAAW,GAAGgU,sBAAsB,CAAClyB,OAAD,CAA1C;;AACA,MAAIke,WAAW,CAACve,MAAZ,GAAqB,CAArB,IAA0BiQ,YAA9B,EAA0C;AACxC,wBACEvU,6BAACqjC,cAAD,QACGxgB,WAAW,CAAC5d,GAAZ;AACC;AACA,cAACgM,UAAD,EAAaW,KAAb;AAAA,0BACE5R,6BAACuU,YAAD;AACE,QAAA,GAAG,YAAK5P,OAAL,aAAKA,OAAL,uBAAKA,OAAO,CAAEvC,EAAd,cAAoBwP,KAApB,CADL;AAEE,QAAA,UAAU,EAAEX,UAFd;AAGE,QAAA,aAAa,EAAE+uB,gBAAgB,IAAIC;AAHrC,QADF;AAAA,KAFD,CADH,CADF;AAcD;;AACD,SAAO,IAAP;AACD,CAzBD;;AA2BA+C,WAAW,CAACn1B,SAAZ,GAAwB;AACtB;AACAlJ,EAAAA,OAAO;AAAE;AAA2EmJ,EAAAA,SAAS,CAC1FmF,MADiF,CAC1EjF,UAHY;;AAItB;;;;AAIAuG,EAAAA,UAAU;AAAE;AAAmGzG,EAAAA,SAAS,CAACkH,WARnG;;AAStB;;;;;;;AAOAisB,EAAAA,OAAO;AAAE;AAAgGnzB,EAAAA,SAAS,CAACozB,SAAV,CACvG,CAACpzB,SAAS,CAACqzB,IAAX,EAAiBrzB,SAAS,CAACI,IAA3B,EAAiCJ,SAAS,CAACmF,MAA3C,CADuG,CAhBnF;;AAmBtB;AACAurB,EAAAA,UAAU,EAAE1wB,SAAS,CAACqE,IApBA;;AAqBtB;AACAjS,EAAAA,MAAM;AAAE;AAAsE4N,EAAAA,SAAS,CAACmF,MAtBlE;;AAuBtB;AACAuqB,EAAAA,cAAc,EAAE1vB,SAAS,CAACqE,IAxBJ;;AAyBtB;AACAwrB,EAAAA,aAAa;AAAE;AAAyE7vB,EAAAA,SAAS,CAACmF,MA1B5E;;AA2BtB;AACAyqB,EAAAA,UAAU,EAAE5vB,SAAS,CAACqE,IA5BA;;AA6BtB;AACAorB,EAAAA,gBAAgB,EAAEzvB,SAAS,CAACI,IA9BN;;AA+BtB;AACA4mB,EAAAA,OAAO,EAAEhnB,SAAS,CAACqE,IAhCG;;AAiCtB;AACAwY,EAAAA,iBAAiB,EAAE7c,SAAS,CAACI,IAlCP;;AAmCtB;AACAusB,EAAAA,WAAW,EAAE3sB,SAAS,CAACI,IApCD;;AAsCtB;AACAmxB,EAAAA,UAAU,EAAEvxB,SAAS,CAACI,IAvCA;;AAwCtB;;;;AAIA0nB,EAAAA,iBAAiB;AAAE;AAAyD9nB,EAAAA,SAAS,CAACI,IA5ChE;;AA6CtB;;;;;AAKAimB,EAAAA,aAAa,EAAErmB,SAAS,CAACI,IAlDH;;AAmDtB;;;;AAIAkyB,EAAAA,WAAW,EAAEtyB,SAAS,CAACI,IAvDD;;AAwDtB;;;;;;AAMAsjB,EAAAA,cAAc,EAAE1jB,SAAS,CAACI,IA9DJ;;AA+DtB;;;AAGAklB,EAAAA,gBAAgB;AAAE;AAA8FtlB,EAAAA,SAAS,CAACkH,WAlEpG;;AAmEtB;;;AAGAue,EAAAA,aAAa;AAAE;AAA2FzlB,EAAAA,SAAS,CAACkH,WAtE9F;;AAuEtB;AACAwhB,EAAAA,eAAe;AAAE;AAA6C1oB,EAAAA,SAAS,CAACmF,MAxElD;;AAyEtB;;;;;AAKAgtB,EAAAA,YAAY,EAAEnyB,SAAS,CAACI,IA9EF;;AA+EtB;;;;;;AAMAowB,EAAAA,sBAAsB,EAAExwB,SAAS,CAACI,IArFZ;;AAsFtB;;;;;;AAMAkwB,EAAAA,sBAAsB,EAAEtwB,SAAS,CAACI,IA5FZ;;AA6FtB;;;;;AAKAksB,EAAAA,WAAW,EAAEtsB,SAAS,CAACI,IAlGD;;AAmGtB;;;;;AAKAosB,EAAAA,WAAW,EAAExsB,SAAS,CAACI,IAxGD;;AAyGtB;AACAooB,EAAAA,WAAW,EAAExoB,SAAS,CAACG,KA1GD;;AA2GtB;;;;AAIA6wB,EAAAA,cAAc;AAAE;AAA4FhxB,EAAAA,SAAS,CAACkH;AA/GhG,CAAxB;AAkHA,iCAAehV,cAAK,CAACmO,IAAN,CAAW60B,WAAX,EAAwB7M,oBAAxB,CAAf;;ACtlBA;AAGA;;;;;;;IAMMmN,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACtL,eAAD,EAAkBF,eAAlB,EAAsC;AAChE,SAAO/oB,iBAAW;AAChB;AACA,YAACnB,CAAD,EAAIrI,eAAJ,EAAwB;AACtB,QAAI,CAACyyB,eAAD,IAAoB,CAACF,eAAzB,EAA0C,OADpB;;AAGtB,QAAM5nB,MAAM;AAAG;AAAgCtC,IAAAA,CAAC,CAACsC,MAAjD;AACA,QAAMqzB,OAAO,GAAGrzB,MAAH,aAAGA,MAAH,uBAAGA,MAAM,CAAEqzB,OAAR,CAAgBpb,WAAhB,EAAhB;AACA,QAAMqb,WAAW,GAAGtzB,MAAH,aAAGA,MAAH,uBAAGA,MAAM,CAAEuzB,SAAR,CAAkB5iC,OAAlB,CAA0B,GAA1B,EAA+B,EAA/B,CAApB;;AACA,QAAI0iC,OAAO,KAAK,QAAZ,IAAwBC,WAAW,CAAC,CAAD,CAAX,KAAmB,GAA/C,EAAoD;AAClD,UAAME,QAAQ,GAAGF,WAAW,CAAC3iC,OAAZ,CAAoB,GAApB,EAAyB,EAAzB,CAAjB;AACA,UAAMsD,IAAI,GAAGoB,eAAe,CAACuY,IAAhB,CACX;AAAA,YAAGld,IAAH,QAAGA,IAAH;AAAA,YAASwB,EAAT,QAASA,EAAT;AAAA,eAAkBxB,IAAI,KAAK8iC,QAAT,IAAqBthC,EAAE,KAAKshC,QAA9C;AAAA,OADW,CAAb;;AAGA,UACE1L,eAAe,IACf,OAAOA,eAAP,KAA2B,UAD3B,IAEApqB,CAAC,CAACjI,IAAF,KAAW,WAHb,EAIE;AACAqyB,QAAAA,eAAe,CAACpqB,CAAD,EAAIzJ,IAAJ,CAAf;AACD;;AACD,UACE2zB,eAAe,IACflqB,CAAC,CAACjI,IAAF,KAAW,OADX,IAEA,OAAOmyB,eAAP,KAA2B,UAH7B,EAIE;AACAA,QAAAA,eAAe,CAAClqB,CAAD,EAAIzJ,IAAJ,CAAf;AACD;AACF;AACF,GA5Be,EA6BhB,CAAC2zB,eAAD,EAAkBE,eAAlB,CA7BgB,CAAlB;AA+BD;;ACzCD;AAIA;;;;;;;IAMM2L,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACC,sBAAD,EAA4B;AAAA,oBAC5BlzB,gBAAU,CAAC3Q,WAAD,CADkB;AAAA,MAChDqiB,OADgD,eAChDA,OADgD;AAAA,MACvCliB,MADuC,eACvCA,MADuC;;AAExD,SAAO,UAACktB,cAAD,EAAoB;AACzB,QAAIwW,sBAAsB,IAAIxhB,OAA9B,EAAuC;AACrC,aAAO2M,OAAO,CAACC,OAAR,CACL4U,sBAAsB,CAACxhB,OAAO,CAACyB,GAAT,EAAcuJ,cAAd,CADjB,CAAP;AAGD;;AACD,WAAOltB,MAAM,CAACi0B,aAAP,CAAqB/G,cAArB,CAAP;AACD,GAPD;AAQD;;;;;ACjBD;;AACO,IAAMyW,cAAc,GAAG,SAAjBA,cAAiB,CAACxwB,KAAD,EAAQ3F,MAAR,EAAmB;AAC/C,UAAQA,MAAM,CAAC/H,IAAf;AACE,SAAK,sBAAL;AAA6B;AAAA,YACnByc,OADmB,GACP1U,MADO,CACnB0U,OADmB;AAE3B,mDACK/O,KADL;AAEEqP,UAAAA,QAAQ,EAAEN,OAAO,CAAC/O,KAAR,CAAcqP,QAF1B;AAGEohB,UAAAA,IAAI,EAAE1hB,OAAO,CAAC/O,KAAR,CAAcywB,IAHtB;AAIEzhB,UAAAA,QAAQ,EAAED,OAAO,CAAC/O,KAAR,CAAcgP,QAJ1B;AAKEW,UAAAA,OAAO,EAAEZ,OAAO,CAAC/O,KAAR,CAAc2P,OALzB;AAMEyN,UAAAA,YAAY,EAAErO,OAAO,CAAC/O,KAAR,CAAcmd,aAN9B;AAOEuT,UAAAA,OAAO,EAAE;AAPX;AASD;;AACD,SAAK,6BAAL;AAAoC;AAAA,YAC1B3hB,QAD0B,GACd1U,MADc,CAC1B0U,OAD0B;AAElC,mDACK/O,KADL;AAEEqP,UAAAA,QAAQ,EAAEN,QAAO,CAAC/O,KAAR,CAAcqP,QAF1B;AAGEohB,UAAAA,IAAI,EAAE1hB,QAAO,CAAC/O,KAAR,CAAcywB,IAHtB;AAIEzhB,UAAAA,QAAQ,EAAED,QAAO,CAAC/O,KAAR,CAAcgP,QAJ1B;AAKEqO,UAAAA,MAAM,EAAEtO,QAAO,CAAC/O,KAAR,CAAcqd,MALxB;AAMED,UAAAA,YAAY,EAAErO,QAAO,CAAC/O,KAAR,CAAcmd;AAN9B;AAQD;;AACD,SAAK,WAAL;AAAkB;AAAA,YACR7rB,OADQ,GACI+I,MADJ,CACR/I,OADQ;AAEhB,mDAAY0O,KAAZ;AAAmB2wB,UAAAA,MAAM,EAAEr/B;AAA3B;AACD;;AACD,SAAK,kBAAL;AAAyB;AAAA,YACfs/B,OADe,GACOv2B,MADP,CACfu2B,OADe;AAAA,YACNvhB,QADM,GACOhV,MADP,CACNgV,QADM;AAEvB,mDACKrP,KADL;AAEE6wB,UAAAA,WAAW,EAAE,KAFf;AAGED,UAAAA,OAHF;AAIEvhB,UAAAA;AAJF;AAMD;;AACD,SAAK,gBAAL;AAAuB;AAAA,YACbwhB,WADa,GACGx2B,MADH,CACbw2B,WADa;AAErB,mDAAY7wB,KAAZ;AAAmB6wB,UAAAA;AAAnB;AACD;;AACD,SAAK,yBAAL;AAAgC;AAAA,YACtB9hB,SADsB,GACA1U,MADA,CACtB0U,OADsB;AAAA,YACb+hB,QADa,GACAz2B,MADA,CACby2B,QADa;AAE9B,mDACK9wB,KADL;AAEEqP,UAAAA,QAAQ,EAAEN,SAAO,CAAC/O,KAAR,CAAcqP,QAF1B;AAGE0hB,UAAAA,cAAc,EAAED,QAAQ,GACpB/hB,SAAO,CAAC/O,KAAR,CAAcgxB,OAAd,CAAsBF,QAAtB,KAAmC,EADf,GAEpB9wB,KAAK,CAAC+wB;AALZ;AAOD;;AACD,SAAK,qBAAL;AAA4B;AAAA,YAClBhiB,SADkB,GACG1U,MADH,CAClB0U,OADkB;AAAA,YACTzd,QADS,GACG+I,MADH,CACT/I,OADS;AAE1B,YAAI,CAAC0O,KAAK,CAAC2wB,MAAX,EAAmB,OAAO3wB,KAAP;AACnB,mDACKA,KADL;AAEE+wB,UAAAA,cAAc,EAAEhiB,SAAO,CAAC/O,KAAR,CAAcgxB,OAAd,CAAsBhxB,KAAK,CAAC2wB,MAAN,CAAa5hC,EAAnC,CAFlB;AAGE4hC,UAAAA,MAAM,EACJ,CAAAr/B,QAAO,SAAP,IAAAA,QAAO,WAAP,YAAAA,QAAO,CAAEvC,EAAT,MAAgBiR,KAAK,CAAC2wB,MAAN,CAAa5hC,EAA7B,GACIggB,SAAO,CAAC/O,KAAR,CAAcixB,kBAAd,CAAiC3/B,QAAjC,CADJ,GAEI0O,KAAK,CAAC2wB;AANd;AAQD;;AACD,SAAK,YAAL;AAAmB;AAAA,YACTr/B,SADS,GACY+I,MADZ,CACT/I,OADS;AAAA,YACAyd,SADA,GACY1U,MADZ,CACA0U,OADA;AAEjB,mDACK/O,KADL;AAEE2wB,UAAAA,MAAM,EAAEr/B,SAFV;AAGEy/B,UAAAA,cAAc,EAAEhiB,SAAO,CAAC/O,KAAR,CAAcgxB,OAAd,CAAsB1/B,SAAO,CAACvC,EAA9B,KAAqC;AAHvD;AAKD;;AACD,SAAK,oBAAL;AAA2B;AACzB,mDACKiR,KADL;AAEEkxB,UAAAA,iBAAiB,EAAE;AAFrB;AAID;;AACD,SAAK,wBAAL;AAA+B;AAAA,YACrBC,aADqB,GACa92B,MADb,CACrB82B,aADqB;AAAA,YACNJ,cADM,GACa12B,MADb,CACN02B,cADM;AAE7B,mDACK/wB,KADL;AAEEmxB,UAAAA,aAFF;AAGEJ,UAAAA,cAHF;AAIEG,UAAAA,iBAAiB,EAAE;AAJrB;AAMD;;AACD,SAAK,aAAL;AAAoB;AAClB,mDACKlxB,KADL;AAEE2wB,UAAAA,MAAM,EAAE,IAFV;AAGEI,UAAAA,cAAc,EAAE7a,SAAS,CAAC,EAAD,CAH3B;AAIEgb,UAAAA,iBAAiB,EAAE;AAJrB;AAMD;;AACD,SAAK,UAAL;AAAiB;AAAA,YACP34B,KADO,GACG8B,MADH,CACP9B,KADO;AAEf,mDAAYyH,KAAZ;AAAmBzH,UAAAA;AAAnB;AACD;;AACD;AACE,aAAOyH,KAAP;AAnGJ;AAqGD,CAtGM;AAwGP;;AACO,IAAMoxB,YAAY,GAAG;AAC1B74B,EAAAA,KAAK,EAAE,IADmB;AAE1Bm4B,EAAAA,OAAO,EAAE,IAFiB;AAG1BG,EAAAA,WAAW,EAAE,KAHa;AAI1BD,EAAAA,OAAO,EAAE,IAJiB;AAK1BvhB,EAAAA,QAAQ,EAAE6G,SAAS,CAAC,EAAD,CALO;AAM1BmH,EAAAA,MAAM,EAAEnH,SAAS;AAAC;AAA4C,IAA7C,CANS;AAO1BvG,EAAAA,OAAO,EAAEuG,SAAS;AAAC;AAA4C,IAA7C,CAPQ;AAQ1BlH,EAAAA,QAAQ,EAAEkH,SAAS;AAAC;AAA4C,IAA7C,CARO;AAS1BkH,EAAAA,YAAY,EAAE,CATY;AAU1BqT,EAAAA,IAAI,EAAEva,SAAS;AAAC;AAA4C,IAA7C,CAVW;AAW1Bya,EAAAA,MAAM,EAAE,IAXkB;AAY1BI,EAAAA,cAAc,EAAE7a,SAAS,CAAC,EAAD,CAZC;AAa1Bgb,EAAAA,iBAAiB,EAAE,KAbO;AAc1BC,EAAAA,aAAa,EAAE;AAdW,CAArB;;;;;ACnFP;;AACA,IAAM9f,OAAO,GAAG,SAAVA,OAAU,OAA2C;AAAA,mCAAxCggB,gBAAwC;AAAA,MAAxCA,gBAAwC,sCAArB,IAAqB;AAAA,MAAZjkC,KAAY;;AAAA,oBACrBiQ,gBAAU,CAAC3Q,WAAD,CADW;AAAA,MACxC+hC,cADwC,eACjD1f,OADiD;;AAEzD,MAAMA,OAAO,GAAG3hB,KAAK,CAAC2hB,OAAN,IAAiB0f,cAAjC;;AACA,MAAI,EAAC1f,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEyB,GAAV,CAAJ,EAAmB;AACjB,WAAO6gB,gBAAP;AACD;;AACD,sBAAO1kC,6BAAC,YAAD,eAAkBS,KAAlB;AAAyB,IAAA,OAAO,EAAE2hB,OAAlC;AAA2C,IAAA,GAAG,EAAEA,OAAO,CAACyB;AAAxD,KAAP;AACD,CAPD;;AASAa,OAAO,CAAC7W,SAAR,GAAoB;AAClB;AACAuU,EAAAA,OAAO,EAAEtU,SAAS,CAAC2W,UAAV,CAAqBkgB,kBAArB,CAFS;;AAGlB;;;;;;AAMAD,EAAAA,gBAAgB,EAAE52B,SAAS,CAACzG,OATV;;AAUlB;;;;;;AAMA;AACA8e,EAAAA,qBAAqB,EAAErY,SAAS,CAACkH,WAjBf;;AAkBlB;;;;;;;AAOA;AACAoR,EAAAA,gBAAgB,EAAEtY,SAAS,CAACkH,WA1BV;;AA2BlB;;;;;;;;;;;AAWA;AACAisB,EAAAA,OAAO,EAAEnzB,SAAS,CAACkH,WAvCD;;AAwClB;;;;;AAKA;AACAT,EAAAA,UAAU,EAAEzG,SAAS,CAACkH,WA9CJ;;AA+ClB;;;;;;AAMA8iB,EAAAA,eAAe,EAAEhqB,SAAS,CAACI,IArDT;;AAsDlB;;;;;;AAMA8pB,EAAAA,eAAe,EAAElqB,SAAS,CAACI,IA5DT;;AA6DlB;AACAwhB,EAAAA,eAAe,EAAE5hB,SAAS,CAACqE,IA9DT;;AA+DlB;AACAke,EAAAA,aAAa,EAAEviB,SAAS,CAACG,KAhEP;;AAiElB;AACA0hB,EAAAA,gBAAgB,EAAE7hB,SAAS,CAACoE,MAlEV;;AAmElB;;;;;AAKA0yB,EAAAA,oBAAoB,EAAE92B,SAAS,CAACI,IAxEd;;AAyElB;;;;;AAKA22B,EAAAA,iBAAiB,EAAE/2B,SAAS,CAACI,IA9EX;;AA+ElB;;;;;AAKA01B,EAAAA,sBAAsB,EAAE91B,SAAS,CAACI;AApFhB,CAApB;AAuFA;;AACA,IAAM42B,YAAY,GAAG,SAAfA,YAAe,QAQf;AAAA;;AAAA,oCAPJ1e,gBAOI;AAAA,MAPJA,gBAOI,sCAPe2e,uBAOf;AAAA,oCANJ5e,qBAMI;AAAA,MANJA,qBAMI,sCANoB6e,8BAMpB;AAAA,+BALJzwB,UAKI;AAAA,MALJA,YAKI,iCALS0wB,UAKT;AAAA,4BAJJhE,OAII;AAAA,MAJJA,OAII,8BAJMiE,eAIN;AAAA,MAHJL,iBAGI,SAHJA,iBAGI;AAAA,MAFDpkC,KAEC;;AAAA,MACI2hB,OADJ,GACgB3hB,KADhB,CACI2hB,OADJ;;AAAA,oBAEsB6I,gBAAU,CAAC4Y,cAAD,EAAiBY,YAAjB,CAFhC;AAAA;AAAA,MAEGpxB,KAFH;AAAA,MAEU6X,QAFV;;AAGJ,MAAMia,aAAa,GAAG32B,YAAM,CAAC,EAAD,CAA5B;AACA,MAAM42B,QAAQ,GAAG52B,YAAM,CAAC,IAAIwoB,IAAJ,EAAD,CAAvB;AACA,MAAMqO,WAAW,GAAG30B,gBAAU,CAAC3Q,WAAD,CAA9B;;AALI,qBAMU2Q,gBAAU,CAACvP,kBAAD,CANpB;AAAA,MAMIC,CANJ,gBAMIA,CANJ;;;AASJ,MAAMkkC,6BAA6B,GAAGv2B,iBAAW,CAC/Cw2B,QAAQ,CACN,YAAM;AACJra,IAAAA,QAAQ,CAAC;AAAEvlB,MAAAA,IAAI,EAAE,6BAAR;AAAuCyc,MAAAA;AAAvC,KAAD,CAAR;AACD,GAHK,EAIN,GAJM,EAKN;AAAEojB,IAAAA,OAAO,EAAE,IAAX;AAAiBC,IAAAA,QAAQ,EAAE;AAA3B,GALM,CADuC,EAQ/C,CAACrjB,OAAD,CAR+C,CAAjD;AAWA,MAAMsjB,QAAQ,GAAG32B,iBAAW,CAAC,YAAM;AACjC,QAAIqT,OAAO,CAACujB,YAAR,IAAwB,CAACvjB,OAAO,CAAC+J,SAAR,GAAoByZ,WAAjD,EAA8D;AAC5D;AACD;;AACDR,IAAAA,QAAQ,CAACp2B,OAAT,GAAmB,IAAIgoB,IAAJ,EAAnB;;AACA,QAAI6N,iBAAJ,EAAuB;AACrBA,MAAAA,iBAAiB,CAACziB,OAAD,CAAjB;AACD,KAFD,MAEO;AACLyJ,MAAAA,kCAAuB,CAACzJ,OAAO,CAACsjB,QAAR,EAAD,EAAqB,WAArB,CAAvB;AACD;;AACD,QAAIP,aAAa,CAACn2B,OAAlB,EAA2B;AACzB0G,MAAAA,QAAQ,CAAC7F,KAAT,GAAiBs1B,aAAa,CAACn2B,OAA/B;AACD;AACF,GAb2B,EAazB,CAACoT,OAAD,EAAUyiB,iBAAV,CAbyB,CAA5B,CApBI;;AAoCJ,MAAMgB,iBAAiB,GAAG92B,iBAAW,CACnCw2B,QAAQ,CAACG,QAAD,EAAW,GAAX,EAAgB;AAAEF,IAAAA,OAAO,EAAE,IAAX;AAAiBC,IAAAA,QAAQ,EAAE;AAA3B,GAAhB,CAD2B,EAEnC,CAACC,QAAD,CAFmC,CAArC;AAKA,MAAM/hB,WAAW,GAAG5U,iBAAW,CAC7B,UAACnB,CAAD,EAAO;AACLsd,IAAAA,QAAQ,CAAC;AAAEvlB,MAAAA,IAAI,EAAE,qBAAR;AAA+BhB,MAAAA,OAAO,EAAEiJ,CAAC,CAACjJ,OAA1C;AAAmDyd,MAAAA;AAAnD,KAAD,CAAR;;AAEA,QAAIxU,CAAC,CAACjI,IAAF,KAAW,aAAf,EAA8B;AAC5B,UAAImgC,kBAAkB,GAAG,IAAzB;;AACA,UAAIl4B,CAAC,CAACjJ,OAAF,CAAUohC,SAAV,IAAuB,CAACn4B,CAAC,CAACjJ,OAAF,CAAUqhC,eAAtC,EAAuD;AACrDF,QAAAA,kBAAkB,GAAG,KAArB;AACD;;AAED,UACEA,kBAAkB,IAClBl4B,CAAC,CAACjJ,OAAF,CAAUR,IAAV,CAAe/B,EAAf,KAAsBijC,WAAW,CAACnlC,MAAZ,CAAmB64B,MAF3C,EAGE;AACA,YAAI,CAACrjB,QAAQ,CAACuwB,MAAd,EAAsB;AACpBJ,UAAAA,iBAAiB;AAClB,SAFD,MAEO,IAAIzjB,OAAO,CAAC+J,SAAR,GAAoByZ,WAAxB,EAAqC;AAC1C,cAAMtjB,MAAM,GAAGF,OAAO,CAACsB,WAAR,CAAoB0hB,QAAQ,CAACp2B,OAA7B,CAAf;AACA0G,UAAAA,QAAQ,CAAC7F,KAAT,cAAqByS,MAArB,eAAgC6iB,aAAa,CAACn2B,OAA9C;AACD;AACF;AACF;;AAEDs2B,IAAAA,6BAA6B;AAC9B,GAxB4B,EAyB7B,CACEljB,OADF,EAEEkjB,6BAFF,EAGED,WAAW,CAACnlC,MAAZ,CAAmB64B,MAHrB,EAIE8M,iBAJF,CAzB6B,CAA/B,CAzCI;;AA2EJK,EAAAA,qBAAe,CAAC,YAAM;AACpB,QAAIC,OAAO,GAAG,KAAd;AACA,QAAIC,IAAI,GAAG,KAAX;;AACA,QAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;AAC/B,UAAI,CAAC3wB,QAAQ,CAACuwB,MAAd,EAAsB;AACpBP,QAAAA,QAAQ;AACT;AACF,KAJD;;AAMA,6DAAC;AAAA;AAAA;AAAA;AAAA;AAAA,kBACMtjB,OAAO,CAACtV,WADd;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,qBAGWsV,OAAO,CAACkkB,KAAR,EAHX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAKKpb,cAAAA,QAAQ,CAAC;AAAEvlB,gBAAAA,IAAI,EAAE,UAAR;AAAoBiG,gBAAAA,KAAK;AAAzB,eAAD,CAAR;AACAu6B,cAAAA,OAAO,GAAG,IAAV;;AANL;AASCC,cAAAA,IAAI,GAAG,IAAP;AACAjB,cAAAA,aAAa,CAACn2B,OAAd,GAAwB0G,QAAQ,CAAC7F,KAAjC;;AACA,kBAAI,CAACs2B,OAAL,EAAc;AACZjb,gBAAAA,QAAQ,CAAC;AAAEvlB,kBAAAA,IAAI,EAAE,sBAAR;AAAgCyc,kBAAAA;AAAhC,iBAAD,CAAR;AACA,oBAAIA,OAAO,CAACsB,WAAR,KAAwB,CAA5B,EAA+BgiB,QAAQ,GAF3B;AAIZ;;AACAhwB,gBAAAA,QAAQ,CAACC,gBAAT,CAA0B,kBAA1B,EAA8C0wB,kBAA9C;AACAhB,gBAAAA,WAAW,CAACnlC,MAAZ,CAAmB4jB,EAAnB,CAAsB,sBAAtB,EAA8CH,WAA9C;AACAvB,gBAAAA,OAAO,CAAC0B,EAAR,CAAWH,WAAX;AACD;;AAnBF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD;;AAqBA,WAAO,YAAM;AACX,UAAIwiB,OAAO,IAAI,CAACC,IAAhB,EAAsB;AACtB1wB,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,kBAA7B,EAAiDwwB,kBAAjD;AACAjkB,MAAAA,OAAO,CAAC2B,GAAR,CAAYJ,WAAZ;AACA0hB,MAAAA,WAAW,CAACnlC,MAAZ,CAAmB6jB,GAAnB,CAAuB,sBAAvB,EAA+CJ,WAA/C;AACD,KALD;AAMD,GApCc,EAoCZ,CAACvB,OAAD,EAAUijB,WAAW,CAACnlC,MAAtB,EAA8ByjB,WAA9B,EAA2C+hB,QAA3C,EAAqDjlC,KAAK,CAAC2hB,OAA3D,CApCY,CAAf;AAsCA/S,EAAAA,eAAS,CAAC,YAAM;AACd,QAAIgE,KAAK,CAAC2wB,MAAV,EAAkB;AAChB,WAAK,IAAI9/B,CAAC,GAAGmP,KAAK,CAACqP,QAAN,CAAepe,MAAf,GAAwB,CAArC,EAAwCJ,CAAC,IAAI,CAA7C,EAAgDA,CAAC,IAAI,CAArD,EAAwD;AACtD,YAAImP,KAAK,CAACqP,QAAN,CAAexe,CAAf,EAAkB9B,EAAlB,KAAyBiR,KAAK,CAAC2wB,MAAN,CAAa5hC,EAA1C,EAA8C;AAC5C8oB,UAAAA,QAAQ,CAAC;AAAEvlB,YAAAA,IAAI,EAAE,WAAR;AAAqBhB,YAAAA,OAAO,EAAE0O,KAAK,CAACqP,QAAN,CAAexe,CAAf;AAA9B,WAAD,CAAR;AACA;AACD;AACF;AACF;AACF,GATQ,EASN,CAACmP,KAAK,CAACqP,QAAP,EAAiBrP,KAAK,CAAC2wB,MAAvB,CATM,CAAT,CAjHI;AA6HJ;;AACA,MAAMuC,gBAAgB,GAAGx3B,iBAAW,CAClCwY,QAAQ;AACN;;;;AAIA,YAAC0c,OAAD,EAAUvhB,QAAV,EAAuB;AACrBwI,IAAAA,QAAQ,CAAC;AAAEvlB,MAAAA,IAAI,EAAE,kBAAR;AAA4Bs+B,MAAAA,OAA5B;AAAqCvhB,MAAAA;AAArC,KAAD,CAAR;AACD,GAPK,EAQN,IARM,EASN;AACE8iB,IAAAA,OAAO,EAAE,IADX;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GATM,CAD0B,EAelC,EAfkC,CAApC;AAkBA,MAAMe,QAAQ,GAAGz3B,iBAAW,wEAC1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAO03B,YAAAA,KAAP,8DAAe,GAAf;AACE;AACMC,YAAAA,aAFR,GAEwBrzB,KAAK,CAACqP,QAAN,CAAe,CAAf,CAFxB;;AAAA,kBAGMrP,KAAK,CAAC6wB,WAAN,IAAqB,CAAAwC,aAAa,SAAb,IAAAA,aAAa,WAAb,YAAAA,aAAa,CAAE3I,MAAf,MAA0B,UAHrD;AAAA;AAAA;AAAA;;AAAA,8CAGwE,CAHxE;;AAAA;AAIE7S,YAAAA,QAAQ,CAAC;AAAEvlB,cAAAA,IAAI,EAAE,gBAAR;AAA0Bu+B,cAAAA,WAAW,EAAE;AAAvC,aAAD,CAAR;AAEMyC,YAAAA,QANR,GAMmB,CAAAD,aAAa,SAAb,IAAAA,aAAa,WAAb,YAAAA,aAAa,CAAEtkC,EAAf,KAAqB,IANxC;AAQQwkC,YAAAA,OARR,GAQkBH,KARlB;AAAA;AAAA;AAAA,mBAW0BrkB,OAAO,CAACoF,KAAR,CAAc;AAClC9E,cAAAA,QAAQ,EAAE;AAAE+jB,gBAAAA,KAAK,EAAEG,OAAT;AAAkBC,gBAAAA,KAAK,EAAEF;AAAzB;AADwB,aAAd,CAX1B;;AAAA;AAWIG,YAAAA,aAXJ;AAAA;AAAA;;AAAA;AAAA;AAAA;AAeIl9B,YAAAA,OAAO,CAACC,IAAR,CAAa,8CAAb;AACAqhB,YAAAA,QAAQ,CAAC;AAAEvlB,cAAAA,IAAI,EAAE,gBAAR;AAA0Bu+B,cAAAA,WAAW,EAAE;AAAvC,aAAD,CAAR;AAhBJ,8CAiBW,CAjBX;;AAAA;AAmBQ6C,YAAAA,eAnBR,GAmB0BD,aAAa,CAACpkB,QAAd,CAAuBpe,MAAvB,KAAkCsiC,OAnB5D;AAqBEL,YAAAA,gBAAgB,CAACQ,eAAD,EAAkB3kB,OAAO,CAAC/O,KAAR,CAAcqP,QAAhC,CAAhB;AArBF,8CAuBSokB,aAAa,CAACpkB,QAAd,CAAuBpe,MAvBhC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAD0B,IA0B1B,CAAC8d,OAAD,EAAUmkB,gBAAV,EAA4BlzB,KAAK,CAAC6wB,WAAlC,EAA+C7wB,KAAK,CAACqP,QAArD,CA1B0B,CAA5B;AA6BA,MAAMyR,aAAa,GAAGplB,iBAAW,CAC/B,UAACqe,cAAD,EAAoB;AAClB;AACA;AACAhL,IAAAA,OAAO,CAAC/O,KAAR,CAAc2zB,gBAAd,CAA+B5Z,cAA/B;AAEAlC,IAAAA,QAAQ,CAAC;AACPvlB,MAAAA,IAAI,EAAE,yBADC;AAEPw+B,MAAAA,QAAQ,EAAE9wB,KAAK,CAAC2wB,MAAN,IAAgB5W,cAAc,CAAC2Y,SAFlC;AAGP3jB,MAAAA;AAHO,KAAD,CAAR;AAKD,GAX8B,EAY/B,CAACA,OAAD,EAAU/O,KAAK,CAAC2wB,MAAhB,CAZ+B,CAAjC;AA7KI,MA4LIY,oBA5LJ,GA4L6BnkC,KA5L7B,CA4LImkC,oBA5LJ;AA6LJ,MAAMqC,aAAa,GAAGl4B,iBAAW;AAAA,yEAC/B,kBAAOpK,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACU5B,cAAAA,IADV,GACgE4B,OADhE,CACU5B,IADV,EACgB8f,WADhB,GACgEle,OADhE,CACgBke,WADhB,EAC6BzgB,EAD7B,GACgEuC,OADhE,CAC6BvC,EAD7B,EACiC2jC,SADjC,GACgEphC,OADhE,CACiCohC,SADjC,EAC4CxgC,eAD5C,GACgEZ,OADhE,CAC4CY,eAD5C;AAEQ2hC,cAAAA,WAFR,GAEsB;AAClBnkC,gBAAAA,IADkB;AAElB8f,gBAAAA,WAFkB;AAGlBtd,gBAAAA,eAHkB;AAIlBnD,gBAAAA,EAJkB;AAKlB2jC,gBAAAA;AALkB,eAFtB;AAAA;;AAAA,mBAYQnB,oBAZR;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAa8BA,oBAAoB,CAC1CxiB,OAAO,CAACyB,GADkC,EAE1CqjB,WAF0C,CAblD;;AAAA;AAaMC,cAAAA,eAbN;AAAA;AAAA;;AAAA;AAAA;AAAA,qBAkB8B/kB,OAAO,CAACkJ,WAAR,CAAoB4b,WAApB,CAlB9B;;AAAA;AAkBMC,cAAAA,eAlBN;;AAAA;AAqBI;AACA,kBAAIA,eAAe,IAAIA,eAAe,CAACxiC,OAAvC,EAAgD;AAC9CwvB,gBAAAA,aAAa,qCACRgT,eAAe,CAACxiC,OADR;AAEXo5B,kBAAAA,MAAM,EAAE;AAFG,mBAAb;AAID;;AA3BL;AAAA;;AAAA;AAAA;AAAA;AA6BI;AACA5J,cAAAA,aAAa,qCACRxvB,OADQ;AAEXo5B,gBAAAA,MAAM,EAAE;AAFG,iBAAb;;AA9BJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAD+B;;AAAA;AAAA;AAAA;AAAA,OAqC/B,CAAC3b,OAAD,EAAUwiB,oBAAV,EAAgCzQ,aAAhC,CArC+B,CAAjC;AAwCA,MAAMiT,oBAAoB,GAAGr4B,iBAAW,CACtC,UAAChM,IAAD,EAAO8f,WAAP,EAAoBgI,MAApB,EAA4BtlB,eAA5B,EAAgD;AAC9C;AACA,QAAM8hC,YAAY,aAAMhC,WAAW,CAACnlC,MAAZ,CAAmB64B,MAAzB,cAAmCuO,OAAM,EAAzC,CAAlB;AACA;AACEvkC,MAAAA,IADF;AAEEg0B,MAAAA,IAAI,EAAEh0B,IAFR;AAGE2V,MAAAA,MAAM,EAAE3V,IAHV;AAIEX,MAAAA,EAAE,EAAEilC,YAJN;AAKE1hC,MAAAA,IAAI,EAAE,SALR;AAMEo4B,MAAAA,MAAM,EAAE,SANV;AAOE55B,MAAAA,IAAI,EAAEkhC,WAAW,CAACnlC,MAAZ,CAAmBiE,IAP3B;AAQEV,MAAAA,UAAU,EAAE,IAAIuzB,IAAJ,EARd;AASEnU,MAAAA,WATF;AAUEtd,MAAAA,eAVF;AAWEiuB,MAAAA,SAAS,EAAE;AAXb,OAYM,CAAA3I,MAAM,SAAN,IAAAA,MAAM,WAAN,YAAAA,MAAM,CAAEzoB,EAAR,IAAa;AAAE2jC,MAAAA,SAAS,EAAElb,MAAM,CAACzoB;AAApB,KAAb,GAAwC,IAZ9C;AAcD,GAlBqC,EAmBtC,CAACijC,WAAW,CAACnlC,MAAZ,CAAmBiE,IAApB,EAA0BkhC,WAAW,CAACnlC,MAAZ,CAAmB64B,MAA7C,CAnBsC,CAAxC;AAsBA,MAAMzN,WAAW,GAAGvc,iBAAW;AAAA,yEAC7B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAShM,cAAAA,IAAT,SAASA,IAAT,4BAAe8f,WAAf,EAAeA,WAAf,kCAA6B,EAA7B,oDAAiCtd,eAAjC,EAAiCA,eAAjC,sCAAmD,EAAnD,0BAAuDslB,MAAvD,SAAuDA,MAAvD;AACE;AACAzI,cAAAA,OAAO,CAAC/O,KAAR,CAAck0B,mBAAd,GAFF;;AAKQC,cAAAA,cALR,GAKyBJ,oBAAoB,CACzCrkC,IADyC,EAEzC8f,WAFyC,EAGzCgI,MAHyC,EAIzCtlB,eAJyC,CAL7C;;AAaE4uB,cAAAA,aAAa,CAACqT,cAAD,CAAb;AAbF;AAAA,qBAeQP,aAAa,CAACO,cAAD,CAfrB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAD6B;;AAAA;AAAA;AAAA;AAAA,OAkB7B,CAACplB,OAAO,CAAC/O,KAAT,EAAgB+zB,oBAAhB,EAAsCH,aAAtC,EAAqD9S,aAArD,CAlB6B,CAA/B;AAqBA,MAAM+F,gBAAgB,GAAGnrB,iBAAW;AAAA,yEAClC,kBAAOpK,OAAP;AAAA;AAAA;AAAA;AAAA;AACE;AACAwvB,cAAAA,aAAa,qCACRxvB,OADQ;AAEXo5B,gBAAAA,MAAM,EAAE;AAFG,iBAAb,CAFF;;AAAA;AAAA,qBAOQkJ,aAAa,CAACtiC,OAAD,CAPrB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADkC;;AAAA;AAAA;AAAA;AAAA,OAUlC,CAACsiC,aAAD,EAAgB9S,aAAhB,CAVkC,CAApC;AAaA,MAAMC,aAAa,GAAGrlB,iBAAW,CAC/B,UAACpK,OAAD,EAAa;AACXyd,IAAAA,OAAO,CAAC/O,KAAR,CAAc+gB,aAAd,CAA4BzvB,OAA5B;AACAumB,IAAAA,QAAQ,CAAC;AACPvlB,MAAAA,IAAI,EAAE,yBADC;AAEPw+B,MAAAA,QAAQ,EAAE9wB,KAAK,CAAC2wB,MAAN,IAAgBr/B,OAAO,CAACohC,SAF3B;AAGP3jB,MAAAA;AAHO,KAAD,CAAR;AAKD,GAR8B,EAS/B,CAACA,OAAD,EAAU/O,KAAK,CAAC2wB,MAAhB,CAT+B,CAAjC,CA7RI;;AA2SJ,MAAMrL,UAAU,GAAG5pB,iBAAW,CAC5B,UAACpK,OAAD,EAAUiJ,CAAV,EAAgB;AACd,QAAIA,CAAC,IAAIA,CAAC,CAACoJ,cAAX,EAA2B;AACzBpJ,MAAAA,CAAC,CAACoJ,cAAF;AACD;;AAEDkU,IAAAA,QAAQ,CAAC;AAAEvlB,MAAAA,IAAI,EAAE,YAAR;AAAsBhB,MAAAA,OAAtB;AAA+Byd,MAAAA;AAA/B,KAAD,CAAR;AACD,GAP2B,EAQ5B,CAACA,OAAD,CAR4B,CAA9B,CA3SI;;AAuTJ,MAAMqlB,sBAAsB,GAAG14B,iBAAW,CACxCwY,QAAQ;AACN;;;;AAIA,YAACid,aAAD,EAAgBJ,cAAhB,EAAmC;AACjClZ,IAAAA,QAAQ,CAAC;AACPvlB,MAAAA,IAAI,EAAE,wBADC;AAEP6+B,MAAAA,aAFO;AAGPJ,MAAAA;AAHO,KAAD,CAAR;AAKD,GAXK,EAYN,IAZM,EAaN;AAAEoB,IAAAA,OAAO,EAAE,IAAX;AAAiBC,IAAAA,QAAQ,EAAE;AAA3B,GAbM,CADgC,EAgBxC,EAhBwC,CAA1C;AAmBA,MAAMiC,cAAc,GAAG34B,iBAAW,wEAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAE7BsE,KAAK,CAACkxB,iBAAN,IAA2B,CAAClxB,KAAK,CAAC2wB,MAFL;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAGjC9Y,YAAAA,QAAQ,CAAC;AAAEvlB,cAAAA,IAAI,EAAE;AAAR,aAAD,CAAR;AACMgiC,YAAAA,QAJ2B,GAIhBt0B,KAAK,CAAC2wB,MAAN,CAAa5hC,EAJG;AAK3BwlC,YAAAA,WAL2B,GAKbxlB,OAAO,CAAC/O,KAAR,CAAcgxB,OAAd,CAAsBsD,QAAtB,KAAmC,EALtB;AAM3BE,YAAAA,eAN2B,GAMTD,WAAW,CAAC,CAAD,CAAX,GAAiBA,WAAW,CAAC,CAAD,CAAX,CAAexlC,EAAhC,GAAqC,IAN5B;AAO3BqkC,YAAAA,KAP2B,GAOnB,EAPmB;AAAA;AAAA,mBAQLrkB,OAAO,CAAC0lB,UAAR,CAAmBH,QAAnB,EAA6B;AACvDlB,cAAAA,KADuD;AAEvDI,cAAAA,KAAK,EAAEgB;AAFgD,aAA7B,CARK;;AAAA;AAQ3Bf,YAAAA,aAR2B;AAa3BiB,YAAAA,qBAb2B,GAaHjB,aAAa,CAACpkB,QAAd,CAAuBpe,MAAvB,KAAkCmiC,KAb/B;AAe3BuB,YAAAA,iBAf2B,GAeP5lB,OAAO,CAAC/O,KAAR,CAAcgxB,OAAd,CAAsBsD,QAAtB,KAAmC,EAf5B;;AAkBjCF,YAAAA,sBAAsB,CAACM,qBAAD,EAAwBC,iBAAxB,CAAtB;;AAlBiC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD,IAmB/B,CAAC5lB,OAAD,EAAUqlB,sBAAV,EAAkCp0B,KAAK,CAAC2wB,MAAxC,EAAgD3wB,KAAK,CAACkxB,iBAAtD,CAnB+B,CAAlC;AAqBA,MAAM0D,WAAW,GAAGl5B,iBAAW,CAAC,UAACnB,CAAD,EAAO;AACrC,QAAIA,CAAC,IAAIA,CAAC,CAACoJ,cAAX,EAA2B;AACzBpJ,MAAAA,CAAC,CAACoJ,cAAF;AACD;;AACDkU,IAAAA,QAAQ,CAAC;AAAEvlB,MAAAA,IAAI,EAAE;AAAR,KAAD,CAAR;AACD,GAL8B,EAK5B,EAL4B,CAA/B;AAOA,MAAMuiC,sBAAsB,GAAG5E,mBAAmB,CAChD7iC,KAAK,CAACu3B,eAD0C,EAEhDv3B,KAAK,CAACq3B,eAF0C,CAAlD;AAKA,MAAMzM,WAAW,GAAGsY,qBAAqB,CAACljC,KAAK,CAACmjC,sBAAP,CAAzC;;AAEA,MAAMuE,mBAAmB,uCAEpB90B,KAFoB;AAGvBmd,IAAAA,aAAa,EAAEnd,KAAK,CAACod,YAHE;AAIvB;AACArO,IAAAA,OALuB;AAMvB6e,IAAAA,OANuB;AAOvB1sB,gBAAAA,YAPuB;AAQvBmb,IAAAA,eAAe,EAAEjvB,KAAK,CAACivB,eARA;AASvBW,IAAAA,aAAa,EAAE5vB,KAAK,CAAC4vB,aATE;AAUvBV,IAAAA,gBAAgB,EAAElvB,KAAK,CAACkvB,gBAVD;AAWvB0F,IAAAA,KAAK,EAAEgQ,WAAW,CAAChQ,KAXI;AAYvB;AACAmR,IAAAA,QAbuB;AAcvBnb,IAAAA,WAduB;AAevB8I,IAAAA,aAfuB;AAgBvB7I,IAAAA,WAhBuB;AAiBvB4O,IAAAA,gBAjBuB;AAkBvB9F,IAAAA,aAlBuB;AAmBvBuE,IAAAA,UAnBuB;AAoBvB+O,IAAAA,cApBuB;AAqBvBO,IAAAA,WArBuB;AAsBvBnQ,IAAAA,eAAe,EAAEoQ,sBAtBM;AAuBvBlQ,IAAAA,eAAe,EAAEkQ,sBAvBM;AAwBvB;AACAhoC,IAAAA,MAAM,EAAEmlC,WAAW,CAACnlC;AAzBG,IAAzB;;AA4BA,MAAIkoC,IAAJ;;AACA,MAAI/0B,KAAK,CAACzH,KAAV,EAAiB;AACfw8B,IAAAA,IAAI,gBAAGpoC,6BAAC,qBAAD;AAAuB,MAAA,KAAK,EAAEqT,KAAK,CAACzH;AAApC,MAAP;AACD,GAFD,MAEO,IAAIyH,KAAK,CAAC0wB,OAAV,EAAmB;AACxBqE,IAAAA,IAAI,gBAAGpoC,6BAAC,gBAAD;AAAkB,MAAA,IAAI,EAAE;AAAxB,MAAP;AACD,GAFM,MAEA,IAAI,oBAACS,KAAK,CAAC2hB,OAAP,mDAAC,eAAekkB,KAAhB,CAAJ,EAA2B;AAChC8B,IAAAA,IAAI,gBAAGpoC,0CAAMoB,CAAC,CAAC,iBAAD,CAAP,CAAP;AACD,GAFM,MAEA;AACLgnC,IAAAA,IAAI,gBACFpoC,6BAAC,cAAD,CAAgB,QAAhB;AAAyB,MAAA,KAAK,EAAEmoC;AAAhC,oBACEnoC;AAAK,MAAA,SAAS,EAAC;AAAf,OAAsCS,KAAK,CAACwP,QAA5C,CADF,CADF;AAKD;;AAED,sBACEjQ;AAAK,IAAA,SAAS,sCAA+BqlC,WAAW,CAAC5H,KAA3C;AAAd,KACG2K,IADH,CADF;AAKD,CAraD;;AAuaA,6BAAepoC,cAAK,CAACmO,IAAN,CAAWuW,OAAX,CAAf;;ACniBA;AAMA;;;;;;AAKA,IAAM2jB,aAAa,GAAG,SAAhBA,aAAgB,OAAqB;AAAA,MAAlBx4B,KAAkB,QAAlBA,KAAkB;AAAA,MAAXy4B,IAAW,QAAXA,IAAW;;AACzC;AADyC,oBAE3B53B,gBAAU,CAACvP,kBAAD,CAFiB;AAAA,MAEjCC,CAFiC,eAEjCA,CAFiC;AAGzC;;;AAHyC,qBAINsP,gBAAU,CAAC5P,cAAD,CAJJ;AAAA,MAIjCshB,OAJiC,gBAIjCA,OAJiC;AAAA,MAIxBoO,aAJwB,gBAIxBA,aAJwB;;AAAA,qBAKf9f,gBAAU,CAAC3Q,WAAD,CALK;AAAA,MAKjCwoC,aALiC,gBAKjCA,aALiC;;AAOzC,sBACEvoC;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC,4BAAf;AAA4C,IAAA,OAAO,EAAEuoC;AAArD,kBACEvoC;AAAM,IAAA,SAAS,EAAC;AAAhB,IADF,eAEEA;AAAM,IAAA,SAAS,EAAC;AAAhB,IAFF,eAGEA;AAAM,IAAA,SAAS,EAAC;AAAhB,IAHF,CADF,EAMGoiB,OAAO,IAAIA,OAAO,CAACzf,IAAR,CAAagO,KAAxB,iBACC3Q,6BAAC,MAAD;AACE,IAAA,KAAK,EAAEoiB,OAAO,CAACzf,IAAR,CAAagO,KADtB;AAEE,IAAA,KAAK,EAAC,SAFR;AAGE,IAAA,IAAI,EAAEyR,OAAO,CAACzc,IAAR,KAAiB,UAAjB,GAA8B,EAA9B,GAAmC;AAH3C,IAPJ,eAaE3F;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAG,IAAA,SAAS,EAAC;AAAb,KACG6P,KAAK,IAAKuS,OAAO,IAAIA,OAAO,CAACzf,IAAR,CAAa/B,IADrC,EAC4C,GAD5C,EAEG0nC,IAAI,iBACHtoC;AAAM,IAAA,SAAS,EAAC;AAAhB,KACGoB,CAAC,CAAC,MAAD,CADJ,CAHJ,CADF,EASGghB,OAAO,IAAIA,OAAO,CAACzf,IAAR,CAAa6lC,QAAxB,iBACCxoC;AAAG,IAAA,SAAS,EAAC;AAAb,KACGoiB,OAAO,CAACzf,IAAR,CAAa6lC,QADhB,CAVJ,eAcExoC;AAAG,IAAA,SAAS,EAAC;AAAb,KACG,CAACsoC,IAAD,IACClmB,OADD,IAECA,OAAO,CAACzf,IAAR,CAAa8lC,YAFd,IAGCrmB,OAAO,CAACzf,IAAR,CAAa8lC,YAAb,GAA4B,CAH7B,iBAIGzoC,4DACGoB,CAAC,CAAC,2BAAD,EAA8B;AAC9BsnC,IAAAA,WAAW,EAAEtmB,OAAO,CAACzf,IAAR,CAAa8lC;AADI,GAA9B,CADJ,OAII,GAJJ,CALN,EAYGrnC,CAAC,CAAC,2BAAD,EAA8B;AAAEqvB,IAAAA,YAAY,EAAED;AAAhB,GAA9B,CAZJ,CAdF,CAbF,CADF;AA6CD,CApDD;;AAsDA6X,aAAa,CAACx6B,SAAd,GAA0B;AACxB;AACAgC,EAAAA,KAAK,EAAE/B,SAAS,CAACC,MAFO;;AAGxB;AACAu6B,EAAAA,IAAI,EAAEx6B,SAAS,CAACqE;AAJQ,CAA1B;AAOA,mCAAenS,cAAK,CAACmO,IAAN,CAAWk6B,aAAX,CAAf;;ACxEA,kBAAe;;ACAf;AASA;;;;;;;AAMA,IAAMM,QAAQ,GAAG,SAAXA,QAAW,OAAqC;AAAA,MAAlCh4B,KAAkC,QAAlCA,KAAkC;AAAA,uBAA3BhL,IAA2B;AAAA,MAA3BA,IAA2B,0BAApB,OAAoB;AAAA,MAAX5C,IAAW,QAAXA,IAAW;;AAAA,oBACtC2N,gBAAU,CAACvP,kBAAD,CAD4B;AAAA,MAC5CC,CAD4C,eAC5CA,CAD4C;;AAGpD,sBACEpB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAACkmB,iBAAD,OADF,eAEElmB;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,mBAAY,cAAjB;AAAgC,IAAA,GAAG,EAAE2Q,KAAK,IAAIiY;AAA9C,IADF,eAEE5oB,yCAAK2F,IAAL,CAFF,eAGE3F,yCACG+C,IAAI,IACH3B,CAAC,CAAC,0DAAD,CAFL,CAHF,CAFF,CADF;AAaD,CAhBD;;AAkBAunC,QAAQ,CAAC96B,SAAT,GAAqB;AACnB;AACA8C,EAAAA,KAAK,EAAE7C,SAAS,CAACC,MAFE;;AAGnB;AACApI,EAAAA,IAAI,EAAEmI,SAAS,CAACC,MAAV,CAAiBC,UAJJ;;AAKnB;AACAjL,EAAAA,IAAI,EAAE+K,SAAS,CAACC;AANG,CAArB;AASA,8BAAe/N,cAAK,CAACmO,IAAN,CAAWw6B,QAAX,CAAf;;AC1CA,kBAAe;;ACAf;AAYA;;;;;;IAKMC,eAAe,GAAG,SAAlBA,eAAkB,OAQlB;AAAA,wBAPJh9B,KAOI;AAAA,MAPJA,KAOI,2BAPI,KAOJ;AAAA,MANJm4B,OAMI,QANJA,OAMI;AAAA,MALJ8E,YAKI,QALJA,YAKI;AAAA,MAJJC,WAII,QAJJA,WAII;AAAA,mCAHJ3iB,qBAGI;AAAA,MAHJA,qBAGI,sCAHoBwiB,UAGpB;AAAA,mCAFJviB,gBAEI;AAAA,MAFJA,gBAEI,sCAFeF,iBAEf;AAAA,MADJjW,QACI,QADJA,QACI;;AAAA,oBACeS,gBAAU,CAAC3Q,WAAD,CADzB;AAAA,MACIG,MADJ,eACIA,MADJ;;AAGJ,MAAI0L,KAAJ,EAAW;AACT,wBAAO5L,6BAAC,qBAAD;AAAuB,MAAA,IAAI,EAAC;AAA5B,MAAP;AACD;;AACD,MAAI+jC,OAAJ,EAAa;AACX,wBAAO/jC,6BAAC,gBAAD,OAAP;AACD;;AACD,sBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,KACG8oC,WAAW,iBACV9oC;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC,MAAD;AAAQ,IAAA,KAAK,EAAE6oC,YAAf;AAA6B,IAAA,IAAI,EAAE;AAAnC,IADF,CADF,CAFJ,eAQE7oC;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAAC,MAAD;AACE,IAAA,KAAK,EAAEE,MAAM,CAACiE,IAAP,CAAYwM,KADrB;AAEE,IAAA,IAAI,EAAEzQ,MAAM,CAACiE,IAAP,CAAYvD,IAAZ,IAAoBV,MAAM,CAACiE,IAAP,CAAY/B,EAFxC;AAGE,IAAA,IAAI,EAAE;AAHR,IADF,CADF,eAQEpC;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,KACGE,MAAM,CAACiE,IAAP,CAAYvD,IAAZ,IAAoBV,MAAM,CAACiE,IAAP,CAAY/B,EADnC,CADF,eAIEpC;AACE,IAAA,SAAS,wDAAiDE,MAAM,CAACiE,IAAP,CAAY45B,MAA7D;AADX,KAGG79B,MAAM,CAACiE,IAAP,CAAY45B,MAHf,CAJF,CARF,eAkBE/9B;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAQ,IAAA,SAAS,EAAC;AAAlB,kBACEA;AAAK,IAAA,GAAG,EAAE+oC;AAAV,IADF,CADF,CAlBF,CADF,EAyBG94B,QAzBH,CARF,CADF;AAsCD;;AAED24B,eAAe,CAAC/6B,SAAhB,GAA4B;AAC1B;AACAk2B,EAAAA,OAAO,EAAEj2B,SAAS,CAACqE,IAFO;;AAG1B;AACAvG,EAAAA,KAAK,EAAEkC,SAAS,CAACqE,IAJS;;AAK1B;AACA22B,EAAAA,WAAW,EAAEh7B,SAAS,CAACqE,IANG;;AAO1B;AACA02B,EAAAA,YAAY,EAAE/6B,SAAS,CAACC,MARE;;AAS1B;;;;;;;AAOAqY,EAAAA,gBAAgB;AAAE;AAA8FtY,EAAAA,SAAS,CAACkH,WAhBhG;;AAiB1B;;;;;;;AAOAmR,EAAAA,qBAAqB;AAAE;AAAsFrY,EAAAA,SAAS,CAACkH;AAxB7F,CAA5B;;AC1EA;AAMA;;;;AAGA,IAAMg0B,cAAc,GAAG,SAAjBA,cAAiB;AAAA,MAAG1nB,OAAH,QAAGA,OAAH;AAAA,MAAY2nB,UAAZ,QAAYA,UAAZ;AAAA,2BAAwBh5B,QAAxB;AAAA,MAAwBA,QAAxB,8BAAmC,WAAnC;AAAA,sBACrBjQ;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AACE,IAAA,SAAS,EAAC,oCADZ;AAEE,IAAA,OAAO,EAAEshB,OAFX;AAGE,mBAAY,kBAHd;AAIE,IAAA,QAAQ,EAAE2nB;AAJZ,KAMGA,UAAU,gBAAGjpC,6BAAComB,+BAAD,OAAH,GAA0BnW,QANvC,CADF,CADqB;AAAA,CAAvB;;AAaA+4B,cAAc,CAACn7B,SAAf,GAA2B;AACzB;AACAyT,EAAAA,OAAO,EAAExT,SAAS,CAACI,IAAV,CAAeF,UAFC;;AAGzB;AACAi7B,EAAAA,UAAU,EAAEn7B,SAAS,CAACqE,IAAV,CAAenE;AAJF,CAA3B;AAOA,yCAAehO,cAAK,CAACmO,IAAN,CAAW66B,cAAX,CAAf;;ACvBA,IAAME,iBAAiB,GAAG,SAApBA,iBAAoB;AAAA,MACxB3X,OADwB,QACxBA,OADwB;AAAA,MAExB4X,WAFwB,QAExBA,WAFwB;AAAA,MAGxBF,UAHwB,QAGxBA,UAHwB;AAAA,MAIxBG,YAJwB,QAIxBA,YAJwB;AAAA,MAKxBJ,cALwB,QAKxBA,cALwB;AAAA,MAMxB/4B,QANwB,QAMxBA,QANwB;AAAA,sBAQxBjQ,4DACG,CAACuxB,OAAD,IAAYthB,QADf,EAEGk5B,WAAW,IACVniC,WAAW,CAACgiC,cAAD,EAAiB;AAAEC,IAAAA,UAAF;AAAc3nB,IAAAA,OAAO,EAAE8nB;AAAvB,GAAjB,CAHf,EAIG7X,OAAO,IAAIthB,QAJd,CARwB;AAAA,CAA1B;;AAgBAi5B,iBAAiB,CAACrkB,YAAlB,GAAiC;AAC/BmkB,EAAAA,cAAc,EAAEK;AADe,CAAjC;AAIAH,iBAAiB,CAACr7B,SAAlB,GAA8B;AAC5Bm7B,EAAAA,cAAc,EAAEl7B,SAAS,CAACozB,SAAV,CAAoB,CAClCpzB,SAAS,CAACqzB,IADwB,EAElCrzB,SAAS,CAACI,IAFwB,EAGlCJ,SAAS,CAACmF,MAHwB,CAApB,CADY;;AAM5B;AACAm2B,EAAAA,YAAY,EAAEt7B,SAAS,CAACI,IAPI;;AAQ5B;AACAi7B,EAAAA,WAAW,EAAEr7B,SAAS,CAACqE,IATK;;AAU5B;AACAof,EAAAA,OAAO,EAAEzjB,SAAS,CAACqE;AAXS,CAA9B;AAcA,uCAAenS,cAAK,CAACmO,IAAN,CAAW+6B,iBAAX,CAAf;;ACxCA;AAMA;;;;AAGA,IAAMI,mBAAmB,GAAG,SAAtBA,mBAAsB,OAAkB;AAAA,MAAfC,QAAe,QAAfA,QAAe;;AAAA,oBAC9B74B,gBAAU,CAACvP,kBAAD,CADoB;AAAA,MACpCC,CADoC,eACpCA,CADoC;;AAE5C,MAAImoC,QAAQ,KAAK,SAAjB,EACE,oBAAOvpC,wCAAIoB,CAAC,CAAC,gCAAD,CAAL,CAAP;AAEF,MAAImoC,QAAQ,KAAK,SAAjB,EAA4B,OAAO,IAAP;AAE5B,sBAAOvpC,yDAAP;AACD,CARD;;AAUAspC,mBAAmB,CAACz7B,SAApB,GAAgC;AAC9B;AACA07B,EAAAA,QAAQ,EAAEz7B,SAAS,CAACC,MAAV,CAAiBC;AAFG,CAAhC;AAKA,yCAAehO,cAAK,CAACmO,IAAN,CAAWm7B,mBAAX,CAAf;;ACxBA;;AAEA;;;;AAIO,IAAME,aAAa,GAAG,SAAhBA,aAAgB,CAAC3lB,GAAD,EAAM4lB,QAAN,EAAmB;AAC9C;AACA,MAAMC,YAAY,GAAGD,QAAQ,CAACtyB,SAAT,CAAmB,UAACiL,OAAD;AAAA,WAAaA,OAAO,CAACyB,GAAR,KAAgBA,GAA7B;AAAA,GAAnB,CAArB;AAEA,MAAI6lB,YAAY,IAAI,CAApB,EAAuB,OAAOD,QAAP,CAJuB;;AAO9C,MAAMrnB,OAAO,GAAGqnB,QAAQ,CAACC,YAAD,CAAxB,CAP8C;;AAU9CD,EAAAA,QAAQ,CAACxhC,MAAT,CAAgByhC,YAAhB,EAA8B,CAA9B,EAV8C;;AAY9CD,EAAAA,QAAQ,CAACE,OAAT,CAAiBvnB,OAAjB;AAEA,4BAAWqnB,QAAX;AACD,CAfM;AAiBP;;;;;;AAKO,IAAMG,UAAU;AAAA,sEAAG,iBAAO1pC,MAAP,EAAeyF,IAAf,EAAqBvD,EAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAClBggB,YAAAA,OADkB,GACRliB,MAAM,CAACkiB,OAAP,CAAezc,IAAf,EAAqBvD,EAArB,CADQ;AAAA;AAAA,mBAElBggB,OAAO,CAACkkB,KAAR,EAFkB;;AAAA;AAAA,6CAGjBlkB,OAHiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAVwnB,UAAU;AAAA;AAAA;AAAA,GAAhB;AAMA,IAAMC,wBAAwB,GAAG,EAAjC;;AClCP;AAMA;;;;;;AAKO,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CACnCC,WADmC,EAGhC;AAAA,MADHC,gBACG,uEADgB,KAChB;;AAAA,oBACgBt5B,gBAAU,CAAC3Q,WAAD,CAD1B;AAAA,MACKG,MADL,eACKA,MADL;;AAEHmP,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAMsU,WAAW,GAAG,SAAdA,WAAc,CAAC/V,CAAD,EAAO;AACzBm8B,MAAAA,WAAW,CAAC,UAACN,QAAD,EAAc;AACxB,YAAI,CAACO,gBAAL,EAAuB,OAAOR,aAAa,CAAC57B,CAAC,CAACiW,GAAH,EAAQ4lB,QAAR,CAApB;AACvB,eAAOA,QAAP;AACD,OAHU,CAAX;AAID,KALD;;AAOAvpC,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,aAAV,EAAyBH,WAAzB;AAEA,WAAO,YAAM;AACXzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,aAAX,EAA0BJ,WAA1B;AACD,KAFD,CAXc;AAef,GAfQ,EAeN,CAACqmB,gBAAD,CAfM,CAAT;AAgBD,CArBM;;ACJP;;;;;;;AAMO,IAAMC,iCAAiC,GAAG,SAApCA,iCAAoC,CAC/CF,WAD+C,EAE/CG,aAF+C,EAG5C;AAAA,oBACgBx5B,gBAAU,CAAC3Q,WAAD,CAD1B;AAAA,MACKG,MADL,eACKA,MADL;;AAEHmP,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAMsU,WAAW;AAAA,0EAAG,iBAAO/V,CAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAGds8B,aAAa,IAAI,OAAOA,aAAP,KAAyB,UAH5B;AAAA;AAAA;AAAA;;AAIhBA,gBAAAA,aAAa,CAACH,WAAD,EAAcn8B,CAAd,CAAb;AAJgB;AAAA;;AAAA;AAAA,oCAKPA,CAAC,CAACwU,OALK,+CAKP,WAAWzc,IALJ;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAMMikC,UAAU,CAAC1pC,MAAD,EAAS0N,CAAC,CAACwU,OAAF,CAAUzc,IAAnB,EAAyBiI,CAAC,CAACwU,OAAF,CAAUhgB,EAAnC,CANhB;;AAAA;AAMVggB,gBAAAA,OANU;AAOhB;AACA2nB,gBAAAA,WAAW,CAAC,UAACN,QAAD,EAAc;AACxB,yBAAOU,MAAM,EAAE/nB,OAAF,4BAAcqnB,QAAd,IAAyB,KAAzB,CAAb;AACD,iBAFU,CAAX;;AARgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAAX9lB,WAAW;AAAA;AAAA;AAAA,OAAjB;;AAcAzjB,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,0BAAV,EAAsCH,WAAtC;AAEA,WAAO,YAAM;AACXzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,0BAAX,EAAuCJ,WAAvC;AACD,KAFD,CAlBc;AAsBf,GAtBQ,EAsBN,CAACumB,aAAD,CAtBM,CAAT;AAuBD,CA5BM;;ACNP;;;;;;;AAMO,IAAME,qCAAqC,GAAG,SAAxCA,qCAAwC,CACnDL,WADmD,EAEnDG,aAFmD,EAGhD;AAAA,oBACgBx5B,gBAAU,CAAC3Q,WAAD,CAD1B;AAAA,MACKG,MADL,eACKA,MADL;;AAEHmP,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAMsU,WAAW;AAAA,0EAAG,iBAAO/V,CAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACds8B,aAAa,IAAI,OAAOA,aAAP,KAAyB,UAD5B;AAAA;AAAA;AAAA;;AAEhBA,gBAAAA,aAAa,CAACH,WAAD,EAAcn8B,CAAd,CAAb;AAFgB;AAAA;;AAAA;AAAA,oCAGPA,CAAC,CAACwU,OAHK,+CAGP,WAAWzc,IAHJ;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAIMikC,UAAU,CAAC1pC,MAAD,EAAS0N,CAAC,CAACwU,OAAF,CAAUzc,IAAnB,EAAyBiI,CAAC,CAACwU,OAAF,CAAUhgB,EAAnC,CAJhB;;AAAA;AAIVggB,gBAAAA,OAJU;AAKhB2nB,gBAAAA,WAAW,CAAC,UAACN,QAAD;AAAA,yBAAcU,MAAM,EAAE/nB,OAAF,4BAAcqnB,QAAd,IAAyB,KAAzB,CAApB;AAAA,iBAAD,CAAX;;AALgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAAX9lB,WAAW;AAAA;AAAA;AAAA,OAAjB;;AASAzjB,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,+BAAV,EAA2CH,WAA3C;AAEA,WAAO,YAAM;AACXzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,+BAAX,EAA4CJ,WAA5C;AACD,KAFD,CAbc;AAiBf,GAjBQ,EAiBN,CAACumB,aAAD,CAjBM,CAAT;AAkBD,CAvBM;;ACbP;AAKA;;;;;;;AAMO,IAAMG,yCAAyC,GAAG,SAA5CA,yCAA4C,CACvDN,WADuD,EAEvDG,aAFuD,EAGpD;AAAA,oBACgBx5B,gBAAU,CAAC3Q,WAAD,CAD1B;AAAA,MACKG,MADL,eACKA,MADL;;AAEHmP,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAMsU,WAAW,GAAG,SAAdA,WAAc,CAAC/V,CAAD,EAAO;AACzB,UAAIs8B,aAAa,IAAI,OAAOA,aAAP,KAAyB,UAA9C,EAA0D;AACxDA,QAAAA,aAAa,CAACH,WAAD,EAAcn8B,CAAd,CAAb;AACD,OAFD,MAEO;AACLm8B,QAAAA,WAAW,CAAC,UAACN,QAAD;AAAA,iBACVA,QAAQ,CAAC1jC,MAAT,CAAgB,UAACqc,OAAD;AAAA;;AAAA,mBAAaA,OAAO,CAACyB,GAAR,oBAAgBjW,CAAC,CAACwU,OAAlB,+CAAgB,WAAWyB,GAA3B,CAAb;AAAA,WAAhB,CADU;AAAA,SAAD,CAAX;AAGD;AACF,KARD;;AAUA3jB,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,mCAAV,EAA+CH,WAA/C;AAEA,WAAO,YAAM;AACXzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,mCAAX,EAAgDJ,WAAhD;AACD,KAFD,CAdc;AAkBf,GAlBQ,EAkBN,CAACumB,aAAD,CAlBM,CAAT;AAmBD,CAxBM;;ACNP;;;;;;;AAMO,IAAMI,yBAAyB,GAAG,SAA5BA,yBAA4B,CAACP,WAAD,EAAcG,aAAd,EAAgC;AAAA,oBACpDx5B,gBAAU,CAAC3Q,WAAD,CAD0C;AAAA,MAC/DG,MAD+D,eAC/DA,MAD+D;;AAGvEmP,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAMsU,WAAW,GAAG,SAAdA,WAAc,CAAC/V,CAAD,EAAO;AACzB,UAAIs8B,aAAa,IAAI,OAAOA,aAAP,KAAyB,UAA9C,EAA0D;AACxDA,QAAAA,aAAa,CAACH,WAAD,EAAcn8B,CAAd,CAAb;AACD,OAFD,MAEO;AACLm8B,QAAAA,WAAW,CAAC,UAACN,QAAD,EAAc;AACxB,cAAMC,YAAY,GAAGD,QAAQ,CAACtyB,SAAT,CACnB,UAACiL,OAAD;AAAA,mBAAaA,OAAO,CAACyB,GAAR,MAAgBjW,CAAhB,aAAgBA,CAAhB,uBAAgBA,CAAC,CAAEiW,GAAnB,CAAb;AAAA,WADmB,CAArB;AAIA,cAAI6lB,YAAY,GAAG,CAAnB,EAAsB,0BAAWD,QAAX,EALE;;AAQxBA,UAAAA,QAAQ,CAACxhC,MAAT,CAAgByhC,YAAhB,EAA8B,CAA9B,EARwB;;AAWxB,oCAAWD,QAAX;AACD,SAZU,CAAX;AAaD;AACF,KAlBD;;AAoBAvpC,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,iBAAV,EAA6BH,WAA7B;AAEA,WAAO,YAAM;AACXzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,iBAAX,EAA8BJ,WAA9B;AACD,KAFD,CAxBc;AA4Bf,GA5BQ,EA4BN,CAACumB,aAAD,CA5BM,CAAT;AA6BD,CAhCM;;ACNP;;;;;;;;AAOO,IAAMK,2BAA2B,GAAG,SAA9BA,2BAA8B,CACzCR,WADyC,EAEzCG,aAFyC,EAGzCM,WAHyC,EAItC;AAAA,oBACgB95B,gBAAU,CAAC3Q,WAAD,CAD1B;AAAA,MACKG,MADL,eACKA,MADL;;AAEHmP,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAMsU,WAAW,GAAG,SAAdA,WAAc,CAAC/V,CAAD,EAAO;AACzBm8B,MAAAA,WAAW,CAAC,UAACN,QAAD;AAAA,kCAAkBA,QAAlB;AAAA,OAAD,CAAX;;AAEA,UAAIS,aAAa,IAAI,OAAOA,aAAP,KAAyB,UAA9C,EAA0D;AACxDA,QAAAA,aAAa,CAACH,WAAD,EAAcn8B,CAAd,CAAb;AACD;;AACD48B,MAAAA,WAAW,SAAX,IAAAA,WAAW,WAAX,YAAAA,WAAW;AACZ,KAPD;;AASAtqC,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,mBAAV,EAA+BH,WAA/B;AAEA,WAAO,YAAM;AACXzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,mBAAX,EAAgCJ,WAAhC;AACD,KAFD,CAbc;AAiBf,GAjBQ,EAiBN,CAACumB,aAAD,CAjBM,CAAT;AAkBD,CAxBM;;ACPP;;;;;;;;AAOO,IAAMO,yBAAyB,GAAG,SAA5BA,yBAA4B,CACvCV,WADuC,EAEvCG,aAFuC,EAGvCM,WAHuC,EAIpC;AAAA,oBACgB95B,gBAAU,CAAC3Q,WAAD,CAD1B;AAAA,MACKG,MADL,eACKA,MADL;;AAGHmP,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAMsU,WAAW,GAAG,SAAdA,WAAc,CAAC/V,CAAD,EAAO;AACzBm8B,MAAAA,WAAW,CAAC,UAACN,QAAD,EAAc;AACxB,YAAMC,YAAY,GAAGD,QAAQ,CAACtyB,SAAT,CACnB,UAACiL,OAAD;AAAA;;AAAA,iBAAaA,OAAO,CAACyB,GAAR,oBAAgBjW,CAAC,CAACwU,OAAlB,+CAAgB,WAAWyB,GAA3B,CAAb;AAAA,SADmB,CAArB;;AAIA,YAAI6lB,YAAY,GAAG,CAAC,CAAhB,IAAqB97B,CAAC,CAACwU,OAA3B,EAAoC;AAClC,cAAMsoB,WAAW,GAAGjB,QAApB;AACAiB,UAAAA,WAAW,CAAChB,YAAD,CAAX,CAA0B/mC,IAA1B,GAAiCiL,CAAC,CAACwU,OAAnC;AACA,oCAAWsoB,WAAX;AACD;;AAED,eAAOjB,QAAP;AACD,OAZU,CAAX;AAaAe,MAAAA,WAAW,SAAX,IAAAA,WAAW,WAAX,YAAAA,WAAW;;AACX,UAAIN,aAAa,IAAI,OAAOA,aAAP,KAAyB,UAA9C,EAA0D;AACxDA,QAAAA,aAAa,CAACH,WAAD,EAAcn8B,CAAd,CAAb;AACD;AACF,KAlBD;;AAoBA1N,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,iBAAV,EAA6BH,WAA7B;AAEA,WAAO,YAAM;AACXzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,iBAAX,EAA8BJ,WAA9B;AACD,KAFD,CAxBc;AA4Bf,GA5BQ,EA4BN,CAACumB,aAAD,CA5BM,CAAT;AA6BD,CApCM;;ACPP;;;;;;;AAMO,IAAMS,wBAAwB,GAAG,SAA3BA,wBAA2B,CAACZ,WAAD,EAAcG,aAAd,EAAgC;AAAA,oBACnDx5B,gBAAU,CAAC3Q,WAAD,CADyC;AAAA,MAC9DG,MAD8D,eAC9DA,MAD8D;;AAGtEmP,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAMsU,WAAW,GAAG,SAAdA,WAAc,CAAC/V,CAAD,EAAO;AACzB,UAAIs8B,aAAa,IAAI,OAAOA,aAAP,KAAyB,UAA9C,EAA0D;AACxDA,QAAAA,aAAa,CAACH,WAAD,EAAcn8B,CAAd,CAAb;AACD,OAFD,MAEO;AACLm8B,QAAAA,WAAW,CAAC,UAACN,QAAD,EAAc;AACxB,cAAMC,YAAY,GAAGD,QAAQ,CAACtyB,SAAT,CACnB,UAACiL,OAAD;AAAA,mBAAaA,OAAO,CAACyB,GAAR,MAAgBjW,CAAhB,aAAgBA,CAAhB,uBAAgBA,CAAC,CAAEiW,GAAnB,CAAb;AAAA,WADmB,CAArB;AAGA,cAAI6lB,YAAY,GAAG,CAAnB,EAAsB,0BAAWD,QAAX,EAJE;;AAOxBA,UAAAA,QAAQ,CAACxhC,MAAT,CAAgByhC,YAAhB,EAA8B,CAA9B,EAPwB;;AAUxB,oCAAWD,QAAX;AACD,SAXU,CAAX;AAYD;AACF,KAjBD;;AAmBAvpC,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,gBAAV,EAA4BH,WAA5B;AAEA,WAAO,YAAM;AACXzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,gBAAX,EAA6BJ,WAA7B;AACD,KAFD,CAvBc;AA2Bf,GA3BQ,EA2BN,CAACumB,aAAD,CA3BM,CAAT;AA4BD,CA/BM;;ACJP;;;;;;;AAMO,IAAMU,yBAAyB,GAAG,SAA5BA,yBAA4B,CAACb,WAAD,EAAcG,aAAd,EAAgC;AAAA,oBACpDx5B,gBAAU,CAAC3Q,WAAD,CAD0C;AAAA,MAC/DG,MAD+D,eAC/DA,MAD+D;;AAEvEmP,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAMsU,WAAW;AAAA,0EAAG,iBAAO/V,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACds8B,aAAa,IAAI,OAAOA,aAAP,KAAyB,UAD5B;AAAA;AAAA;AAAA;;AAEhBA,gBAAAA,aAAa,CAACH,WAAD,EAAcn8B,CAAd,CAAb;AAFgB;AAAA;;AAAA;AAAA,sBAGPA,CAHO,aAGPA,CAHO,uBAGPA,CAAC,CAAEjI,IAHI;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAIMikC,UAAU,CAAC1pC,MAAD,EAAS0N,CAAC,CAACi9B,YAAX,EAAyBj9B,CAAC,CAACk9B,UAA3B,CAJhB;;AAAA;AAIV1oB,gBAAAA,OAJU;AAKhB2nB,gBAAAA,WAAW,CAAC,UAACN,QAAD;AAAA,yBAAcU,MAAM,EAAE/nB,OAAF,4BAAcqnB,QAAd,IAAyB,KAAzB,CAApB;AAAA,iBAAD,CAAX;;AALgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAAX9lB,WAAW;AAAA;AAAA;AAAA,OAAjB;;AASAzjB,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,iBAAV,EAA6BH,WAA7B;AAEA,WAAO,YAAM;AACXzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,iBAAX,EAA8BJ,WAA9B;AACD,KAFD,CAbc;AAiBf,GAjBQ,EAiBN,CAACumB,aAAD,CAjBM,CAAT;AAkBD,CApBM;;ACbP;AAKA;;;;AAGO,IAAMa,8BAA8B,GAAG,SAAjCA,8BAAiC,CAACP,WAAD,EAAiB;AAAA,oBAC1C95B,gBAAU,CAAC3Q,WAAD,CADgC;AAAA,MACrDG,MADqD,eACrDA,MADqD;;AAE7DmP,EAAAA,eAAS,CAAC,YAAM;AACd,QAAMsU,WAAW,GAAG,SAAdA,WAAc,GAAM;AACxB6mB,MAAAA,WAAW,SAAX,IAAAA,WAAW,WAAX,YAAAA,WAAW;AACZ,KAFD;;AAIAtqC,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,sBAAV,EAAkCH,WAAlC;AAEA,WAAO,YAAM;AACXzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,sBAAX,EAAmCJ,WAAnC;AACD,KAFD,CAPc;AAWf,GAXQ,EAWN,EAXM,CAAT;AAYD,CAdM;;ACHP;;;;;AAIO,IAAMqnB,8BAA8B,GAAG,SAAjCA,8BAAiC,CAACjB,WAAD,EAAiB;AAAA,oBAC1Cr5B,gBAAU,CAAC3Q,WAAD,CADgC;AAAA,MACrDG,MADqD,eACrDA,MADqD;;AAE7DmP,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAMsU,WAAW,GAAG,SAAdA,WAAc,CAAC/V,CAAD,EAAO;AACzBm8B,MAAAA,WAAW,CAAC,UAACN,QAAD,EAAc;AACxB,YAAMiB,WAAW,GAAGjB,QAAQ,CAACxkC,GAAT,CAAa,UAACmd,OAAD,EAAa;AAAA;;AAC5C,cAAI,aAACxU,CAAC,CAACzJ,IAAH,4CAAC,QAAQ/B,EAAT,KAAe,CAACggB,OAAO,CAAC/O,KAAR,CAAc2P,OAAd,CAAsBpV,CAAC,CAACzJ,IAAF,CAAO/B,EAA7B,CAApB,EAAsD,OAAOggB,OAAP;AAEtDA,UAAAA,OAAO,CAAC/O,KAAR,CAAc2P,OAAd,CAAsB8G,KAAtB,CAA4B,CAAClc,CAAC,CAACzJ,IAAF,CAAO/B,EAAR,EAAY,MAAZ,CAA5B,EAAiDwL,CAAC,CAACzJ,IAAnD;AAEA,iBAAOie,OAAP;AACD,SANmB,CAApB;AAQA,kCAAWsoB,WAAX;AACD,OAVU,CAAX;AAWD,KAZD;;AAcAxqC,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,uBAAV,EAAmCH,WAAnC;AAEA,WAAO,YAAM;AACXzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,uBAAX,EAAoCJ,WAApC;AACD,KAFD,CAlBc;AAsBf,GAtBQ,EAsBN,EAtBM,CAAT;AAuBD,CAzBM;;;;;ACLP;;;;;;;;;AAQO,IAAMsnB,oBAAoB,GAAG,SAAvBA,oBAAuB,CAClC/qC,MADkC,EAElCgrC,OAFkC,EAGlC5iB,IAHkC,EAIlCre,OAJkC,EAKlCkhC,oBALkC,EAM/B;AAAA,kBAC6B18B,cAAQ;AAAC;AAA0B,IAA3B,CADrC;AAAA;AAAA,MACIg7B,QADJ;AAAA,MACcM,WADd;;AAAA,mBAE2Ct7B,cAAQ,CAAC,IAAD,CAFnD;AAAA;AAAA,MAEI28B,eAFJ;AAAA,MAEqBC,kBAFrB;;AAAA,mBAGiC58B,cAAQ,CAAC,IAAD,CAHzC;AAAA;AAAA,MAGIw6B,UAHJ;AAAA,MAGgBqC,aAHhB;;AAAA,mBAIyB78B,cAAQ,CAAC,CAAD,CAJjC;AAAA;AAAA,MAII88B,MAJJ;AAAA,MAIYC,SAJZ;;AAAA,mBAKuB/8B,cAAQ,CAAC,KAAD,CAL/B;AAAA;AAAA,MAKI7C,KALJ;AAAA,MAKW8V,QALX;;AAAA,oBAMmCjT,cAAQ,CAAC,IAAD,CAN3C;AAAA;AAAA,MAMI06B,WANJ;AAAA,MAMiBsC,cANjB;AAQH;;;;;AAGA,MAAMC,aAAa;AAAA,wEAAG,iBAAOC,SAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACpB,kBAAIA,SAAS,KAAK,QAAlB,EAA4B;AAC1B5B,gBAAAA,WAAW,CAAC,EAAD,CAAX;AACAsB,gBAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACD;;AAEDC,cAAAA,aAAa,CAAC,IAAD,CAAb;AAEMM,cAAAA,UARc;AASlBL,gBAAAA,MAAM,EAAEI,SAAS,KAAK,QAAd,GAAyB,CAAzB,GAA6BJ;AATnB,iBAUfthC,OAVe;AAWlBw8B,gBAAAA,KAAK,oBAAEx8B,OAAF,aAAEA,OAAF,uBAAEA,OAAO,CAAEw8B,KAAX,2DAAoBoD;AAXP;AAAA;AAAA;AAAA,qBAeiB3pC,MAAM,CAACwrC,aAAP,CACjCR,OADiC,EAEjC5iB,IAAI,IAAI,EAFyB,EAGjCsjB,UAHiC,CAfjB;;AAAA;AAeZC,cAAAA,oBAfY;;AAsBlB,kBAAIF,SAAS,KAAK,QAAlB,EAA4B;AAC1BjB,gBAAAA,WAAW,GAAGmB,oBAAd;AACD,eAFD,MAEO;AACLnB,gBAAAA,WAAW,gCAAOjB,QAAP,sBAAoBoC,oBAApB,EAAX;AACD;;AAED9B,cAAAA,WAAW,CAACW,WAAD,CAAX;AACAY,cAAAA,aAAa,CAAC,KAAD,CAAb;AACAG,cAAAA,cAAc,CAACI,oBAAoB,CAACvnC,MAArB,IAA+BsnC,UAAU,CAACnF,KAA3C,CAAd,CA9BkB;;AAiClB,kBAAI8E,MAAM,KAAK,CAAX,IAAgBJ,oBAApB,EAA0C;AACxCA,gBAAAA,oBAAoB,CAACT,WAAD,EAAcX,WAAd,CAApB;AACD;;AAEDyB,cAAAA,SAAS,CAACd,WAAW,CAACpmC,MAAb,CAAT;AArCkB;AAAA;;AAAA;AAAA;AAAA;AAuClBsF,cAAAA,OAAO,CAACC,IAAR;AACA6X,cAAAA,QAAQ,CAAC,IAAD,CAAR;;AAxCkB;AA0CpB2pB,cAAAA,kBAAkB,CAAC,KAAD,CAAlB;AACAC,cAAAA,aAAa,CAAC,KAAD,CAAb;;AA3CoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAbI,aAAa;AAAA;AAAA;AAAA,KAAnB;;AA8CA,MAAMtC,YAAY,GAAG,SAAfA,YAAe,GAAM;AACzBsC,IAAAA,aAAa;AACd,GAFD;;AAIAr8B,EAAAA,eAAS,CAAC,YAAM;AACdq8B,IAAAA,aAAa,CAAC,QAAD,CAAb,CADc;AAGf,GAHQ,EAGN,CAACR,OAAD,CAHM,CAAT;AAKA,SAAO;AACLzB,IAAAA,QADK;AAELL,IAAAA,YAFK;AAGLD,IAAAA,WAHK;AAILpL,IAAAA,MAAM,EAAE;AACNqN,MAAAA,eADM;AAENnC,MAAAA,UAFM;AAGNr9B,MAAAA;AAHM,KAJH;AASLm+B,IAAAA;AATK,GAAP;AAWD,CAnFM;;ACZP;AAIA;;;;;;AAKO,IAAM+B,mBAAmB,GAAG,SAAtBA,mBAAsB,CACjCC,cADiC,EAEjCC,OAFiC,EAGjCC,cAHiC,EAI9B;AACH58B,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAM68B,kBAAkB,GAAG,SAArBA,kBAAqB,CAACt+B,CAAD,EAAO;AAChC,UACEm+B,cAAc,CAAC/8B,OAAf,IACA,CAAC+8B,cAAc,CAAC/8B,OAAf,CAAuB0P,QAAvB;AACC;AAA4B9Q,MAAAA,CAAC,CAACsC,MAD/B,CADD,IAIA87B,OALF,EAME;AACAC,QAAAA,cAAc,SAAd,IAAAA,cAAc,WAAd,YAAAA,cAAc;AACf;AACF,KAVD;;AAYAv2B,IAAAA,QAAQ,CAACC,gBAAT,CAA0B,OAA1B,EAAmCu2B,kBAAnC;AAEA,WAAO,YAAM;AACXx2B,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,OAA7B,EAAsCq2B,kBAAtC;AACD,KAFD;AAGD,GAnBQ,EAmBN,CAACF,OAAD,EAAUD,cAAV,EAA0BE,cAA1B,CAnBM,CAAT;AAoBD,CAzBM;;;;;ACsBP;;;;;;AAKA,IAAME,WAAW,GAAG,SAAdA,WAAc,CAAC1rC,KAAD,EAAW;AAAA,oBAQzBiQ,gBAAU,CAAC3Q,WAAD,CARe;AAAA,MAE3BG,MAF2B,eAE3BA,MAF2B;AAAA,MAG3BE,gBAH2B,eAG3BA,gBAH2B;AAAA,wCAI3B4rC,OAJ2B;AAAA,MAI3BA,OAJ2B,oCAIjB,KAJiB;AAAA,MAK3BC,cAL2B,eAK3BA,cAL2B;AAAA,MAM3B7pB,OAN2B,eAM3BA,OAN2B;AAAA,MAO3Bqb,KAP2B,eAO3BA,KAP2B;;AAS7B,MAAMsO,cAAc,GAAGv9B,YAAM;AAAC;AAAsC,MAAvC,CAA7B;;AAT6B,kBAUuBC,cAAQ,CAAC,CAAD,CAV/B;AAAA;AAAA,MAUtB29B,kBAVsB;AAAA,MAUFC,qBAVE;AAY7B;;;;;;;;AAMA,MAAMlB,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAC1B,QAAD,EAAWM,WAAX,EAA2B;AAAA,gCAMlDtpC,KANkD,CAEpD6rC,uBAFoD;AAAA,QAEpDA,uBAFoD,sCAE1B,IAF0B;AAAA,QAGpDC,mBAHoD,GAMlD9rC,KANkD,CAGpD8rC,mBAHoD;AAAA,QAIpDlqB,QAJoD,GAMlD5hB,KANkD,CAIpD4hB,QAJoD;AAAA,yBAMlD5hB,KANkD,CAKpDwJ,OALoD;AAAA,QAKpDA,OALoD,+BAK1C,EAL0C;;AAQtD,QACE,CAACw/B,QAAD,IACAA,QAAQ,CAACnlC,MAAT,KAAoB,CADpB,IAEAmlC,QAAQ,CAACnlC,MAAT,IAAmB2F,OAAO,CAACw8B,KAAR,IAAiBoD,wBAApC,CAHF,EAIE;AACA;AACD;;AAED,QAAI0C,mBAAJ,EAAyB;AACvB,UAAMC,yBAAyB,GAAG/C,QAAQ,CAAC3rB,IAAT,CAChC,UAAC2uB,IAAD;AAAA,eAAUA,IAAI,CAACrqC,EAAL,KAAYmqC,mBAAtB;AAAA,OADgC,CAAlC;;AAGA,UAAIC,yBAAJ,EAA+B;AAC7BpsC,QAAAA,gBAAgB,SAAhB,IAAAA,gBAAgB,WAAhB,YAAAA,gBAAgB,CAAGosC,yBAAH,EAA8BnqB,QAA9B,CAAhB;AACA,YAAMqoB,WAAW,GAAGlB,aAAa,CAC/BgD,yBAAyB,CAAC3oB,GADK,EAE/B4lB,QAF+B,CAAjC;AAIAM,QAAAA,WAAW,CAACW,WAAD,CAAX;AACD;;AAED;AACD;;AAED,QAAI4B,uBAAJ,EAA6B;AAC3BlsC,MAAAA,gBAAgB,SAAhB,IAAAA,gBAAgB,WAAhB,YAAAA,gBAAgB,CAAGqpC,QAAQ,CAAC,CAAD,CAAX,EAAgBpnB,QAAhB,CAAhB;AACD;AACF,GAnCD,CAlB6B;AAwD7B;AACA;AACA;AACA;;;AACA,MAAMmoB,WAAW,GAAG,SAAdA,WAAc,GAAM;AACxB6B,IAAAA,qBAAqB,CAAC,UAACnZ,KAAD;AAAA,aAAWA,KAAK,GAAG,CAAnB;AAAA,KAAD,CAArB;AACD,GAFD;;AA5D6B,8BAsEzB+X,oBAAoB,CACtB/qC,MADsB,EAEtBO,KAAK,CAACyqC,OAAN,IAAiB,EAFK,EAGtBzqC,KAAK,CAAC6nB,IAAN,IAAc,EAHQ,EAItB7nB,KAAK,CAACwJ,OAAN,IAAiB,EAJK,EAKtBkhC,oBALsB,CAtEK;AAAA,MAiE3B1B,QAjE2B,yBAiE3BA,QAjE2B;AAAA,MAkE3BL,YAlE2B,yBAkE3BA,YAlE2B;AAAA,MAmE3BD,WAnE2B,yBAmE3BA,WAnE2B;AAAA,MAoE3BpL,MApE2B,yBAoE3BA,MApE2B;AAAA,MAqE3BgM,WArE2B,yBAqE3BA,WArE2B;;AA8E7B+B,EAAAA,mBAAmB,CAACC,cAAD,EAAiBC,OAAjB,EAA0BC,cAA1B,CAAnB,CA9E6B;;AAiF7BnC,EAAAA,qBAAqB,CAACC,WAAD,EAActpC,KAAK,CAACupC,gBAApB,CAArB;AACAC,EAAAA,iCAAiC,CAACF,WAAD,EAActpC,KAAK,CAACisC,YAApB,CAAjC;AACAtC,EAAAA,qCAAqC,CAACL,WAAD,EAActpC,KAAK,CAACksC,gBAApB,CAArC;AACAtC,EAAAA,yCAAyC,CACvCN,WADuC,EAEvCtpC,KAAK,CAACmsC,oBAFiC,CAAzC;AAIAtC,EAAAA,yBAAyB,CAACP,WAAD,EAActpC,KAAK,CAACosC,gBAApB,CAAzB;AACAlC,EAAAA,wBAAwB,CAACZ,WAAD,EAActpC,KAAK,CAACqsC,eAApB,CAAxB;AACAlC,EAAAA,yBAAyB,CAACb,WAAD,EAActpC,KAAK,CAACssC,gBAApB,CAAzB;AACAxC,EAAAA,2BAA2B,CACzBR,WADyB,EAEzBtpC,KAAK,CAACusC,kBAFmB,EAGzBxC,WAHyB,CAA3B;AAKAC,EAAAA,yBAAyB,CAACV,WAAD,EAActpC,KAAK,CAACwsC,gBAApB,EAAsCzC,WAAtC,CAAzB;AACAO,EAAAA,8BAA8B,CAACP,WAAD,CAA9B;AACAQ,EAAAA,8BAA8B,CAACjB,WAAD,CAA9B,CAlG6B;;AAqG7B16B,EAAAA,eAAS,CAAC,YAAM;AACd;AACA,QAAMsU,WAAW,GAAG,SAAdA,WAAc,CAAC/V,CAAD,EAAO;AACzB,UAAI,CAAAA,CAAC,SAAD,IAAAA,CAAC,WAAD,YAAAA,CAAC,CAAEiW,GAAH,OAAWzB,OAAX,aAAWA,OAAX,uBAAWA,OAAO,CAAEyB,GAApB,CAAJ,EAA6B;AAC3BzjB,QAAAA,gBAAgB,SAAhB,IAAAA,gBAAgB,WAAhB,YAAAA,gBAAgB;AACjB;AACF,KAJD;;AAMAF,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,iBAAV,EAA6BH,WAA7B;AACAzjB,IAAAA,MAAM,CAAC4jB,EAAP,CAAU,gBAAV,EAA4BH,WAA5B;AAEA,WAAO,YAAM;AACXzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,iBAAX,EAA8BJ,WAA9B;AACAzjB,MAAAA,MAAM,CAAC6jB,GAAP,CAAW,gBAAX,EAA6BJ,WAA7B;AACD,KAHD,CAXc;AAgBf,GAhBQ,EAgBN,CAACvB,OAAD,CAhBM,CAAT,CArG6B;;AAwH7B;;AACA,MAAM8qB,aAAa,GAAG,SAAhBA,aAAgB,CAACjpC,IAAD,EAAU;AAC9B,QAAI,CAACA,IAAL,EAAW,OAAO,IAAP;AADmB,yBAGiCxD,KAHjC,CAGtB6iB,OAHsB;AAAA,QAGtBA,OAHsB,+BAGZqB,2BAHY;AAAA,0BAGiClkB,KAHjC,CAGe4hB,QAHf;AAAA,QAGeA,QAHf,gCAG0B,EAH1B;AAI9B,QAAM8qB,YAAY,GAAG;AACnB/qB,MAAAA,OAAO,EAAEne,IADU;AAEnBqf,MAAAA,OAFmB;AAGnBD,MAAAA,aAAa,EAAEjB,OAHI;AAInBhiB,MAAAA,gBAJmB;AAKnBiiB,MAAAA,QALmB;AAMnBhhB,MAAAA,GAAG,EAAE4C,IAAI,CAAC7B,EANS;AAOnB;AACAgqC,MAAAA;AARmB,KAArB;AAUA,WAAOplC,WAAW,CAACoc,cAAD,sBAAsB+pB,YAAtB,EAAlB;AACD,GAfD,CAzH6B;;;AA2I7B,MAAMC,yBAAyB,GAAG,SAA5BA,yBAA4B,GAAM;AAAA,gCACuB3sC,KADvB,CAC9B6oC,mBAD8B;AAAA,QAC9BA,mBAD8B,sCACR+D,qBADQ;AAGtC,wBAAOrtC,6BAAC,mBAAD;AAAqB,MAAA,QAAQ,EAAC;AAA9B,MAAP;AACD,GAJD,CA3I6B;;;AAkJ7B,MAAMstC,UAAU,GAAG,SAAbA,UAAa,GAAM;AAAA,sBAOnB7sC,KAPmB,CAErBqW,IAFqB;AAAA,QAErBA,IAFqB,4BAEd8xB,eAFc;AAAA,2BAOnBnoC,KAPmB,CAGrB8sC,SAHqB;AAAA,QAGrBA,SAHqB,iCAGTrE,mBAHS;AAAA,QAIrBJ,WAJqB,GAOnBroC,KAPmB,CAIrBqoC,WAJqB;AAAA,gCAOnBroC,KAPmB,CAKrB2lB,gBALqB;AAAA,QAKrBA,gBALqB,sCAKFF,iBALE;AAAA,gCAOnBzlB,KAPmB,CAMrB0lB,qBANqB;AAAA,QAMrBA,qBANqB,sCAMGwiB,UANH;AASvB,wBACE3oC,6BAAC,IAAD;AACE,MAAA,OAAO,EAAE+9B,MAAM,CAACqN,eADlB;AAEE,MAAA,KAAK,EAAErN,MAAM,CAACnyB,KAFhB;AAGE,MAAA,WAAW,EAAEk9B,WAHf;AAIE,MAAA,gBAAgB,EAAE1iB,gBAJpB;AAKE,MAAA,qBAAqB,EAAED;AALzB,OAOG,CAACsjB,QAAD,IAAaA,QAAQ,CAACnlC,MAAT,KAAoB,CAAjC,GACG8oC,yBAAyB,EAD5B,GAEGpmC,WAAW,CAACumC,SAAD,EAAY;AACrBnE,MAAAA,YADqB;AAErBD,MAAAA,WAFqB;AAGrBF,MAAAA,UAAU,EAAElL,MAAM,CAACkL,UAHE;AAIrBh5B,MAAAA,QAAQ,EAAEw5B,QAAQ,CAACxkC,GAAT,CAAa,UAAChB,IAAD;AAAA,eAAUipC,aAAa,CAACjpC,IAAD,CAAvB;AAAA,OAAb;AAJW,KAAZ,CATjB,CADF;AAkBD,GA3BD;;AA6BA,sBACEjE,6BAACA,cAAD,CAAO,QAAP,qBACEA;AACE,IAAA,SAAS,2CAAoCy9B,KAApC,cACPuO,OAAO,GAAG,6BAAH,GAAmC,EADnC,CADX;AAIE,IAAA,GAAG,EAAED;AAJP,KAMGuB,UAAU,EANb,CADF,CADF;AAYD,CA3LD;;AA6LAnB,WAAW,CAACt+B,SAAZ,GAAwB;AACtB;AACAy7B,EAAAA,mBAAmB;AAAE;AAAiGx7B,EAAAA,SAAS,CAACkH,WAF1G;;AAGtB;;;;;;;;;AASAsO,EAAAA,OAAO;AAAE;AAAuGxV,EAAAA,SAAS,CAACkH,WAZpG;;AActB;;;;;;;;;AASAoR,EAAAA,gBAAgB;AAAE;AAA8FtY,EAAAA,SAAS,CAACkH,WAvBpG;;AAwBtB;;;;;;;;AAQAmR,EAAAA,qBAAqB;AAAE;AAAsFrY,EAAAA,SAAS,CAACkH,WAhCjG;;AAiCtB;;;;;;;;;;;;;;;;AAgBA8B,EAAAA,IAAI;AAAE;AAAoGhJ,EAAAA,SAAS,CAACkH,WAjD9F;;AAkDtB;;;;;;;;;;;AAWAu4B,EAAAA,SAAS;AAAE;AAAuFz/B,EAAAA,SAAS,CAACkH,WA7DtF;;AA8DtB;;;;;;AAMA03B,EAAAA,YAAY,EAAE5+B,SAAS,CAACI,IApEF;;AAqEtB;;;;;;AAMAy+B,EAAAA,gBAAgB,EAAE7+B,SAAS,CAACI,IA3EN;;AA4EtB;;;;;;AAMA0+B,EAAAA,oBAAoB,EAAE9+B,SAAS,CAACI,IAlFV;;AAmFtB;;;;;;AAMA++B,EAAAA,gBAAgB,EAAEn/B,SAAS,CAACI,IAzFN;;AA0FtB;;;;;;AAMA8+B,EAAAA,kBAAkB,EAAEl/B,SAAS,CAACI,IAhGR;;AAiGtB;;;;;;AAMA2+B,EAAAA,gBAAgB,EAAE/+B,SAAS,CAACI,IAvGN;;AAwGtB;;;;AAIAg9B,EAAAA,OAAO;AAAE;AAAoEp9B,EAAAA,SAAS,CAACmF,MA5GjE;;AA6GtB;;;;AAIAhJ,EAAAA,OAAO,EAAE6D,SAAS,CAACmF,MAjHG;;AAkHtB;;;;AAIAqV,EAAAA,IAAI;AAAE;AAAiExa,EAAAA,SAAS,CAACmF,MAtH3D;;AAuHtB;;;;AAIAoP,EAAAA,QAAQ;AAAE;AAA+HvU,EAAAA,SAAS,CAACmF,MA3H7H;;AA6HtB;;;AAGAs5B,EAAAA,mBAAmB,EAAEz+B,SAAS,CAACC,MAhIT;;AAiItB;;;AAGAu+B,EAAAA,uBAAuB,EAAEx+B,SAAS,CAACqE,IApIb;;AAqItB;;;AAGA63B,EAAAA,gBAAgB,EAAEl8B,SAAS,CAACqE;AAxIN,CAAxB;AA2IA,iCAAenS,cAAK,CAACmO,IAAN,CAAWg+B,WAAX,CAAf;;AC5WA;AAQA;;;;;;IAKaqB,oBAAoB,GAAG,SAAvBA,oBAAuB,OAM9B;AAAA,wBALJ5hC,KAKI;AAAA,MALJA,KAKI,2BALI,KAKJ;AAAA,MAJJm4B,OAII,QAJJA,OAII;AAAA,mCAHJ5d,qBAGI;AAAA,MAHJA,qBAGI,sCAHoBwiB,UAGpB;AAAA,mCAFJviB,gBAEI;AAAA,MAFJA,gBAEI,sCAFeF,iBAEf;AAAA,MADJjW,QACI,QADJA,QACI;;AACJ,MAAIrE,KAAJ,EAAW;AACT,wBAAO5L,6BAAC,qBAAD;AAAuB,MAAA,IAAI,EAAC;AAA5B,MAAP;AACD;;AACD,MAAI+jC,OAAJ,EAAa;AACX,wBAAO/jC,6BAAC,gBAAD,OAAP;AACD;;AACD,sBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,KAAyDiQ,QAAzD,CADF,CADF;AAKD;AAEDu9B,oBAAoB,CAAC3/B,SAArB,GAAiC;AAC/B;AACAk2B,EAAAA,OAAO,EAAEj2B,SAAS,CAACqE,IAFY;;AAG/B;AACAvG,EAAAA,KAAK,EAAEkC,SAAS,CAACqE,IAJc;;AAK/B;;;;;;;AAOAiU,EAAAA,gBAAgB;AAAE;AAA8FtY,EAAAA,SAAS,CAACkH,WAZ3F;;AAa/B;;;;;;;AAOAmR,EAAAA,qBAAqB;AAAE;AAAsFrY,EAAAA,SAAS,CAACkH;AApBxF,CAAjC;;ACjCA;AAGA;;;;AAGA,IAAMy4B,aAAa,GAAG,SAAhBA,aAAgB;AAAA,sBACpBztC;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,WAAW,EAAC;AAA/B,IADF,eAEEA;AAAQ,IAAA,IAAI,EAAC;AAAb,kBACEA;AACE,IAAA,KAAK,EAAC,IADR;AAEE,IAAA,MAAM,EAAC,IAFT;AAGE,IAAA,OAAO,EAAC,WAHV;AAIE,IAAA,KAAK,EAAC;AAJR,kBAMEA;AACE,IAAA,CAAC,EAAC,wDADJ;AAEE,IAAA,QAAQ,EAAC;AAFX,IANF,CADF,CAFF,CADoB;AAAA,CAAtB;;AAmBA,mCAAeA,cAAK,CAACmO,IAAN,CAAWs/B,aAAX,CAAf;;;;;AChBA;;;;;;;;;;;;;;;;;;IAiBMC,IAAI,GAAG,SAAPA,IAAO,OAMP;AAAA;;AAAA,MALJxtC,MAKI,QALJA,MAKI;AAAA,wBAJJu9B,KAII;AAAA,MAJJA,KAII,2BAJI,iBAIJ;AAAA,MAHJjyB,YAGI,QAHJA,YAGI;AAAA,iCAFJmiC,cAEI;AAAA,MAFJA,cAEI,oCAFa,IAEb;AAAA,MADJ19B,QACI,QADJA,QACI;;AAAA,kBACkCxB,cAAQ;AAC5C;AAAmE;AACjErN,IAAAA,CAAC;AAAE;AAA2B,eAACC,GAAD;AAAA,aAASA,GAAT;AAAA,KADmC;AAEjEC,IAAAA,eAAe,EAAE,yBAACC,KAAD;AAAA,aAAWP,KAAK,CAACO,KAAD,CAAhB;AAAA;AAFgD,GADvB,CAD1C;AAAA;AAAA,MACGqsC,WADH;AAAA,MACgBC,cADhB;;AAAA,mBAOsBp/B,cAAQ;AAChC;AAA6C,IADb,CAP9B;AAAA;AAAA,MAOG4mB,KAPH;AAAA,MAOUyY,QAPV;;AAAA,mBAU0Br/B,cAAQ,CAACk/B,cAAD,CAVlC;AAAA;AAAA,MAUG3B,OAVH;AAAA,MAUY+B,UAVZ;;AAAA,mBAW0Bt/B,cAAQ;AACpC;AAA6BtH,EAAAA,SADO,CAXlC;AAAA;AAAA,MAWGib,OAXH;AAAA,MAWY4rB,UAXZ;;AAeJ,MAAMzF,aAAa,GAAG,SAAhBA,aAAgB;AAAA,WAAM0F,UAAU,CAAC;AAAA,aAAMF,UAAU,CAAC,IAAD,CAAhB;AAAA,KAAD,EAAyB,GAAzB,CAAhB;AAAA,GAAtB;;AACA,MAAM9B,cAAc,GAAG,SAAjBA,cAAiB;AAAA,WAAM8B,UAAU,CAAC,KAAD,CAAhB;AAAA,GAAvB;;AACA,MAAMG,WAAW,GAAGhuC,MAAH,aAAGA,MAAH,uCAAGA,MAAM,CAAEiE,IAAX,iDAAG,aAAckxB,KAAlC;AAEAhmB,EAAAA,eAAS,CAAC,YAAM;AACdy+B,IAAAA,QAAQ,CAACI,WAAW,IAAI,EAAhB,CAAR;AAEA;;AACA,QAAMvqB,WAAW,GAAG,SAAdA,WAAc,CAAC/V,CAAD,EAAO;AAAA;;AACzB,UAAIA,CAAC,CAACjI,IAAF,KAAW,4BAAf,EAA6CmoC,QAAQ,CAAC,UAAAlgC,CAAC,CAACugC,EAAF,gDAAM9Y,KAAN,KAAe,EAAhB,CAAR;AAC9C,KAFD;;AAGA,QAAIn1B,MAAJ,EAAYA,MAAM,CAAC4jB,EAAP,CAAUH,WAAV;AACZ,WAAO;AAAA,aAAMzjB,MAAM,IAAIA,MAAM,CAAC6jB,GAAP,CAAWJ,WAAX,CAAhB;AAAA,KAAP;AACD,GATQ,EASN,CAACzjB,MAAD,EAASguC,WAAT,CATM,CAAT;AAWA7+B,EAAAA,eAAS,CAAC,YAAM;AACd,QAAI++B,UAAJ;AACA,QAAI5iC,YAAY,YAAYxB,UAA5B,EAAwCokC,UAAU,GAAG5iC,YAAb,CAAxC,KACK4iC,UAAU,GAAG,IAAIpkC,UAAJ,CAAe;AAAET,MAAAA,QAAQ,EAAE;AAAZ,KAAf,CAAb;AAEL6kC,IAAAA,UAAU,CAACC,2BAAX,CAAuC,UAACjtC,CAAD;AAAA,aACrCysC,cAAc,CAAC,UAACS,cAAD;AAAA,mDAA0BA,cAA1B;AAA0CltC,UAAAA;AAA1C;AAAA,OAAD,CADuB;AAAA,KAAvC;AAGAgtC,IAAAA,UAAU,CAACG,cAAX,GAA4BlrC,IAA5B,CAAiC,UAACmrC,UAAD,EAAgB;AAC/C,UAAIA,UAAJ,EAAgBX,cAAc,CAACW,UAAD,CAAd;AACjB,KAFD;AAGD,GAXQ,EAWN,CAAChjC,YAAD,CAXM,CAAT;AAaA,MAAMpL,gBAAgB,GAAG2O,iBAAW;AAAA;;AAClC;;;;;AADkC;AAAA,yEAMlC,iBAAOsU,aAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsBhB,cAAAA,QAAtB,2DAAiC,EAAjC;AAAqCzU,cAAAA,CAArC;AACE,kBAAIA,CAAC,IAAIA,CAAC,CAACoJ,cAAX,EAA2BpJ,CAAC,CAACoJ,cAAF;;AAD7B,oBAGMqM,aAAa,IAAI5gB,MAAM,CAACqB,IAAP,CAAYue,QAAZ,EAAsB/d,MAH7C;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAIU+e,aAAa,CAACmE,KAAd,CAAoB;AAAE8e,gBAAAA,KAAK,EAAE,IAAT;AAAejkB,gBAAAA;AAAf,eAApB,CAJV;;AAAA;AAME2rB,cAAAA,UAAU,CAAC3qB,aAAD,CAAV;AACA4oB,cAAAA,cAAc;;AAPhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KANkC;;AAAA;AAAA;AAAA;AAAA,OAelC,EAfkC,CAApC;AAkBA,MAAI,CAAC2B,WAAW,CAACxsC,CAAjB,EAAoB,OAAO,IAAP;AAEpB,sBACEpB,6BAAC,WAAD,CAAa,QAAb;AACE,IAAA,KAAK,EAAE;AACLE,MAAAA,MADK;AAELu9B,MAAAA,KAFK;AAGLrb,MAAAA,OAHK;AAILiT,MAAAA,KAJK;AAKL2W,MAAAA,OALK;AAML5rC,MAAAA,gBANK;AAOLmoC,MAAAA,aAPK;AAQL0D,MAAAA;AARK;AADT,kBAYEjsC,6BAAC,kBAAD,CAAoB,QAApB;AAA6B,IAAA,KAAK,EAAE4tC;AAApC,KACG39B,QADH,CAZF,CADF;AAkBD;;AAEDy9B,IAAI,CAAC7/B,SAAL,GAAiB;AACf;AACA3N,EAAAA,MAAM;AAAE;AAAsE4N,EAAAA,SAAS,CACpFmF,MAD2E,CACpEjF,UAHK;;AAIf;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCAyvB,EAAAA,KAAK,EAAE3vB,SAAS,CAACC,MAzCF;;AA0Cf;AACA4/B,EAAAA,cAAc,EAAE7/B,SAAS,CAACqE;AA3CX,CAAjB;;ACnHA;AAMA;;;;;;;AAMA,IAAMs8B,aAAa,GAAG,SAAhBA,aAAgB,OAA8C;AAAA,2BAA3Cx/B,QAA2C;AAAA,MAA3CA,QAA2C,8BAAhC,OAAgC;AAAA,MAAvBowB,UAAuB,QAAvBA,UAAuB;AAAA,MAAXqP,IAAW,QAAXA,IAAW;;AAAA,oBACtCh+B,gBAAU,CAACvP,kBAAD,CAD4B;AAAA,MAC1DG,eAD0D,eAC1DA,eAD0D;;AAElE,MAAI,OAAOotC,IAAP,KAAgB,QAApB,EAA8B,OAAO,IAAP;AAE9B,sBACE1uC;AAAK,IAAA,SAAS,EAAC;AAAf,KACG,CAACiP,QAAQ,KAAK,OAAb,IAAwBA,QAAQ,KAAK,QAAtC,kBACCjP;AAAI,IAAA,SAAS,EAAC;AAAd,IAFJ,eAIEA;AAAK,IAAA,SAAS,EAAC;AAAf,KACGq/B,UAAU,GACPA,UAAU,CAACqP,IAAD,CADH,GAEPptC,eAAe,CAACotC,IAAI,CAACC,WAAL,EAAD,CAAf,CAAoCpmC,QAApC,EAHN,CAJF,EASG,CAAC0G,QAAQ,KAAK,MAAb,IAAuBA,QAAQ,KAAK,QAArC,kBACCjP;AAAI,IAAA,SAAS,EAAC;AAAd,IAVJ,CADF;AAeD,CAnBD;;AAqBAyuC,aAAa,CAAC5gC,SAAd,GAA0B;AACxB;AACA6gC,EAAAA,IAAI,EAAE5gC,SAAS,CAAC2W,UAAV,CAAqBuS,IAArB,EAA2BhpB,UAFT;;AAGxB;AACAiB,EAAAA,QAAQ,EAAEnB,SAAS,CAACoU,KAAV,CAAgB,CAAC,MAAD,EAAS,QAAT,EAAmB,OAAnB,CAAhB,CAJc;;AAKxB;AACAmd,EAAAA,UAAU,EAAEvxB,SAAS,CAACI;AANE,CAA1B;AASA,wCAAelO,cAAK,CAACmO,IAAN,CAAWsgC,aAAX,CAAf;;AC1CA;AAOA;;;;;AAIA,IAAMG,cAAc,GAAG,SAAjBA,cAAiB,OAAiB;AAAA,MAAdjqC,OAAc,QAAdA,OAAc;;AAAA,oBACV+L,gBAAU,CAACvP,kBAAD,CADA;AAAA,MAC9BG,eAD8B,eAC9BA,eAD8B;;AAAA,MAE9BqE,IAF8B,GAEIhB,OAFJ,CAE9BgB,IAF8B;AAAA,MAExB5C,IAFwB,GAEI4B,OAFJ,CAExB5B,IAFwB;AAAA,MAElBmX,KAFkB,GAEIvV,OAFJ,CAElBuV,KAFkB;AAAA,MAEXzW,UAFW,GAEIkB,OAFJ,CAEXlB,UAFW;AAItC,MAAIkC,IAAI,KAAK,QAAb,EACE,oBACE3F;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAC;AAAf,IADF,eAEEA,wCAAI+C,IAAJ,CAFF,eAGE/C;AAAK,IAAA,SAAS,EAAC;AAAf,IAHF,CADF,eAMEA;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6CAASsB,eAAe,CAACmC,UAAD,CAAf,CAA4B67B,MAA5B,CAAmC,MAAnC,CAAT,MADF,SAEMh+B,eAAe,CAACmC,UAAD,CAAf,CAA4B67B,MAA5B,CAAmC,SAAnC,CAFN,CANF,CADF;;AAcF,MACE35B,IAAI,KAAK,eAAT,KACCuU,KAAK,CAACvU,IAAN,KAAe,gBAAf,IAAmCuU,KAAK,CAACvU,IAAN,KAAe,cADnD,CADF,EAGE;AACA,QAAM/E,IAAI,GAAGsZ,KAAK,CAAC/V,IAAN,CAAWvD,IAAX,IAAmBsZ,KAAK,CAAC/V,IAAN,CAAW/B,EAA3C;AACA,QAAMysC,QAAQ,aAAMjuC,IAAN,cACZsZ,KAAK,CAACvU,IAAN,KAAe,cAAf,GACI,qBADJ,GAEI,2BAHQ,CAAd;AAMA,wBACE3F;AAAK,MAAA,SAAS,EAAC;AAAf,oBACEA,6BAAC,MAAD;AAAQ,MAAA,KAAK,EAAEka,KAAK,CAAC/V,IAAN,CAAWwM,KAA1B;AAAiC,MAAA,IAAI,EAAE/P;AAAvC,MADF,eAEEZ;AAAK,MAAA,SAAS,EAAC;AAAf,oBACEA;AAAI,MAAA,SAAS,EAAC;AAAd,OACG6uC,QADH,CADF,eAIE7uC;AAAK,MAAA,SAAS,EAAC;AAAf,OACGsB,eAAe,CAACmC,UAAD,CAAf,CAA4B67B,MAA5B,CAAmC,IAAnC,CADH,CAJF,CAFF,CADF;AAaD;;AAED,SAAO,IAAP;AACD,CA9CD;;AAgDAsP,cAAc,CAAC/gC,SAAf,GAA2B;AACzB;AACA;AACAlJ,EAAAA,OAAO,EAAEmJ,SAAS,CAACmF,MAAV,CAAiBjF;AAHD,CAA3B;AAMA,oCAAehO,cAAK,CAACmO,IAAN,CAAWygC,cAAX,CAAf;;;;;AC7DA;;;;;;AAKA,IAAME,kBAAkB,GAAG,SAArBA,kBAAqB,CAAClhC,CAAD,EAAO;AAChC,MAAIA,CAAC,YAAYmhC,UAAb,IAA2BnhC,CAAC,CAACohC,MAAF,KAAa,CAA5C,EAA+C;AAC7CphC,IAAAA,CAAC,CAACoJ,cAAF;AACD;AACF,CAJD;AAMA;;;;;;AAIA,IAAMi4B,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAC3wB,EAAD,EAAQ;AACnC,MAAIA,EAAE,YAAY4wB,WAAlB,EAA+B;AAC7B,WAAO5wB,EAAE,CAAChF,SAAH,GAAe21B,oBAAoB,CAAC3wB,EAAE,CAAC6wB,YAAJ,CAA1C;AACD;;AACD,SAAO,CAAP;AACD,CALD;AAOA;;;;;;;AAKA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAAC9wB,EAAD,EAAK9E,SAAL,EAAmB;AACzC,MAAI,CAAC8E,EAAL,EAAS;AACP,WAAO,CAAP;AACD;;AAED,SACE2wB,oBAAoB,CAAC3wB,EAAD,CAApB,IACCA,EAAE,CAAC+wB,YAAH,GAAkB71B,SAAlB,GAA8B81B,MAAM,CAACC,WADtC,CADF;AAID,CATD;AAWA;;;IACMC,cAAc,GAAG,SAAjBA,cAAiB,OAejB;AAAA,MAdJv/B,QAcI,QAdJA,QAcI;AAAA,0BAbJ5I,OAaI;AAAA,MAbJA,OAaI,6BAbM,KAaN;AAAA,0BAZJ48B,OAYI;AAAA,MAZJA,OAYI,6BAZM,KAYN;AAAA,8BAXJwL,WAWI;AAAA,MAXJA,WAWI,iCAXU,IAWV;AAAA,4BAVJC,SAUI;AAAA,MAVJA,SAUI,+BAVQ,KAUR;AAAA,MATJC,MASI,QATJA,MASI;AAAA,MARJnJ,QAQI,QARJA,QAQI;AAAA,4BAPJoJ,SAOI;AAAA,MAPJA,SAOI,+BAPQ,GAOR;AAAA,6BANJC,UAMI;AAAA,MANJA,UAMI,gCANS,KAMT;AAAA,4BALJC,SAKI;AAAA,MALJA,SAKI,+BALQ,IAKR;AAAA,4BAJJC,SAII;AAAA,MAJJA,SAII,+BAJQ,KAIR;AAAA,MAHJC,cAGI,QAHJA,cAGI;AAAA,MAFDC,YAEC;;AACJ,MAAMC,eAAe,GAAG1hC,YAAM;AAAC;AAAmC,MAApC,CAA9B;AAEA,MAAM2hC,cAAc,GAAGphC,iBAAW,CAAC,YAAM;AACvC,QAAMuP,EAAE,GAAG4xB,eAAe,CAAClhC,OAA3B;AACA,QAAI,CAACsP,EAAL,EAAS;AAF8B,QAG/B8xB,aAH+B,GAGb9xB,EAHa,CAG/B8xB,aAH+B;AAKvC,QAAI7E,MAAM,GAAG,CAAb;AACA,QAAI8E,aAAa,GAAG,CAApB;;AACA,QAAIP,SAAJ,EAAe;AACb,UAAMQ,GAAG,GACP56B,QAAQ,CAAC66B,eAAT,IAA4B76B,QAAQ,CAAC86B,IAAT,CAAcC,UAA1C,IAAwD/6B,QAAQ,CAAC86B,IADnE;AAEA,UAAMh3B,SAAS,GACb81B,MAAM,CAACoB,WAAP,KAAuBvpC,SAAvB,GAAmCmoC,MAAM,CAACoB,WAA1C,GAAwDJ,GAAG,CAAC92B,SAD9D;AAEA+xB,MAAAA,MAAM,GAAG6D,eAAe,CAAC9wB,EAAD,EAAK9E,SAAL,CAAxB;AACA62B,MAAAA,aAAa,GAAG72B,SAAhB;AACD,KAPD,MAOO,IAAI42B,aAAJ,EAAmB;AACxB7E,MAAAA,MAAM,GACJjtB,EAAE,CAACqyB,YAAH,GAAkBP,aAAa,CAAC52B,SAAhC,GAA4C42B,aAAa,CAACQ,YAD5D;AAEAP,MAAAA,aAAa,GAAGD,aAAa,CAAC52B,SAA9B;AACD;;AACD,QAAIw2B,cAAJ,EAAoBA,cAAc,CAACzE,MAAD,EAAS8E,aAAT,CAAd,CAnBmB;;AAsBvC,QACE,CAACX,SAAS,GAAGW,aAAH,GAAmB9E,MAA7B,IAAuC7vB,MAAM,CAACk0B,SAAD,CAA7C,IACAtxB,EAAE,CAAC6wB,YAAH,KAAoB,IADpB,IAEA,OAAO3I,QAAP,KAAoB,UAHtB,EAIE;AACAA,MAAAA,QAAQ;AACT;AACF,GA7BiC,EA6B/B,CAACsJ,SAAD,EAAYJ,SAAZ,EAAuBE,SAAvB,EAAkCI,cAAlC,EAAkDxJ,QAAlD,CA7B+B,CAAlC;AA+BAn3B,EAAAA,eAAS,CAAC,YAAM;AAAA;;AACd,QAAMwhC,QAAQ,GAAGf,SAAS,GAAGR,MAAH,4BAAYY,eAAe,CAAClhC,OAA5B,0DAAY,sBAAyByhC,UAA/D;;AACA,QAAI,CAACxM,OAAD,IAAY8L,SAAZ,IAAyB,CAACc,QAA9B,EAAwC;AACtC,aAAO,YAAM,EAAb;AACD;;AAEDA,IAAAA,QAAQ,CAACl7B,gBAAT,CAA0B,QAA1B,EAAoCw6B,cAApC,EAAoDN,UAApD;AACAgB,IAAAA,QAAQ,CAACl7B,gBAAT,CAA0B,QAA1B,EAAoCw6B,cAApC,EAAoDN,UAApD;;AAEA,QAAIJ,WAAJ,EAAiB;AACfU,MAAAA,cAAc;AACf;;AAED,WAAO,YAAM;AACXU,MAAAA,QAAQ,CAACh7B,mBAAT,CAA6B,QAA7B,EAAuCs6B,cAAvC,EAAuDN,UAAvD;AACAgB,MAAAA,QAAQ,CAACh7B,mBAAT,CAA6B,QAA7B,EAAuCs6B,cAAvC,EAAuDN,UAAvD;AACD,KAHD;AAID,GAjBQ,EAiBN,CAAC5L,OAAD,EAAUwL,WAAV,EAAuBM,SAAvB,EAAkCI,cAAlC,EAAkDN,UAAlD,EAA8DC,SAA9D,CAjBM,CAAT;AAmBAzgC,EAAAA,eAAS,CAAC,YAAM;AAAA;;AACd,QAAMwhC,QAAQ,GAAGf,SAAS,GAAGR,MAAH,6BAAYY,eAAe,CAAClhC,OAA5B,2DAAY,uBAAyByhC,UAA/D;AACA,QAAI,CAACI,QAAL,EAAe,OAAO,YAAM,EAAb;AACfA,IAAAA,QAAQ,CAACl7B,gBAAT,CAA0B,YAA1B,EAAwCm5B,kBAAxC,EAA4De,UAA5D;AACA,WAAO;AAAA,aACLgB,QAAQ,CAACh7B,mBAAT,CACE,YADF,EAEEi5B,kBAFF,EAGEe,UAHF,CADK;AAAA,KAAP;AAMD,GAVQ,EAUN,CAACA,UAAD,EAAaC,SAAb,CAVM,CAAT;;AAYA,MAAMgB,UAAU,uCACXb,YADW;AAEd;AACAr3B,IAAAA,GAAG,EAAE,aAAChL,CAAD,EAAO;AACVsiC,MAAAA,eAAe,CAAClhC,OAAhB,GAA0BpB,CAA1B;AACD;AALa,IAAhB;;AAQA,MAAMmjC,aAAa,GAAG,CAAC9gC,QAAD,CAAtB;;AACA,MAAI8/B,SAAS,IAAIJ,MAAjB,EAAyB;AACvB,QAAID,SAAJ,EAAe;AACbqB,MAAAA,aAAa,CAACpH,OAAd,CAAsBgG,MAAtB;AACD,KAFD,MAEO;AACLoB,MAAAA,aAAa,CAAC3sC,IAAd,CAAmBurC,MAAnB;AACD;AACF;;AACD,sBAAO3vC,cAAK,CAACgxC,aAAN,CAAoB3pC,OAApB,EAA6BypC,UAA7B,EAAyCC,aAAzC,CAAP;AACD;;AAEDvB,cAAc,CAAC3hC,SAAf,GAA2B;AACzBxG,EAAAA,OAAO,EAAEyG,SAAS,CAACkH,WADM;AAEzBivB,EAAAA,OAAO,EAAEn2B,SAAS,CAACqE,IAFM;AAGzBs9B,EAAAA,WAAW,EAAE3hC,SAAS,CAACqE,IAHE;AAIzBu9B,EAAAA,SAAS,EAAE5hC,SAAS,CAACqE,IAJI;AAKzBw9B,EAAAA,MAAM,EAAE7hC,SAAS,CAACqzB,IALO;AAMzBqF,EAAAA,QAAQ,EAAE14B,SAAS,CAACI,IAAV,CAAeF,UANA;AAOzBijC,EAAAA,SAAS,EAAEnjC,SAAS,CAACoE,MAPI;AAQzB69B,EAAAA,SAAS,EAAEjiC,SAAS,CAACqE,IARI;AASzBy9B,EAAAA,SAAS,EAAE9hC,SAAS,CAACoE,MATI;AAUzB29B,EAAAA,UAAU,EAAE/hC,SAAS,CAACqE,IAVG;AAWzB29B,EAAAA,SAAS,EAAEhiC,SAAS,CAACqE;AAXI,CAA3B;;AC9IA;AAQA;;;;IAGM++B,uBAAuB,GAAG,SAA1BA,uBAA0B;AAAA,mCAC9B9qB,gBAD8B;AAAA,MAC9BA,gBAD8B,sCACX+qB,+BADW;AAAA,MAE9B/H,YAF8B,QAE9BA,YAF8B;AAAA,MAG9BD,WAH8B,QAG9BA,WAH8B;AAAA,MAI9BF,UAJ8B,QAI9BA,UAJ8B;AAAA,MAK9B1X,OAL8B,QAK9BA,OAL8B;AAAA,MAM9Bqe,SAN8B,QAM9BA,SAN8B;AAAA,MAO9B3/B,QAP8B,QAO9BA,QAP8B;AAAA,sBAS9BjQ,6BAAC,cAAD;AACE,IAAA,QAAQ,EAAEopC,YADZ;AAEE,IAAA,OAAO,EAAED,WAFX;AAGE,IAAA,SAAS,EAAEF,UAHb;AAIE,IAAA,SAAS,EAAE1X,OAJb;AAKE,IAAA,SAAS,EAAEqe,SALb;AAME,IAAA,SAAS,EAAE,KANb;AAOE,IAAA,MAAM,eACJ5vC;AACE,MAAA,SAAS,EAAC,qCADZ;AAEE,MAAA,GAAG,EAAC;AAFN,oBAIEA,6BAAC,gBAAD,OAJF;AARJ,KAgBGiQ,QAhBH,CAT8B;AAAA;;AA6BhCihC,uBAAuB,CAACrjC,SAAxB,GAAoC;AAClC;AACAu7B,EAAAA,YAAY,EAAEt7B,SAAS,CAACI,IAAV,CAAeF,UAFK;;AAGlC;AACAm7B,EAAAA,WAAW,EAAEr7B,SAAS,CAACqE,IAJW;;AAKlC;AACA82B,EAAAA,UAAU,EAAEn7B,SAAS,CAACqE,IANY;;AAOlC;AACAof,EAAAA,OAAO,EAAEzjB,SAAS,CAACqE,IARe;;AASlC;AACAy9B,EAAAA,SAAS,EAAE9hC,SAAS,CAACoE,MAVa;;AAWlC;AACA;AACAkU,EAAAA,gBAAgB,EAAEtY,SAAS,CAACkH;AAbM,CAApC;;ACpCA;;IACMo8B,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAC3wC,KAAD;AAAA,sBAC5BT,6BAAC,cAAD,eAAoBS,KAApB;AAA2B,IAAA,SAAS;AAApC,KAD4B;AAAA;;ACH9B,IAAM4wC,MAAM,GAAG,SAATA,MAAS;AAAA,MAAGphC,QAAH,QAAGA,QAAH;AAAA,sBACbjQ;AAAK,IAAA,SAAS,EAAC;AAAf,KAAyCiQ,QAAzC,CADa;AAAA,CAAf;;AAIA,4BAAejQ,cAAK,CAACmO,IAAN,CAAWkjC,MAAX,CAAf;;ACNA;AAIA;;AACA,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB,OAA6C;AAAA,MAA1CC,gBAA0C,QAA1CA,gBAA0C;AAAA,MAAxBjwB,OAAwB,QAAxBA,OAAwB;AAAA,MAAfrR,QAAe,QAAfA,QAAe;AACvE,MAAI,CAACshC,gBAAL,EAAuB,OAAO,IAAP;AACvB,sBACEvxC;AACE,mBAAY,sBADd;AAEE,IAAA,SAAS,EAAC,gCAFZ;AAGE,IAAA,OAAO,EAAEshB;AAHX,KAKGrR,QALH,CADF;AASD,CAXD;;AAaAqhC,mBAAmB,CAACzsB,YAApB,GAAmC;AACjC0sB,EAAAA,gBAAgB,EAAE;AADe,CAAnC;AAIAD,mBAAmB,CAACzjC,SAApB,GAAgC;AAC9B;AACA0jC,EAAAA,gBAAgB,EAAEzjC,SAAS,CAACqE,IAAV,CAAenE,UAFH;;AAG9B;AACAsT,EAAAA,OAAO,EAAExT,SAAS,CAACI,IAAV,CAAeF;AAJM,CAAhC;AAOA,yCAAehO,cAAK,CAACmO,IAAN,CAAWmjC,mBAAX,CAAf;;AC1BA,IAAME,kBAAkB,GAAG,SAArBA,kBAAqB,OAAgC;AAAA,MAA7BvhC,QAA6B,QAA7BA,QAA6B;AAAA,MAAnBoU,MAAmB,QAAnBA,MAAmB;AAAA,MAAX1e,IAAW,QAAXA,IAAW;AACzD,MAAI,CAAC0e,MAAL,EAAa,OAAO,IAAP;AAEb,sBACErkB;AACE,IAAA,SAAS,uDAAgD2F,IAAhD,CADX;AAEE,mBAAY;AAFd,KAIGsK,QAJH,CADF;AAQD,CAXD;;AAaAuhC,kBAAkB,CAAC3jC,SAAnB,GAA+B;AAC7BwW,EAAAA,MAAM,EAAEvW,SAAS,CAACqE,IADW;AAE7BxM,EAAAA,IAAI,EAAEmI,SAAS,CAACC;AAFa,CAA/B;AAKA,wCAAe/N,cAAK,CAACmO,IAAN,CAAWqjC,kBAAX,CAAf;;ACXA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAAC/uB,QAAD,EAAc;AACpC,OAAK,IAAIxe,CAAC,GAAGwe,QAAQ,CAACpe,MAAT,GAAkB,CAA/B,EAAkCJ,CAAC,GAAG,CAAtC,EAAyCA,CAAC,IAAI,CAA9C,EAAiD;AAC/C,QAAIwe,QAAQ,CAACxe,CAAD,CAAR,CAAY65B,MAAZ,KAAuB,UAA3B,EAAuC,OAAOrb,QAAQ,CAACxe,CAAD,CAAR,CAAY9B,EAAnB;AACxC;;AACD,SAAO,IAAP;AACD,CALD;;AAOA,IAAMsvC,aAAa,GAAG,SAAhBA,aAAgB,CAAChvB,QAAD,EAAWohB,IAAX,EAAoB;AACxC;AACA,MAAM6N,QAAQ,GAAG,EAAjB;AACAlvC,EAAAA,MAAM,CAAC2T,MAAP,CAAc0tB,IAAd,EAAoB9/B,OAApB,CAA4B,UAAC4tC,SAAD,EAAe;AACzC,QAAI,CAACA,SAAS,CAACC,SAAf,EAA0B;AAE1B,QAAIC,iBAAJ;AACApvB,IAAAA,QAAQ,CAAC1e,OAAT,CAAiB,UAAC2F,GAAD,EAAS;AACxB,UAAIA,GAAG,CAACstB,UAAJ,GAAiB2a,SAAS,CAACC,SAA/B,EAA0CC,iBAAiB,GAAGnoC,GAAG,CAACvH,EAAxB;AAC3C,KAFD;;AAIA,QAAI0vC,iBAAJ,EAAuB;AACrB,UAAI,CAACH,QAAQ,CAACG,iBAAD,CAAb,EAAkCH,QAAQ,CAACG,iBAAD,CAAR,GAA8B,EAA9B;AAClCH,MAAAA,QAAQ,CAACG,iBAAD,CAAR,CAA4B1tC,IAA5B,CAAiCwtC,SAAS,CAACztC,IAA3C;AACD;AACF,GAZD;AAcA,SAAOwtC,QAAP;AACD,CAlBD;;AAoBA,IAAMI,WAAW,GAAG,SAAdA,WAAc,CAACrvB,QAAD,EAAc;AAChC,MAAMsvB,WAAW,GAAG,EAApB;;AACA,OAAK,IAAI9tC,CAAC,GAAG,CAAR,EAAW+tC,CAAC,GAAGvvB,QAAQ,CAACpe,MAA7B,EAAqCJ,CAAC,GAAG+tC,CAAzC,EAA4C/tC,CAAC,IAAI,CAAjD,EAAoD;AAClD,QAAMS,OAAO,GAAG+d,QAAQ,CAACxe,CAAD,CAAxB;;AACA,QAAIS,OAAO,CAACgB,IAAR,KAAiB,cAArB,EAAqC;AACnCqsC,MAAAA,WAAW,CAAC5tC,IAAZ,CAAiBO,OAAjB;AACA;AACD;;AACD,QAAMutC,WAAW,GAAGvtC,OAAO,CAAClB,UAAR,CAAmB0uC,YAAnB,EAApB;AACA,QAAIC,eAAe,GAAGF,WAAtB;;AACA,QAAIhuC,CAAC,GAAG,CAAR,EAAW;AACTkuC,MAAAA,eAAe,GAAG1vB,QAAQ,CAACxe,CAAC,GAAG,CAAL,CAAR,CAAgBT,UAAhB,CAA2B0uC,YAA3B,EAAlB;AACD;;AAED,QAAIjuC,CAAC,KAAK,CAAN,IAAWguC,WAAW,KAAKE,eAA/B,EAAgD;AAC9CJ,MAAAA,WAAW,CAAC5tC,IAAZ,CACE;AAAEuB,QAAAA,IAAI,EAAE,cAAR;AAAwB+oC,QAAAA,IAAI,EAAE/pC,OAAO,CAAClB;AAAtC,OADF,EAEEkB,OAFF;AAID,KALD,MAKO;AACLqtC,MAAAA,WAAW,CAAC5tC,IAAZ,CAAiBO,OAAjB;AACD;AACF;;AAED,SAAOqtC,WAAP;AACD,CAzBD;;AA2BA,IAAMK,WAAW,GAAG,SAAdA,WAAc,CAAC3vB,QAAD,EAAW4vB,cAAX,EAA8B;AAChD,MAAMN,WAAW,GAAGtvB,QAApB,CADgD;;AAGhD,MAAI,CAAC4vB,cAAL,EAAqB;AACnBN,IAAAA,WAAW,CAACrI,OAAZ,CAAoB;AAAEhkC,MAAAA,IAAI,EAAE;AAAR,KAApB;AACA,WAAOqsC,WAAP;AACD,GAN+C;;;AAShD,MAAI,CAACA,WAAW,CAAC1tC,MAAjB,EAAyB;AACvB0tC,IAAAA,WAAW,CAACrI,OAAZ,CAAoB;AAAEhkC,MAAAA,IAAI,EAAE;AAAR,KAApB;AACA,WAAOqsC,WAAP;AACD,GAZ+C;;;AAehD,OAAK,IAAI9tC,CAAC,GAAG,CAAR,EAAW+tC,CAAC,GAAGvvB,QAAQ,CAACpe,MAA7B,EAAqCJ,CAAC,GAAG+tC,CAAzC,EAA4C/tC,CAAC,IAAI,CAAjD,EAAoD;AAClD,QAAMS,OAAO,GAAG+d,QAAQ,CAACxe,CAAD,CAAxB;AAEA,QAAMquC,WAAW,GAAG5tC,OAAO,CAAClB,UAAR,GAChBkB,OAAO,CAAClB,UAAR,CAAmB+uC,OAAnB,EADgB,GAEhB,IAFJ;AAGA,QAAMC,eAAe,GACnB/vB,QAAQ,CAACxe,CAAC,GAAG,CAAL,CAAR,IAAmBwe,QAAQ,CAACxe,CAAC,GAAG,CAAL,CAAR,CAAgBT,UAAnC,GACIif,QAAQ,CAACxe,CAAC,GAAG,CAAL,CAAR,CAAgBT,UAAhB,CAA2B+uC,OAA3B,EADJ,GAEI,IAHN,CANkD;;AAYlD,QAAID,WAAW,GAAGD,cAAlB,EAAkC;AAChC;AACA,UAAIG,eAAe,GAAGH,cAAtB,EAAsC;AACpC,YAAI5vB,QAAQ,CAACxe,CAAC,GAAG,CAAL,CAAR,IAAmBwe,QAAQ,CAACxe,CAAC,GAAG,CAAL,CAAR,CAAgByB,IAAhB,KAAyB,cAAhD,EACE;;AACF,YAAI,CAAC8sC,eAAL,EAAsB;AACpBT,UAAAA,WAAW,CAAC5tC,IAAZ,CAAiB;AAAEuB,YAAAA,IAAI,EAAE;AAAR,WAAjB;AACA,iBAAOqsC,WAAP;AACD;;AACD;AACD,OARD,MAQO;AACLA,QAAAA,WAAW,CAAC/pC,MAAZ,CAAmB/D,CAAC,GAAG,CAAvB,EAA0B,CAA1B,EAA6B;AAAEyB,UAAAA,IAAI,EAAE;AAAR,SAA7B;AACA,eAAOqsC,WAAP;AACD;AACF;AACF;;AAED,SAAOA,WAAP;AACD,CA7CD;;AA+CA,IAAMU,cAAc,GAAG,SAAjBA,cAAiB,CACrB/tC,OADqB,EAErBguC,eAFqB,EAGrBC,WAHqB,EAIrBC,aAJqB,EAKlB;AACH,MAAIluC,OAAO,CAACgB,IAAR,KAAiB,cAArB,EAAqC,OAAO,EAAP;AACrC,MAAIhB,OAAO,CAACgB,IAAR,KAAiB,eAArB,EAAsC,OAAO,EAAP;AACtC,MAAIhB,OAAO,CAACgB,IAAR,KAAiB,eAArB,EAAsC,OAAO,EAAP;AAEtC,MAAIktC,aAAa,IAAIluC,OAAO,CAACke,WAAR,CAAoBve,MAApB,KAA+B,CAApD,EAAuD,OAAO,QAAP;AAEvD,MAAMwuC,YAAY,GAChB,CAACH,eAAD,IACAA,eAAe,CAAChtC,IAAhB,KAAyB,eADzB,IAEAgtC,eAAe,CAAChtC,IAAhB,KAAyB,cAFzB,IAGAgtC,eAAe,CAAChtC,IAAhB,KAAyB,QAHzB,IAIAgtC,eAAe,CAAChtC,IAAhB,KAAyB,eAJzB,IAKAgtC,eAAe,CAAC9vB,WAAhB,CAA4Bve,MAA5B,KAAuC,CALvC,IAMAK,OAAO,CAACR,IAAR,CAAa/B,EAAb,KAAoBuwC,eAAe,CAACxuC,IAAhB,CAAqB/B,EANzC,IAOAuwC,eAAe,CAAChtC,IAAhB,KAAyB,OAPzB,IAQAgtC,eAAe,CAAChwB,UATlB;AAWA,MAAMowB,eAAe,GACnB,CAACH,WAAD,IACAA,WAAW,CAACjtC,IAAZ,KAAqB,cADrB,IAEAitC,WAAW,CAACjtC,IAAZ,KAAqB,QAFrB,IAGAitC,WAAW,CAACjtC,IAAZ,KAAqB,eAHrB,IAIAitC,WAAW,CAACjtC,IAAZ,KAAqB,eAJrB,IAKAitC,WAAW,CAAC/vB,WAAZ,CAAwBve,MAAxB,KAAmC,CALnC,IAMAK,OAAO,CAACR,IAAR,CAAa/B,EAAb,KAAoBwwC,WAAW,CAACzuC,IAAZ,CAAiB/B,EANrC,IAOAwwC,WAAW,CAACjtC,IAAZ,KAAqB,OAPrB,IAQAitC,WAAW,CAACjwB,UATd;;AAWA,MAAI,CAACmwB,YAAD,IAAiB,CAACC,eAAtB,EAAuC;AACrC,QAAIpuC,OAAO,CAACge,UAAR,IAAsBhe,OAAO,CAACgB,IAAR,KAAiB,OAA3C,EAAoD,OAAO,QAAP;AACpD,WAAO,QAAP;AACD;;AAED,MAAIotC,eAAJ,EAAqB;AACnB,QAAID,YAAY,IAAInuC,OAAO,CAACge,UAAxB,IAAsChe,OAAO,CAACgB,IAAR,KAAiB,OAA3D,EACE,OAAO,QAAP;AACF,WAAO,QAAP;AACD;;AAED,MAAImtC,YAAJ,EAAkB,OAAO,KAAP;AAElB,SAAO,EAAP;AACD,CAhDD;;AAkDA,IAAME,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACvyC,KAAD,EAAW;AAAA,MAEhC6oC,mBAFgC,GAgB9B7oC,KAhB8B,CAEhC6oC,mBAFgC;AAAA,MAGhC2J,aAHgC,GAgB9BxyC,KAhB8B,CAGhCwyC,aAHgC;AAAA,MAIhCxE,aAJgC,GAgB9BhuC,KAhB8B,CAIhCguC,aAJgC;AAAA,MAKhCyE,eALgC,GAgB9BzyC,KAhB8B,CAKhCyyC,eALgC;AAAA,MAMhCZ,cANgC,GAgB9B7xC,KAhB8B,CAMhC6xC,cANgC;AAAA,MAOhCa,SAPgC,GAgB9B1yC,KAhB8B,CAOhC0yC,SAPgC;AAAA,MAQhCC,qBARgC,GAgB9B3yC,KAhB8B,CAQhC2yC,qBARgC;AAAA,MAShC1wB,QATgC,GAgB9BjiB,KAhB8B,CAShCiiB,QATgC;AAAA,MAUhCmwB,aAVgC,GAgB9BpyC,KAhB8B,CAUhCoyC,aAVgC;AAAA,MAWhC3yC,MAXgC,GAgB9BO,KAhB8B,CAWhCP,MAXgC;AAAA,MAYhCw9B,UAZgC,GAgB9Bj9B,KAhB8B,CAYhCi9B,UAZgC;AAAA,MAahCoG,IAbgC,GAgB9BrjC,KAhB8B,CAahCqjC,IAbgC;AAAA,MAchCuP,oBAdgC,GAgB9B5yC,KAhB8B,CAchC4yC,oBAdgC;AAAA,MAehCC,2BAfgC,GAgB9B7yC,KAhB8B,CAehC6yC,2BAfgC;AAkBlC,MAAMC,gBAAgB,GAAG7gC,aAAO,CAAC,YAAM;AACrC,QAAM8gC,gBAAgB,GAAGzB,WAAW,CAACrvB,QAAD,CAApC,CADqC;;AAGrC,QAAIwwB,eAAJ,EAAqB,OAAOb,WAAW,CAACmB,gBAAD,EAAmBlB,cAAnB,CAAlB;AACrB,WAAOkB,gBAAP;AACD,GAL+B,EAK7B,CAACN,eAAD,EAAkBZ,cAAlB,EAAkC5vB,QAAlC,CAL6B,CAAhC;AAOA,MAAM+wB,kBAAkB,GAAG/gC,aAAO,CAChC;AAAA,WACE6gC,gBAAgB,CAAC3pB,MAAjB,CAAwB,UAACC,GAAD,EAAMllB,OAAN,EAAeT,CAAf,EAAqB;AAC3C,UAAMyJ,KAAK,GAAG+kC,cAAc,CAC1B/tC,OAD0B,EAE1B4uC,gBAAgB,CAACrvC,CAAC,GAAG,CAAL,CAFU,EAG1BqvC,gBAAgB,CAACrvC,CAAC,GAAG,CAAL,CAHU,EAI1B2uC,aAJ0B,CAA5B;AAMA,UAAIllC,KAAJ,EAAWkc,GAAG,CAACllB,OAAO,CAACvC,EAAT,CAAH,GAAkBuL,KAAlB;AACX,aAAOkc,GAAP;AACD,KATD,EASG,EATH,CADF;AAAA,GADgC,EAYhC,CAAC0pB,gBAAD,EAAmBV,aAAnB,CAZgC,CAAlC,CAzBkC;;AAyClC,MAAMlB,QAAQ,GAAGj/B,aAAO,CACtB;AAAA,WACEg/B,aAAa,CACX6B,gBAAgB,CAACxtC,MAAjB,CAAwB;AAAA,UAAG5B,IAAH,QAAGA,IAAH;AAAA,aAAc,CAAAA,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAE/B,EAAN,MAAalC,MAAM,CAAC64B,MAAlC;AAAA,KAAxB,CADW,EAEX+K,IAFW,CADf;AAAA,GADsB,EAMtB,CAAC5jC,MAAM,CAAC64B,MAAR,EAAgBwa,gBAAhB,EAAkCzP,IAAlC,CANsB,CAAxB;AASA,MAAMvN,cAAc,GAAG7jB,aAAO,CAAC;AAAA,WAAM++B,eAAe,CAAC8B,gBAAD,CAArB;AAAA,GAAD,EAA0C,CACtEA,gBADsE,CAA1C,CAA9B;AAIA,MAAMG,QAAQ,GAAGhhC,aAAO,CAAC,YAAM;AAC7B,WAAO6gC,gBAAgB,CAACtuC,GAAjB,CAAqB,UAACN,OAAD,EAAa;AACvC,UAAIA,OAAO,CAACgB,IAAR,KAAiB,cAArB,EAAqC;AACnC,YAAI+3B,UAAJ,EAAgB,OAAO,IAAP;AAEhB,4BACE19B;AAAI,UAAA,GAAG,YAAK2E,OAAO,CAAC+pC,IAAR,CAAaC,WAAb,EAAL;AAAP,wBACE3uC,6BAAC,aAAD;AAAe,UAAA,IAAI,EAAE2E,OAAO,CAAC+pC;AAA7B,UADF,CADF;AAKD;;AAED,UAAI/pC,OAAO,CAACgB,IAAR,KAAiB,eAArB,EAAsC;AACpC,4BACE3F;AAAI,UAAA,GAAG,EAAC;AAAR,wBACEA,6BAAC,eAAD,OADF,CADF;AAKD;;AAED,UAAI2E,OAAO,CAACgB,IAAR,KAAiB,eAAjB,IAAoChB,OAAO,CAACgB,IAAR,KAAiB,QAAzD,EAAmE;AAAA;;AACjE,YAAI,CAACstC,aAAL,EAAoB,OAAO,IAAP;AACpB,4BACEjzC;AAAI,UAAA,GAAG,EAAE,mBAAA2E,OAAO,CAACuV,KAAR,kEAAezW,UAAf,KAA6BkB,OAAO,CAAClB,UAArC,IAAmD;AAA5D,wBACEzD,6BAAC,aAAD;AAAe,UAAA,OAAO,EAAE2E;AAAxB,UADF,CADF;AAKD;;AAED,UAAIA,OAAO,CAACgB,IAAR,KAAiB,cAArB,EAAqC;AACnC,YAAM2wB,WAAW,GAAGmd,kBAAkB,CAAC9uC,OAAO,CAACvC,EAAT,CAAlB,IAAkC,EAAtD;AAEA,4BACEpC;AACE,UAAA,SAAS,uCAAgCs2B,WAAhC,CADX;AAEE,UAAA,GAAG,EAAE3xB,OAAO,CAACvC,EAAR,IAAcuC,OAAO,CAAClB,UAF7B;AAGE,UAAA,aAAa,EAAE2vC;AAHjB,wBAKEpzC,6BAACihC,SAAD;AACE,UAAA,MAAM,EAAE/gC,MADV;AAEE,UAAA,OAAO,EAAEyE,OAFX;AAGE,UAAA,WAAW,EAAE,CAAC2xB,WAAD;AAAe;AAH9B;AAIE,UAAA,MAAM,EAAEqb,QAAQ,CAAChtC,OAAO,CAACvC,EAAT,CAAR,IAAwB,EAJlC;AAKE,UAAA,cAAc,EAAEm0B,cALlB;AAME,UAAA,UAAU,EAAEmH;AANd,WAOM2V,oBAPN,EALF,CADF;AAiBD;;AAED,aAAO,IAAP;AACD,KAnDM,CAAP;AAoDD,GArDuB,EAqDrB,CACDJ,aADC,EAED/yC,MAFC,EAGDqzC,gBAHC,EAIDF,oBAJC,EAKD9c,cALC,EAMDkd,kBANC,EAODL,qBAPC,EAQDzB,QARC,EASDjU,UATC,CArDqB,CAAxB;AAiEA,MAAI,CAACgW,QAAQ,CAACpvC,MAAd,EAAsB,oBAAOtE,6BAAC,mBAAD;AAAqB,IAAA,QAAQ,EAAC;AAA9B,IAAP;AAEtB,sBACEA,6BAAC,cAAD;AACE,IAAA,SAAS,MADX;AAEE,IAAA,SAAS,EAAE,KAFb;AAGE,IAAA,SAAS,EAAC,mCAHZ;AAIE,mBAAY;AAJd,KAKMszC,2BALN,gBAOEtzC;AAAI,IAAA,SAAS,EAAC;AAAd,KAA8B0zC,QAA9B,CAPF,eASE1zC;AAAK,IAAA,GAAG,EAAC,QAAT;AAAkB,IAAA,GAAG,EAAEmzC;AAAvB,IATF,CADF;AAaD,CAtID;;AAwIA,sCAAenzC,cAAK,CAACmO,IAAN,CAAW6kC,gBAAX,EAA6B5c,SAA7B,CAAf;;;;;ACrRA;;;;;;;IAMMud;;;;;AACJ,uBAAYlzC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,KAAN;;AADiB,wEAcC,gBAAgB;AAAA,UAAbmzC,MAAa,QAAbA,MAAa;AAClC,UAAI,MAAKvgC,KAAL,CAAWugC,MAAX,KAAsBA,MAA1B,EAAkC,MAAKxgC,QAAL,CAAc;AAAEwgC,QAAAA;AAAF,OAAd;AACnC,KAhBkB;;AAAA,qEA0GF,YAAM;AACrB,YAAKC,YAAL,CAAkB,MAAKV,SAAvB,EAAkC,MAAKW,WAAvC;AACD,KA5GkB;;AAAA,mEA8GJ,UAACx1B,EAAD,EAAKuM,MAAL,EAAgB;AAC7B,UAAMkpB,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvB,YAAIz1B,EAAE,IAAIA,EAAE,CAACtP,OAAT,IAAoB6b,MAApB,IAA8BA,MAAM,CAAC7b,OAAzC,EAAkD;AAChD,gBAAKglC,cAAL,CAAoB11B,EAAE,CAACtP,OAAvB,EAAgC6b,MAAM,CAAC7b,OAAvC;AACD;AACF,OAJD;;AAMA+kC,MAAAA,UAAU,GAPmB;;AAS7B9F,MAAAA,UAAU,CAAC8F,UAAD,EAAa,GAAb,CAAV;AACD,KAxHkB;;AAAA,qEA+HF,UAAC7jC,MAAD,EAAS+jC,WAAT,EAAyB;AACxC;AACA,UAAMC,SAAS,GAAGhkC,MAAM,IAAIA,MAAM,CAACikC,QAAP,KAAoB,CAAhD;AACA,UAAMC,QAAQ,GACZ3xC,MAAM,CAAC4xC,SAAP,CAAiBttC,QAAjB,CAA0ButC,IAA1B,CAA+BpkC,MAA/B,MAA2C,iBAD7C;AAGA,UAAIsJ,SAAJ;AACA,UAAI06B,SAAJ,EAAe16B,SAAS,GAAGtJ,MAAM,CAACoJ,SAAnB,CAAf,KACK,IAAI86B,QAAJ,EAAc56B,SAAS,GAAGtJ,MAAZ,CAAd,KACA,IAAIA,MAAM,KAAK,KAAf,EAAsBsJ,SAAS,GAAG,CAAZ,CAAtB,KACA,IAAItJ,MAAM,KAAK,QAAf,EACHsJ,SAAS,GAAGy6B,WAAW,CAACtD,YAAZ,GAA2BsD,WAAW,CAAC5E,YAAnD;AAEF,UAAI71B,SAAS,KAAKrS,SAAlB,EAA6B8sC,WAAW,CAACz6B,SAAZ,GAAwBA,SAAxB,CAbW;AAczC,KA7IkB;;AAAA,sEA+ID,YAAM;AACtB,YAAK+6B,cAAL;;AACA,YAAKnhC,QAAL,CAAc;AAAEohC,QAAAA,uBAAuB,EAAE;AAA3B,OAAd;AACD,KAlJkB;;AAAA,qEAoJF;AAAA,aAAM,MAAKC,YAAL,GAAoB,GAA1B;AAAA,KApJE;;AAAA,qEAsJF,UAAClJ,MAAD,EAAY;AAC3B,YAAKkJ,YAAL,GAAoBlJ,MAApB;;AACA,UAAI,MAAKl4B,KAAL,CAAWmhC,uBAAX,IAAsC,CAAC,MAAKE,cAAL,EAA3C,EAAkE;AAChE,cAAKthC,QAAL,CAAc;AAAEohC,UAAAA,uBAAuB,EAAE;AAA3B,SAAd;AACD;AACF,KA3JkB;;AAAA,sEAoKD,UAACG,gBAAD,EAAmBhvC,IAAnB,EAA4B;AAC5C,UAAI,OAAOgvC,gBAAP,KAA4B,QAAhC,EAA0C;AAC1C,UAAIhvC,IAAI,KAAK,SAAT,IAAsBA,IAAI,KAAK,OAAnC,EAA4C;AAE5C,UAAMvD,EAAE,GAAGklC,OAAM,EAAjB;;AAEA,YAAKl0B,QAAL,CAAc;AAAA,YAAGgkB,aAAH,SAAGA,aAAH;AAAA,eAAwB;AACpCA,UAAAA,aAAa,+BAAMA,aAAN,IAAqB;AAAEh1B,YAAAA,EAAF;AAAMW,YAAAA,IAAI,EAAE4xC,gBAAZ;AAA8BhvC,YAAAA;AAA9B,WAArB;AADuB,SAAxB;AAAA,OAAd,EAN4C;;;AAW5C,UAAMivC,EAAE,GAAG3G,UAAU,CACnB;AAAA,eACE,MAAK76B,QAAL,CAAc;AAAA,cAAGgkB,aAAH,SAAGA,aAAH;AAAA,iBAAwB;AACpCA,YAAAA,aAAa,EAAEA,aAAa,CAACrxB,MAAd,CAAqB,UAAC8uC,CAAD;AAAA,qBAAOA,CAAC,CAACzyC,EAAF,KAASA,EAAhB;AAAA,aAArB;AADqB,WAAxB;AAAA,SAAd,CADF;AAAA,OADmB,EAKnB,IALmB,CAArB;;AAQA,YAAK0yC,oBAAL,CAA0B1wC,IAA1B,CAA+BwwC,EAA/B;AACD,KAxLkB;;AAAA,4EA0LK,YAAM;AAC5B;AACA;AACA,UAAI,CAAC,MAAKF,cAAL,EAAL,EAA4B;AAC1B,cAAKH,cAAL;AACD;AACF,KAhMkB;;AAAA,+DAkMR;AAAA,aACT,MAAK9zC,KAAL,CAAWs0C,YAAX,GACI,MAAKt0C,KAAL,CAAW+lC,QAAX,CAAoB,MAAK/lC,KAAL,CAAWs0C,YAA/B,CADJ,GAEI,MAAKt0C,KAAL,CAAW+lC,QAAX,EAHK;AAAA,KAlMQ;;AAGjB,UAAKnzB,KAAL,GAAa;AACXmhC,MAAAA,uBAAuB,EAAE,KADd;AAEXZ,MAAAA,MAAM,EAAE,IAFG;AAGXxc,MAAAA,aAAa,EAAE;AAHJ,KAAb;AAMA,UAAK+b,SAAL,gBAAiBnzC,cAAK,CAACygC,SAAN,EAAjB;AACA,UAAKqT,WAAL,gBAAmB9zC,cAAK,CAACygC,SAAN,EAAnB;AACA,UAAKqU,oBAAL,GAA4B,EAA5B;AAXiB;AAYlB;;;;wCAMmB;AAClB;AACA,WAAKP,cAAL;AACA,UAAM/d,eAAe,GAAG,KAAKsd,WAAL,CAAiB9kC,OAAjB,CAAyBsjB,qBAAzB,EAAxB;AAEA,WAAKlf,QAAL,CAAc;AACZojB,QAAAA;AADY,OAAd;AAIA,WAAK/1B,KAAL,CAAWP,MAAX,CAAkB4jB,EAAlB,CAAqB,oBAArB,EAA2C,KAAKkxB,iBAAhD;AACD;;;2CAEsB;AACrB,WAAKv0C,KAAL,CAAWP,MAAX,CAAkB6jB,GAAlB,CAAsB,oBAAtB,EAA4C,KAAKixB,iBAAjD;AAEA,WAAKF,oBAAL,CAA0B9wC,OAA1B,CAAkCixC,YAAlC;AACD;;;4CAEuBC,WAAW;AACjC,UAAI,KAAKz0C,KAAL,CAAWi9B,UAAf,EAA2B;AACzB,eAAO,IAAP;AACD,OAHgC;AAKjC;;;AAEA,UAAIwX,SAAS,CAACxyB,QAAV,CAAmBpe,MAAnB,GAA4B,KAAK7D,KAAL,CAAWiiB,QAAX,CAAoBpe,MAApD,EAA4D;AAC1D,YAAM6wC,IAAI,GAAG,KAAKrB,WAAL,CAAiB9kC,OAA9B;AACA,eAAO;AACLsK,UAAAA,SAAS,EAAE67B,IAAI,CAAC37B,SADX;AAEL47B,UAAAA,YAAY,EAAED,IAAI,CAACxE,YAAL,GAAoBwE,IAAI,CAAC37B;AAFlC,SAAP;AAID;;AACD,aAAO,IAAP;AACD;;;uCAEkB07B,WAAWG,WAAWC,UAAU;AACjD;AACA;AACA;AACA,UAAMZ,cAAc,GAAG,KAAKA,cAAL,EAAvB;AACA,UAAMa,kBAAkB,GAAG,KAAK90C,KAAL,CAAWiiB,QAAX,CACzB,KAAKjiB,KAAL,CAAWiiB,QAAX,CAAoBpe,MAApB,GAA6B,CADJ,CAA3B;AAGA,UAAMkxC,mBAAmB,GACvBN,SAAS,CAACxyB,QAAV,CAAmBwyB,SAAS,CAACxyB,QAAV,CAAmBpe,MAAnB,GAA4B,CAA/C,CADF;;AAEA,UAAI,CAACkxC,mBAAD,IAAwB,CAACD,kBAA7B,EAAiD;AAC/C;AACD;;AAED,UAAME,aAAa,GAAGF,kBAAkB,CAACnzC,EAAnB,KAA0BozC,mBAAmB,CAACpzC,EAApE;AACA,UAAMy4B,OAAO,GAAG0a,kBAAkB,CAACpxC,IAAnB,CAAwB/B,EAAxB,KAA+B,KAAK3B,KAAL,CAAWP,MAAX,CAAkB64B,MAAjE;AAEA,UAAMoc,IAAI,GAAG,KAAKrB,WAAL,CAAiB9kC,OAA9B,CAjBiD;;AAoBjD,UAAMulC,cAAc,GAAGkB,aAAa,KAAK5a,OAAO,IAAI,CAAC6Z,cAAjB,CAApC;;AAEA,UAAIH,cAAJ,EAAoB;AAClB,aAAKA,cAAL,GADkB;;AAIlB,YAAI,KAAKlhC,KAAL,CAAWmhC,uBAAf,EACE,KAAKphC,QAAL,CAAc;AAAEohC,UAAAA,uBAAuB,EAAE;AAA3B,SAAd;AAEF;AACD;;AAED,UAAIc,QAAQ,KAAK,IAAjB,EAAuB;AACrB;AACA;AACA,YAAIG,aAAJ,EAAmB;AACjB,eAAKzB,cAAL,CAAoBsB,QAAQ,CAACh8B,SAA7B,EAAwC,KAAKw6B,WAAL,CAAiB9kC,OAAzD;AACD,SAFD,MAEO;AACL;AACA;AACA,eAAKglC,cAAL,CACEmB,IAAI,CAACxE,YAAL,GAAoB2E,QAAQ,CAACF,YAD/B,EAEE,KAAKtB,WAAL,CAAiB9kC,OAFnB;AAID;AACF,OA7CgD;;;AAgDjD,UAAIymC,aAAa,IAAI,CAAC,KAAKpiC,KAAL,CAAWmhC,uBAAjC,EAA0D;AACxD,aAAKphC,QAAL,CAAc;AAAEohC,UAAAA,uBAAuB,EAAE;AAA3B,SAAd;AACD;AACF;;;6BA+FQ;AAAA,UACCpzC,CADD,GACO,KAAKX,KADZ,CACCW,CADD;AAGP,0BACEpB,6BAACA,cAAD,CAAO,QAAP,qBACEA;AACE,QAAA,SAAS,2BACP,KAAKS,KAAL,CAAWi9B,UAAX,GAAwB,wBAAxB,GAAmD,EAD5C,CADX;AAIE,QAAA,GAAG,EAAE,KAAKoW;AAJZ,sBAME9zC,6BAACgzC,kBAAD;AACE,QAAA,mBAAmB,EAAE,KAAKvyC,KAAL,CAAW6oC,mBADlC;AAEE,QAAA,aAAa,EAAE,KAAK7oC,KAAL,CAAWwyC,aAF5B;AAGE,QAAA,eAAe,EAAE,KAAKxyC,KAAL,CAAWyyC,eAH9B;AAIE,QAAA,cAAc,EAAE,KAAKzyC,KAAL,CAAW6xC,cAJ7B;AAKE,QAAA,aAAa,EAAE,KAAK7xC,KAAL,CAAWguC,aAAX,IAA4B,KAAKhuC,KAAL,CAAWi1C,aALxD;AAME,QAAA,QAAQ,EAAE,KAAKj1C,KAAL,CAAWiiB,QANvB;AAOE,QAAA,aAAa,EAAE,KAAKjiB,KAAL,CAAWoyC,aAP5B;AAQE,QAAA,UAAU,EAAE,KAAKpyC,KAAL,CAAWi9B,UARzB;AASE,QAAA,MAAM,EAAE,KAAKj9B,KAAL,CAAWP,MATrB;AAUE,QAAA,IAAI,EAAE,KAAKO,KAAL,CAAWqjC,IAVnB;AAWE,QAAA,SAAS,EAAE,KAAKqP,SAXlB;AAYE,QAAA,qBAAqB,EAAE,KAAKC,qBAZ9B;AAaE,QAAA,2BAA2B,EAAE;AAC3BnP,UAAAA,OAAO,EAAE,KAAKxjC,KAAL,CAAWwjC,OADO;AAE3B8L,UAAAA,SAAS,EAAE,KAAKtvC,KAAL,CAAWyjC,WAFK;AAG3B8L,UAAAA,cAAc,EAAE,KAAKA,cAHM;AAI3BxJ,UAAAA,QAAQ,EAAE,KAAKA,QAJY;AAK3BmJ,UAAAA,MAAM,eACJ3vC,6BAACqxC,QAAD;AAAQ,YAAA,GAAG,EAAC;AAAZ,aACGrqC,WAAW,CAAC,KAAKvG,KAAL,CAAW2lB,gBAAZ,EAA8B;AAAEzkB,YAAAA,IAAI,EAAE;AAAR,WAA9B,EAA4C,IAA5C,CADd;AANyB,SAb/B;AAwBE,QAAA,oBAAoB,EAAE;AACpB60B,UAAAA,eAAe,EAAE,KAAKnjB,KAAL,CAAWmjB,eADR;AAEpBmC,UAAAA,UAAU,EAAE,KAAKl4B,KAAL,CAAWk4B,UAFH;AAGpB3V,UAAAA,OAAO,EAAE,KAAKviB,KAAL,CAAWuiB,OAHA;AAIpBX,UAAAA,QAAQ,EAAE,KAAK5hB,KAAL,CAAW4hB,QAJD;AAKpBD,UAAAA,OAAO,EAAE,KAAK3hB,KAAL,CAAW2hB,OALA;AAMpB8X,UAAAA,gBAAgB,EAAE,KAAKz5B,KAAL,CAAWy5B,gBANT;AAOpB2B,UAAAA,eAAe,EAAE,KAAKA,eAPF;AAQpB1H,UAAAA,aAAa,EAAE,KAAK1zB,KAAL,CAAW0zB,aARN;AASpBC,UAAAA,aAAa,EAAE,KAAK3zB,KAAL,CAAW2zB,aATN;AAUpB6M,UAAAA,OAAO,EAAE,KAAKxgC,KAAL,CAAWwgC,OAVA;AAWpB5L,UAAAA,KAAK,EAAE,KAAK50B,KAAL,CAAW40B,KAXE;AAYpBmJ,UAAAA,UAAU,EAAE,KAAK/9B,KAAL,CAAW+9B,UAZH;AAapBjqB,UAAAA,UAAU,EAAE,KAAK9T,KAAL,CAAW8T,UAbH;AAcpBujB,UAAAA,eAAe,EAAE,KAAKr3B,KAAL,CAAWq3B,eAdR;AAepBE,UAAAA,eAAe,EAAE,KAAKv3B,KAAL,CAAWu3B,eAfR;AAgBpB9B,UAAAA,cAAc,EAAE,KAAKz1B,KAAL,CAAWy1B,cAhBP;AAiBpB0K,UAAAA,2BAA2B,EAAE,KAAKngC,KAAL,CAC1BmgC,2BAlBiB;AAmBpB1E,UAAAA,iCAAiC,EAAE,KAAKz7B,KAAL,CAChCy7B,iCApBiB;AAqBpBD,UAAAA,+BAA+B,EAAE,KAAKx7B,KAAL,CAC9Bw7B,+BAtBiB;AAuBpBF,UAAAA,8BAA8B,EAAE,KAAKt7B,KAAL,CAC7Bs7B,8BAxBiB;AAyBpBC,UAAAA,4BAA4B,EAAE,KAAKv7B,KAAL,CAC3Bu7B;AA1BiB;AAxBxB,QANF,CADF,eA8DEh8B;AAAK,QAAA,SAAS,EAAC;AAAf,SACG,KAAKqT,KAAL,CAAW+jB,aAAX,CAAyBnyB,GAAzB,CAA6B,UAAC0wC,YAAD;AAAA,4BAC5B31C,6BAACwxC,oBAAD;AACE,UAAA,MAAM,EAAE,IADV;AAEE,UAAA,GAAG,EAAEmE,YAAY,CAACvzC,EAFpB;AAGE,UAAA,IAAI,EAAEuzC,YAAY,CAAChwC;AAHrB,WAKGgwC,YAAY,CAAC5yC,IALhB,CAD4B;AAAA,OAA7B,CADH,eAWE/C,6BAACwxC,oBAAD;AAAoB,QAAA,MAAM,EAAE,CAAC,KAAKn+B,KAAL,CAAWugC,MAAxC;AAAgD,QAAA,IAAI,EAAC;AAArD,SACGxyC,CAAC,CAAC,yCAAD,CADJ,CAXF,eAeEpB,6BAACsxC,qBAAD;AACE,QAAA,gBAAgB,EAAE,KAAKj+B,KAAL,CAAWmhC,uBAD/B;AAEE,QAAA,OAAO,EAAE,KAAKoB;AAFhB,SAIGx0C,CAAC,CAAC,eAAD,CAJJ,CAfF,CA9DF,CADF;AAuFD;;;;EAlSuBkS;;AAqS1BqgC,WAAW,CAAC9lC,SAAZ,GAAwB;AACtB;;;;;AAKA6nC,EAAAA,aAAa,EAAE5nC,SAAS,CAACkH,WANH;;AAOtB;AACA69B,EAAAA,aAAa,EAAE/kC,SAAS,CAACqE,IARH;;AAStB;AACAqsB,EAAAA,UAAU,EAAE1wB,SAAS,CAACqE,IAVA;;AAWtB;AACA4iC,EAAAA,YAAY,EAAEjnC,SAAS,CAACoE,MAZF;;AAatB;;;;AAIAgkB,EAAAA,cAAc,EAAEpoB,SAAS,CAACozB,SAAV,CAAoB,CAACpzB,SAAS,CAACqE,IAAX,EAAiBrE,SAAS,CAACG,KAA3B,CAApB,CAjBM;;AAkBtB;;;AAGAyvB,EAAAA,UAAU,EAAE5vB,SAAS,CAACqE,IArBA;;AAsBtB;;;;;;;;AAQA+pB,EAAAA,iCAAiC,EAAEpuB,SAAS,CAACI,IA9BvB;;AA+BtB;;;;;;;;AAQA+tB,EAAAA,+BAA+B,EAAEnuB,SAAS,CAACI,IAvCrB;;AAwCtB;;;;;;;;AAQA6tB,EAAAA,8BAA8B,EAAEjuB,SAAS,CAACI,IAhDpB;;AAiDtB;;;;;;;;AAQA8tB,EAAAA,4BAA4B,EAAEluB,SAAS,CAACI,IAzDlB;;AA0DtB;AACAhO,EAAAA,MAAM,EAAE4N,SAAS,CAACmF,MA3DI;;AA4DtB;AACAsB,EAAAA,UAAU,EAAEzG,SAAS,CAACkH,WA7DA;;AA8DtB;AACAisB,EAAAA,OAAO,EAAEnzB,SAAS,CAACkH,WA/DG;;AAgEtB;;;;;AAKAi+B,EAAAA,aAAa,EAAEnlC,SAAS,CAACkH,WArEH;;AAsEtB;;;AAGAs0B,EAAAA,mBAAmB,EAAEx7B,SAAS,CAACkH,WAzET;;AA0EtB;;;AAGAk+B,EAAAA,eAAe,EAAEplC,SAAS,CAACkH,WA7EL;;AA8EtB;;;AAGAoR,EAAAA,gBAAgB,EAAEtY,SAAS,CAACkH,WAjFN;;AAkFtB;AACA0N,EAAAA,QAAQ,EAAE5U,SAAS,CAACG,KAAV,CAAgBD,UAnFJ;;AAoFtB;AACAoU,EAAAA,OAAO,EAAEtU,SAAS,CAAC2W,UAAV,CAAqBC,kBAArB,EAA8B1W,UArFjB;;AAsFtB;AACAmmB,EAAAA,aAAa,EAAErmB,SAAS,CAACI,IAAV,CAAeF,UAvFR;;AAwFtB;AACAksB,EAAAA,gBAAgB,EAAEpsB,SAAS,CAACI,IAzFN;;AA0FtB;AACAkmB,EAAAA,aAAa,EAAEtmB,SAAS,CAACI,IA3FH;;AA4FtB;AACA4pB,EAAAA,eAAe,EAAEhqB,SAAS,CAACI,IA7FL;;AA8FtB;AACA8pB,EAAAA,eAAe,EAAElqB,SAAS,CAACI,IA/FL;;AAgGtB;AACAyqB,EAAAA,UAAU,EAAE7qB,SAAS,CAACI,IAjGA;;AAkGtB;AACA8U,EAAAA,OAAO,EAAElV,SAAS,CAACmF,MAnGG;;AAoGtB;AACAoP,EAAAA,QAAQ,EAAEvU,SAAS,CAACmF,MArGE;;AAsGtB;AACA6wB,EAAAA,IAAI,EAAEh2B,SAAS,CAACmF,MAvGM;;AAwGtB;;;;;AAKA2tB,EAAAA,2BAA2B,EAAE9yB,SAAS,CAACmF;AA7GjB,CAAxB;AAgHA0gC,WAAW,CAAC9uB,YAAZ,GAA2B;AACzBoc,EAAAA,OAAO,EAAEnB,eADgB;AAEzBmT,EAAAA,aAAa,EAAErE,gBAFU;AAGzBlR,EAAAA,UAAU,EAAE,KAHa;AAIzBnpB,EAAAA,UAJyB;AAKzBk6B,EAAAA,aAAa,EAAEoH,oBALU;AAMzBzvB,EAAAA,gBAAgB,EAAE+qB,uBANO;AAOzB7H,EAAAA,mBAAmB,EAAE+D,qBAPI;AAQzB7O,EAAAA,UAAU,EAAE,KARa;AASzBqU,EAAAA,aAAa,EAAE,KATU;AAUzB3c,EAAAA,cAAc,EAAEzzB,MAAM,CAACqB,IAAP,CAAYyxB,eAAZ;AAVS,CAA3B;AAaA,oBAAe/zB,sBAAsB,CAAC,UAACf,KAAD;AAAA,sBACpCT,6BAAC,cAAD,CAAgB,QAAhB,QAEG;AAAA,QAAG0wB,MAAH,SAAGA,MAAH;AAAA,QAActF,cAAd;;AAAA,wBACCprB,6BAAC,WAAD,eAAiBorB,cAAjB,EAAqC3qB,KAArC,EADD;AAAA,GAFH,CADoC;AAAA,CAAD,CAArC;;ACpaA,IAAMwgC,SAAO,gBAAGjhC,cAAK,CAACmO,IAAN,CAAW,SAAS8yB,OAAT,QAAmD;AAAA,MAAhC/gC,MAAgC,SAAhCA,MAAgC;AAAA,MAAxByE,OAAwB,SAAxBA,OAAwB;AAAA,MAAfmxC,WAAe,SAAfA,WAAe;AAC5E,MAAMC,YAAY,GAAGrjC,aAAO,CAC1B;AAAA,WAAMpN,UAAU,CAACX,OAAO,CAAC5B,IAAT,EAAe4B,OAAO,CAACY,eAAvB,CAAhB;AAAA,GAD0B,EAE1B,CAACZ,OAAO,CAAC5B,IAAT,EAAe4B,OAAO,CAACY,eAAvB,CAF0B,CAA5B;AAKA,MAAMs1B,OAAO,GAAGl2B,OAAO,CAACR,IAAR,CAAa/B,EAAb,KAAoBlC,MAAM,CAAC64B,MAA3C;AACA,MAAMid,iBAAiB,GAAG,CAAAF,WAAW,SAAX,IAAAA,WAAW,WAAX,YAAAA,WAAW,CAAE3xC,IAAb,CAAkB/B,EAAlB,MAAyBlC,MAAM,CAAC64B,MAA1D;AAEA,MAAMkd,WAAW,GAAGpb,OAAO,GACvB,mEADuB,GAEvB,gCAFJ;AAGA,MAAMkC,YAAY,GAAGlC,OAAO,GACxB,qEADwB,GAExB,iCAFJ;AAGA,MAAMqb,SAAS,GAAGrb,OAAO,GACrB,8BADqB,GAErB,8BAFJ;AAGA,sBACE76B;AAAK,IAAA,GAAG,EAAE2E,OAAO,CAACvC,EAAlB;AAAsB,IAAA,SAAS,EAAE26B;AAAjC,kBACE/8B,6BAAC,MAAD;AACE,IAAA,KAAK,EAAE2E,OAAO,CAACR,IAAR,CAAawM,KADtB;AAEE,IAAA,IAAI,EAAEhM,OAAO,CAACR,IAAR,CAAavD,IAAb,IAAqB+D,OAAO,CAACR,IAAR,CAAa/B;AAF1C,IADF,eAKEpC;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAK,IAAA,SAAS,EAAEi2C;AAAhB,KAA8BF,YAA9B,CADF,eAEE/1C;AAAK,IAAA,SAAS,EAAEk2C;AAAhB,kBACEl2C;AAAM,IAAA,SAAS,EAAC;AAAhB,kBACEA,6CAAS2E,OAAO,CAACR,IAAR,CAAavD,IAAb,GAAoB+D,OAAO,CAACR,IAAR,CAAavD,IAAjC,GAAwC,SAAjD,CADF,CADF,eAIEZ;AAAM,IAAA,SAAS,EAAC;AAAhB,kBACEA,6BAACy/B,kBAAD;AACE,IAAA,WAAW,EAAC,oCADd;AAEE,IAAA,OAAO,EAAE96B,OAFX;AAGE,IAAA,QAAQ;AAHV,IADF,CAJF,CAFF,CALF,CADF;AAuBD,CAzCe,EAyCbyxB,SAzCa,CAAhB;;AA2CA,IAAM+f,eAAe,GAAG,SAAlBA,eAAkB,QAMlB;AAAA,MALJj2C,MAKI,SALJA,MAKI;AAAA,MAJJwiB,QAII,SAJJA,QAII;AAAA,MAHJ8jB,QAGI,SAHJA,QAGI;AAAA,MAFJvC,OAEI,SAFJA,OAEI;AAAA,MADJmS,UACI,SADJA,UACI;AACJ,MAAMC,QAAQ,GAAG7nC,YAAM,EAAvB;AACA,MAAM8nC,OAAO,GAAG9nC,YAAM,CAAC,KAAD,CAAtB;AAEAa,EAAAA,eAAS,CAAC,YAAM;AACd,QAAI,CAACqT,QAAQ,CAACpe,MAAd,EAAsB;AAEtB,QAAMif,WAAW,GAAGb,QAAQ,CAACA,QAAQ,CAACpe,MAAT,GAAkB,CAAnB,CAA5B;AACA,QAAMu2B,OAAO,GAAGtX,WAAW,CAACpf,IAAZ,CAAiB/B,EAAjB,KAAwBlC,MAAM,CAAC64B,MAA/C;AACA,QAAI8B,OAAJ,EAAawb,QAAQ,CAACrnC,OAAT,CAAiBunC,aAAjB,CAA+B7zB,QAAQ,CAACpe,MAAxC;AACd,GANQ,EAMN,CAACpE,MAAM,CAAC64B,MAAR,EAAgBrW,QAAhB,CANM,CAAT;AAQA,MAAM8zB,YAAY,GAAGznC,iBAAW,CAC9B,UAACpK,OAAD,EAAUmxC,WAAV,EAA0B;AACxB,QAAI,CAACnxC,OAAL,EAAc,OAAO,IAAP;;AACd,QAAIA,OAAO,CAACgB,IAAR,KAAiB,eAAjB,IAAoChB,OAAO,CAACgB,IAAR,KAAiB,QAAzD,EAAmE;AACjE,aAAO,IAAP;AACD;;AAED,wBACE3F,6BAACihC,SAAD;AAAS,MAAA,MAAM,EAAE/gC,MAAjB;AAAyB,MAAA,OAAO,EAAEyE,OAAlC;AAA2C,MAAA,WAAW,EAAEmxC;AAAxD,MADF;AAGD,GAV6B,EAW9B,CAAC51C,MAAD,CAX8B,CAAhC;AAcAmP,EAAAA,eAAS,CAAC,YAAM;AACd,QAAIinC,OAAO,CAACtnC,OAAZ,EAAqB;;AACrB,QAAI0T,QAAQ,CAACpe,MAAT,IAAmB+xC,QAAQ,CAACrnC,OAAhC,EAAyC;AACvCqnC,MAAAA,QAAQ,CAACrnC,OAAT,CAAiBunC,aAAjB,CAA+B7zB,QAAQ,CAACpe,MAAxC;AACAgyC,MAAAA,OAAO,CAACtnC,OAAR,GAAkB,IAAlB;AACD;AACF,GANQ,EAMN,CAAC0T,QAAQ,CAACpe,MAAV,CANM,CAAT;AAQA,MAAI,CAACoe,QAAQ,CAACpe,MAAd,EAAsB,oBAAOtE,6BAACspC,qBAAD;AAAqB,IAAA,QAAQ,EAAC;AAA9B,IAAP;AAEtB,sBACEtpC;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA,6BAACy2C,sBAAD;AACE,IAAA,GAAG,EAAEJ,QADP;AAEE,IAAA,KAAK,EAAE;AAAEtmC,MAAAA,KAAK,EAAE,MAAT;AAAiB8R,MAAAA,MAAM,EAAE;AAAzB,KAFT;AAGE,IAAA,UAAU,EAAEa,QAAQ,CAACpe,MAAT,IAAmB8xC,UAAU,IAAI,CAAjC,CAHd;AAIE,IAAA,IAAI,EAAE,cAACxkC,KAAD;AAAA,aAAW4kC,YAAY,CAAC9zB,QAAQ,CAAC9Q,KAAD,CAAT,EAAkB8Q,QAAQ,CAAC9Q,KAAK,GAAG,CAAT,CAA1B,CAAvB;AAAA,KAJR;AAKE,IAAA,YAAY,EAAE,6BAAoB;AAAA,UAAjB8kC,UAAiB,SAAjBA,UAAiB;AAChC,UAAIJ,OAAO,CAACtnC,OAAR,IAAmBi1B,OAAnB,IAA8ByS,UAAU,GAAG,EAA/C,EACElQ,QAAQ,GAAGnjC,IAAX,CAAgBgzC,QAAQ,CAACrnC,OAAT,CAAiB2nC,uBAAjC;AACH,KARH;AAUE;AACA;AACA;AACA;AACA;;AAdF,IADF,CADF;AAoBD,CA9DD;;AAgEA,IAAMC,sBAAsB,gBAAG52C,cAAK,CAACmO,IAAN,CAAWgoC,eAAX,EAA4B/f,SAA5B,CAA/B;AAEe,SAASygB,0BAAT,CAAoCp2C,KAApC,EAA2C;AACxD,sBACET,6BAAC,cAAD,CAAgB,QAAhB,QACG,iBAA0D;AAAA,QAAvD0iB,QAAuD,SAAvDA,QAAuD;AAAA,QAA7CxiB,MAA6C,SAA7CA,MAA6C;AAAA,QAArCsmC,QAAqC,SAArCA,QAAqC;AAAA,QAA3BvC,OAA2B,SAA3BA,OAA2B;AAAA,QAAlBC,WAAkB,SAAlBA,WAAkB;AACzD,wBACElkC,6BAAC,sBAAD;AACE,MAAA,QAAQ,EAAE0iB,QADZ;AAEE,MAAA,MAAM,EAAExiB,MAFV;AAGE,MAAA,QAAQ,EAAEsmC,QAHZ;AAIE,MAAA,OAAO,EAAEvC,OAJX;AAKE,MAAA,SAAS,EAAEC;AALb,OAMMzjC,KANN,EADF;AAUD,GAZH,CADF;AAgBD;;;;;;;;;AC3ID;;;;;;;;;;;;;IAYMq2C;;;;;;;;;;;;;6BAoEK;AACP,UAAI,CAAC,KAAKr2C,KAAL,CAAWujC,MAAhB,EAAwB;AACtB,eAAO,IAAP;AACD;;AACD,UAAM2D,QAAQ,GAAG,KAAKlnC,KAAL,CAAWujC,MAAX,CAAkB5hC,EAAnC;AACA,UAAMyhB,GAAG,GAAG,KAAKpjB,KAAL,CAAW2hB,OAAX,IAAsB,KAAK3hB,KAAL,CAAW2hB,OAAX,CAAmByB,GAArD;AAEA,UAAMxiB,GAAG,oBAAasmC,QAAb,cAAyB9jB,GAAzB,CAAT,CAPO;AASP;;AACA,0BAAO7jB,6BAAC,WAAD,eAAiB,KAAKS,KAAtB;AAA6B,QAAA,GAAG,EAAEY;AAAlC,SAAP;AACD;;;;EA/EkBiS;AAkFrB;;;gBAlFMwjC,uBACe;AACjB;AACAC,EAAAA,SAAS,EAAEjpC,SAAS,CAACqE,IAFJ;;AAGjB;AACA6kC,EAAAA,SAAS,EAAElpC,SAAS,CAACqE,IAJJ;;AAKjB;AACAiQ,EAAAA,OAAO,EAAEtU,SAAS,CAAC2W,UAAV,CAAqBC,kBAArB,EAA8B1W,UANtB;;AAOjB;AACAizB,EAAAA,OAAO;AAAE;AAAkGnzB,EAAAA,SAAS,CAACkH,WARpG;;AASjB;;;AAGAgvB,EAAAA,MAAM;AAAE;AAAyHl2B,EAAAA,SAAS,CAACmF,MAZ1H;;AAajB;;;AAGAmxB,EAAAA,cAAc;AACZ;AACCt2B,EAAAA,SAAS,CAACG,KAlBI;;AAmBjB;;;;;;AAMAy5B,EAAAA,cAAc,EAAE55B,SAAS,CAACI,IAAV,CAAeF,UAzBd;;AA0BjB;;;;AAIAw2B,EAAAA,aAAa,EAAE12B,SAAS,CAACqE,IA9BR;;AA+BjB;;;AAGAoyB,EAAAA,iBAAiB,EAAEz2B,SAAS,CAACqE,IAlCZ;;AAmCjB;;;;AAIA8kC,EAAAA,4BAA4B,EAAEnpC,SAAS,CAACmF,MAvCvB;;AAwCjB;;;;AAIAikC,EAAAA,0BAA0B,EAAEppC,SAAS,CAACmF,MA5CrB;;AA6CjB;;;;AAIA2tB,EAAAA,2BAA2B,EAAE9yB,SAAS,CAACmF,MAjDtB;;AAkDjB;;;;;;AAMA4d,EAAAA,YAAY;AAAE;AAA4F/iB,EAAAA,SAAS,CAACkH;AAxDnG;;gBADf8hC,0BA4DkB;AACpBtS,EAAAA,aAAa,EAAE,IADK;AAEpBD,EAAAA,iBAAiB,EAAE,IAFC;AAGpBwS,EAAAA,SAAS,EAAE,KAHS;AAIpBC,EAAAA,SAAS,EAAE,IAJS;AAKpBnmB,gBAAAA;AALoB;;IAuBlBsmB;;;;;AAQJ;AACA,uBAAY12C,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,+BAAMA,KAAN;AACA,UAAKqzC,WAAL,gBAAmB9zC,cAAK,CAACygC,SAAN,EAAnB;AAFiB;AAGlB;;;;wCAEmB;AAAA,wBACiB,KAAKhgC,KADtB;AAAA,UACVujC,MADU,eACVA,MADU;AAAA,UACF0D,cADE,eACFA,cADE;AAElB,UAAMC,QAAQ,GAAG3D,MAAM,IAAIA,MAAM,CAAC5hC,EAAlC;;AACA,UAAIulC,QAAQ,KAAI3D,MAAJ,aAAIA,MAAJ,uBAAIA,MAAM,CAAE3e,WAAZ,CAAR,IAAmCqiB,cAAvC,EAAuD;AACrDA,QAAAA,cAAc;AACf;AACF;AAED;;;;4CACwBwN,WAAW;AACjC;AACA;AACA,UACEA,SAAS,CAAC9Q,cAAV,IACA,KAAK3jC,KAAL,CAAW2jC,cADX,IAEA8Q,SAAS,CAAC9Q,cAAV,CAAyB9/B,MAAzB,GAAkC,KAAK7D,KAAL,CAAW2jC,cAAX,CAA0B9/B,MAH9D,EAIE;AACA,YAAM6wC,IAAI,GAAG,KAAKrB,WAAL,CAAiB9kC,OAA9B;AACA,eAAOmmC,IAAI,CAACvE,YAAL,GAAoBuE,IAAI,CAAC37B,SAAzB,KAAuC27B,IAAI,CAACxE,YAAnD;AACD;;AACD,aAAO,IAAP;AACD;AAED;;;;;;;;uCAKmBuE,WAAWG,WAAWC,UAAU;AAAA;;AAAA,yBACE,KAAK70C,KADP;AAAA,UACzCujC,MADyC,gBACzCA,MADyC;AAAA,UACjCI,cADiC,gBACjCA,cADiC;AAAA,UACjBsD,cADiB,gBACjBA,cADiB;AAEjD,UAAMC,QAAQ,GAAG3D,MAAH,aAAGA,MAAH,uBAAGA,MAAM,CAAE5hC,EAAzB;;AAEA,UACEulC,QAAQ,KACR3D,MADQ,aACRA,MADQ,uBACRA,MAAM,CAAE3e,WADA,CAAR,IAEA2e,MAAM,CAAC3e,WAAP,GAAqB,CAFrB,IAGA,CAAA+e,cAAc,SAAd,IAAAA,cAAc,WAAd,YAAAA,cAAc,CAAE9/B,MAAhB,MAA2B,CAH3B,IAIAojC,cALF,EAME;AACAA,QAAAA,cAAc;AACf,OAZgD;AAejD;AACA;;;AACA,UAAI4N,QAAQ,KAAK,IAAjB,EAAuB;AACrB,YAAMvB,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvB,cAAMoB,IAAI,GAAG,MAAI,CAACrB,WAAL,CAAiB9kC,OAA9B;AACA,cAAIsmC,QAAJ,EAAcH,IAAI,CAAC37B,SAAL,GAAiB27B,IAAI,CAACxE,YAAtB;AACf,SAHD;;AAIAoD,QAAAA,UAAU,GALW;;AAOrB9F,QAAAA,UAAU,CAAC8F,UAAD,EAAa,GAAb,CAAV;AACD;AACF;;;6BAEQ;AAAA,yBAC4B,KAAKtzC,KADjC;AAAA,UACCW,CADD,gBACCA,CADD;AAAA,UACI6mC,WADJ,gBACIA,WADJ;AAAA,UACiBjE,MADjB,gBACiBA,MADjB;;AAGP,UAAI,CAACA,MAAL,EAAa;AACX,eAAO,IAAP;AACD;;AAED,UAAMF,IAAI,GAAG,EAAb;AACA,0BACE9jC;AACE,QAAA,SAAS,6BACP,KAAKS,KAAL,CAAWs2C,SAAX,GAAuB,wBAAvB,GAAkD,EAD3C;AADX,sBAKE/2C;AAAK,QAAA,SAAS,EAAC;AAAf,sBACEA;AAAK,QAAA,SAAS,EAAC;AAAf,sBACEA,6CAASoB,CAAC,IAAIA,CAAC,CAAC,QAAD,CAAf,CADF,eAEEpB,4CACG,GADH,EAEGoB,CAAC,IACAA,CAAC,CAAC,0BAAD,EAA6B;AAC5BskB,QAAAA,UAAU,EAAEse,MAAM,CAAC3e;AADS,OAA7B,CAHL,CAFF,CADF,eAWErlB;AACE,QAAA,OAAO,EAAE,iBAAC4N,CAAD;AAAA,iBAAOq6B,WAAW,IAAIA,WAAW,CAACr6B,CAAD,CAAjC;AAAA,SADX;AAEE,QAAA,SAAS,EAAC,yBAFZ;AAGE,uBAAY;AAHd,sBAKE5N;AAAK,QAAA,KAAK,EAAC,IAAX;AAAgB,QAAA,MAAM,EAAC,IAAvB;AAA4B,QAAA,KAAK,EAAC;AAAlC,sBACEA;AACE,QAAA,CAAC,EAAC,sHADJ;AAEE,QAAA,QAAQ,EAAC;AAFX,QADF,CALF,CAXF,CALF,eA6BEA;AAAK,QAAA,SAAS,EAAC,uBAAf;AAAuC,QAAA,GAAG,EAAE,KAAK8zC;AAAjD,sBACE9zC,6BAACihC,SAAD;AAAA;AAEE,QAAA,OAAO,EAAE+C,MAFX;AAGE,QAAA,cAAc,MAHhB;AAIE,QAAA,UAAU,MAJZ;AAKE,QAAA,OAAO,EAAE,KAAKvjC,KAAL,CAAWwgC,OALtB;;AAAA,SAOM,KAAKxgC,KAPX,EAQM,KAAKA,KAAL,CAAWw2C,4BARjB,EADF,eAWEj3C;AAAK,QAAA,SAAS,EAAC;AAAf,SACGoB,CAAC,IAAIA,CAAC,CAAC,uBAAD,CADT,CAXF,eAcEpB,6BAAC2zC,aAAD;AACE,QAAA,QAAQ,EAAE,KAAKlzC,KAAL,CAAW2jC,cADvB;AAEE,QAAA,IAAI,EAAEN,IAFR;AAGE,QAAA,UAAU,MAHZ;AAIE,QAAA,QAAQ,EAAE,KAAKrjC,KAAL,CAAWinC,cAJvB;AAKE,QAAA,OAAO,EAAE,KAAKjnC,KAAL,CAAW+jC,aALtB;AAME,QAAA,WAAW,EAAE,KAAK/jC,KAAL,CAAW8jC,iBAN1B;AAOE,QAAA,OAAO,EAAE,KAAK9jC,KAAL,CAAWwgC;AAPtB,SAQM,KAAKxgC,KAAL,CAAWy2C,0BARjB,EAdF,CA7BF,EAsDGlwC,WAAW,CAAC,KAAKvG,KAAL,CAAWowB,YAAZ;AACVF,QAAAA,KAAK,EAAEI,iBADG;AAEVlG,QAAAA,MAAM,EAAE,KAAKpqB,KAAL,CAAWujC,MAFT;AAGVhqB,QAAAA,KAAK,EAAE,KAAKvZ,KAAL,CAAWu2C,SAHR;AAIVhsB,QAAAA,kBAAkB,EAAE;AAJV,SAKP,KAAKvqB,KAAL,CAAWmgC,2BALJ,EAtDd,CADF;AAgED;;;;EA9IuB5gC,cAAK,CAACsT;;gBAA1B6jC,0BACe;AACjB;AACA/0B,EAAAA,OAAO,EAAEtU,SAAS,CAACmF,MAAV,CAAiBjF,UAFT;;AAGjB;AACAg2B,EAAAA,MAAM,EAAEl2B,SAAS,CAACmF,MAAV,CAAiBjF;AAJR;;AAgJrB,eAAejN,kBAAkB,CAACS,sBAAsB,CAACs1C,QAAD,CAAvB,CAAjC;;AC3PA;AAKA;;;;;;AAKA,IAAMM,eAAe,GAAG,SAAlBA,eAAkB,CAAC32C,KAAD,EAAW;AACjC,MAAMiwB,MAAM,GAAGjuB,MAAM,CAAC2T,MAAP,CAAc3V,KAAK,CAACiwB,MAApB,CAAf;AACA,MAAI2mB,IAAJ;;AACA,MACE3mB,MAAM,CAACpsB,MAAP,KAAkB,CAAlB,IACCosB,MAAM,CAACpsB,MAAP,KAAkB,CAAlB,IAAuBosB,MAAM,CAAC,CAAD,CAAN,CAAUvsB,IAAV,CAAe/B,EAAf,KAAsB3B,KAAK,CAACP,MAAN,CAAaiE,IAAb,CAAkB/B,EAFlE,EAGE;AACAi1C,IAAAA,IAAI,GAAG,KAAP;AACD,GALD,MAKO;AACLA,IAAAA,IAAI,GAAG,IAAP;AACD;;AAED,sBACEr3C;AACE,IAAA,SAAS,uCACPq3C,IAAI,GAAG,oCAAH,GAA0C,EADvC;AADX,kBAKEr3C;AAAK,IAAA,SAAS,EAAC;AAAf,KACG0wB,MAAM,CACJ3qB,MADF,CACS;AAAA,QAAG5B,IAAH,QAAGA,IAAH;AAAA,WAAcA,IAAI,CAAC/B,EAAL,KAAY3B,KAAK,CAACP,MAAN,CAAaiE,IAAb,CAAkB/B,EAA5C;AAAA,GADT,EAEE6C,GAFF,CAEM;AAAA,QAAGd,IAAH,SAAGA,IAAH;AAAA,wBACHnE,6BAAC,MAAD;AACE,MAAA,KAAK,EAAEmE,IAAI,CAACwM,KADd;AAEE,MAAA,IAAI,EAAE,EAFR;AAGE,MAAA,IAAI,EAAExM,IAAI,CAACvD,IAAL,IAAauD,IAAI,CAAC/B,EAH1B;AAIE,MAAA,GAAG,EAAE+B,IAAI,CAAC/B;AAJZ,MADG;AAAA,GAFN,CADH,CALF,eAiBEpC;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AAAM,IAAA,SAAS,EAAC;AAAhB,IADF,eAEEA;AAAM,IAAA,SAAS,EAAC;AAAhB,IAFF,eAGEA;AAAM,IAAA,SAAS,EAAC;AAAhB,IAHF,CAjBF,CADF;AAyBD,CArCD;;AAuCAo3C,eAAe,CAACvpC,SAAhB,GAA4B;AAC1B;AACA;AACA3N,EAAAA,MAAM,EAAE4N,SAAS,CAACmF,MAHQ;;AAI1B;AACAyd,EAAAA,MAAM,EAAE5iB,SAAS,CAACmF,MAAV,CAAiBjF;AALC,CAA5B;AAQA,qCAAehO,cAAK,CAACmO,IAAN,CAAWipC,eAAX,CAAf;;ACzDA;AAMA;;;;;;;AAMA,IAAME,MAAM,GAAG,SAATA,MAAS,OAAwC;AAAA,MAArCrnC,QAAqC,QAArCA,QAAqC;AAAA,+BAA3BsnC,YAA2B;AAAA,MAA3BA,YAA2B,kCAAZ,KAAY;;AAAA,oBAClC7mC,gBAAU,CAAC5P,cAAD,CADwB;AAAA,MAC7CkjC,MAD6C,eAC7CA,MAD6C;;;AAGrD,MAAIA,MAAM,IAAIuT,YAAd,EAA4B,OAAO,IAAP;AAE5B,sBAAOv3C;AAAK,IAAA,SAAS;AAAd,KAAyCiQ,QAAzC,CAAP;AACD,CAND;;AAQAqnC,MAAM,CAACzpC,SAAP,GAAmB;AACjB;AACA0pC,EAAAA,YAAY,EAAEzpC,SAAS,CAACqE;AAFP,CAAnB;AAKA,4BAAenS,cAAK,CAACmO,IAAN,CAAWmpC,MAAX,CAAf;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}